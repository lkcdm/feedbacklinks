import{r as a,d as w,a as p,U as f}from"./framework.5WOR9rZB.js";const b={__name:"LinkInterceptor",setup(v){const o=a([]),s=a([]),i=a(!1),d=async()=>{try{const t=await(await fetch("/link-whitlist.json")).json();i.value=t.enable,t.links&&(o.value=t.links),t.domain&&(s.value=t.domain)}catch(e){console.error("Failed to load whitelist:",e)}},u=e=>{try{if(!e||e.startsWith("#")||e.startsWith("javascript:")||new URL(e,window.location.origin).pathname==="/external-link.html")return!1;const n=r=>new URL(r).hostname.replace("www.","");return n(window.location.href)!==n(e)}catch{return!1}},m=e=>{try{const t=new URL(e).hostname.replace("www.","");return s.value.some(n=>{const r=new URL(n).hostname.replace("www.","");return t===r})}catch{return!1}},c=e=>{e.preventDefault();const t=e.currentTarget.href;console.log("Opening external link:",t);const r=document.documentElement.classList.contains("dark")?"dark":"normal",h=btoa(t);window.open(`/external-link.html?url=${h}&mode=${r}`,"_blank")},l=()=>{document.querySelectorAll("a").forEach(e=>{if(u(e.href)&&!e.classList.contains("no-intercept")){if(i.value&&(o.value.includes(e.href)||m(e.href))||e.dataset.intercepted)return;e.dataset.intercepted=!0,e.addEventListener("click",c)}})};return w(async()=>{await d(),l();let e;new MutationObserver(()=>{clearTimeout(e),e=setTimeout(()=>l(),100)}).observe(document.body,{childList:!0,subtree:!0})}),p(()=>{document.querySelectorAll("a").forEach(e=>{e.dataset.intercepted&&(e.removeEventListener("click",c),delete e.dataset.intercepted)})}),(e,t)=>f(" 这是一个无渲染组件 ")}};export{b as _};
