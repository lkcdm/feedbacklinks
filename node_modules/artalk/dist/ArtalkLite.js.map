{"version":3,"file":"ArtalkLite.js","sources":["../src/api/v2.ts","../../../node_modules/.pnpm/abortcontroller-polyfill@1.7.5/node_modules/abortcontroller-polyfill/dist/polyfill-patch-fetch.js","../src/api/fetch.ts","../src/api/index.ts","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/she.js","../../../node_modules/.pnpm/assignment@2.0.0/node_modules/assignment/assignment.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/lowercase.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/toMap.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/attributes.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/elements.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/parser.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/sanitizer.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/insane.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/defaults.js","../src/lib/sanitizer.ts","../../../node_modules/.pnpm/hanabi@0.4.0/node_modules/hanabi/dist/hanabi.js","../src/lib/highlight.ts","../src/lib/marked-renderer.ts","../src/lib/marked.ts","../src/lib/merge-deep.ts","../src/data.ts","../src/lib/utils.ts","../src/i18n/en.ts","../src/i18n/external.ts","../src/i18n/index.ts","../src/i18n/zh-CN.ts","../src/lib/event-manager.ts","../src/defaults.ts","../src/config.ts","../src/lib/watch-conf.ts","../src/context.ts","../src/api/handler.ts","../src/lib/ui.ts","../src/components/checker/captcha-renders.ts","../src/components/checker/captcha.ts","../src/components/checker/admin.ts","../src/components/dialog.ts","../src/components/checker/index.ts","../src/lib/component.ts","../src/editor/editor.html?raw","../src/editor/ui.ts","../src/plugins/editor/_plug.ts","../src/plugins/editor/mover.ts","../src/editor/state.ts","../src/editor/editor.ts","../src/layer/sidebar-layer.ts","../src/layer/sidebar-layer.html?raw","../src/list/layout/nest.ts","../src/list/nest.ts","../src/list/layout/flat.ts","../src/list/layout/index.ts","../src/comment/height-limit.ts","../src/comment/renders/header.ts","../src/components/action-btn.ts","../src/comment/renders/actions.ts","../src/comment/renders/index.ts","../src/comment/renders/avatar.ts","../src/comment/renders/content.ts","../src/comment/renders/reply-at.ts","../src/comment/renders/reply-to.ts","../src/comment/renders/pending.ts","../src/comment/render.ts","../src/comment/comment.html?raw","../src/comment/actions.ts","../src/comment/comment-node.ts","../src/lib/detect.ts","../src/components/read-more-btn.ts","../src/list/paginator/read-more.ts","../src/components/pagination.ts","../src/list/paginator/up-down.ts","../src/list/page.ts","../src/list/list.ts","../src/list/list.html?raw","../src/list/comment.ts","../src/layer/scrollbar-helper.ts","../src/layer/layer.ts","../src/layer/wrap.ts","../src/layer/layer-manager.ts","../src/lib/user.ts","../src/service.ts","../src/plugins/stat.ts","../src/plugins/markdown.ts","../src/plugins/editor/local-storage.ts","../src/plugins/editor/submit-add.ts","../src/plugins/editor/submit.ts","../src/plugins/editor/emoticons.ts","../src/plugins/editor/upload.ts","../src/plugins/editor/preview.ts","../src/plugins/editor/index.ts","../src/plugins/editor/header-event.ts","../src/plugins/editor/header-user.ts","../src/plugins/editor/header-link.ts","../src/plugins/editor/textarea.ts","../src/plugins/editor/submit-btn.ts","../src/plugins/editor/state-reply.ts","../src/plugins/editor/state-edit.ts","../src/plugins/editor/closable.ts","../src/plugins/editor/_kit.ts","../src/plugins/editor-kit.ts","../src/plugins/list/goto-focus.ts","../src/components/error-dialog.ts","../src/plugins/version-check.ts","../src/plugins/dark-mode.ts","../src/plugins/index.ts","../src/plugins/admin-only-elem.ts","../src/plugins/list/index.ts","../src/plugins/list/fetch.ts","../src/plugins/list/loading.ts","../src/plugins/list/unread.ts","../src/plugins/list/with-editor.ts","../src/plugins/list/count.ts","../src/plugins/list/sidebar-btn.ts","../src/plugins/list/unread-badge.ts","../src/plugins/list/dropdown.ts","../src/plugins/list/goto-dispatcher.ts","../src/plugins/list/no-comment.ts","../src/plugins/list/copyright.ts","../src/plugins/list/time-ticking.ts","../src/plugins/list/error-dialog.ts","../src/plugins/list/reach-bottom.ts","../src/plugins/list/goto-first.ts","../src/plugins/notifies.ts","../src/load.ts","../src/artalk.ts","../src/main.ts"],"sourcesContent":["/* eslint-disable */\n/* tslint:disable */\n/*\n * ---------------------------------------------------------------\n * ## THIS FILE WAS GENERATED VIA SWAGGER-TYPESCRIPT-API        ##\n * ##                                                           ##\n * ## AUTHOR: acacode                                           ##\n * ## SOURCE: https://github.com/acacode/swagger-typescript-api ##\n * ---------------------------------------------------------------\n */\n\nexport interface AuthAuthProviderInfo {\n  icon: string\n  label: string\n  name: string\n  path?: string\n}\n\nexport interface CommonApiVersionData {\n  app: string\n  commit_hash: string\n  version: string\n}\n\nexport interface CommonConfData {\n  frontend_conf: CommonMap\n  version: CommonApiVersionData\n}\n\nexport interface CommonJSONResult {\n  /** Data */\n  data: any\n  /** Message */\n  msg: string\n}\n\nexport type CommonMap = Record<string, any>\n\nexport interface EntityCookedComment {\n  badge_color: string\n  badge_name: string\n  content: string\n  content_marked: string\n  date: string\n  email_encrypted: string\n  id: number\n  ip_region: string\n  is_allow_reply: boolean\n  is_collapsed: boolean\n  is_pending: boolean\n  is_pinned: boolean\n  is_verified: boolean\n  link: string\n  nick: string\n  page_key: string\n  page_url: string\n  rid: number\n  site_name: string\n  ua: string\n  user_id: number\n  visible: boolean\n  vote_down: number\n  vote_up: number\n}\n\nexport interface EntityCookedNotify {\n  comment_id: number\n  id: number\n  is_emailed: boolean\n  is_read: boolean\n  read_link: string\n  user_id: number\n}\n\nexport interface EntityCookedPage {\n  admin_only: boolean\n  date: string\n  id: number\n  key: string\n  pv: number\n  site_name: string\n  title: string\n  url: string\n  vote_down: number\n  vote_up: number\n}\n\nexport interface EntityCookedSite {\n  first_url: string\n  id: number\n  name: string\n  urls: string[]\n  urls_raw: string\n}\n\nexport interface EntityCookedUser {\n  badge_color: string\n  badge_name: string\n  email: string\n  id: number\n  is_admin: boolean\n  link: string\n  name: string\n  receive_email: boolean\n}\n\nexport interface EntityCookedUserForAdmin {\n  badge_color: string\n  badge_name: string\n  comment_count: number\n  email: string\n  id: number\n  is_admin: boolean\n  is_in_conf: boolean\n  last_ip: string\n  last_ua: string\n  link: string\n  name: string\n  receive_email: boolean\n}\n\nexport type HandlerMap = Record<string, any>\n\nexport interface HandlerParamsCaptchaVerify {\n  /** The captcha value to check */\n  value: string\n}\n\nexport interface HandlerParamsCommentCreate {\n  /** The comment content */\n  content: string\n  /** The comment email */\n  email: string\n  /** The comment link */\n  link?: string\n  /** The comment name */\n  name: string\n  /** The comment page_key */\n  page_key: string\n  /** The comment page_title */\n  page_title?: string\n  /** The comment rid */\n  rid?: number\n  /** The site name of your content scope */\n  site_name: string\n  /** The comment ua */\n  ua?: string\n}\n\nexport interface HandlerParamsCommentUpdate {\n  /** The comment content */\n  content: string\n  /** The comment email */\n  email?: string\n  /** The comment ip */\n  ip?: string\n  /** The comment is_collapsed */\n  is_collapsed: boolean\n  /** The comment is_pending */\n  is_pending: boolean\n  /** The comment is_pinned */\n  is_pinned: boolean\n  /** The comment link */\n  link?: string\n  /** The comment nick */\n  nick?: string\n  /** The comment page_key */\n  page_key: string\n  /** The comment rid */\n  rid: number\n  /** The site name of your content scope */\n  site_name: string\n  /** The comment ua */\n  ua?: string\n}\n\nexport interface HandlerParamsEmailSend {\n  /** The body of email */\n  body: string\n  /** The subject of email */\n  subject: string\n  /** The email address of the receiver */\n  to_addr: string\n}\n\nexport interface HandlerParamsNotifyReadAll {\n  /** The user email */\n  email: string\n  /** The username */\n  name: string\n}\n\nexport interface HandlerParamsPageFetchAll {\n  /** If not empty, only fetch pages of this site */\n  site_name?: string\n}\n\nexport interface HandlerParamsPagePV {\n  /** The page key */\n  page_key: string\n  /** The page title */\n  page_title?: string\n  /** The site name of your content scope */\n  site_name?: string\n}\n\nexport interface HandlerParamsPageUpdate {\n  /** Updated page admin_only option */\n  admin_only: boolean\n  /** Updated page key */\n  key: string\n  /** The site name of your content scope */\n  site_name: string\n  /** Updated page title */\n  title: string\n}\n\nexport interface HandlerParamsSettingApply {\n  /** The content of the config file in YAML format */\n  yaml: string\n}\n\nexport interface HandlerParamsSiteCreate {\n  /** The site name */\n  name: string\n  /** The site urls */\n  urls: string[]\n}\n\nexport interface HandlerParamsSiteUpdate {\n  /** Updated site name */\n  name: string\n  /** Updated site urls */\n  urls: string[]\n}\n\nexport interface HandlerParamsTransferImport {\n  /** Automatically answer yes for all questions */\n  assumeyes?: boolean\n  /** The JSON data */\n  json_data?: string\n  /** The JSON file path */\n  json_file?: string\n  /** The target site name */\n  target_site_name?: string\n  /** The target site url */\n  target_site_url?: string\n  /** Keep domain */\n  url_keep_domain?: boolean\n  /** Enable URL resolver */\n  url_resolver?: boolean\n}\n\nexport interface HandlerParamsUserCreate {\n  /** The user badge color (hex format) */\n  badge_color?: string\n  /** The user badge name */\n  badge_name?: string\n  /** The user email */\n  email: string\n  /** The user is an admin */\n  is_admin: boolean\n  /** The user link */\n  link?: string\n  /** The user name */\n  name: string\n  /** The user password */\n  password?: string\n  /** The user receive email */\n  receive_email: boolean\n}\n\nexport interface HandlerParamsUserLogin {\n  /** The user email */\n  email: string\n  /** The username */\n  name?: string\n  /** The user password */\n  password: string\n}\n\nexport interface HandlerParamsUserUpdate {\n  /** The user badge color (hex format) */\n  badge_color?: string\n  /** The user badge name */\n  badge_name?: string\n  /** The user email */\n  email: string\n  /** The user is an admin */\n  is_admin: boolean\n  /** The user link */\n  link?: string\n  /** The user name */\n  name: string\n  /** The user password */\n  password?: string\n  /** The user receive email */\n  receive_email: boolean\n}\n\nexport interface HandlerParamsVote {\n  /** The user email */\n  email?: string\n  /** The username */\n  name?: string\n}\n\nexport interface HandlerRequestAuthDataMergeApply {\n  user_name: string\n}\n\nexport interface HandlerRequestAuthEmailLogin {\n  code?: string\n  email: string\n  password?: string\n}\n\nexport interface HandlerRequestAuthEmailRegister {\n  code: string\n  email: string\n  link?: string\n  name?: string\n  password: string\n}\n\nexport interface HandlerRequestAuthEmailSend {\n  email: string\n}\n\nexport interface HandlerResponseAdminUserList {\n  count: number\n  users: EntityCookedUserForAdmin[]\n}\n\nexport interface HandlerResponseAuthDataMergeApply {\n  deleted_user_count: number\n  update_comments_count: number\n  update_notifies_count: number\n  update_votes_count: number\n  /** Empty if login user is target user no need to re-login */\n  user_token: string\n}\n\nexport interface HandlerResponseAuthDataMergeCheck {\n  need_merge: boolean\n  user_names: string[]\n}\n\nexport interface HandlerResponseCaptchaGet {\n  img_data: string\n}\n\nexport interface HandlerResponseCaptchaStatus {\n  is_pass: boolean\n}\n\nexport interface HandlerResponseCommentCreate {\n  badge_color: string\n  badge_name: string\n  content: string\n  content_marked: string\n  date: string\n  email_encrypted: string\n  id: number\n  ip_region: string\n  is_allow_reply: boolean\n  is_collapsed: boolean\n  is_pending: boolean\n  is_pinned: boolean\n  is_verified: boolean\n  link: string\n  nick: string\n  page_key: string\n  page_url: string\n  rid: number\n  site_name: string\n  ua: string\n  user_id: number\n  visible: boolean\n  vote_down: number\n  vote_up: number\n}\n\nexport interface HandlerResponseCommentGet {\n  /** The comment detail */\n  comment: EntityCookedComment\n  /** The reply comment if exists (like reply) */\n  reply_comment: EntityCookedComment\n}\n\nexport interface HandlerResponseCommentList {\n  comments: EntityCookedComment[]\n  count: number\n  page: EntityCookedPage\n  roots_count: number\n}\n\nexport interface HandlerResponseCommentUpdate {\n  badge_color: string\n  badge_name: string\n  content: string\n  content_marked: string\n  date: string\n  email_encrypted: string\n  id: number\n  ip_region: string\n  is_allow_reply: boolean\n  is_collapsed: boolean\n  is_pending: boolean\n  is_pinned: boolean\n  is_verified: boolean\n  link: string\n  nick: string\n  page_key: string\n  page_url: string\n  rid: number\n  site_name: string\n  ua: string\n  user_id: number\n  visible: boolean\n  vote_down: number\n  vote_up: number\n}\n\nexport interface HandlerResponseConfAuthProviders {\n  anonymous: boolean\n  providers: AuthAuthProviderInfo[]\n}\n\nexport interface HandlerResponseConfDomain {\n  /** Is the domain trusted */\n  is_trusted: boolean\n  /** The origin of the domain */\n  origin: string\n}\n\nexport interface HandlerResponseNotifyList {\n  count: number\n  notifies: EntityCookedNotify[]\n}\n\nexport interface HandlerResponsePageFetch {\n  admin_only: boolean\n  date: string\n  id: number\n  key: string\n  pv: number\n  site_name: string\n  title: string\n  url: string\n  vote_down: number\n  vote_up: number\n}\n\nexport interface HandlerResponsePageFetchStatus {\n  /** The number of pages that have been fetched */\n  done: number\n  /** If the task is in progress */\n  is_progress: boolean\n  /** The message of the task status */\n  msg: string\n  /** The total number of pages */\n  total: number\n}\n\nexport interface HandlerResponsePageList {\n  count: number\n  pages: EntityCookedPage[]\n}\n\nexport interface HandlerResponsePagePV {\n  pv: number\n}\n\nexport interface HandlerResponsePageUpdate {\n  admin_only: boolean\n  date: string\n  id: number\n  key: string\n  pv: number\n  site_name: string\n  title: string\n  url: string\n  vote_down: number\n  vote_up: number\n}\n\nexport interface HandlerResponseSettingGet {\n  yaml: string\n}\n\nexport interface HandlerResponseSettingTemplate {\n  yaml: string\n}\n\nexport interface HandlerResponseSiteCreate {\n  first_url: string\n  id: number\n  name: string\n  urls: string[]\n  urls_raw: string\n}\n\nexport interface HandlerResponseSiteList {\n  count: number\n  sites: EntityCookedSite[]\n}\n\nexport interface HandlerResponseSiteUpdate {\n  first_url: string\n  id: number\n  name: string\n  urls: string[]\n  urls_raw: string\n}\n\nexport interface HandlerResponseTransferExport {\n  /** The exported data which is a JSON string */\n  artrans: string\n}\n\nexport interface HandlerResponseTransferUpload {\n  /** The uploaded file name which can be used to import */\n  filename: string\n}\n\nexport interface HandlerResponseUpload {\n  file_name: string\n  file_type: string\n  public_url: string\n}\n\nexport interface HandlerResponseUserCreate {\n  badge_color: string\n  badge_name: string\n  comment_count: number\n  email: string\n  id: number\n  is_admin: boolean\n  is_in_conf: boolean\n  last_ip: string\n  last_ua: string\n  link: string\n  name: string\n  receive_email: boolean\n}\n\nexport interface HandlerResponseUserInfo {\n  is_login: boolean\n  notifies: EntityCookedNotify[]\n  notifies_count: number\n  user: EntityCookedUser\n}\n\nexport interface HandlerResponseUserLogin {\n  token: string\n  user: EntityCookedUser\n}\n\nexport interface HandlerResponseUserStatus {\n  is_admin: boolean\n  is_login: boolean\n}\n\nexport interface HandlerResponseUserUpdate {\n  badge_color: string\n  badge_name: string\n  comment_count: number\n  email: string\n  id: number\n  is_admin: boolean\n  is_in_conf: boolean\n  last_ip: string\n  last_ua: string\n  link: string\n  name: string\n  receive_email: boolean\n}\n\nexport interface HandlerResponseVote {\n  down: number\n  up: number\n}\n\nexport type QueryParamsType = Record<string | number, any>\nexport type ResponseFormat = keyof Omit<Body, 'body' | 'bodyUsed'>\n\nexport interface FullRequestParams extends Omit<RequestInit, 'body'> {\n  /** set parameter to `true` for call `securityWorker` for this request */\n  secure?: boolean\n  /** request path */\n  path: string\n  /** content type of request body */\n  type?: ContentType\n  /** query params */\n  query?: QueryParamsType\n  /** format of response (i.e. response.json() -> format: \"json\") */\n  format?: ResponseFormat\n  /** request body */\n  body?: unknown\n  /** base url */\n  baseUrl?: string\n  /** request cancellation token */\n  cancelToken?: CancelToken\n}\n\nexport type RequestParams = Omit<FullRequestParams, 'body' | 'method' | 'query' | 'path'>\n\nexport interface ApiConfig<SecurityDataType = unknown> {\n  baseUrl?: string\n  baseApiParams?: Omit<RequestParams, 'baseUrl' | 'cancelToken' | 'signal'>\n  securityWorker?: (\n    securityData: SecurityDataType | null,\n  ) => Promise<RequestParams | void> | RequestParams | void\n  customFetch?: typeof fetch\n}\n\nexport interface HttpResponse<D extends unknown, E extends unknown = unknown> extends Response {\n  data: D\n  error: E\n}\n\ntype CancelToken = Symbol | string | number\n\nexport enum ContentType {\n  Json = 'application/json',\n  FormData = 'multipart/form-data',\n  UrlEncoded = 'application/x-www-form-urlencoded',\n  Text = 'text/plain',\n}\n\nexport class HttpClient<SecurityDataType = unknown> {\n  public baseUrl: string = '/api/v2'\n  private securityData: SecurityDataType | null = null\n  private securityWorker?: ApiConfig<SecurityDataType>['securityWorker']\n  private abortControllers = new Map<CancelToken, AbortController>()\n  private customFetch = (...fetchParams: Parameters<typeof fetch>) => fetch(...fetchParams)\n\n  private baseApiParams: RequestParams = {\n    credentials: 'same-origin',\n    headers: {},\n    redirect: 'follow',\n    referrerPolicy: 'no-referrer',\n  }\n\n  constructor(apiConfig: ApiConfig<SecurityDataType> = {}) {\n    Object.assign(this, apiConfig)\n  }\n\n  public setSecurityData = (data: SecurityDataType | null) => {\n    this.securityData = data\n  }\n\n  protected encodeQueryParam(key: string, value: any) {\n    const encodedKey = encodeURIComponent(key)\n    return `${encodedKey}=${encodeURIComponent(typeof value === 'number' ? value : `${value}`)}`\n  }\n\n  protected addQueryParam(query: QueryParamsType, key: string) {\n    return this.encodeQueryParam(key, query[key])\n  }\n\n  protected addArrayQueryParam(query: QueryParamsType, key: string) {\n    const value = query[key]\n    return value.map((v: any) => this.encodeQueryParam(key, v)).join('&')\n  }\n\n  protected toQueryString(rawQuery?: QueryParamsType): string {\n    const query = rawQuery || {}\n    const keys = Object.keys(query).filter((key) => 'undefined' !== typeof query[key])\n    return keys\n      .map((key) =>\n        Array.isArray(query[key])\n          ? this.addArrayQueryParam(query, key)\n          : this.addQueryParam(query, key),\n      )\n      .join('&')\n  }\n\n  protected addQueryParams(rawQuery?: QueryParamsType): string {\n    const queryString = this.toQueryString(rawQuery)\n    return queryString ? `?${queryString}` : ''\n  }\n\n  private contentFormatters: Record<ContentType, (input: any) => any> = {\n    [ContentType.Json]: (input: any) =>\n      input !== null && (typeof input === 'object' || typeof input === 'string')\n        ? JSON.stringify(input)\n        : input,\n    [ContentType.Text]: (input: any) =>\n      input !== null && typeof input !== 'string' ? JSON.stringify(input) : input,\n    [ContentType.FormData]: (input: any) =>\n      Object.keys(input || {}).reduce((formData, key) => {\n        const property = input[key]\n        formData.append(\n          key,\n          property instanceof Blob\n            ? property\n            : typeof property === 'object' && property !== null\n            ? JSON.stringify(property)\n            : `${property}`,\n        )\n        return formData\n      }, new FormData()),\n    [ContentType.UrlEncoded]: (input: any) => this.toQueryString(input),\n  }\n\n  protected mergeRequestParams(params1: RequestParams, params2?: RequestParams): RequestParams {\n    return {\n      ...this.baseApiParams,\n      ...params1,\n      ...(params2 || {}),\n      headers: {\n        ...(this.baseApiParams.headers || {}),\n        ...(params1.headers || {}),\n        ...((params2 && params2.headers) || {}),\n      },\n    }\n  }\n\n  protected createAbortSignal = (cancelToken: CancelToken): AbortSignal | undefined => {\n    if (this.abortControllers.has(cancelToken)) {\n      const abortController = this.abortControllers.get(cancelToken)\n      if (abortController) {\n        return abortController.signal\n      }\n      return void 0\n    }\n\n    const abortController = new AbortController()\n    this.abortControllers.set(cancelToken, abortController)\n    return abortController.signal\n  }\n\n  public abortRequest = (cancelToken: CancelToken) => {\n    const abortController = this.abortControllers.get(cancelToken)\n\n    if (abortController) {\n      abortController.abort()\n      this.abortControllers.delete(cancelToken)\n    }\n  }\n\n  public request = async <T = any, E = any>({\n    body,\n    secure,\n    path,\n    type,\n    query,\n    format,\n    baseUrl,\n    cancelToken,\n    ...params\n  }: FullRequestParams): Promise<HttpResponse<T, E>> => {\n    const secureParams =\n      ((typeof secure === 'boolean' ? secure : this.baseApiParams.secure) &&\n        this.securityWorker &&\n        (await this.securityWorker(this.securityData))) ||\n      {}\n    const requestParams = this.mergeRequestParams(params, secureParams)\n    const queryString = query && this.toQueryString(query)\n    const payloadFormatter = this.contentFormatters[type || ContentType.Json]\n    const responseFormat = format || requestParams.format\n\n    return this.customFetch(\n      `${baseUrl || this.baseUrl || ''}${path}${queryString ? `?${queryString}` : ''}`,\n      {\n        ...requestParams,\n        headers: {\n          ...(requestParams.headers || {}),\n          ...(type && type !== ContentType.FormData ? { 'Content-Type': type } : {}),\n        },\n        signal: (cancelToken ? this.createAbortSignal(cancelToken) : requestParams.signal) || null,\n        body: typeof body === 'undefined' || body === null ? null : payloadFormatter(body),\n      },\n    ).then(async (response) => {\n      const r = response as HttpResponse<T, E>\n      r.data = null as unknown as T\n      r.error = null as unknown as E\n\n      const data = !responseFormat\n        ? r\n        : await response[responseFormat]()\n            .then((data) => {\n              if (r.ok) {\n                r.data = data\n              } else {\n                r.error = data\n              }\n              return r\n            })\n            .catch((e) => {\n              r.error = e\n              return r\n            })\n\n      if (cancelToken) {\n        this.abortControllers.delete(cancelToken)\n      }\n\n      if (!response.ok) throw data\n      return data\n    })\n  }\n}\n\n/**\n * @title Artalk API\n * @version 2.0\n * @license MIT (https://github.com/ArtalkJS/Artalk/blob/master/LICENSE)\n * @baseUrl /api/v2\n * @contact API Support <artalkjs@gmail.com> (https://artalk.js.org)\n *\n * Artalk is a modern comment system based on Golang.\n */\nexport class Api<SecurityDataType extends unknown> extends HttpClient<SecurityDataType> {\n  auth = {\n    /**\n * @description Login by email with verify code (Need send email verify code first) or password\n *\n * @tags Auth\n * @name LoginByEmail\n * @summary Login by email\n * @request POST:/auth/email/login\n * @response `200` `HandlerResponseUserLogin` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    loginByEmail: (data: HandlerRequestAuthEmailLogin, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseUserLogin,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/auth/email/login`,\n        method: 'POST',\n        body: data,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Register by email and verify code (if user exists, will update user, like forget password. Need send email verify code first)\n *\n * @tags Auth\n * @name RegisterByEmail\n * @summary Register by email\n * @request POST:/auth/email/register\n * @response `200` `HandlerResponseUserLogin` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    registerByEmail: (data: HandlerRequestAuthEmailRegister, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseUserLogin,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/auth/email/register`,\n        method: 'POST',\n        body: data,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Send email including verify code to user\n *\n * @tags Auth\n * @name SendVerifyEmail\n * @summary Send verify email\n * @request POST:/auth/email/send\n * @response `200` `(HandlerMap & {\n    msg?: string,\n\n})` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    sendVerifyEmail: (data: HandlerRequestAuthEmailSend, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap & {\n          msg?: string\n        },\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/auth/email/send`,\n        method: 'POST',\n        body: data,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Get all users with same email, if there are more than one user with same email, need merge\n *\n * @tags Auth\n * @name CheckDataMerge\n * @summary Check data merge\n * @request GET:/auth/merge\n * @secure\n * @response `200` `HandlerResponseAuthDataMergeCheck` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    checkDataMerge: (params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseAuthDataMergeCheck,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/auth/merge`,\n        method: 'GET',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description This function is to solve the problem of multiple users with the same email address, should be called after user login and then check, and perform data merge.\n *\n * @tags Auth\n * @name ApplyDataMerge\n * @summary Apply data merge\n * @request POST:/auth/merge\n * @secure\n * @response `200` `HandlerResponseAuthDataMergeApply` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    applyDataMerge: (data: HandlerRequestAuthDataMergeApply, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseAuthDataMergeApply,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/auth/merge`,\n        method: 'POST',\n        body: data,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n  }\n  cache = {\n    /**\n * @description Flush all cache on the server\n *\n * @tags Cache\n * @name FlushCache\n * @summary Flush Cache\n * @request POST:/cache/flush\n * @secure\n * @response `200` `(HandlerMap & {\n    msg?: string,\n\n})` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n */\n    flushCache: (params: RequestParams = {}) =>\n      this.request<\n        HandlerMap & {\n          msg?: string\n        },\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/cache/flush`,\n        method: 'POST',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Cache warming helps you to pre-load the cache to improve the performance of the first request\n *\n * @tags Cache\n * @name WarmUpCache\n * @summary Warm-Up Cache\n * @request POST:/cache/warm_up\n * @secure\n * @response `200` `(HandlerMap & {\n    msg?: string,\n\n})` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n */\n    warmUpCache: (params: RequestParams = {}) =>\n      this.request<\n        HandlerMap & {\n          msg?: string\n        },\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/cache/warm_up`,\n        method: 'POST',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n  }\n  captcha = {\n    /**\n * @description Get a base64 encoded captcha image or a HTML page to verify for user\n *\n * @tags Captcha\n * @name GetCaptcha\n * @summary Get Captcha\n * @request GET:/captcha\n * @response `200` `HandlerResponseCaptchaGet` OK\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    getCaptcha: (params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseCaptchaGet,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/captcha`,\n        method: 'GET',\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Get the status of the user's captcha verification\n     *\n     * @tags Captcha\n     * @name GetCaptchaStatus\n     * @summary Get Captcha Status\n     * @request GET:/captcha/status\n     * @response `200` `HandlerResponseCaptchaStatus` OK\n     */\n    getCaptchaStatus: (params: RequestParams = {}) =>\n      this.request<HandlerResponseCaptchaStatus, any>({\n        path: `/captcha/status`,\n        method: 'GET',\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Verify user enters correct captcha code\n *\n * @tags Captcha\n * @name VerifyCaptcha\n * @summary Verify Captcha\n * @request POST:/captcha/verify\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    img_data?: string,\n\n})` Forbidden\n */\n    verifyCaptcha: (data: HandlerParamsCaptchaVerify, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          img_data?: string\n        }\n      >({\n        path: `/captcha/verify`,\n        method: 'POST',\n        body: data,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n  }\n  comments = {\n    /**\n * @description Get a list of comments by some conditions\n *\n * @tags Comment\n * @name GetComments\n * @summary Get Comment List\n * @request GET:/comments\n * @secure\n * @response `200` `HandlerResponseCommentList` OK\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    getComments: (\n      query: {\n        /** The user email */\n        email?: string\n        /** Enable flat_mode */\n        flat_mode?: boolean\n        /** The limit for pagination */\n        limit?: number\n        /** The username */\n        name?: string\n        /** The offset for pagination */\n        offset?: number\n        /** The comment page_key */\n        page_key: string\n        /** The scope of comments */\n        scope?: 'page' | 'user' | 'site'\n        /** Search keywords */\n        search?: string\n        /** The site name of your content scope */\n        site_name?: string\n        /** Sort by condition */\n        sort_by?: 'date_asc' | 'date_desc' | 'vote'\n        /** Message center show type */\n        type?: 'all' | 'mentions' | 'mine' | 'pending'\n        /** Only show comments by admin */\n        view_only_admin?: boolean\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponseCommentList,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/comments`,\n        method: 'GET',\n        query: query,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Create a new comment\n *\n * @tags Comment\n * @name CreateComment\n * @summary Create Comment\n * @request POST:/comments\n * @secure\n * @response `200` `HandlerResponseCommentCreate` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    createComment: (comment: HandlerParamsCommentCreate, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseCommentCreate,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/comments`,\n        method: 'POST',\n        body: comment,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Get the detail of a comment by comment id\n *\n * @tags Comment\n * @name GetComment\n * @summary Get a comment\n * @request GET:/comments/{id}\n * @response `200` `HandlerResponseCommentGet` OK\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    getComment: (id: number, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseCommentGet,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/comments/${id}`,\n        method: 'GET',\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Update a specific comment\n *\n * @tags Comment\n * @name UpdateComment\n * @summary Update Comment\n * @request PUT:/comments/{id}\n * @secure\n * @response `200` `HandlerResponseCommentUpdate` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    updateComment: (id: number, comment: HandlerParamsCommentUpdate, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseCommentUpdate,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/comments/${id}`,\n        method: 'PUT',\n        body: comment,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Delete a specific comment\n *\n * @tags Comment\n * @name DeleteComment\n * @summary Delete Comment\n * @request DELETE:/comments/{id}\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    deleteComment: (id: number, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/comments/${id}`,\n        method: 'DELETE',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n  }\n  conf = {\n    /**\n     * @description Get System Configs for UI\n     *\n     * @tags System\n     * @name Conf\n     * @summary Get System Configs\n     * @request GET:/conf\n     * @response `200` `CommonConfData` OK\n     */\n    conf: (params: RequestParams = {}) =>\n      this.request<CommonConfData, any>({\n        path: `/conf`,\n        method: 'GET',\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Get social login providers\n *\n * @tags System\n * @name GetSocialLoginProviders\n * @summary Get Social Login Providers\n * @request GET:/conf/auth/providers\n * @response `200` `HandlerResponseConfAuthProviders` OK\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n */\n    getSocialLoginProviders: (params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseConfAuthProviders,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/conf/auth/providers`,\n        method: 'GET',\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Get Domain Info\n     *\n     * @tags System\n     * @name GetDomain\n     * @summary Get Domain Info\n     * @request GET:/conf/domain\n     * @response `200` `HandlerResponseConfDomain` OK\n     */\n    getDomain: (\n      query?: {\n        /** Domain URL */\n        url?: string\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<HandlerResponseConfDomain, any>({\n        path: `/conf/domain`,\n        method: 'GET',\n        query: query,\n        format: 'json',\n        ...params,\n      }),\n  }\n  notifies = {\n    /**\n * @description Get a list of notifies for user\n *\n * @tags Notify\n * @name GetNotifies\n * @summary Get Notifies\n * @request GET:/notifies\n * @response `200` `HandlerResponseNotifyList` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    getNotifies: (\n      query: {\n        /** The user email */\n        email: string\n        /** The user name */\n        name: string\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponseNotifyList,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/notifies`,\n        method: 'GET',\n        query: query,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Mark all notifies as read for user\n *\n * @tags Notify\n * @name MarkAllNotifyRead\n * @summary Mark All Notifies as Read\n * @request POST:/notifies/read\n * @response `200` `HandlerMap` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    markAllNotifyRead: (options: HandlerParamsNotifyReadAll, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/notifies/read`,\n        method: 'POST',\n        body: options,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Mark specific notification as read for user\n *\n * @tags Notify\n * @name MarkNotifyRead\n * @summary Mark Notify as Read\n * @request POST:/notifies/{comment_id}/{notify_key}\n * @response `200` `HandlerMap` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    markNotifyRead: (commentId: number, notifyKey: string, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/notifies/${commentId}/${notifyKey}`,\n        method: 'POST',\n        format: 'json',\n        ...params,\n      }),\n  }\n  pages = {\n    /**\n * @description Get a list of pages by some conditions\n *\n * @tags Page\n * @name GetPages\n * @summary Get Page List\n * @request GET:/pages\n * @secure\n * @response `200` `HandlerResponsePageList` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n */\n    getPages: (\n      query?: {\n        /** The limit for pagination */\n        limit?: number\n        /** The offset for pagination */\n        offset?: number\n        /** The site name of your content scope */\n        site_name?: string\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponsePageList,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/pages`,\n        method: 'GET',\n        query: query,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Fetch the data of all pages\n *\n * @tags Page\n * @name FetchAllPages\n * @summary Fetch All Pages Data\n * @request POST:/pages/fetch\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    fetchAllPages: (options: HandlerParamsPageFetchAll, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/pages/fetch`,\n        method: 'POST',\n        body: options,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Get the status of the task of fetching all pages\n     *\n     * @tags Page\n     * @name GetPageFetchStatus\n     * @summary Get Pages Fetch Status\n     * @request GET:/pages/fetch/status\n     * @secure\n     * @response `200` `HandlerResponsePageFetchStatus` OK\n     */\n    getPageFetchStatus: (params: RequestParams = {}) =>\n      this.request<HandlerResponsePageFetchStatus, any>({\n        path: `/pages/fetch/status`,\n        method: 'GET',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Increase and get the number of page views\n     *\n     * @tags Page\n     * @name LogPv\n     * @summary Increase Page Views (PV)\n     * @request POST:/pages/pv\n     * @response `200` `HandlerResponsePagePV` OK\n     */\n    logPv: (page: HandlerParamsPagePV, params: RequestParams = {}) =>\n      this.request<HandlerResponsePagePV, any>({\n        path: `/pages/pv`,\n        method: 'POST',\n        body: page,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Update a specific page\n *\n * @tags Page\n * @name UpdatePage\n * @summary Update Page\n * @request PUT:/pages/{id}\n * @secure\n * @response `200` `HandlerResponsePageUpdate` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    updatePage: (id: number, page: HandlerParamsPageUpdate, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponsePageUpdate,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/pages/${id}`,\n        method: 'PUT',\n        body: page,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Delete a specific page\n *\n * @tags Page\n * @name DeletePage\n * @summary Delete Page\n * @request DELETE:/pages/{id}\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    deletePage: (id: number, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/pages/${id}`,\n        method: 'DELETE',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Fetch the data of a specific page\n *\n * @tags Page\n * @name FetchPage\n * @summary Fetch Page Data\n * @request POST:/pages/{id}/fetch\n * @secure\n * @response `200` `HandlerResponsePageFetch` OK\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    fetchPage: (id: number, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponsePageFetch,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/pages/${id}/fetch`,\n        method: 'POST',\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n  }\n  sendEmail = {\n    /**\n * @description Send an email to test the email sender\n *\n * @tags System\n * @name SendEmail\n * @summary Send Email\n * @request POST:/send_email\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `500` `HandlerMap` Internal Server Error\n */\n    sendEmail: (email: HandlerParamsEmailSend, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        | (HandlerMap & {\n            msg?: string\n          })\n        | HandlerMap\n      >({\n        path: `/send_email`,\n        method: 'POST',\n        body: email,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n  }\n  settings = {\n    /**\n * @description Get settings from app config file\n *\n * @tags System\n * @name GetSettings\n * @summary Get Settings\n * @request GET:/settings\n * @secure\n * @response `200` `HandlerResponseSettingGet` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    getSettings: (params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseSettingGet,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/settings`,\n        method: 'GET',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Apply settings and restart the server\n *\n * @tags System\n * @name ApplySettings\n * @summary Save and apply Settings\n * @request PUT:/settings\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    applySettings: (settings: HandlerParamsSettingApply, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/settings`,\n        method: 'PUT',\n        body: settings,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Get config templates in different languages for rendering the settings page in the frontend\n     *\n     * @tags System\n     * @name GetSettingsTemplate\n     * @summary Get Settings Template\n     * @request GET:/settings/template/{locale}\n     * @secure\n     * @response `200` `HandlerResponseSettingTemplate` OK\n     */\n    getSettingsTemplate: (locale: string, params: RequestParams = {}) =>\n      this.request<HandlerResponseSettingTemplate, any>({\n        path: `/settings/template/${locale}`,\n        method: 'GET',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n  }\n  sites = {\n    /**\n     * @description Get a list of sites by some conditions\n     *\n     * @tags Site\n     * @name GetSites\n     * @summary Get Site List\n     * @request GET:/sites\n     * @secure\n     * @response `200` `HandlerResponseSiteList` OK\n     */\n    getSites: (params: RequestParams = {}) =>\n      this.request<HandlerResponseSiteList, any>({\n        path: `/sites`,\n        method: 'GET',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Create a new site\n *\n * @tags Site\n * @name CreateSite\n * @summary Create Site\n * @request POST:/sites\n * @secure\n * @response `200` `HandlerResponseSiteCreate` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    createSite: (site: HandlerParamsSiteCreate, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseSiteCreate,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/sites`,\n        method: 'POST',\n        body: site,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Update a specific site\n     *\n     * @tags Site\n     * @name UpdateSite\n     * @summary Update Site\n     * @request PUT:/sites/{id}\n     * @secure\n     * @response `200` `HandlerResponseSiteUpdate` OK\n     */\n    updateSite: (id: number, site: HandlerParamsSiteUpdate, params: RequestParams = {}) =>\n      this.request<HandlerResponseSiteUpdate, any>({\n        path: `/sites/${id}`,\n        method: 'PUT',\n        body: site,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Delete a specific site\n *\n * @tags Site\n * @name DeleteSite\n * @summary Site Delete\n * @request DELETE:/sites/{id}\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    deleteSite: (id: number, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/sites/${id}`,\n        method: 'DELETE',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n  }\n  stats = {\n    /**\n * @description Get the statistics of various data analysis\n *\n * @tags Statistic\n * @name GetStats\n * @summary Statistic\n * @request GET:/stats/{type}\n * @response `200` `CommonJSONResult` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    getStats: (\n      type:\n        | 'latest_comments'\n        | 'latest_pages'\n        | 'pv_most_pages'\n        | 'comment_most_pages'\n        | 'page_pv'\n        | 'site_pv'\n        | 'page_comment'\n        | 'site_comment'\n        | 'rand_comments'\n        | 'rand_pages',\n      query?: {\n        /** The limit for pagination */\n        limit?: number\n        /** multiple page keys separated by commas */\n        page_keys?: string\n        /** The site name of your content scope */\n        site_name?: string\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        CommonJSONResult,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/stats/${type}`,\n        method: 'GET',\n        query: query,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n  }\n  transfer = {\n    /**\n * @description Export data from Artalk\n *\n * @tags Transfer\n * @name ExportArtrans\n * @summary Export Artrans\n * @request GET:/transfer/export\n * @secure\n * @response `200` `HandlerResponseTransferExport` OK\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    exportArtrans: (params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseTransferExport,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/transfer/export`,\n        method: 'GET',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Import data to Artalk\n     *\n     * @tags Transfer\n     * @name ImportArtrans\n     * @summary Import Artrans\n     * @request POST:/transfer/import\n     * @secure\n     * @response `200` `string` OK\n     */\n    importArtrans: (data: HandlerParamsTransferImport, params: RequestParams = {}) =>\n      this.request<string, any>({\n        path: `/transfer/import`,\n        method: 'POST',\n        body: data,\n        secure: true,\n        type: ContentType.Json,\n        ...params,\n      }),\n\n    /**\n * @description Upload a file to prepare to import\n *\n * @tags Transfer\n * @name UploadArtrans\n * @summary Upload Artrans\n * @request POST:/transfer/upload\n * @secure\n * @response `200` `(HandlerResponseTransferUpload & {\n    filename?: string,\n\n})` OK\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    uploadArtrans: (\n      data: {\n        /**\n         * Upload file in preparation for import task\n         * @format binary\n         */\n        file: File\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponseTransferUpload & {\n          filename?: string\n        },\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/transfer/upload`,\n        method: 'POST',\n        body: data,\n        secure: true,\n        type: ContentType.FormData,\n        format: 'json',\n        ...params,\n      }),\n  }\n  upload = {\n    /**\n * @description Upload file from this endpoint\n *\n * @tags Upload\n * @name Upload\n * @summary Upload\n * @request POST:/upload\n * @secure\n * @response `200` `HandlerResponseUpload` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    upload: (\n      data: {\n        /**\n         * Upload file\n         * @format binary\n         */\n        file: File\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponseUpload,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/upload`,\n        method: 'POST',\n        body: data,\n        secure: true,\n        type: ContentType.FormData,\n        format: 'json',\n        ...params,\n      }),\n  }\n  user = {\n    /**\n * @description Get user info to prepare for login or check current user status\n *\n * @tags Auth\n * @name GetUser\n * @summary Get User Info\n * @request GET:/user\n * @secure\n * @response `200` `HandlerResponseUserInfo` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n */\n    getUser: (\n      query?: {\n        /** The user email */\n        email?: string\n        /** The username */\n        name?: string\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponseUserInfo,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/user`,\n        method: 'GET',\n        query: query,\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Login user by name or email\n *\n * @tags Auth\n * @name Login\n * @summary Get Access Token\n * @request POST:/user/access_token\n * @response `200` `HandlerResponseUserLogin` OK\n * @response `400` `(HandlerMap & {\n    data?: {\n    need_name_select?: (string)[],\n\n},\n    msg?: string,\n\n})` Multiple users with the same email address are matched\n * @response `401` `(HandlerMap & {\n    msg?: string,\n\n})` Unauthorized\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    login: (user: HandlerParamsUserLogin, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseUserLogin,\n        | (HandlerMap & {\n            data?: {\n              need_name_select?: string[]\n            }\n            msg?: string\n          })\n        | (HandlerMap & {\n            msg?: string\n          })\n      >({\n        path: `/user/access_token`,\n        method: 'POST',\n        body: user,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Get user login status by header Authorization\n     *\n     * @tags Auth\n     * @name GetUserStatus\n     * @summary Get Login Status\n     * @request GET:/user/status\n     * @secure\n     * @response `200` `HandlerResponseUserStatus` OK\n     */\n    getUserStatus: (\n      query?: {\n        /** The user email */\n        email?: string\n        /** The username */\n        name?: string\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<HandlerResponseUserStatus, any>({\n        path: `/user/status`,\n        method: 'GET',\n        query: query,\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n  }\n  users = {\n    /**\n * @description Create a new user\n *\n * @tags User\n * @name CreateUser\n * @summary Create User\n * @request POST:/users\n * @secure\n * @response `200` `HandlerResponseUserCreate` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    createUser: (user: HandlerParamsUserCreate, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseUserCreate,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/users`,\n        method: 'POST',\n        body: user,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Update a specific user\n *\n * @tags User\n * @name UpdateUser\n * @summary Update User\n * @request PUT:/users/{id}\n * @secure\n * @response `200` `HandlerResponseUserUpdate` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    updateUser: (id: number, user: HandlerParamsUserUpdate, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseUserUpdate,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/users/${id}`,\n        method: 'PUT',\n        body: user,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Delete a specific user\n *\n * @tags User\n * @name DeleteUser\n * @summary Delete User\n * @request DELETE:/users/{id}\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    deleteUser: (id: number, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/users/${id}`,\n        method: 'DELETE',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Get a list of users by some conditions\n *\n * @tags User\n * @name GetUsers\n * @summary Get User List\n * @request GET:/users/{type}\n * @secure\n * @response `200` `HandlerResponseAdminUserList` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n */\n    getUsers: (\n      type?: 'all' | 'admin' | 'in_conf',\n      query?: {\n        /** The limit for pagination */\n        limit?: number\n        /** The offset for pagination */\n        offset?: number\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponseAdminUserList,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/users/${type}`,\n        method: 'GET',\n        query: query,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n  }\n  version = {\n    /**\n     * @description Get the version of Artalk\n     *\n     * @tags System\n     * @name GetVersion\n     * @summary Get Version Info\n     * @request GET:/version\n     * @response `200` `CommonApiVersionData` OK\n     */\n    getVersion: (params: RequestParams = {}) =>\n      this.request<CommonApiVersionData, any>({\n        path: `/version`,\n        method: 'GET',\n        format: 'json',\n        ...params,\n      }),\n  }\n  votes = {\n    /**\n * @description Sync the number of votes in the `comments` or `pages` data tables to keep them the same as the `votes` table\n *\n * @tags Vote\n * @name SyncVotes\n * @summary Sync Vote Data\n * @request POST:/votes/sync\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n */\n    syncVotes: (params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/votes/sync`,\n        method: 'POST',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Vote for a specific comment or page\n *\n * @tags Vote\n * @name Vote\n * @summary Vote\n * @request POST:/votes/{type}/{target_id}\n * @response `200` `HandlerResponseVote` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    vote: (\n      type: 'comment_up' | 'comment_down' | 'page_up' | 'page_down',\n      targetId: number,\n      vote: HandlerParamsVote,\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponseVote,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/votes/${type}/${targetId}`,\n        method: 'POST',\n        body: vote,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n  }\n}\n","(function (factory) {\n  typeof define === 'function' && define.amd ? define(factory) :\n  factory();\n})((function () { 'use strict';\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    Object.defineProperty(Constructor, \"prototype\", {\n      writable: false\n    });\n    return Constructor;\n  }\n\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    Object.defineProperty(subClass, \"prototype\", {\n      writable: false\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n      return o.__proto__ || Object.getPrototypeOf(o);\n    };\n    return _getPrototypeOf(o);\n  }\n\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n      o.__proto__ = p;\n      return o;\n    };\n    return _setPrototypeOf(o, p);\n  }\n\n  function _isNativeReflectConstruct() {\n    if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === \"function\") return true;\n\n    try {\n      Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return self;\n  }\n\n  function _possibleConstructorReturn(self, call) {\n    if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n      return call;\n    } else if (call !== void 0) {\n      throw new TypeError(\"Derived constructors may only return object or undefined\");\n    }\n\n    return _assertThisInitialized(self);\n  }\n\n  function _createSuper(Derived) {\n    var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n    return function _createSuperInternal() {\n      var Super = _getPrototypeOf(Derived),\n          result;\n\n      if (hasNativeReflectConstruct) {\n        var NewTarget = _getPrototypeOf(this).constructor;\n\n        result = Reflect.construct(Super, arguments, NewTarget);\n      } else {\n        result = Super.apply(this, arguments);\n      }\n\n      return _possibleConstructorReturn(this, result);\n    };\n  }\n\n  function _superPropBase(object, property) {\n    while (!Object.prototype.hasOwnProperty.call(object, property)) {\n      object = _getPrototypeOf(object);\n      if (object === null) break;\n    }\n\n    return object;\n  }\n\n  function _get() {\n    if (typeof Reflect !== \"undefined\" && Reflect.get) {\n      _get = Reflect.get.bind();\n    } else {\n      _get = function _get(target, property, receiver) {\n        var base = _superPropBase(target, property);\n\n        if (!base) return;\n        var desc = Object.getOwnPropertyDescriptor(base, property);\n\n        if (desc.get) {\n          return desc.get.call(arguments.length < 3 ? target : receiver);\n        }\n\n        return desc.value;\n      };\n    }\n\n    return _get.apply(this, arguments);\n  }\n\n  var Emitter = /*#__PURE__*/function () {\n    function Emitter() {\n      _classCallCheck(this, Emitter);\n\n      Object.defineProperty(this, 'listeners', {\n        value: {},\n        writable: true,\n        configurable: true\n      });\n    }\n\n    _createClass(Emitter, [{\n      key: \"addEventListener\",\n      value: function addEventListener(type, callback, options) {\n        if (!(type in this.listeners)) {\n          this.listeners[type] = [];\n        }\n\n        this.listeners[type].push({\n          callback: callback,\n          options: options\n        });\n      }\n    }, {\n      key: \"removeEventListener\",\n      value: function removeEventListener(type, callback) {\n        if (!(type in this.listeners)) {\n          return;\n        }\n\n        var stack = this.listeners[type];\n\n        for (var i = 0, l = stack.length; i < l; i++) {\n          if (stack[i].callback === callback) {\n            stack.splice(i, 1);\n            return;\n          }\n        }\n      }\n    }, {\n      key: \"dispatchEvent\",\n      value: function dispatchEvent(event) {\n        if (!(event.type in this.listeners)) {\n          return;\n        }\n\n        var stack = this.listeners[event.type];\n        var stackToCall = stack.slice();\n\n        for (var i = 0, l = stackToCall.length; i < l; i++) {\n          var listener = stackToCall[i];\n\n          try {\n            listener.callback.call(this, event);\n          } catch (e) {\n            Promise.resolve().then(function () {\n              throw e;\n            });\n          }\n\n          if (listener.options && listener.options.once) {\n            this.removeEventListener(event.type, listener.callback);\n          }\n        }\n\n        return !event.defaultPrevented;\n      }\n    }]);\n\n    return Emitter;\n  }();\n\n  var AbortSignal = /*#__PURE__*/function (_Emitter) {\n    _inherits(AbortSignal, _Emitter);\n\n    var _super = _createSuper(AbortSignal);\n\n    function AbortSignal() {\n      var _this;\n\n      _classCallCheck(this, AbortSignal);\n\n      _this = _super.call(this); // Some versions of babel does not transpile super() correctly for IE <= 10, if the parent\n      // constructor has failed to run, then \"this.listeners\" will still be undefined and then we call\n      // the parent constructor directly instead as a workaround. For general details, see babel bug:\n      // https://github.com/babel/babel/issues/3041\n      // This hack was added as a fix for the issue described here:\n      // https://github.com/Financial-Times/polyfill-library/pull/59#issuecomment-477558042\n\n      if (!_this.listeners) {\n        Emitter.call(_assertThisInitialized(_this));\n      } // Compared to assignment, Object.defineProperty makes properties non-enumerable by default and\n      // we want Object.keys(new AbortController().signal) to be [] for compat with the native impl\n\n\n      Object.defineProperty(_assertThisInitialized(_this), 'aborted', {\n        value: false,\n        writable: true,\n        configurable: true\n      });\n      Object.defineProperty(_assertThisInitialized(_this), 'onabort', {\n        value: null,\n        writable: true,\n        configurable: true\n      });\n      Object.defineProperty(_assertThisInitialized(_this), 'reason', {\n        value: undefined,\n        writable: true,\n        configurable: true\n      });\n      return _this;\n    }\n\n    _createClass(AbortSignal, [{\n      key: \"toString\",\n      value: function toString() {\n        return '[object AbortSignal]';\n      }\n    }, {\n      key: \"dispatchEvent\",\n      value: function dispatchEvent(event) {\n        if (event.type === 'abort') {\n          this.aborted = true;\n\n          if (typeof this.onabort === 'function') {\n            this.onabort.call(this, event);\n          }\n        }\n\n        _get(_getPrototypeOf(AbortSignal.prototype), \"dispatchEvent\", this).call(this, event);\n      }\n    }]);\n\n    return AbortSignal;\n  }(Emitter);\n  var AbortController = /*#__PURE__*/function () {\n    function AbortController() {\n      _classCallCheck(this, AbortController);\n\n      // Compared to assignment, Object.defineProperty makes properties non-enumerable by default and\n      // we want Object.keys(new AbortController()) to be [] for compat with the native impl\n      Object.defineProperty(this, 'signal', {\n        value: new AbortSignal(),\n        writable: true,\n        configurable: true\n      });\n    }\n\n    _createClass(AbortController, [{\n      key: \"abort\",\n      value: function abort(reason) {\n        var event;\n\n        try {\n          event = new Event('abort');\n        } catch (e) {\n          if (typeof document !== 'undefined') {\n            if (!document.createEvent) {\n              // For Internet Explorer 8:\n              event = document.createEventObject();\n              event.type = 'abort';\n            } else {\n              // For Internet Explorer 11:\n              event = document.createEvent('Event');\n              event.initEvent('abort', false, false);\n            }\n          } else {\n            // Fallback where document isn't available:\n            event = {\n              type: 'abort',\n              bubbles: false,\n              cancelable: false\n            };\n          }\n        }\n\n        var signalReason = reason;\n\n        if (signalReason === undefined) {\n          if (typeof document === 'undefined') {\n            signalReason = new Error('This operation was aborted');\n            signalReason.name = 'AbortError';\n          } else {\n            try {\n              signalReason = new DOMException('signal is aborted without reason');\n            } catch (err) {\n              // IE 11 does not support calling the DOMException constructor, use a\n              // regular error object on it instead.\n              signalReason = new Error('This operation was aborted');\n              signalReason.name = 'AbortError';\n            }\n          }\n        }\n\n        this.signal.reason = signalReason;\n        this.signal.dispatchEvent(event);\n      }\n    }, {\n      key: \"toString\",\n      value: function toString() {\n        return '[object AbortController]';\n      }\n    }]);\n\n    return AbortController;\n  }();\n\n  if (typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n    // These are necessary to make sure that we get correct output for:\n    // Object.prototype.toString.call(new AbortController())\n    AbortController.prototype[Symbol.toStringTag] = 'AbortController';\n    AbortSignal.prototype[Symbol.toStringTag] = 'AbortSignal';\n  }\n\n  function polyfillNeeded(self) {\n    if (self.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL) {\n      console.log('__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill');\n      return true;\n    } // Note that the \"unfetch\" minimal fetch polyfill defines fetch() without\n    // defining window.Request, and this polyfill need to work on top of unfetch\n    // so the below feature detection needs the !self.AbortController part.\n    // The Request.prototype check is also needed because Safari versions 11.1.2\n    // up to and including 12.1.x has a window.AbortController present but still\n    // does NOT correctly implement abortable fetch:\n    // https://bugs.webkit.org/show_bug.cgi?id=174980#c2\n\n\n    return typeof self.Request === 'function' && !self.Request.prototype.hasOwnProperty('signal') || !self.AbortController;\n  }\n\n  /**\n   * Note: the \"fetch.Request\" default value is available for fetch imported from\n   * the \"node-fetch\" package and not in browsers. This is OK since browsers\n   * will be importing umd-polyfill.js from that path \"self\" is passed the\n   * decorator so the default value will not be used (because browsers that define\n   * fetch also has Request). One quirky setup where self.fetch exists but\n   * self.Request does not is when the \"unfetch\" minimal fetch polyfill is used\n   * on top of IE11; for this case the browser will try to use the fetch.Request\n   * default value which in turn will be undefined but then then \"if (Request)\"\n   * will ensure that you get a patched fetch but still no Request (as expected).\n   * @param {fetch, Request = fetch.Request}\n   * @returns {fetch: abortableFetch, Request: AbortableRequest}\n   */\n\n  function abortableFetchDecorator(patchTargets) {\n    if ('function' === typeof patchTargets) {\n      patchTargets = {\n        fetch: patchTargets\n      };\n    }\n\n    var _patchTargets = patchTargets,\n        fetch = _patchTargets.fetch,\n        _patchTargets$Request = _patchTargets.Request,\n        NativeRequest = _patchTargets$Request === void 0 ? fetch.Request : _patchTargets$Request,\n        NativeAbortController = _patchTargets.AbortController,\n        _patchTargets$__FORCE = _patchTargets.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,\n        __FORCE_INSTALL_ABORTCONTROLLER_POLYFILL = _patchTargets$__FORCE === void 0 ? false : _patchTargets$__FORCE;\n\n    if (!polyfillNeeded({\n      fetch: fetch,\n      Request: NativeRequest,\n      AbortController: NativeAbortController,\n      __FORCE_INSTALL_ABORTCONTROLLER_POLYFILL: __FORCE_INSTALL_ABORTCONTROLLER_POLYFILL\n    })) {\n      return {\n        fetch: fetch,\n        Request: Request\n      };\n    }\n\n    var Request = NativeRequest; // Note that the \"unfetch\" minimal fetch polyfill defines fetch() without\n    // defining window.Request, and this polyfill need to work on top of unfetch\n    // hence we only patch it if it's available. Also we don't patch it if signal\n    // is already available on the Request prototype because in this case support\n    // is present and the patching below can cause a crash since it assigns to\n    // request.signal which is technically a read-only property. This latter error\n    // happens when you run the main5.js node-fetch example in the repo\n    // \"abortcontroller-polyfill-examples\". The exact error is:\n    //   request.signal = init.signal;\n    //   ^\n    // TypeError: Cannot set property signal of #<Request> which has only a getter\n\n    if (Request && !Request.prototype.hasOwnProperty('signal') || __FORCE_INSTALL_ABORTCONTROLLER_POLYFILL) {\n      Request = function Request(input, init) {\n        var signal;\n\n        if (init && init.signal) {\n          signal = init.signal; // Never pass init.signal to the native Request implementation when the polyfill has\n          // been installed because if we're running on top of a browser with a\n          // working native AbortController (i.e. the polyfill was installed due to\n          // __FORCE_INSTALL_ABORTCONTROLLER_POLYFILL being set), then passing our\n          // fake AbortSignal to the native fetch will trigger:\n          // TypeError: Failed to construct 'Request': member signal is not of type AbortSignal.\n\n          delete init.signal;\n        }\n\n        var request = new NativeRequest(input, init);\n\n        if (signal) {\n          Object.defineProperty(request, 'signal', {\n            writable: false,\n            enumerable: false,\n            configurable: true,\n            value: signal\n          });\n        }\n\n        return request;\n      };\n\n      Request.prototype = NativeRequest.prototype;\n    }\n\n    var realFetch = fetch;\n\n    var abortableFetch = function abortableFetch(input, init) {\n      var signal = Request && Request.prototype.isPrototypeOf(input) ? input.signal : init ? init.signal : undefined;\n\n      if (signal) {\n        var abortError;\n\n        try {\n          abortError = new DOMException('Aborted', 'AbortError');\n        } catch (err) {\n          // IE 11 does not support calling the DOMException constructor, use a\n          // regular error object on it instead.\n          abortError = new Error('Aborted');\n          abortError.name = 'AbortError';\n        } // Return early if already aborted, thus avoiding making an HTTP request\n\n\n        if (signal.aborted) {\n          return Promise.reject(abortError);\n        } // Turn an event into a promise, reject it once `abort` is dispatched\n\n\n        var cancellation = new Promise(function (_, reject) {\n          signal.addEventListener('abort', function () {\n            return reject(abortError);\n          }, {\n            once: true\n          });\n        });\n\n        if (init && init.signal) {\n          // Never pass .signal to the native implementation when the polyfill has\n          // been installed because if we're running on top of a browser with a\n          // working native AbortController (i.e. the polyfill was installed due to\n          // __FORCE_INSTALL_ABORTCONTROLLER_POLYFILL being set), then passing our\n          // fake AbortSignal to the native fetch will trigger:\n          // TypeError: Failed to execute 'fetch' on 'Window': member signal is not of type AbortSignal.\n          delete init.signal;\n        } // Return the fastest promise (don't need to wait for request to finish)\n\n\n        return Promise.race([cancellation, realFetch(input, init)]);\n      }\n\n      return realFetch(input, init);\n    };\n\n    return {\n      fetch: abortableFetch,\n      Request: Request\n    };\n  }\n\n  (function (self) {\n\n    if (!polyfillNeeded(self)) {\n      return;\n    }\n\n    if (!self.fetch) {\n      console.warn('fetch() is not available, cannot install abortcontroller-polyfill');\n      return;\n    }\n\n    var _abortableFetch = abortableFetchDecorator(self),\n        fetch = _abortableFetch.fetch,\n        Request = _abortableFetch.Request;\n\n    self.fetch = fetch;\n    self.Request = Request;\n    Object.defineProperty(self, 'AbortController', {\n      writable: true,\n      enumerable: false,\n      configurable: true,\n      value: AbortController\n    });\n    Object.defineProperty(self, 'AbortSignal', {\n      writable: true,\n      enumerable: false,\n      configurable: true,\n      value: AbortSignal\n    });\n  })(typeof self !== 'undefined' ? self : global);\n\n}));\n","import 'abortcontroller-polyfill/dist/polyfill-patch-fetch'\n\nimport { ApiOptions } from './options'\nimport { FetchError } from '@/types'\n\nexport const Fetch = async (\n  opts: ApiOptions,\n  input: string | URL | Request,\n  init?: RequestInit,\n) => {\n  const apiToken = opts.getApiToken && opts.getApiToken()\n\n  const headers = new Headers({\n    Authorization: apiToken ? `Bearer ${apiToken}` : '',\n    ...init?.headers,\n  })\n\n  if (!headers.get('Authorization')) headers.delete('Authorization')\n\n  // \n  const resp = await fetch(input, {\n    ...init,\n    headers,\n  })\n\n  if (!resp.ok) {\n    // Deserialize response body (if it is JSON, otherwise returns `{}`)\n    const json: any = (await resp.json().catch(() => {})) || {}\n\n    let retry = false\n    opts.handlers &&\n      (await opts.handlers.get().reduce(async (promise, item) => {\n        await promise\n        if (json[item.action] === true) {\n          await item.handler(json)\n          retry = true\n        }\n      }, Promise.resolve()))\n\n    if (retry) return Fetch(opts, input, init)\n    throw createError(resp.status, json)\n  }\n\n  return resp\n}\n\nexport class FetchException extends Error implements FetchError {\n  code: number = 0\n  message: string = 'fetch error'\n  data?: any\n}\n\nfunction createError(code: number, data: any): FetchException {\n  const err = new FetchException()\n  err.message = data.msg || data.message || 'fetch error'\n  err.code = code\n  err.data = data\n  console.error(err)\n  return err\n}\n","import { ApiOptions } from './options'\nimport { Api as ApiV2 } from './v2'\nimport { Fetch } from './fetch'\n\nexport * from './options'\nexport * from './handler'\n\nexport class Api extends ApiV2<void> {\n  private _opts: ApiOptions\n\n  constructor(opts: ApiOptions) {\n    super({\n      baseUrl: opts.baseURL,\n      customFetch: (input, init) => Fetch(opts, input, init),\n    })\n\n    this._opts = opts\n  }\n\n  /**\n   * Get user info as params for request\n   *\n   * @returns Request params with user info\n   */\n  getUserFields() {\n    const user = this._opts.userInfo\n    if (!user?.name || !user?.email) return undefined\n    return { name: user.name, email: user.email }\n  }\n}\n","'use strict';\n\nvar escapes = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#39;'\n};\nvar unescapes = {\n  '&amp;': '&',\n  '&lt;': '<',\n  '&gt;': '>',\n  '&quot;': '\"',\n  '&#39;': \"'\"\n};\nvar rescaped = /(&amp;|&lt;|&gt;|&quot;|&#39;)/g;\nvar runescaped = /[&<>\"']/g;\n\nfunction escapeHtmlChar (match) {\n  return escapes[match];\n}\nfunction unescapeHtmlChar (match) {\n  return unescapes[match];\n}\n\nfunction escapeHtml (text) {\n  return text == null ? '' : String(text).replace(runescaped, escapeHtmlChar);\n}\n\nfunction unescapeHtml (html) {\n  return html == null ? '' : String(html).replace(rescaped, unescapeHtmlChar);\n}\n\nescapeHtml.options = unescapeHtml.options = {};\n\nmodule.exports = {\n  encode: escapeHtml,\n  escape: escapeHtml,\n  decode: unescapeHtml,\n  unescape: unescapeHtml,\n  version: '1.0.0-browser'\n};\n","'use strict';\n\nfunction assignment (result) {\n  var stack = Array.prototype.slice.call(arguments, 1);\n  var item;\n  var key;\n  while (stack.length) {\n    item = stack.shift();\n    for (key in item) {\n      if (item.hasOwnProperty(key)) {\n        if (Object.prototype.toString.call(result[key]) === '[object Object]') {\n          result[key] = assignment(result[key], item[key]);\n        } else {\n          result[key] = item[key];\n        }\n      }\n    }\n  }\n  return result;\n}\n\nmodule.exports = assignment;\n","'use strict';\n\nmodule.exports = function lowercase (string) {\n  return typeof string === 'string' ? string.toLowerCase() : string;\n};\n","'use strict';\n\nfunction toMap (list) {\n  return list.reduce(asKey, {});\n}\n\nfunction asKey (accumulator, item) {\n  accumulator[item] = true;\n  return accumulator;\n}\n\nmodule.exports = toMap;\n","'use strict';\n\nvar toMap = require('./toMap');\nvar uris = ['background', 'base', 'cite', 'href', 'longdesc', 'src', 'usemap'];\n\nmodule.exports = {\n  uris: toMap(uris) // attributes that have an href and hence need to be sanitized\n};\n","'use strict';\n\nvar toMap = require('./toMap');\nvar voids = ['area', 'br', 'col', 'hr', 'img', 'wbr', 'input', 'base', 'basefont', 'link', 'meta'];\n\nmodule.exports = {\n  voids: toMap(voids)\n};\n","'use strict';\n\nvar he = require('he');\nvar lowercase = require('./lowercase');\nvar attributes = require('./attributes');\nvar elements = require('./elements');\nvar rstart = /^<\\s*([\\w:-]+)((?:\\s+[\\w:-]+(?:\\s*=\\s*(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>\\s]+))?)*)\\s*(\\/?)\\s*>/;\nvar rend = /^<\\s*\\/\\s*([\\w:-]+)[^>]*>/;\nvar rattrs = /([\\w:-]+)(?:\\s*=\\s*(?:(?:\"((?:[^\"])*)\")|(?:'((?:[^'])*)')|([^>\\s]+)))?/g;\nvar rtag = /^</;\nvar rtagend = /^<\\s*\\//;\n\nfunction createStack () {\n  var stack = [];\n  stack.lastItem = function lastItem () {\n    return stack[stack.length - 1];\n  };\n  return stack;\n}\n\nfunction parser (html, handler) {\n  var stack = createStack();\n  var last = html;\n  var chars;\n\n  while (html) {\n    parsePart();\n  }\n  parseEndTag(); // clean up any remaining tags\n\n  function parsePart () {\n    chars = true;\n    parseTag();\n\n    var same = html === last;\n    last = html;\n\n    if (same) { // discard, because it's invalid\n      html = '';\n    }\n  }\n\n  function parseTag () {\n    if (html.substr(0, 4) === '<!--') { // comments\n      parseComment();\n    } else if (rtagend.test(html)) {\n      parseEdge(rend, parseEndTag);\n    } else if (rtag.test(html)) {\n      parseEdge(rstart, parseStartTag);\n    }\n    parseTagDecode();\n  }\n\n  function parseEdge (regex, parser) {\n    var match = html.match(regex);\n    if (match) {\n      html = html.substring(match[0].length);\n      match[0].replace(regex, parser);\n      chars = false;\n    }\n  }\n\n  function parseComment () {\n    var index = html.indexOf('-->');\n    if (index >= 0) {\n      if (handler.comment) {\n        handler.comment(html.substring(4, index));\n      }\n      html = html.substring(index + 3);\n      chars = false;\n    }\n  }\n\n  function parseTagDecode () {\n    if (!chars) {\n      return;\n    }\n    var text;\n    var index = html.indexOf('<');\n    if (index >= 0) {\n      text = html.substring(0, index);\n      html = html.substring(index);\n    } else {\n      text = html;\n      html = '';\n    }\n    if (handler.chars) {\n      handler.chars(text);\n    }\n  }\n\n  function parseStartTag (tag, tagName, rest, unary) {\n    var attrs = {};\n    var low = lowercase(tagName);\n    var u = elements.voids[low] || !!unary;\n\n    rest.replace(rattrs, attrReplacer);\n\n    if (!u) {\n      stack.push(low);\n    }\n    if (handler.start) {\n      handler.start(low, attrs, u);\n    }\n\n    function attrReplacer (match, name, doubleQuotedValue, singleQuotedValue, unquotedValue) {\n      if (doubleQuotedValue === void 0 && singleQuotedValue === void 0 && unquotedValue === void 0) {\n        attrs[name] = void 0; // attribute is like <button disabled></button>\n      } else {\n        attrs[name] = he.decode(doubleQuotedValue || singleQuotedValue || unquotedValue || '');\n      }\n    }\n  }\n\n  function parseEndTag (tag, tagName) {\n    var i;\n    var pos = 0;\n    var low = lowercase(tagName);\n    if (low) {\n      for (pos = stack.length - 1; pos >= 0; pos--) {\n        if (stack[pos] === low) {\n          break; // find the closest opened tag of the same type\n        }\n      }\n    }\n    if (pos >= 0) {\n      for (i = stack.length - 1; i >= pos; i--) {\n        if (handler.end) { // close all the open elements, up the stack\n          handler.end(stack[i]);\n        }\n      }\n      stack.length = pos;\n    }\n  }\n}\n\nmodule.exports = parser;\n","'use strict';\n\nvar he = require('he');\nvar lowercase = require('./lowercase');\nvar attributes = require('./attributes');\nvar elements = require('./elements');\n\nfunction sanitizer (buffer, options) {\n  var last;\n  var context;\n  var o = options || {};\n\n  reset();\n\n  return {\n    start: start,\n    end: end,\n    chars: chars\n  };\n\n  function out (value) {\n    buffer.push(value);\n  }\n\n  function start (tag, attrs, unary) {\n    var low = lowercase(tag);\n\n    if (context.ignoring) {\n      ignore(low); return;\n    }\n    if ((o.allowedTags || []).indexOf(low) === -1) {\n      ignore(low); return;\n    }\n    if (o.filter && !o.filter({ tag: low, attrs: attrs })) {\n      ignore(low); return;\n    }\n\n    out('<');\n    out(low);\n    Object.keys(attrs).forEach(parse);\n    out(unary ? '/>' : '>');\n\n    function parse (key) {\n      var value = attrs[key];\n      var classesOk = (o.allowedClasses || {})[low] || [];\n      var attrsOk = (o.allowedAttributes || {})[low] || [];\n      var valid;\n      var lkey = lowercase(key);\n      if (lkey === 'class' && attrsOk.indexOf(lkey) === -1) {\n        value = value.split(' ').filter(isValidClass).join(' ').trim();\n        valid = value.length;\n      } else {\n        valid = attrsOk.indexOf(lkey) !== -1 && (attributes.uris[lkey] !== true || testUrl(value));\n      }\n      if (valid) {\n        out(' ');\n        out(key);\n        if (typeof value === 'string') {\n          out('=\"');\n          out(he.encode(value));\n          out('\"');\n        }\n      }\n      function isValidClass (className) {\n        return classesOk && classesOk.indexOf(className) !== -1;\n      }\n    }\n  }\n\n  function end (tag) {\n    var low = lowercase(tag);\n    var allowed = (o.allowedTags || []).indexOf(low) !== -1;\n    if (allowed) {\n      if (context.ignoring === false) {\n        out('</');\n        out(low);\n        out('>');\n      } else {\n        unignore(low);\n      }\n    } else {\n      unignore(low);\n    }\n  }\n\n  function testUrl (text) {\n    var start = text[0];\n    if (start === '#' || start === '/') {\n      return true;\n    }\n    var colon = text.indexOf(':');\n    if (colon === -1) {\n      return true;\n    }\n    var questionmark = text.indexOf('?');\n    if (questionmark !== -1 && colon > questionmark) {\n      return true;\n    }\n    var hash = text.indexOf('#');\n    if (hash !== -1 && colon > hash) {\n      return true;\n    }\n    return o.allowedSchemes.some(matches);\n\n    function matches (scheme) {\n      return text.indexOf(scheme + ':') === 0;\n    }\n  }\n\n  function chars (text) {\n    if (context.ignoring === false) {\n      out(o.transformText ? o.transformText(text) : text);\n    }\n  }\n\n  function ignore (tag) {\n    if (elements.voids[tag]) {\n      return;\n    }\n    if (context.ignoring === false) {\n      context = { ignoring: tag, depth: 1 };\n    } else if (context.ignoring === tag) {\n      context.depth++;\n    }\n  }\n\n  function unignore (tag) {\n    if (context.ignoring === tag) {\n      if (--context.depth <= 0) {\n        reset();\n      }\n    }\n  }\n\n  function reset () {\n    context = { ignoring: false, depth: 0 };\n  }\n}\n\nmodule.exports = sanitizer;\n","'use strict';\n\nvar he = require('he');\nvar assign = require('assignment');\nvar parser = require('./parser');\nvar sanitizer = require('./sanitizer');\nvar defaults = require('./defaults');\n\nfunction insane (html, options, strict) {\n  var buffer = [];\n  var configuration = strict === true ? options : assign({}, defaults, options);\n  var handler = sanitizer(buffer, configuration);\n\n  parser(html, handler);\n\n  return buffer.join('');\n}\n\ninsane.defaults = defaults;\nmodule.exports = insane;\n","'use strict';\n\nvar defaults = {\n  allowedAttributes: {\n    a: ['href', 'name', 'target', 'title', 'aria-label'],\n    iframe: ['allowfullscreen', 'frameborder', 'src'],\n    img: ['src', 'alt', 'title', 'aria-label']\n  },\n  allowedClasses: {},\n  allowedSchemes: ['http', 'https', 'mailto'],\n  allowedTags: [\n    'a', 'abbr', 'article', 'b', 'blockquote', 'br', 'caption', 'code', 'del', 'details', 'div', 'em',\n    'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'hr', 'i', 'img', 'ins', 'kbd', 'li', 'main', 'mark',\n    'ol', 'p', 'pre', 'section', 'span', 'strike', 'strong', 'sub', 'summary', 'sup', 'table',\n    'tbody', 'td', 'th', 'thead', 'tr', 'u', 'ul'\n  ],\n  filter: null\n};\n\nmodule.exports = defaults;\n","import insane from 'insane'\n\nconst insaneOptions = {\n  allowedClasses: {},\n  // @refer CVE-2018-8495\n  // @link https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-8495\n  // @link https://leucosite.com/Microsoft-Edge-RCE/\n  // @link https://medium.com/@knownsec404team/analysis-of-the-security-issues-of-url-scheme-in-pc-from-cve-2018-8495-934478a36756\n  allowedSchemes: [\n    'http',\n    'https',\n    'mailto',\n    'data', // for support base64 encoded image ()\n  ],\n  allowedTags: [\n    'a',\n    'abbr',\n    'article',\n    'b',\n    'blockquote',\n    'br',\n    'caption',\n    'code',\n    'del',\n    'details',\n    'div',\n    'em',\n    'h1',\n    'h2',\n    'h3',\n    'h4',\n    'h5',\n    'h6',\n    'hr',\n    'i',\n    'img',\n    'ins',\n    'kbd',\n    'li',\n    'main',\n    'mark',\n    'ol',\n    'p',\n    'pre',\n    'section',\n    'span',\n    'strike',\n    'strong',\n    'sub',\n    'summary',\n    'sup',\n    'table',\n    'tbody',\n    'td',\n    'th',\n    'thead',\n    'tr',\n    'u',\n    'ul',\n  ],\n  allowedAttributes: {\n    '*': ['title', 'accesskey'],\n    a: ['href', 'name', 'target', 'aria-label', 'rel'],\n    img: ['src', 'alt', 'title', 'atk-emoticon', 'aria-label', 'data-src', 'class', 'loading'],\n    // for code highlight\n    code: ['class'],\n    span: ['class', 'style'],\n  },\n  filter: (node) => {\n    // class whitelist\n    const allowed = [\n      ['code', /^hljs\\W+language-(.*)$/],\n      ['span', /^(hljs-.*)$/],\n      ['img', /^lazyload$/],\n    ]\n    allowed.forEach(([tag, reg]) => {\n      if (node.tag === tag && !!node.attrs.class && !(reg as RegExp).test(node.attrs.class)) {\n        delete node.attrs.class\n      }\n    })\n\n    // allow <span> set color sty\n    if (\n      node.tag === 'span' &&\n      !!node.attrs.style &&\n      !/^color:(\\W+)?#[0-9a-f]{3,6};?$/i.test(node.attrs.style)\n    ) {\n      delete node.attrs.style\n    }\n\n    return true\n  },\n}\n\nexport function sanitize(content: string): string {\n  // @link https://github.com/markedjs/marked/discussions/1232\n  // @link https://gist.github.com/lionel-rowe/bb384465ba4e4c81a9c8dada84167225\n  return insane(content, insaneOptions)\n}\n","(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global.hanabi = factory());\n}(this, (function () { 'use strict';\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar index$1 = createCommonjsModule(function (module) {\n'use strict';\n\nvar comment = module.exports = function () {\n\treturn new RegExp('(?:' + comment.line().source + ')|(?:' + comment.block().source + ')', 'gm');\n};\n\ncomment.line = function () {\n\treturn /(?:^|\\s)\\/\\/(.+?)$/gm;\n};\n\ncomment.block = function () {\n\treturn /\\/\\*([\\S\\s]*?)\\*\\//gm;\n};\n});\n\nvar defaultColors = ['23AC69', '91C132', 'F19726', 'E8552D', '1AAB8E', 'E1147F', '2980C1', '1BA1E6', '9FA0A0', 'F19726', 'E30B20', 'E30B20', 'A3338B'];\n\nvar index = function (input, ref) {\n  if ( ref === void 0 ) ref = {};\n  var colors = ref.colors; if ( colors === void 0 ) colors = defaultColors;\n\n  var index = 0;\n  var cache = {};\n  var wordRe = /[\\u4E00-\\u9FFF\\u3400-\\u4dbf\\uf900-\\ufaff\\u3040-\\u309f\\uac00-\\ud7af\\u0400-\\u04FF]+|\\w+/;\n  var leftAngleRe = /</;\n\n  var re = new RegExp((\"(\" + (wordRe.source) + \"|\" + (leftAngleRe.source) + \")|(\" + (index$1().source) + \")\"), 'gmi');\n  return input\n  .replace(re, function (m, word, cm) {\n    if (cm) {\n      return toComment(cm)\n    }\n\n    if (word === '<') {\n      return '&lt;'\n    }\n    var color;\n    if (cache[word]) {\n      color = cache[word];\n    } else {\n      color = colors[index];\n      cache[word] = color;\n    }\n\n    var out = \"<span style=\\\"color: #\" + color + \"\\\">\" + word + \"</span>\";\n    index = ++index % colors.length;\n    return out\n  })\n};\n\nfunction toComment(cm) {\n  return (\"<span style=\\\"color: slategray\\\">\" + cm + \"</span>\")\n}\n\nreturn index;\n\n})));\n","import hanabi from 'hanabi'\n\nexport function renderCode(code: string) {\n  return hanabi(code)\n}\n","import { marked } from 'marked'\nimport { renderCode } from './highlight'\nimport type { ArtalkConfig } from '@/types'\n\nexport interface RendererOptions {\n  imgLazyLoad: ArtalkConfig['imgLazyLoad']\n}\n\nexport function getRenderer(options: RendererOptions) {\n  const renderer = new marked.Renderer()\n  renderer.link = markedLinkRenderer(renderer, renderer.link)\n  renderer.code = markedCodeRenderer()\n  renderer.image = markedImageRenderer(renderer, renderer.image, options)\n  return renderer\n}\n\nconst markedLinkRenderer =\n  (renderer: any, orgLinkRenderer: (href: string, title: string, text: string) => string) =>\n  (href: string, title: string, text: string): string => {\n    const getLinkOrigin = (link: string) => {\n      try {\n        return new URL(link).origin\n      } catch {\n        return ''\n      }\n    }\n    const isSameOriginLink = getLinkOrigin(href) === window.location.origin\n    const html = orgLinkRenderer.call(renderer, href, title, text)\n    return html.replace(\n      /^<a /,\n      `<a target=\"_blank\" ${!isSameOriginLink ? `rel=\"noreferrer noopener nofollow\"` : ''} `,\n    )\n  }\n\nconst markedCodeRenderer =\n  () =>\n  (block: string, lang: string | undefined): string => {\n    // Colorize the block only if the language is known to highlight.js\n    const realLang = !lang ? 'plaintext' : lang\n    let colorized = block\n    if ((window as any).hljs) {\n      if (realLang && (window as any).hljs.getLanguage(realLang)) {\n        colorized = (window as any).hljs.highlight(realLang, block).value\n      }\n    } else {\n      colorized = renderCode(block)\n    }\n\n    return (\n      `<pre rel=\"${realLang}\">\\n` +\n      `<code class=\"hljs language-${realLang}\">${colorized.replace(/&amp;/g, '&')}</code>\\n` +\n      `</pre>`\n    )\n  }\n\nconst markedImageRenderer =\n  (\n    renderer: any,\n    orgImageRenderer: (href: string, title: string | null, text: string) => string,\n    { imgLazyLoad }: RendererOptions,\n  ) =>\n  (href: string, title: string | null, text: string): string => {\n    const html = orgImageRenderer.call(renderer, href, title, text)\n    if (!imgLazyLoad) return html\n    if (imgLazyLoad === 'native' || (imgLazyLoad as any) === true)\n      return html.replace(/^<img /, '<img class=\"lazyload\" loading=\"lazy\" ')\n    if (imgLazyLoad === 'data-src')\n      return html.replace(/^<img /, '<img class=\"lazyload\" ').replace('src=', 'data-src=')\n    return html\n  }\n","import { marked as libMarked, MarkedOptions } from 'marked'\n\nimport { sanitize } from './sanitizer'\nimport { renderCode } from './highlight'\nimport { getRenderer } from './marked-renderer'\nimport type { ArtalkConfig } from '@/types'\n\ntype Replacer = (raw: string) => string\n\nlet instance: typeof libMarked | undefined\nlet replacers: Replacer[] = []\n\nconst markedOptions: MarkedOptions = {\n  gfm: true,\n  breaks: true,\n  async: false,\n}\n\n/** Get Marked instance */\nexport function getInstance() {\n  return instance\n}\n\nexport function setReplacers(arr: Replacer[]) {\n  replacers = arr\n}\n\nexport interface MarkedInitOptions {\n  markedOptions: ArtalkConfig['markedOptions']\n  imgLazyLoad: ArtalkConfig['imgLazyLoad']\n}\n\n/**  marked */\nexport function initMarked(options: MarkedInitOptions) {\n  try {\n    if (!libMarked.name) return\n  } catch {\n    return\n  }\n\n  // @see https://github.com/markedjs/marked/blob/4afb228d956a415624c4e5554bb8f25d047676fe/src/Tokenizer.js#L329\n  libMarked.setOptions({\n    renderer: getRenderer({\n      imgLazyLoad: options.imgLazyLoad,\n    }),\n    ...markedOptions,\n    ...options.markedOptions,\n  })\n\n  instance = libMarked\n}\n\n/**  markdown */\nexport default function marked(src: string): string {\n  let markedContent = getInstance()?.parse(src) as string\n  if (!markedContent) {\n    //  Markdown \n    markedContent = simpleMarked(src)\n  }\n\n  let dest = sanitize(markedContent)\n\n  // \n  replacers.forEach((replacer) => {\n    if (typeof replacer === 'function') dest = replacer(dest)\n  })\n\n  return dest\n}\n\nfunction simpleMarked(src: string) {\n  return (\n    src\n      // .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n      .replace(\n        /```\\s*([^]+?.*?[^]+?[^]+?)```/g,\n        (_, code) => `<pre><code>${renderCode(code)}</code></pre>`,\n      )\n      // .replace(/`([^`]+?)`/g, '<code>$1</code>')\n      .replace(/!\\[(.*?)\\]\\((.*?)\\)/g, (_, alt, imgSrc) => `<img src=\"${imgSrc}\" alt=\"${alt}\" />`)\n      .replace(\n        /\\[(.*?)\\]\\((.*?)\\)/g,\n        (_, text, link) => `<a href=\"${link}\" target=\"_blank\">${text}</a>`,\n      )\n      .replace(/\\n/g, '<br>')\n  )\n}\n","/**\n * Performs a deep merge of objects and returns new object.\n * Does not modify objects (immutable) and merges arrays via concatenation.\n *\n * @param objects - Objects to merge\n * @returns New object with merged key/values\n */\nexport function mergeDeep<T>(...objects: any[]): T {\n  const isObject = (obj: any) => obj && typeof obj === 'object' && obj.constructor === Object\n\n  return objects.reduce((prev, obj) => {\n    Object.keys(obj ?? {}).forEach((key) => {\n      // Avoid prototype pollution\n      if (key === '__proto__' || key === 'constructor' || key === 'prototype') {\n        return\n      }\n\n      const pVal = prev[key]\n      const oVal = obj[key]\n\n      if (Array.isArray(pVal) && Array.isArray(oVal)) {\n        prev[key] = pVal.concat(...oVal)\n      } else if (isObject(pVal) && isObject(oVal)) {\n        prev[key] = mergeDeep(pVal, oVal)\n      } else {\n        prev[key] = oVal\n      }\n    })\n\n    return prev\n  }, {})\n}\n","import EventManager from './lib/event-manager'\nimport type {\n  NotifyData,\n  PageData,\n  CommentData,\n  DataManagerApi,\n  ListFetchParams,\n  ListLastFetchData,\n  EventPayloadMap,\n} from '@/types'\n\nexport class DataManager implements DataManagerApi {\n  private loading: boolean = false\n  private listLastFetch?: ListLastFetchData\n  private comments: CommentData[] = [] // Note:  + \n  private notifies: NotifyData[] = []\n  private page?: PageData\n\n  constructor(protected events: EventManager<EventPayloadMap>) {}\n\n  getLoading() {\n    return this.loading\n  }\n\n  setLoading(val: boolean) {\n    this.loading = val\n  }\n\n  getListLastFetch() {\n    return this.listLastFetch\n  }\n\n  setListLastFetch(val: ListLastFetchData) {\n    this.listLastFetch = val\n  }\n\n  // -------------------------------------------------------------------\n  //  Comments\n  // -------------------------------------------------------------------\n  getComments() {\n    return this.comments\n  }\n\n  fetchComments(params: Partial<ListFetchParams>) {\n    this.events.trigger('list-fetch', params)\n  }\n\n  findComment(id: number) {\n    return this.comments.find((c) => c.id === id)\n  }\n\n  clearComments() {\n    this.comments = []\n    this.events.trigger('list-loaded', this.comments)\n  }\n\n  loadComments(partialComments: CommentData[]) {\n    this.events.trigger('list-load', partialComments)\n\n    this.comments.push(...partialComments)\n\n    this.events.trigger('list-loaded', this.comments)\n  }\n\n  insertComment(comment: CommentData) {\n    this.comments.push(comment)\n\n    this.events.trigger('comment-inserted', comment)\n    this.events.trigger('list-loaded', this.comments) // list-loaded should always keep the last\n  }\n\n  updateComment(comment: CommentData) {\n    this.comments = this.comments.map((c) => {\n      if (c.id === comment.id) return comment\n      return c\n    })\n\n    this.events.trigger('comment-updated', comment)\n    this.events.trigger('list-loaded', this.comments)\n  }\n\n  deleteComment(id: number) {\n    const comment = this.comments.find((c) => c.id === id)\n    if (!comment) throw new Error(`Comment ${id} not found`)\n    this.comments = this.comments.filter((c) => c.id !== id)\n\n    this.events.trigger('comment-deleted', comment)\n    this.events.trigger('list-loaded', this.comments)\n  }\n\n  // -------------------------------------------------------------------\n  //  Notifies\n  // -------------------------------------------------------------------\n  getNotifies() {\n    return this.notifies\n  }\n\n  updateNotifies(notifies: NotifyData[]) {\n    this.notifies = notifies\n\n    this.events.trigger('notifies-updated', this.notifies)\n  }\n\n  // -------------------------------------------------------------------\n  // Page\n  // -------------------------------------------------------------------\n  getPage() {\n    return this.page\n  }\n\n  updatePage(pageData: PageData) {\n    this.page = pageData\n\n    this.events.trigger('page-loaded', pageData)\n  }\n}\n","export function createElement<E extends HTMLElement = HTMLElement>(htmlStr: string = ''): E {\n  const div = document.createElement('div')\n  div.innerHTML = htmlStr.trim()\n  return (div.firstElementChild || div) as E\n}\n\nexport function getHeight(el: HTMLElement): number {\n  const num = parseFloat(getComputedStyle(el, null).height.replace('px', ''))\n  return num || 0 // NaN -> 0\n}\n\nexport function htmlEncode(str: string) {\n  const temp = document.createElement('div')\n  temp.innerText = str\n  const output = temp.innerHTML\n  return output\n}\n\nexport function htmlDecode(str: string) {\n  const temp = document.createElement('div')\n  temp.innerHTML = str\n  const output = temp.innerText\n  return output\n}\n\nexport function getQueryParam(name: string) {\n  const match = RegExp(`[?&]${name}=([^&]*)`).exec(window.location.search)\n  return match && decodeURIComponent(match[1].replace(/\\+/g, ' '))\n}\n\nexport function getOffset(el: HTMLElement, relativeTo?: HTMLElement) {\n  const getOffsetRecursive = (element: HTMLElement): { top: number; left: number } => {\n    const rect = element.getBoundingClientRect()\n    const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft\n    const scrollTop = window.pageYOffset || document.documentElement.scrollTop\n    return {\n      top: rect.top + scrollTop,\n      left: rect.left + scrollLeft,\n    }\n  }\n\n  const elOffset = getOffsetRecursive(el)\n  if (!relativeTo) return elOffset\n\n  const relativeToOffset = getOffsetRecursive(relativeTo)\n\n  return {\n    top: elOffset.top - relativeToOffset.top,\n    left: elOffset.left - relativeToOffset.left,\n  }\n}\n\nexport function padWithZeros(vNumber: number, width: number) {\n  let numAsString = vNumber.toString()\n  while (numAsString.length < width) {\n    numAsString = `0${numAsString}`\n  }\n  return numAsString\n}\n\nexport function dateFormat(date: Date) {\n  const vDay = padWithZeros(date.getDate(), 2)\n  const vMonth = padWithZeros(date.getMonth() + 1, 2)\n  const vYear = padWithZeros(date.getFullYear(), 2)\n  // var vHour = padWithZeros(date.getHours(), 2);\n  // var vMinute = padWithZeros(date.getMinutes(), 2);\n  // var vSecond = padWithZeros(date.getSeconds(), 2);\n  return `${vYear}-${vMonth}-${vDay}`\n}\n\nexport function timeAgo(date: Date, $t = (n: any) => n) {\n  try {\n    const oldTime = date.getTime()\n    const currTime = new Date().getTime()\n    const diffValue = currTime - oldTime\n\n    const days = Math.floor(diffValue / (24 * 3600 * 1000))\n    if (days === 0) {\n      // \n      const leave1 = diffValue % (24 * 3600 * 1000) // \n      const hours = Math.floor(leave1 / (3600 * 1000))\n      if (hours === 0) {\n        // \n        const leave2 = leave1 % (3600 * 1000) // \n        const minutes = Math.floor(leave2 / (60 * 1000))\n        if (minutes === 0) {\n          // \n          const leave3 = leave2 % (60 * 1000) // \n          const seconds = Math.round(leave3 / 1000)\n          if (seconds < 10) return $t('now')\n          return `${seconds} ${$t('seconds')}`\n        }\n        return `${minutes} ${$t('minutes')}`\n      }\n      return `${hours} ${$t('hours')}`\n    }\n    if (days < 0) return $t('now')\n\n    if (days < 8) {\n      return `${days} ${$t('days')}`\n    }\n\n    return dateFormat(date)\n  } catch (error) {\n    console.error(error)\n    return ' - '\n  }\n}\n\nexport function getGravatarURL(opts: { params: string; mirror: string; emailHash: string }) {\n  return `${opts.mirror.replace(/\\/$/, '')}/${opts.emailHash}?${opts.params.replace(/^\\?/, '')}`\n}\n\nexport function sleep(ms: number) {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms)\n  })\n}\n\n/** a < b :-1 | 0 | b < a :1 */\nexport function versionCompare(a: string, b: string) {\n  const pa = a.split('.')\n  const pb = b.split('.')\n  for (let i = 0; i < 3; i++) {\n    const na = Number(pa[i])\n    const nb = Number(pb[i])\n    if (na > nb) return 1\n    if (nb > na) return -1\n    if (!Number.isNaN(na) && Number.isNaN(nb)) return 1\n    if (Number.isNaN(na) && !Number.isNaN(nb)) return -1\n  }\n  return 0\n}\n\n/**  UserAgent */\nexport async function getCorrectUserAgent() {\n  const uaRaw = navigator.userAgent\n  if (!(navigator as any).userAgentData || !(navigator as any).userAgentData.getHighEntropyValues) {\n    return uaRaw\n  }\n\n  // @link https://web.dev/migrate-to-ua-ch/\n  // @link https://web.dev/user-agent-client-hints/\n  const uaData = (navigator as any).userAgentData\n  let uaGot: any = null\n  try {\n    uaGot = await uaData.getHighEntropyValues(['platformVersion'])\n  } catch (err) {\n    console.error(err)\n    return uaRaw\n  }\n  const majorPlatformVersion = Number(uaGot.platformVersion.split('.')[0])\n\n  if (uaData.platform === 'Windows') {\n    if (majorPlatformVersion >= 13) {\n      // @link https://docs.microsoft.com/en-us/microsoft-edge/web-platform/how-to-detect-win11\n      // @date 2022-4-29\n      // Win 11 \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36\"\n      return uaRaw.replace(/Windows NT 10.0/, 'Windows NT 11.0')\n    }\n  }\n  if (uaData.platform === 'macOS') {\n    if (majorPlatformVersion >= 11) {\n      // 11 => BigSur\n      // @date 2022-4-29\n      // (Intel Chip) macOS 12.3 \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36\"\n      // (Arm Chip) macOS \"Mozilla/5.0 (Macintosh; ARM Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.2 Safari/605.1.15\"\n      return uaRaw.replace(\n        /(Mac OS X \\d+_\\d+_\\d+|Mac OS X)/,\n        `Mac OS X ${uaGot.platformVersion.replace(/\\./g, '_')}`,\n      )\n    }\n  }\n\n  return uaRaw\n}\n\n/**  URL */\nexport function isValidURL(urlRaw: string) {\n  // @link https://www.rfc-editor.org/rfc/rfc3986\n  let url: URL\n  try {\n    url = new URL(urlRaw)\n  } catch (_) {\n    return false\n  }\n  return url.protocol === 'http:' || url.protocol === 'https:'\n}\n\n/**  conf.server  URL */\nexport function getURLBasedOnApi(opts: { base: string; path: string }) {\n  return getURLBasedOn(opts.base, opts.path)\n}\n\n/**  baseURL  URL */\nexport function getURLBasedOn(baseURL: string, path: string) {\n  return `${baseURL.replace(/\\/$/, '')}/${path.replace(/^\\//, '')}`\n}\n","const en = {\n  /* Editor */\n  placeholder: 'Leave a comment',\n  noComment: 'No Comment',\n  send: 'Send',\n  signIn: 'Sign in',\n  signUp: 'Sign up',\n  save: 'Save',\n  nick: 'Nickname',\n  email: 'Email',\n  link: 'Website',\n  emoticon: 'Emoji',\n  preview: 'Preview',\n  uploadImage: 'Upload Image',\n  uploadFail: 'Upload Failed',\n  commentFail: 'Failed to comment',\n  restoredMsg: 'Content has been restored',\n  onlyAdminCanReply: 'Only admin can reply',\n  uploadLoginMsg: 'Please fill in your name and email to upload',\n\n  /* List */\n  counter: '{count} Comments',\n  sortLatest: 'Latest',\n  sortOldest: 'Oldest',\n  sortBest: 'Best',\n  sortAuthor: 'Author',\n  openComment: 'Open Comment',\n  closeComment: 'Close Comment',\n  listLoadFailMsg: 'Failed to load comments',\n  listRetry: 'Retry',\n  loadMore: 'Load More',\n\n  /* Comment */\n  admin: 'Admin',\n  reply: 'Reply',\n  voteUp: 'Up',\n  voteDown: 'Down',\n  voteFail: 'Vote Failed',\n  readMore: 'Read More',\n  actionConfirm: 'Confirm',\n  collapse: 'Collapse',\n  collapsed: 'Collapsed',\n  collapsedMsg: 'This comment has been collapsed',\n  expand: 'Expand',\n  approved: 'Approved',\n  pending: 'Pending',\n  pendingMsg: 'Pending, visible only to commenter.',\n  edit: 'Edit',\n  editCancel: 'Cancel Edit',\n  delete: 'Delete',\n  deleteConfirm: 'Confirm',\n  pin: 'Pin',\n  unpin: 'Unpin',\n\n  /* Time */\n  seconds: 'seconds ago',\n  minutes: 'minutes ago',\n  hours: 'hours ago',\n  days: 'days ago',\n  now: 'just now',\n\n  /* Checker */\n  adminCheck: 'Enter admin password:',\n  captchaCheck: 'Enter the CAPTCHA to continue:',\n  confirm: 'Confirm',\n  cancel: 'Cancel',\n\n  /* Sidebar */\n  msgCenter: 'Messages',\n  ctrlCenter: 'Admin',\n\n  /* Auth */\n  noAccountPrompt: \"Don't have an account?\",\n  haveAccountPrompt: 'Already have an account?',\n  forgetPassword: 'Forget Password',\n  resetPassword: 'Reset Password',\n  verificationCode: 'Verification Code',\n  verifySend: 'Verify',\n  verifyResend: 'Resend',\n  waitSeconds: 'Wait {seconds}s',\n  emailVerified: 'Email has been verified',\n  password: 'Password',\n  username: 'Username',\n  nextStep: 'Next Step',\n  skipNotVerify: 'Skip, do not verify',\n  logoutConfirm: 'Are you sure to logout?',\n  accountMergeNotice: 'Your email has multiple accounts with different id.',\n  accountMergeSelectOne: 'Please select one you want to merge all the data into it.',\n  accountMergeConfirm: 'All data will be merged into one account, the id is {id}.',\n  dismiss: 'Dismiss',\n  merge: 'Merge',\n\n  /* General */\n  frontend: 'Frontend',\n  backend: 'Backend',\n  loading: 'Loading',\n  loadFail: 'Load Failed',\n  editing: 'Editing',\n  editFail: 'Edit Failed',\n  deleting: 'Deleting',\n  deleteFail: 'Delete Failed',\n  reqGot: 'Request got',\n  reqAborted: 'Request timed out or terminated unexpectedly',\n  updateMsg: 'Please update Artalk {name} to get the best experience!',\n  currentVersion: 'Current Version',\n  ignore: 'Ignore',\n  open: 'Open',\n  openName: 'Open {name}',\n}\n\nexport type I18n = typeof en\nexport type I18nKeys = keyof I18n\n\nexport default en\n","import type { I18n } from '.'\n\nexport const GLOBAL_LOCALES_KEY = 'ArtalkI18n'\n\nexport function defineLocaleExternal(lang: string, locale: I18n, aliases?: string[]) {\n  if (!window[GLOBAL_LOCALES_KEY]) window[GLOBAL_LOCALES_KEY] = {}\n  window[GLOBAL_LOCALES_KEY][lang] = locale\n  if (aliases)\n    aliases.forEach((l) => {\n      window[GLOBAL_LOCALES_KEY][l] = locale\n    })\n  return locale\n}\n","import * as Utils from '../lib/utils'\nimport en, { I18n, I18nKeys } from './en'\nimport zhCN from './zh-CN'\nimport { GLOBAL_LOCALES_KEY } from './external'\n\nexport type * from './en'\n\n// @note the key of language is followed by `ISO 639`\n// https://en.wikipedia.org/wiki/ISO_639\n// https://datatracker.ietf.org/doc/html/rfc5646#section-2.1\nexport const internal = {\n  en,\n  'en-US': en,\n  'zh-CN': zhCN,\n}\n\n/**\n * find a locale object by language name\n */\nexport function findLocaleSet(lang: string): I18n {\n  // normalize a key of language to `ISO 639`\n  lang = lang.replace(\n    /^([a-zA-Z]+)(-[a-zA-Z]+)?$/,\n    (_, p1: string, p2: string) => p1.toLowerCase() + (p2 || '').toUpperCase(),\n  )\n\n  // internal finding\n  if (internal[lang]) {\n    return internal[lang]\n  }\n\n  // external finding\n  if (window[GLOBAL_LOCALES_KEY] && window[GLOBAL_LOCALES_KEY][lang]) {\n    return window[GLOBAL_LOCALES_KEY][lang]\n  }\n\n  // case when not found:\n  // use `en` by default\n  return internal.en\n}\n\n/**\n * System locale setting\n */\nlet LocaleConf: I18n | string = 'en'\nlet LocaleDict: I18n = findLocaleSet(LocaleConf) // en by default\n\n/**\n * Set system locale\n */\nexport function setLocale(locale: I18n | string) {\n  if (locale === LocaleConf) return\n  LocaleConf = locale\n  LocaleDict = typeof locale === 'string' ? findLocaleSet(locale) : locale\n}\n\n/**\n * Get an i18n message by key\n */\nexport function t(key: I18nKeys, args: { [key: string]: string } = {}) {\n  let str = LocaleDict?.[key] || key\n  str = str.replace(/\\{\\s*(\\w+?)\\s*\\}/g, (_, token) => args[token] || '')\n\n  return Utils.htmlEncode(str)\n}\n\nexport default t\n","import type { I18n } from '.'\n\nconst zhCN: I18n = {\n  /* Editor */\n  placeholder: '...',\n  noComment: '',\n  send: '',\n  signIn: '',\n  signUp: '',\n  save: '',\n  nick: '',\n  email: '',\n  link: '',\n  emoticon: '',\n  preview: '',\n  uploadImage: '',\n  uploadFail: '',\n  commentFail: '',\n  restoredMsg: '',\n  onlyAdminCanReply: '',\n  uploadLoginMsg: '',\n\n  /* List */\n  counter: '{count} ',\n  sortLatest: '',\n  sortOldest: '',\n  sortBest: '',\n  sortAuthor: '',\n  openComment: '',\n  closeComment: '',\n  listLoadFailMsg: '',\n  listRetry: '',\n  loadMore: '',\n\n  /* Comment */\n  admin: '',\n  reply: '',\n  voteUp: '',\n  voteDown: '',\n  voteFail: '',\n  readMore: '',\n  actionConfirm: '',\n  collapse: '',\n  collapsed: '',\n  collapsedMsg: '',\n  expand: '',\n  approved: '',\n  pending: '',\n  pendingMsg: '',\n  edit: '',\n  editCancel: '',\n  delete: '',\n  deleteConfirm: '',\n  pin: '',\n  unpin: '',\n\n  /* Time */\n  seconds: '',\n  minutes: '',\n  hours: '',\n  days: '',\n  now: '',\n\n  /* Checker */\n  adminCheck: '',\n  captchaCheck: '',\n  confirm: '',\n  cancel: '',\n\n  /* Sidebar */\n  msgCenter: '',\n  ctrlCenter: '',\n\n  /* Auth */\n  noAccountPrompt: '',\n  haveAccountPrompt: '',\n  forgetPassword: '',\n  resetPassword: '',\n  verificationCode: '',\n  verifySend: '',\n  verifyResend: '',\n  waitSeconds: ' {seconds}',\n  emailVerified: '',\n  password: '',\n  username: '',\n  nextStep: '',\n  skipNotVerify: '',\n  logoutConfirm: '',\n  accountMergeNotice: ' ID ',\n  accountMergeSelectOne: '',\n  accountMergeConfirm: ' ID  {id} ',\n  dismiss: '',\n  merge: '',\n\n  /* General */\n  frontend: '',\n  backend: '',\n  loading: '',\n  loadFail: '',\n  editing: '',\n  editFail: '',\n  deleting: '',\n  deleteFail: '',\n  reqGot: '',\n  reqAborted: '',\n  updateMsg: ' Artalk {name} ',\n  currentVersion: '',\n  ignore: '',\n  open: '',\n  openName: '{name}',\n}\n\nexport default zhCN\n","export type EventHandler<T> = (payload: T) => void\nexport interface Event<PayloadMap, K extends keyof PayloadMap = keyof PayloadMap>\n  extends EventOptions {\n  name: K\n  handler: EventHandler<PayloadMap[K]>\n}\nexport interface EventOptions {\n  once?: boolean\n}\n\nexport interface EventManagerFuncs<PayloadMap> {\n  on<K extends keyof PayloadMap>(\n    name: K,\n    handler: EventHandler<PayloadMap[K]>,\n    opts?: EventOptions,\n  ): void\n  off<K extends keyof PayloadMap>(name: K, handler: EventHandler<PayloadMap[K]>): void\n  trigger<K extends keyof PayloadMap>(name: K, payload?: PayloadMap[K]): void\n}\n\nexport default class EventManager<PayloadMap> implements EventManagerFuncs<PayloadMap> {\n  private events: Event<PayloadMap>[] = []\n\n  /**\n   * Add an event listener for a specific event name\n   */\n  public on<K extends keyof PayloadMap>(\n    name: K,\n    handler: EventHandler<PayloadMap[K]>,\n    opts: EventOptions = {},\n  ) {\n    this.events.push({\n      name,\n      handler: handler as EventHandler<PayloadMap[keyof PayloadMap]>,\n      ...opts,\n    })\n  }\n\n  /**\n   * Remove an event listener for a specific event name and handler\n   */\n  public off<K extends keyof PayloadMap>(name: K, handler: EventHandler<PayloadMap[K]>) {\n    if (!handler) return // not allow remove all events with same name\n    this.events = this.events.filter((evt) => !(evt.name === name && evt.handler === handler))\n  }\n\n  /**\n   * Trigger an event with an optional payload\n   */\n  public trigger<K extends keyof PayloadMap>(name: K, payload?: PayloadMap[K]) {\n    this.events\n      .slice(0) // make a copy, in case listeners are removed while iterating\n      .filter((evt) => evt.name === name && typeof evt.handler === 'function')\n      .forEach((evt) => {\n        if (evt.once) this.off(name, evt.handler)\n        evt.handler(payload!)\n      })\n  }\n}\n","import type { ArtalkConfig } from '@/types'\n\nconst defaults: ArtalkConfig = {\n  el: '',\n  pageKey: '',\n  pageTitle: '',\n  server: '',\n  site: '',\n\n  placeholder: '',\n  noComment: '',\n  sendBtn: '',\n  darkMode: false,\n  editorTravel: true,\n\n  flatMode: 'auto',\n  nestMax: 2,\n  nestSort: 'DATE_ASC',\n\n  emoticons: 'https://cdn.jsdelivr.net/gh/ArtalkJS/Emoticons/grps/default.json',\n\n  vote: true,\n  voteDown: false,\n  uaBadge: true,\n  listSort: true,\n  preview: true,\n  countEl: '.artalk-comment-count',\n  pvEl: '.artalk-pv-count',\n  statPageKeyAttr: 'data-page-key',\n\n  gravatar: {\n    mirror: 'https://www.gravatar.com/avatar/',\n    params: 'sha256=1&d=mp&s=240',\n  },\n\n  pagination: {\n    pageSize: 20,\n    readMore: true,\n    autoLoad: true,\n  },\n\n  heightLimit: {\n    content: 300,\n    children: 400,\n    scrollable: false,\n  },\n\n  imgUpload: true,\n  reqTimeout: 15000,\n  versionCheck: true,\n  useBackendConf: true,\n\n  locale: 'en',\n}\n\nif (ARTALK_LITE) {\n  defaults.vote = false\n  defaults.uaBadge = false\n  defaults.emoticons = false\n  defaults.preview = false\n}\n\nexport default defaults\n","import type { ApiOptions } from './api/options'\nimport { mergeDeep } from './lib/merge-deep'\nimport { createApiHandlers } from './api'\nimport Defaults from './defaults'\nimport type { ArtalkConfig, ContextApi } from '@/types'\n\n/**\n * Handle the custom config which is provided by the user\n *\n * @param customConf - The custom config object which is provided by the user\n * @param full - If `full` is `true`, the return value will be the complete config for Artalk instance creation\n * @returns The config for Artalk instance creation\n */\nexport function handelCustomConf(customConf: Partial<ArtalkConfig>, full: true): ArtalkConfig\nexport function handelCustomConf(\n  customConf: Partial<ArtalkConfig>,\n  full?: false,\n): Partial<ArtalkConfig>\nexport function handelCustomConf(customConf: Partial<ArtalkConfig>, full = false) {\n  // \n  const conf: Partial<ArtalkConfig> = full ? mergeDeep(Defaults, customConf) : customConf\n\n  // \n  if (conf.el && typeof conf.el === 'string') {\n    try {\n      const findEl = document.querySelector<HTMLElement>(conf.el)\n      if (!findEl) throw Error(`Target element \"${conf.el}\" was not found.`)\n      conf.el = findEl\n    } catch (e) {\n      console.error(e)\n      throw new Error('Please check your Artalk `el` config.')\n    }\n  }\n\n  //  pageKey\n  if (conf.pageKey === '') conf.pageKey = `${window.location.pathname}` // @link http://bl.ocks.org/abernier/3070589\n\n  //  pageTitle\n  if (conf.pageTitle === '') conf.pageTitle = `${document.title}`\n\n  // \n  if (conf.server) conf.server = conf.server.replace(/\\/$/, '').replace(/\\/api\\/?$/, '')\n\n  // \n  if (conf.locale === 'auto') conf.locale = navigator.language\n\n  // \n  if (conf.flatMode === 'auto') conf.flatMode = window.matchMedia('(max-width: 768px)').matches\n\n  // flatMode\n  if (typeof conf.nestMax === 'number' && Number(conf.nestMax) <= 1) conf.flatMode = true\n\n  return conf\n}\n\n/**\n * Handle the config which is provided by the server\n *\n * @param conf - The Server response config for control the frontend of Artalk remotely\n * @returns The config for Artalk instance creation\n */\nexport function handleConfFormServer(conf: Partial<ArtalkConfig>) {\n  const ExcludedKeys: (keyof ArtalkConfig)[] = [\n    'el',\n    'pageKey',\n    'pageTitle',\n    'server',\n    'site',\n    'pvEl',\n    'countEl',\n    'statPageKeyAttr',\n  ]\n  Object.keys(conf).forEach((k) => {\n    if (ExcludedKeys.includes(k as any)) delete conf[k]\n    if (k === 'darkMode' && conf[k] !== 'auto') delete conf[k]\n  })\n\n  // Patch: `emoticons` config string to json\n  if (conf.emoticons && typeof conf.emoticons === 'string') {\n    conf.emoticons = conf.emoticons.trim()\n    if (conf.emoticons.startsWith('[') || conf.emoticons.startsWith('{')) {\n      conf.emoticons = JSON.parse(conf.emoticons) // parse json\n    } else if (conf.emoticons === 'false') {\n      conf.emoticons = false\n    }\n  }\n\n  return conf\n}\n\n/**\n * Convert Artalk Config to ApiOptions for Api client\n *\n * @param conf - Artalk config\n * @param ctx - If `ctx` not provided, `checkAdmin` and `checkCaptcha` will be disabled\n * @returns ApiOptions for Api client instance creation\n */\nexport function convertApiOptions(conf: Partial<ArtalkConfig>, ctx?: ContextApi): ApiOptions {\n  return {\n    baseURL: `${conf.server}/api/v2`,\n    siteName: conf.site || '',\n    pageKey: conf.pageKey || '',\n    pageTitle: conf.pageTitle || '',\n    timeout: conf.reqTimeout,\n    getApiToken: () => ctx?.get('user').getData().token,\n    userInfo: ctx?.get('user').checkHasBasicUserInfo()\n      ? {\n          name: ctx?.get('user').getData().nick,\n          email: ctx?.get('user').getData().email,\n        }\n      : undefined,\n    handlers: ctx?.getApiHandlers(),\n  }\n}\n\nexport function createNewApiHandlers(ctx: ContextApi) {\n  const h = createApiHandlers()\n  h.add('need_captcha', (res) => ctx.checkCaptcha(res))\n  h.add('need_login', () => ctx.checkAdmin({}))\n\n  return h\n}\n","import type { ArtalkConfig, ContextApi } from '@/types'\n\nexport function watchConf<T extends (keyof ArtalkConfig)[]>(\n  ctx: ContextApi,\n  keys: T,\n  effect: (conf: Pick<ArtalkConfig, T[number]>) => void,\n): void {\n  const deepEqual = (a: any, b: any) => JSON.stringify(a) === JSON.stringify(b)\n  const val = () => {\n    const conf = ctx.getConf()\n    const res: any = {}\n    keys.forEach((key) => {\n      res[key] = conf[key]\n    })\n    return res\n  }\n  let lastVal: any = null\n  const handler = () => {\n    const newVal = val()\n    const isDiff = lastVal == null || !deepEqual(lastVal, newVal)\n    // only trigger when specific keys changed\n    if (isDiff) {\n      lastVal = newVal\n      effect(newVal)\n    }\n  }\n  ctx.on('mounted', handler)\n  ctx.on('updated', handler)\n}\n","import type { TInjectedServices } from './service'\nimport { Api, ApiHandlers } from './api'\n\nimport * as marked from './lib/marked'\nimport { mergeDeep } from './lib/merge-deep'\nimport { CheckerCaptchaPayload, CheckerPayload } from './components/checker'\n\nimport { DataManager } from './data'\nimport * as I18n from './i18n'\n\nimport EventManager from './lib/event-manager'\nimport { convertApiOptions, createNewApiHandlers, handelCustomConf } from './config'\nimport { watchConf } from './lib/watch-conf'\n\nimport type {\n  ArtalkConfig,\n  CommentData,\n  ListFetchParams,\n  ContextApi,\n  EventPayloadMap,\n  SidebarShowPayload,\n} from '@/types'\n\n// Auto dependency injection\ninterface Context extends TInjectedServices {}\n\n/**\n * Artalk Context\n */\nclass Context implements ContextApi {\n  /*  */\n  conf: ArtalkConfig\n  data: DataManager\n  $root: HTMLElement\n\n  /* Event Manager */\n  private events = new EventManager<EventPayloadMap>()\n  private mounted = false\n\n  constructor(conf: ArtalkConfig) {\n    this.conf = conf\n\n    this.$root = conf.el as HTMLElement\n    this.$root.classList.add('artalk')\n    this.$root.innerHTML = ''\n\n    this.data = new DataManager(this.events)\n\n    this.on('mounted', () => {\n      this.mounted = true\n    })\n  }\n\n  inject(depName: string, obj: any) {\n    this[depName] = obj\n  }\n\n  get(depName: string) {\n    return this[depName]\n  }\n\n  getApi() {\n    return new Api(convertApiOptions(this.conf, this))\n  }\n\n  private apiHandlers = <ApiHandlers | null>null\n  getApiHandlers() {\n    if (!this.apiHandlers) this.apiHandlers = createNewApiHandlers(this)\n    return this.apiHandlers\n  }\n\n  getData() {\n    return this.data\n  }\n\n  replyComment(commentData: CommentData, $comment: HTMLElement): void {\n    this.editor.setReply(commentData, $comment)\n  }\n\n  editComment(commentData: CommentData, $comment: HTMLElement): void {\n    this.editor.setEditComment(commentData, $comment)\n  }\n\n  fetch(params: Partial<ListFetchParams>): void {\n    this.data.fetchComments(params)\n  }\n\n  reload(): void {\n    this.data.fetchComments({ offset: 0 })\n  }\n\n  /* List */\n  listGotoFirst(): void {\n    this.events.trigger('list-goto-first')\n  }\n\n  getCommentNodes() {\n    return this.list.getCommentNodes()\n  }\n\n  getComments() {\n    return this.data.getComments()\n  }\n\n  getCommentList = this.getCommentNodes\n  getCommentDataList = this.getComments\n\n  /* Editor */\n  editorShowLoading(): void {\n    this.editor.showLoading()\n  }\n\n  editorHideLoading(): void {\n    this.editor.hideLoading()\n  }\n\n  editorShowNotify(msg, type): void {\n    this.editor.showNotify(msg, type)\n  }\n\n  editorResetState(): void {\n    this.editor.resetState()\n  }\n\n  /* Sidebar */\n  showSidebar(payload?: SidebarShowPayload): void {\n    this.sidebarLayer.show(payload)\n  }\n\n  hideSidebar(): void {\n    this.sidebarLayer.hide()\n  }\n\n  /* Checker */\n  checkAdmin(payload: CheckerPayload): Promise<void> {\n    return this.checkerLauncher.checkAdmin(payload)\n  }\n\n  checkCaptcha(payload: CheckerCaptchaPayload): Promise<void> {\n    return this.checkerLauncher.checkCaptcha(payload)\n  }\n\n  /* Events */\n  on(name: any, handler: any) {\n    this.events.on(name, handler)\n  }\n\n  off(name: any, handler: any) {\n    this.events.off(name, handler)\n  }\n\n  trigger(name: any, payload?: any) {\n    this.events.trigger(name, payload)\n  }\n\n  /* i18n */\n  $t(key: I18n.I18nKeys, args: { [key: string]: string } = {}): string {\n    return I18n.t(key, args)\n  }\n\n  setDarkMode(darkMode: boolean | 'auto'): void {\n    this.updateConf({ darkMode })\n  }\n\n  updateConf(nConf: Partial<ArtalkConfig>): void {\n    this.conf = mergeDeep(this.conf, handelCustomConf(nConf, false))\n    this.mounted && this.events.trigger('updated', this.conf)\n  }\n\n  getConf(): ArtalkConfig {\n    return this.conf\n  }\n\n  getEl(): HTMLElement {\n    return this.$root\n  }\n\n  getMarked() {\n    return marked.getInstance()\n  }\n\n  watchConf<T extends (keyof ArtalkConfig)[]>(\n    keys: T,\n    effect: (conf: Pick<ArtalkConfig, T[number]>) => void,\n  ): void {\n    watchConf(this, keys, effect)\n  }\n}\n\nexport default Context\n","export interface ApiHandlerPayload {\n  need_captcha: { img_data?: string; iframe?: string }\n  need_login: object\n  need_auth_login: object\n}\n\ntype PayloadKey = keyof ApiHandlerPayload\n\nexport interface ApiHandler<T extends PayloadKey = PayloadKey> {\n  action: T\n  handler: (data: ApiHandlerPayload[T]) => Promise<void>\n}\n\nexport interface ApiHandlers {\n  add: <T extends PayloadKey>(\n    action: T,\n    handler: (data: ApiHandlerPayload[T]) => Promise<void>,\n  ) => void\n  get: () => ApiHandler[]\n}\n\nexport function createApiHandlers(): ApiHandlers {\n  const handlers: ApiHandler[] = []\n  return {\n    add: (action, handler) => {\n      handlers.push({ action, handler })\n    },\n    get: () => handlers,\n  }\n}\n","import * as Utils from './utils'\nimport type { NotifyLevel } from '@/types'\n\n/**  */\nexport function showLoading(parentElem: HTMLElement, conf?: { transparentBg?: boolean }) {\n  // Use :scope https://developer.mozilla.org/en-US/docs/Web/CSS/:scope\n  let $loading = parentElem.querySelector<HTMLElement>(':scope > .atk-loading')\n  if (!$loading) {\n    $loading = Utils.createElement(\n      `<div class=\"atk-loading\" style=\"display: none;\">\n      <div class=\"atk-loading-spinner\">\n        <svg viewBox=\"25 25 50 50\"><circle cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-width=\"2\" stroke-miterlimit=\"10\"></circle></svg>\n      </div>\n    </div>`,\n    )\n    if (conf?.transparentBg) $loading.style.background = 'transparent'\n    parentElem.appendChild($loading)\n  }\n  $loading.style.display = ''\n\n  // spinner \n  const $spinner = $loading.querySelector<HTMLElement>('.atk-loading-spinner')\n  if ($spinner) {\n    $spinner.style.display = 'none'\n    window.setTimeout(() => {\n      if ($spinner.isConnected) $spinner.style.display = ''\n    }, 500)\n  }\n}\n\n/**  */\nexport function hideLoading(parentElem: HTMLElement) {\n  const $loading = parentElem.querySelector<HTMLElement>(':scope > .atk-loading')\n  if ($loading) $loading.style.display = 'none'\n}\n\n/**  */\nexport function setLoading(val: boolean, parentElem: HTMLElement) {\n  if (val) showLoading(parentElem)\n  else hideLoading(parentElem)\n}\n\n/**  */\nexport function isVisible(el: HTMLElement, viewport: HTMLElement = document.documentElement) {\n  const viewportHeight = viewport.clientHeight\n\n  const docViewTop = viewport.scrollTop\n  const docViewBottom = docViewTop + viewportHeight\n\n  const rect = el.getBoundingClientRect()\n  const elemTop = rect.top + docViewTop\n  const elemBottom = elemTop + rect.height\n\n  return elemBottom <= docViewBottom //&& (elemTop >= docViewTop)  el  viewport \n}\n\n/**  */\nexport function scrollIntoView(\n  elem: HTMLElement,\n  enableAnim: boolean = true,\n  relativeTo?: HTMLElement,\n) {\n  let top: number\n\n  if (relativeTo) {\n    const containerRect = relativeTo.getBoundingClientRect()\n    const elementRect = elem.getBoundingClientRect()\n    top =\n      elementRect.top -\n      containerRect.top +\n      relativeTo.scrollTop -\n      relativeTo.clientHeight / 2 +\n      elem.clientHeight / 2\n  } else {\n    const rect = elem.getBoundingClientRect()\n    const elemTop = rect.top + window.scrollY\n    top = elemTop - (window.innerHeight / 2 - rect.height / 2)\n  }\n\n  const scrollOptions: ScrollToOptions = {\n    top,\n    left: 0,\n    // behavior: enableAnim ? 'smooth' : 'instant',\n    behavior: 'instant',\n  }\n\n  if (relativeTo) relativeTo.scroll(scrollOptions)\n  else window.scroll(scrollOptions)\n}\n\n/**  */\nexport function showNotify(wrapElem: HTMLElement, msg: string, type: NotifyLevel) {\n  const colors = { s: '#57d59f', e: '#ff6f6c', w: '#ffc721', i: '#2ebcfc' }\n  const timeout = 3000 //  ms\n\n  const notifyElem = Utils.createElement(\n    `<div class=\"atk-notify atk-fade-in\" style=\"background-color: ${colors[type]}\"><span class=\"atk-notify-content\"></span></div>`,\n  )\n  const notifyContentEl = notifyElem.querySelector<HTMLElement>('.atk-notify-content')!\n  notifyContentEl.innerHTML = Utils.htmlEncode(msg).replace('\\n', '<br/>')\n\n  wrapElem.appendChild(notifyElem)\n\n  const notifyRemove = () => {\n    notifyElem.classList.add('atk-fade-out')\n    setTimeout(() => {\n      notifyElem.remove()\n    }, 200)\n  }\n\n  let timeoutFn: number\n  if (timeout > 0) {\n    timeoutFn = window.setTimeout(() => {\n      notifyRemove()\n    }, timeout)\n  }\n\n  notifyElem.addEventListener('click', () => {\n    notifyRemove()\n    window.clearTimeout(timeoutFn)\n  })\n}\n\n/** fade  */\nexport function playFadeAnim(elem: HTMLElement, after?: () => void, type: 'in' | 'out' = 'in') {\n  elem.classList.add(`atk-fade-${type}`)\n  //  class\n  const onAnimEnded = () => {\n    elem.classList.remove(`atk-fade-${type}`)\n    elem.removeEventListener('animationend', onAnimEnded)\n    if (after) after()\n  }\n  elem.addEventListener('animationend', onAnimEnded)\n}\n\n/**  */\nexport function playFadeInAnim(elem: HTMLElement, after?: () => void) {\n  playFadeAnim(elem, after, 'in')\n}\n\n/**  */\nexport function playFadeOutAnim(elem: HTMLElement, after?: () => void) {\n  playFadeAnim(elem, after, 'out')\n}\n\n/**  */\nexport function setError(\n  parentElem: HTMLElement,\n  html: string | HTMLElement | null,\n  title: string = '<span class=\"atk-error-title\">Artalk Error</span>',\n) {\n  let elem = parentElem.querySelector<HTMLElement>('.atk-error-layer')\n  if (html === null) {\n    if (elem !== null) elem.remove()\n    return\n  }\n  if (!elem) {\n    elem = Utils.createElement(\n      `<div class=\"atk-error-layer\">${title}<span class=\"atk-error-text\"></span></div>`,\n    )\n    parentElem.appendChild(elem)\n  }\n\n  const errorTextEl = elem.querySelector<HTMLElement>('.atk-error-text')!\n  errorTextEl.innerHTML = ''\n  if (html === null) return\n\n  if (html instanceof HTMLElement) {\n    errorTextEl.appendChild(html)\n  } else {\n    errorTextEl.innerText = html\n  }\n}\n\nexport function getScrollBarWidth() {\n  const inner = document.createElement('p')\n  inner.style.width = '100%'\n  inner.style.height = '200px'\n\n  const outer = document.createElement('div')\n  outer.style.position = 'absolute'\n  outer.style.top = '0px'\n  outer.style.left = '0px'\n  outer.style.visibility = 'hidden'\n  outer.style.width = '200px'\n  outer.style.height = '150px'\n  outer.style.overflow = 'hidden'\n  outer.appendChild(inner)\n\n  document.body.appendChild(outer)\n  const w1 = inner.offsetWidth\n  outer.style.overflow = 'scroll'\n  let w2 = inner.offsetWidth\n  if (w1 === w2) w2 = outer.clientWidth\n\n  document.body.removeChild(outer)\n\n  return w1 - w2\n}\n","import type { CheckerCtx } from '.'\nimport $t from '@/i18n'\nimport * as Utils from '@/lib/utils'\nimport * as Ui from '@/lib/ui'\n\n/**  */\nexport function imgBody(checker: CheckerCtx) {\n  // \n  const elem = Utils.createElement(\n    `<span><img class=\"atk-captcha-img\" src=\"${checker.get('img_data') || ''}\">${$t('captchaCheck')}</span>`,\n  )\n\n  // \n  elem.querySelector<HTMLElement>('.atk-captcha-img')!.onclick = () => {\n    const imgEl = elem.querySelector('.atk-captcha-img')\n    checker\n      .getApi()\n      .captcha.getCaptcha()\n      .then((res) => {\n        imgEl!.setAttribute('src', res.data.img_data)\n      })\n      .catch((err) => {\n        console.error('Failed to get captcha image ', err)\n      })\n  }\n  return elem\n}\n\n/** iframe  */\nexport function iframeBody(checker: CheckerCtx) {\n  const $iframeWrap = Utils.createElement(`<div class=\"atk-checker-iframe-wrap\"></div>`)\n  const $iframe = Utils.createElement<HTMLIFrameElement>(\n    `<iframe class=\"atk-fade-in\" referrerpolicy=\"strict-origin-when-cross-origin\"></iframe>`,\n  )\n  $iframe.style.display = 'none'\n  Ui.showLoading($iframeWrap, { transparentBg: true })\n  $iframe.src = checker.getOpts().getCaptchaIframeURL()\n  $iframe.onload = () => {\n    $iframe.style.display = ''\n    Ui.hideLoading($iframeWrap)\n  }\n  $iframeWrap.append($iframe)\n\n  const $closeBtn = Utils.createElement(\n    `<div class=\"atk-close-btn\"><i class=\"atk-icon atk-icon-close\"></i></div>`,\n  )\n  $iframeWrap.append($closeBtn)\n\n  checker.hideInteractInput()\n\n  // \n  let stop = false // \n  const sleep = (ms: number) =>\n    new Promise((resolve) => {\n      window.setTimeout(() => {\n        resolve(null)\n      }, ms)\n    })\n  ;(async function queryStatus() {\n    await sleep(1000)\n    if (stop) return\n    let isPass = false\n    try {\n      const resp = await checker.getApi().captcha.getCaptchaStatus()\n      isPass = resp.data.is_pass\n    } catch {\n      isPass = false\n    }\n    if (isPass) {\n      checker.triggerSuccess()\n    } else {\n      queryStatus()\n    }\n  })()\n\n  $closeBtn.onclick = () => {\n    stop = true\n    checker.cancel()\n  }\n\n  return $iframeWrap\n}\n","import * as render from './captcha-renders'\nimport type { Checker } from '.'\n\nconst CaptchaChecker: Checker = {\n  request(checker, inputVal) {\n    return checker.getApi().captcha.verifyCaptcha({\n      value: inputVal,\n    })\n  },\n\n  body(checker) {\n    if (checker.get('iframe')) return render.iframeBody(checker)\n    return render.imgBody(checker)\n  },\n\n  onSuccess(checker, data, inputVal, formEl) {\n    checker.set('val', inputVal)\n  },\n\n  onError(checker, err, inputVal, formEl) {\n    formEl.querySelector<HTMLElement>('.atk-captcha-img')!.click() // \n    formEl.querySelector<HTMLInputElement>('input[type=\"text\"]')!.value = '' // \n  },\n}\n\nexport default CaptchaChecker\n","import type { Checker } from '.'\nimport $t from '@/i18n'\nimport * as Utils from '@/lib/utils'\n\nconst AdminChecker: Checker<{ token: string }> = {\n  inputType: 'password',\n\n  async request(checker, inputVal) {\n    return (\n      await checker.getApi().user.login({\n        name: checker.getUser().getData().nick,\n        email: checker.getUser().getData().email,\n        password: inputVal,\n      })\n    ).data\n  },\n\n  body(checker) {\n    return Utils.createElement(`<span>${$t('adminCheck')}</span>`)\n  },\n\n  onSuccess(checker, res, inputVal, formEl) {\n    checker.getUser().update({\n      isAdmin: true,\n      token: res.token,\n    })\n    checker.getOpts().onReload()\n  },\n\n  onError(checker, err, inputVal, formEl) {},\n}\n\nexport default AdminChecker\n","import * as Utils from '../lib/utils'\nimport $t from '@/i18n'\n\ntype BtnClickHandler = (btnEl: HTMLElement, dialog: Dialog) => boolean | void\n\n/**\n * \n */\nexport default class Dialog {\n  public $el: HTMLElement\n  public $content: HTMLElement\n  public $actions: HTMLElement\n\n  constructor(contentEl: HTMLElement) {\n    this.$el = Utils.createElement(\n      `<div class=\"atk-layer-dialog-wrap\">\n        <div class=\"atk-layer-dialog\">\n          <div class=\"atk-layer-dialog-content\"></div>\n          <div class=\"atk-layer-dialog-actions\"></div>\n        </div>\n      </div>`,\n    )\n\n    // \n    this.$actions = this.$el.querySelector<HTMLElement>('.atk-layer-dialog-actions')!\n\n    // \n    this.$content = this.$el.querySelector('.atk-layer-dialog-content')!\n    this.$content.appendChild(contentEl)\n  }\n\n  /**    */\n  public setYes(handler: BtnClickHandler) {\n    const btn = Utils.createElement<HTMLButtonElement>(\n      `<button data-action=\"confirm\">${$t('confirm')}</button>`,\n    )\n    btn.onclick = this.onBtnClick(handler)\n    this.$actions.appendChild(btn)\n\n    return this\n  }\n\n  /**    */\n  public setNo(handler: BtnClickHandler) {\n    const btn = Utils.createElement<HTMLButtonElement>(\n      `<button data-action=\"cancel\">${$t('cancel')}</button>`,\n    )\n    btn.onclick = this.onBtnClick(handler)\n    this.$actions.appendChild(btn)\n\n    return this\n  }\n\n  private onBtnClick(handler: BtnClickHandler) {\n    return (evt: Event) => {\n      const re = handler(evt.currentTarget as HTMLElement, this)\n      if (re === undefined || re === true) {\n        this.$el.remove()\n      }\n    }\n  }\n}\n","import CaptchaChecker from './captcha'\nimport AdminChecker from './admin'\nimport type { Api } from '@/api'\nimport Dialog from '@/components/dialog'\nimport $t from '@/i18n'\nimport type { ContextApi } from '@/types'\nimport type User from '@/lib/user'\nimport * as Utils from '@/lib/utils'\n\nexport interface CheckerCaptchaPayload extends CheckerPayload {\n  img_data?: string\n  iframe?: string\n}\n\nexport interface CheckerPayload {\n  onSuccess?: () => void\n  onMount?: (dialogEl: HTMLElement) => void\n  onCancel?: () => void\n}\n\nexport interface CheckerLauncherOptions {\n  getCtx: () => ContextApi\n  getApi: () => Api\n  getCaptchaIframeURL: () => string\n  onReload: () => void\n}\n\nfunction wrapPromise<P extends CheckerPayload = CheckerPayload>(fn: (p: P) => void) {\n  return (payload: P) =>\n    new Promise<void>((resolve, reject) => {\n      const cancelFn = payload.onCancel\n      payload.onCancel = () => {\n        cancelFn && cancelFn()\n        reject(new Error('user canceled the checker'))\n      }\n      const successFn = payload.onSuccess\n      payload.onSuccess = () => {\n        successFn && successFn()\n        resolve()\n      }\n      fn(payload)\n    })\n}\n\n/**\n * Checker \n */\nexport default class CheckerLauncher {\n  constructor(private opts: CheckerLauncherOptions) {}\n\n  public checkCaptcha: (payload: CheckerCaptchaPayload) => Promise<void> = wrapPromise((p) => {\n    this.fire(CaptchaChecker, p, (ctx) => {\n      ctx.set('img_data', p.img_data)\n      ctx.set('iframe', p.iframe)\n    })\n  })\n\n  public checkAdmin: (payload: CheckerPayload) => Promise<void> = wrapPromise((p) => {\n    this.fire(AdminChecker, p)\n  })\n\n  public fire(checker: Checker, payload: CheckerPayload, postFire?: (c: CheckerCtx) => void) {\n    // \n    const layer = this.opts.getCtx().get('layerManager').create(`checker-${new Date().getTime()}`)\n    layer.show()\n\n    const close = () => {\n      layer.destroy()\n    }\n\n    //  Checker \n    const checkerStore: CheckerStore = {}\n    let hideInteractInput = false\n    const checkerCtx: CheckerCtx = {\n      set: (key, val) => {\n        checkerStore[key] = val\n      },\n      get: (key) => checkerStore[key],\n      getOpts: () => this.opts,\n      getUser: () => this.opts.getCtx().get('user'),\n      getApi: () => this.opts.getApi(),\n      hideInteractInput: () => {\n        hideInteractInput = true\n      },\n      triggerSuccess: () => {\n        close()\n        if (checker.onSuccess) checker.onSuccess(checkerCtx, '', '', formEl)\n        if (payload.onSuccess) payload.onSuccess()\n      },\n      cancel: () => {\n        close()\n        if (payload.onCancel) payload.onCancel()\n      },\n    }\n\n    if (postFire) postFire(checkerCtx)\n\n    // \n    const formEl = Utils.createElement()\n    formEl.appendChild(checker.body(checkerCtx))\n\n    // \n    const $input = Utils.createElement<HTMLInputElement>(\n      `<input id=\"check\" type=\"${checker.inputType || 'text'}\" autocomplete=\"off\" required placeholder=\"\">`,\n    )\n    formEl.appendChild($input)\n    setTimeout(() => $input.focus(), 80) //  Focus\n\n    // \n    $input.onkeyup = (evt) => {\n      if (evt.key === 'Enter' || evt.keyCode === 13) {\n        // \n        evt.preventDefault()\n        layer.getEl().querySelector<HTMLButtonElement>('button[data-action=\"confirm\"]')!.click()\n      }\n    }\n\n    let btnTextOrg: string | undefined\n    const dialog = new Dialog(formEl)\n\n    // \n    dialog.setYes((btnEl) => {\n      const inputVal = $input.value.trim()\n\n      // \n      if (!btnTextOrg) btnTextOrg = btnEl.innerText\n      const btnTextSet = (btnText: string) => {\n        btnEl.innerText = btnText\n        btnEl.classList.add('error')\n      }\n      const btnTextRestore = () => {\n        btnEl.innerText = btnTextOrg || ''\n        btnEl.classList.remove('error')\n      }\n\n      btnEl.innerText = `${$t('loading')}...`\n\n      // \n      checker\n        .request(checkerCtx, inputVal)\n        .then((data) => {\n          // \n          close()\n\n          if (checker.onSuccess) checker.onSuccess(checkerCtx, data, inputVal, formEl)\n          if (payload.onSuccess) payload.onSuccess()\n        })\n        .catch((err) => {\n          // \n          btnTextSet(String(err.message || String(err)))\n\n          if (checker.onError) checker.onError(checkerCtx, err, inputVal, formEl)\n\n          //  3s \n          const tf = setTimeout(() => btnTextRestore(), 3000)\n          $input.onfocus = () => {\n            btnTextRestore()\n            clearTimeout(tf)\n          }\n        })\n\n      return false\n    })\n\n    // \n    dialog.setNo(() => {\n      close()\n      if (payload.onCancel) payload.onCancel()\n      return false\n    })\n\n    if (hideInteractInput) {\n      $input.style.display = 'none'\n      dialog.$el.querySelector<HTMLElement>('.atk-layer-dialog-actions')!.style.display = 'none'\n    }\n\n    //  dialog \n    layer.getEl().append(dialog.$el)\n\n    // onMount \n    if (payload.onMount) payload.onMount(dialog.$el)\n  }\n}\n\nexport interface Checker<T = any> {\n  el?: HTMLElement\n  inputType?: 'password' | 'text'\n  body: (checker: CheckerCtx) => HTMLElement\n  request: (checker: CheckerCtx, inputVal: string) => Promise<T>\n  onSuccess?: (checker: CheckerCtx, respData: T, inputVal: string, formEl: HTMLElement) => void\n  onError?: (checker: CheckerCtx, errData: any, inputVal: string, formEl: HTMLElement) => void\n}\n\ninterface CheckerStore {\n  val?: string\n  img_data?: string\n  iframe?: string\n}\n\nexport interface CheckerCtx {\n  get<K extends keyof CheckerStore>(key: K): CheckerStore[K]\n  set<K extends keyof CheckerStore>(key: K, val: CheckerStore[K]): void\n  getOpts(): CheckerLauncherOptions\n  getApi(): Api\n  getUser(): User\n  hideInteractInput(): void\n  triggerSuccess(): void\n  cancel(): void\n}\n","import type { ContextApi } from '@/types'\n\nexport default abstract class Component {\n  public $el!: HTMLElement\n  public get conf() {\n    return this.ctx.conf\n  }\n\n  public constructor(public ctx: ContextApi) {}\n\n  getEl() {\n    return this.$el\n  }\n}\n","export default \"<div class=\\\"atk-main-editor\\\">\\n  <div class=\\\"atk-header\\\">\\n    <input name=\\\"nick\\\" class=\\\"atk-nick\\\" type=\\\"text\\\" required=\\\"required\\\" />\\n    <input name=\\\"email\\\" class=\\\"atk-email\\\" type=\\\"email\\\" required=\\\"required\\\" />\\n    <input name=\\\"link\\\" class=\\\"atk-link\\\" type=\\\"url\\\" />\\n  </div>\\n  <div class=\\\"atk-textarea-wrap\\\">\\n    <textarea class=\\\"atk-textarea\\\"></textarea>\\n  </div>\\n  <div class=\\\"atk-plug-panel-wrap\\\" style=\\\"display: none\\\"></div>\\n  <div class=\\\"atk-bottom\\\">\\n    <div class=\\\"atk-item atk-bottom-left\\\">\\n      <span class=\\\"atk-state-wrap\\\"></span>\\n      <span class=\\\"atk-plug-btn-wrap\\\"></span>\\n    </div>\\n    <div class=\\\"atk-item\\\">\\n      <button type=\\\"button\\\" class=\\\"atk-send-btn\\\"></button>\\n    </div>\\n  </div>\\n  <div class=\\\"atk-notify-wrap\\\"></div>\\n</div>\\n\"","import * as Utils from '../lib/utils'\nimport EditorHTML from './editor.html?raw'\n\nconst Sel = {\n  $header: '.atk-header',\n  $nick: '.atk-header [name=\"nick\"]',\n  $email: '.atk-header [name=\"email\"]',\n  $link: '.atk-header [name=\"link\"]',\n  $textareaWrap: '.atk-textarea-wrap',\n  $textarea: '.atk-textarea',\n  $bottom: '.atk-bottom',\n  $submitBtn: '.atk-send-btn',\n  $notifyWrap: '.atk-notify-wrap',\n  $bottomLeft: '.atk-bottom-left',\n  $stateWrap: '.atk-state-wrap',\n  $plugBtnWrap: '.atk-plug-btn-wrap',\n  $plugPanelWrap: '.atk-plug-panel-wrap',\n}\n\nexport interface EditorUI extends Record<keyof typeof Sel, HTMLElement> {\n  $el: HTMLElement\n  $nick: HTMLInputElement\n  $email: HTMLInputElement\n  $link: HTMLInputElement\n  $textarea: HTMLTextAreaElement\n  $submitBtn: HTMLButtonElement\n  $sendReplyBtn?: HTMLElement\n  $editCancelBtn?: HTMLElement\n}\n\nexport function render() {\n  const $el = Utils.createElement(EditorHTML)\n  const ui = { $el }\n  Object.entries(Sel).forEach(([k, sel]) => {\n    ui[k] = $el.querySelector(sel)\n  })\n  return ui as EditorUI\n}\n","import type PlugKit from './_kit'\nimport type { CommentData, EditorState } from '@/types'\nimport * as Utils from '@/lib/utils'\n\n/**\n * Editor \n */\ninterface EditorPlug {\n  $btn?: HTMLElement\n  $panel?: HTMLElement\n  contentTransformer?(rawContent: string): string\n  editorStateEffectWhen?: EditorState\n  editorStateEffect?(comment: CommentData): () => void\n}\n\nclass EditorPlug {\n  constructor(protected kit: PlugKit) {}\n\n  /** Use plug btn will add a btn on the bottom of editor */\n  useBtn(html: string = '<div></div>') {\n    this.$btn = Utils.createElement(`<span class=\"atk-plug-btn\">${html}</span>`)\n    return this.$btn\n  }\n\n  /** Use plug panel will show the panel when btn is clicked */\n  usePanel(html: string = '<div></div>') {\n    this.$panel = Utils.createElement(html)\n    return this.$panel\n  }\n\n  /** Use the content transformer to handle the content of the last submit by the editor */\n  useContentTransformer(func: (raw: string) => string) {\n    this.contentTransformer = func\n  }\n\n  /** Listen the event of panel show */\n  usePanelShow(func: () => void) {\n    this.kit.useEvents().on('panel-show', (aPlug) => {\n      if (aPlug === this) func()\n    })\n  }\n\n  /** Listen the event of panel hide */\n  usePanelHide(func: () => void) {\n    this.kit.useEvents().on('panel-hide', (aPlug) => {\n      if (aPlug === this) func()\n    })\n  }\n\n  /** Use editor state modifier */\n  useEditorStateEffect(stateName: EditorState, effectFn: (comment: CommentData) => () => void) {\n    this.editorStateEffectWhen = stateName\n    this.editorStateEffect = effectFn\n  }\n}\n\nexport default EditorPlug\n","import EditorPlug from './_plug'\nimport * as Utils from '@/lib/utils'\n\nexport default class Mover extends EditorPlug {\n  private isMoved = false\n\n  move(afterEl: HTMLElement) {\n    if (this.isMoved) return\n    this.isMoved = true\n\n    const editorEl = this.kit.useUI().$el\n\n    editorEl.after(Utils.createElement('<div class=\"atk-editor-travel-placeholder\"></div>'))\n\n    const $travelPlace = Utils.createElement('<div></div>')\n    afterEl.after($travelPlace)\n    $travelPlace.replaceWith(editorEl)\n\n    editorEl.classList.add('atk-fade-in') // \n    editorEl.classList.add('editor-traveling')\n  }\n\n  back() {\n    if (!this.isMoved) return\n    this.isMoved = false\n    this.kit\n      .useGlobalCtx()\n      .$root.querySelector('.atk-editor-travel-placeholder')\n      ?.replaceWith(this.kit.useUI().$el)\n    this.kit.useUI().$el.classList.remove('editor-traveling')\n  }\n}\n","import Mover from '../plugins/editor/mover'\nimport type Editor from './editor'\nimport type { EditorState, CommentData } from '@/types'\nimport * as Ui from '@/lib/ui'\n\nexport default class EditorStateManager {\n  constructor(private editor: Editor) {}\n\n  private stateCurt: EditorState = 'normal'\n  private stateUnmountFn: (() => void) | null = null\n\n  /** Get current state */\n  get() {\n    return this.stateCurt\n  }\n\n  /**\n   * Switch editor state\n   *\n   * @param state The state to switch\n   * @param payload The cause of state switch\n   */\n  switch(state: EditorState, payload?: { $comment: HTMLElement; comment: CommentData }) {\n    // trigger unmount\n    if (this.stateUnmountFn) {\n      this.stateUnmountFn()\n      this.stateUnmountFn = null\n\n      // move editor back to the initial position\n      this.editor.getPlugs()?.get(Mover)?.back()\n    }\n\n    // invoke effect function and save unmount function\n    if (state !== 'normal' && payload) {\n      // move editor position\n      let moveAfterEl = payload.$comment\n      if (!this.editor.conf.flatMode)\n        moveAfterEl = moveAfterEl.querySelector<HTMLElement>('.atk-footer')!\n      this.editor.getPlugs()?.get(Mover)?.move(moveAfterEl)\n\n      const $relative =\n        this.editor.ctx.conf.scrollRelativeTo && this.editor.ctx.conf.scrollRelativeTo()\n      Ui.scrollIntoView(this.editor.getUI().$el, true, $relative)\n\n      const plugin = this.editor\n        .getPlugs()\n        ?.getPlugs()\n        .find((p) => p.editorStateEffectWhen === state)\n      if (plugin && plugin.editorStateEffect) {\n        this.stateUnmountFn = plugin.editorStateEffect(payload.comment)\n      }\n    }\n\n    // change current state\n    this.stateCurt = state\n  }\n}\n","import Component from '../lib/component'\nimport * as Ui from '../lib/ui'\nimport marked from '../lib/marked'\nimport { render, EditorUI } from './ui'\nimport EditorStateManager from './state'\nimport type { CommentData, ContextApi, EditorApi } from '@/types'\n\nclass Editor extends Component implements EditorApi {\n  private ui: EditorUI\n  private state: EditorStateManager\n\n  getUI() {\n    return this.ui\n  }\n  getPlugs() {\n    return this.ctx.get('editorPlugs')\n  }\n  getState() {\n    return this.state.get()\n  }\n\n  constructor(ctx: ContextApi) {\n    super(ctx)\n\n    // init editor ui\n    this.ui = render()\n    this.$el = this.ui.$el\n\n    // init state manager\n    this.state = new EditorStateManager(this)\n  }\n\n  getHeaderInputEls() {\n    return { nick: this.ui.$nick, email: this.ui.$email, link: this.ui.$link }\n  }\n\n  getContentFinal() {\n    let content = this.getContentRaw()\n\n    // plug hook: final content transformer\n    const plugs = this.getPlugs()\n    if (plugs) content = plugs.getTransformedContent(content)\n\n    return content\n  }\n\n  getContentRaw() {\n    return this.ui.$textarea.value || ''\n  }\n\n  getContentMarked() {\n    return marked(this.getContentFinal())\n  }\n\n  setContent(val: string) {\n    this.ui.$textarea.value = val\n\n    // plug hook: content updated\n    this.getPlugs()?.getEvents().trigger('content-updated', val)\n  }\n\n  insertContent(val: string) {\n    if ((document as any).selection) {\n      this.ui.$textarea.focus()\n      ;(document as any).selection.createRange().text = val\n      this.ui.$textarea.focus()\n    } else if (this.ui.$textarea.selectionStart || this.ui.$textarea.selectionStart === 0) {\n      const sStart = this.ui.$textarea.selectionStart\n      const sEnd = this.ui.$textarea.selectionEnd\n      const sT = this.ui.$textarea.scrollTop\n      this.setContent(\n        this.ui.$textarea.value.substring(0, sStart) +\n          val +\n          this.ui.$textarea.value.substring(sEnd, this.ui.$textarea.value.length),\n      )\n      this.ui.$textarea.focus()\n      this.ui.$textarea.selectionStart = sStart + val.length\n      this.ui.$textarea.selectionEnd = sStart + val.length\n      this.ui.$textarea.scrollTop = sT\n    } else {\n      this.ui.$textarea.focus()\n      this.ui.$textarea.value += val\n    }\n  }\n\n  focus() {\n    this.ui.$textarea.focus()\n  }\n\n  reset() {\n    this.setContent('')\n    this.resetState()\n  }\n\n  resetState() {\n    this.state.switch('normal')\n  }\n\n  setReply(comment: CommentData, $comment: HTMLElement) {\n    this.state.switch('reply', { comment, $comment })\n  }\n\n  setEditComment(comment: CommentData, $comment: HTMLElement) {\n    this.state.switch('edit', { comment, $comment })\n  }\n\n  showNotify(msg: string, type: any) {\n    Ui.showNotify(this.ui.$notifyWrap, msg, type)\n  }\n\n  showLoading() {\n    Ui.showLoading(this.ui.$el)\n  }\n\n  hideLoading() {\n    Ui.hideLoading(this.ui.$el)\n  }\n\n  submit() {\n    const next = () => this.ctx.trigger('editor-submit')\n    if (this.ctx.conf.beforeSubmit) {\n      this.ctx.conf.beforeSubmit(this, next)\n    } else {\n      next()\n    }\n  }\n}\n\nexport default Editor\n","import SidebarHTML from './sidebar-layer.html?raw'\nimport type { Layer } from './layer'\nimport type { ContextApi, SidebarShowPayload } from '@/types'\nimport Component from '@/lib/component'\nimport * as Utils from '@/lib/utils'\nimport * as Ui from '@/lib/ui'\n\nexport default class SidebarLayer extends Component {\n  public layer?: Layer\n  public $header: HTMLElement\n  public $closeBtn: HTMLElement\n  public $iframeWrap: HTMLElement\n  public $iframe?: HTMLIFrameElement\n\n  constructor(ctx: ContextApi) {\n    super(ctx)\n\n    this.$el = Utils.createElement(SidebarHTML)\n    this.$header = this.$el.querySelector('.atk-sidebar-header')!\n    this.$closeBtn = this.$header.querySelector('.atk-sidebar-close')!\n    this.$iframeWrap = this.$el.querySelector('.atk-sidebar-iframe-wrap')!\n\n    this.$closeBtn.onclick = () => {\n      this.hide()\n    }\n\n    // event\n    this.ctx.on('user-changed', () => {\n      this.refreshOnShow = true\n    })\n  }\n\n  /** Refresh iFrame on show */\n  private refreshOnShow = true\n\n  /** Animation timer */\n  private animTimer?: any = undefined\n\n  /**  */\n  public async show(conf: SidebarShowPayload = {}) {\n    this.$el.style.transform = '' // \n\n    // init layer\n    this.initLayer()\n    this.layer!.show()\n\n    // init iframe\n    if (this.refreshOnShow) {\n      this.refreshOnShow = false\n      this.$iframeWrap.innerHTML = ''\n      this.$iframe = this.createIframe(conf.view)\n      this.$iframeWrap.append(this.$iframe)\n    } else {\n      // Sync Dark Mode (reload iframe if not match)\n      const $iframe = this.$iframe!\n      const iFrameSrc = $iframe.src\n      if (this.getDarkMode() !== iFrameSrc.includes('&darkMode=1')) {\n        this.iframeLoad(\n          $iframe,\n          this.getDarkMode()\n            ? iFrameSrc.concat('&darkMode=1')\n            : iFrameSrc.replace('&darkMode=1', ''),\n        )\n      }\n    }\n\n    //  ()\n    this.authCheck({\n      onSuccess: () => this.show(conf), // retry show after auth check\n    })\n\n    // \n    this.animTimer = setTimeout(() => {\n      this.animTimer = undefined\n      this.$el.style.transform = 'translate(0, 0)'\n\n      setTimeout(() => {\n        this.ctx.getData().updateNotifies([])\n      }, 0)\n\n      this.ctx.trigger('sidebar-show')\n    }, 100)\n  }\n\n  /**  */\n  public hide() {\n    this.layer?.hide()\n  }\n\n  // --------------------------------------------------\n\n  private async authCheck(opts: { onSuccess: () => void }) {\n    const data = (\n      await this.ctx.getApi().user.getUserStatus({\n        ...this.ctx.getApi().getUserFields(),\n      })\n    ).data\n    if (data.is_admin && !data.is_login) {\n      this.refreshOnShow = true\n\n      // show checker layer\n      this.ctx.checkAdmin({\n        onSuccess: () => {\n          setTimeout(() => {\n            opts.onSuccess()\n          }, 500)\n        },\n        onCancel: () => {\n          this.hide()\n        },\n      })\n\n      // hide sidebar layer\n      this.hide()\n    }\n  }\n\n  private initLayer() {\n    if (this.layer) return\n\n    this.layer = this.ctx.get('layerManager').create('sidebar', this.$el)\n    this.layer.setOnAfterHide(() => {\n      // \n      this.ctx.editorResetState()\n\n      // interrupt animation\n      this.animTimer && clearTimeout(this.animTimer)\n\n      // perform transform\n      this.$el.style.transform = ''\n\n      // trigger event\n      this.ctx.trigger('sidebar-hide')\n    })\n  }\n\n  private createIframe(view?: string) {\n    const $iframe = Utils.createElement<HTMLIFrameElement>(\n      '<iframe referrerpolicy=\"strict-origin-when-cross-origin\"></iframe>',\n    )\n\n    //  Iframe \n    const baseURL = import.meta.env.DEV\n      ? 'http://localhost:23367/'\n      : Utils.getURLBasedOnApi({\n          base: this.ctx.conf.server,\n          path: '/sidebar/',\n        })\n\n    const query: any = {\n      pageKey: this.conf.pageKey,\n      site: this.conf.site || '',\n      user: JSON.stringify(this.ctx.get('user').getData()),\n      time: +new Date(),\n    }\n\n    if (view) query.view = view\n    if (this.getDarkMode()) query.darkMode = '1'\n\n    const urlParams = new URLSearchParams(query)\n    this.iframeLoad($iframe, `${baseURL}?${urlParams.toString()}`)\n\n    return $iframe\n  }\n\n  private getDarkMode() {\n    return this.conf.darkMode === 'auto'\n      ? window.matchMedia('(prefers-color-scheme: dark)').matches\n      : this.conf.darkMode\n  }\n\n  private iframeLoad($iframe: HTMLIFrameElement, src: string) {\n    $iframe.src = src\n\n    // \n    Ui.showLoading(this.$iframeWrap)\n    $iframe.onload = () => {\n      Ui.hideLoading(this.$iframeWrap)\n    }\n  }\n}\n","export default \"<div class=\\\"atk-sidebar-layer\\\">\\n  <div class=\\\"atk-sidebar-inner\\\">\\n    <div class=\\\"atk-sidebar-header\\\">\\n      <div class=\\\"atk-sidebar-close\\\">\\n        <i class=\\\"atk-icon atk-icon-close-slim\\\"></i>\\n      </div>\\n    </div>\\n    <div class=\\\"atk-sidebar-iframe-wrap\\\"></div>\\n  </div>\\n</div>\\n\"","import type { LayoutStrategyCreator } from '.'\nimport type { CommentNode } from '@/comment'\nimport * as Ui from '@/lib/ui'\nimport * as ListNest from '@/list/nest'\n\nexport const createNestStrategy: LayoutStrategyCreator = (opts) => ({\n  import: (comments) => {\n    //  root \n    const rootNodes = ListNest.makeNestCommentNodeList(comments, opts.nestSortBy, opts.nestMax)\n    rootNodes.forEach((rootNode: ListNest.CommentNode) => {\n      const rootC = opts.createCommentNode(rootNode.comment)\n\n      // \n      opts.$commentsWrap?.appendChild(rootC.getEl())\n      rootC.getRender().playFadeAnim()\n\n      // \n      const loadChildren = (parentC: CommentNode, parentNode: ListNest.CommentNode) => {\n        parentNode.children.forEach((node: ListNest.CommentNode) => {\n          const replyD = comments.find((c) => c.id === node.comment.rid)\n          const childD = node.comment\n          const childC = opts.createCommentNode(childD, replyD)\n\n          // \n          parentC.putChild(childC)\n\n          // \n          loadChildren(childC, node)\n        })\n      }\n      loadChildren(rootC, rootNode)\n\n      // \n      rootC.getRender().checkHeightLimit()\n    })\n  },\n  insert: (comment, replyComment) => {\n    // \n    const node = opts.createCommentNode(comment, replyComment)\n\n    if (comment.rid === 0) {\n      // root \n      opts.$commentsWrap?.prepend(node.getEl())\n    } else {\n      //  \n      const parent = opts.findCommentNode(comment.rid)\n      if (parent) {\n        parent.putChild(node, opts.nestSortBy === 'DATE_ASC' ? 'append' : 'prepend')\n\n        //   \n        node.getParents().forEach((p) => {\n          p.getRender().heightLimitRemoveForChildren()\n        })\n      }\n    }\n\n    node.getRender().checkHeightLimit()\n\n    node.scrollIntoView() // \n    node.getRender().playFadeAnim() // \n  },\n})\n","import type { CommentData } from '@/types'\n\nexport type CommentNode = {\n  id: number\n  comment: CommentData\n  children: CommentNode[]\n  parent?: CommentNode\n  level: number\n}\n\nexport type SortByType = 'DATE_DESC' | 'DATE_ASC' | 'SRC_INDEX' | 'VOTE_UP_DESC'\n\n// \nexport function makeNestCommentNodeList(\n  srcData: CommentData[],\n  sortBy: SortByType = 'DATE_DESC',\n  nestMax = 2,\n) {\n  const nodeList: CommentNode[] = []\n\n  const roots = srcData.filter((o) => o.rid === 0)\n  roots.forEach((root: CommentData) => {\n    const rootNode: CommentNode = {\n      id: root.id,\n      comment: root,\n      children: [],\n      level: 1,\n    }\n\n    rootNode.parent = rootNode\n    nodeList.push(rootNode)\n    ;(function loadChildren(parentNode: CommentNode) {\n      const children = srcData.filter((o) => o.rid === parentNode.id)\n      if (children.length === 0) return\n      if (parentNode.level >= nestMax) parentNode = parentNode.parent!\n      children.forEach((child: CommentData) => {\n        const childNode: CommentNode = {\n          id: child.id,\n          comment: child,\n          children: [],\n          parent: parentNode,\n          level: parentNode.level + 1,\n        }\n\n        parentNode.children.push(childNode)\n        loadChildren(childNode)\n      })\n    })(rootNode)\n  })\n\n  // \n  const sortFunc = (a: CommentNode, b: CommentNode): number => {\n    let v = a.id - b.id\n    if (sortBy === 'DATE_ASC') v = +new Date(a.comment.date) - +new Date(b.comment.date)\n    else if (sortBy === 'DATE_DESC') v = +new Date(b.comment.date) - +new Date(a.comment.date)\n    else if (sortBy === 'SRC_INDEX') v = srcData.indexOf(a.comment) - srcData.indexOf(b.comment)\n    else if (sortBy === 'VOTE_UP_DESC') v = b.comment.vote_up - a.comment.vote_up\n    return v\n  }\n\n  ;(function sortLevels(nodes: CommentNode[]) {\n    nodes.forEach((node) => {\n      node.children = node.children.sort(sortFunc)\n      sortLevels(node.children)\n    })\n  })(nodeList)\n\n  return nodeList\n}\n","import type { LayoutStrategyCreator, LayoutOptions } from '.'\nimport type { CommentData } from '@/types'\nimport * as Ui from '@/lib/ui'\n\nexport const createFlatStrategy: LayoutStrategyCreator = (opts) => ({\n  import: (comments) => {\n    comments.forEach((comment: CommentData) => {\n      const replyComment =\n        comment.rid === 0 ? undefined : comments.find((c) => c.id === comment.rid)\n      insertComment(opts, 'append', comment, replyComment)\n    })\n  },\n  insert: (comment, replyComment) => {\n    const node = insertComment(opts, 'prepend', comment, replyComment)\n    node.scrollIntoView()\n  },\n})\n\n/**    */\nfunction insertComment(\n  opts: LayoutOptions,\n  insertMode: 'append' | 'prepend',\n  comment: CommentData,\n  replyComment?: CommentData | undefined,\n) {\n  if (comment.is_collapsed) comment.is_allow_reply = false\n  const node = opts.createCommentNode(comment, replyComment)\n\n  // \n  //  \n  if (comment.visible) {\n    const $comment = node.getEl()\n    const $listCommentsWrap = opts.$commentsWrap\n    if (insertMode === 'append') $listCommentsWrap?.append($comment)\n    if (insertMode === 'prepend') $listCommentsWrap?.prepend($comment)\n    node.getRender().playFadeAnim()\n  }\n\n  //   \n  //  (visible=true)  (visible=false) \n  node.getRender().checkHeightLimit()\n\n  return node\n}\n","import * as ListNest from '../nest'\nimport { createNestStrategy } from './nest'\nimport { createFlatStrategy } from './flat'\nimport type { CommentNode } from '@/comment'\nimport type { CommentData } from '@/types'\n\nexport interface LayoutOptions {\n  /** The comments wrap of list */\n  $commentsWrap: HTMLElement\n  nestSortBy: ListNest.SortByType\n  nestMax: number\n  flatMode: boolean\n\n  createCommentNode(comment: CommentData, replyComment?: CommentData): CommentNode\n  findCommentNode(id: number): CommentNode | undefined\n}\n\nexport interface LayoutStrategy {\n  import(comments: CommentData[]): void\n  insert(comment: CommentData, replyComment?: CommentData): void\n}\n\nexport type LayoutStrategyCreator = (opts: LayoutOptions) => LayoutStrategy\n\nexport class ListLayout {\n  constructor(private options: LayoutOptions) {}\n\n  private getStrategy() {\n    return this.options.flatMode\n      ? createFlatStrategy(this.options)\n      : createNestStrategy(this.options)\n  }\n\n  import(comments: CommentData[]) {\n    this.getStrategy().import(comments)\n  }\n\n  insert(comment: CommentData, replyComment?: CommentData) {\n    this.getStrategy().insert(comment, replyComment)\n  }\n}\n","import * as Utils from '../lib/utils'\nimport $t from '../i18n'\n\nexport interface IHeightLimitConf {\n  /** After expand btn click */\n  afterExpandBtnClick?: () => void\n  /** Allow Scroll */\n  scrollable?: boolean\n}\n\nexport interface IHeightLimitRule {\n  /** Target element need to check */\n  el: HTMLElement | null | undefined\n\n  /** Max height (unit: px) */\n  max: number\n\n  /** Whether or not the element contains `<img />` */\n  imgCheck?: boolean\n}\n\nexport type THeightLimitRuleSet = IHeightLimitRule[]\n\n/** Check all elements below the max height limit */\nexport function check(conf: IHeightLimitConf, rules: THeightLimitRuleSet) {\n  rules.forEach(({ el, max, imgCheck }) => {\n    if (!el) return\n\n    // set max height for avoiding img exceed the limit while loading\n    if (imgCheck) el.style.maxHeight = `${max + 1}px` // allow 1px more for next detecting\n\n    let lock = false\n    const _check = () => {\n      if (lock) return\n      if (Utils.getHeight(el) <= max) return // if not exceed the limit, do nothing\n\n      const afterExpandBtnClick = () => {\n        lock = true // add lock to prevent collapse again after expand when image lazy loaded\n        conf.afterExpandBtnClick?.()\n      }\n\n      !conf.scrollable\n        ? applyHeightLimit({ el, max, afterExpandBtnClick })\n        : applyScrollableHeightLimit({ el, max })\n    }\n\n    // check immediately\n    _check()\n\n    // check images after loaded\n    if (imgCheck) {\n      // check again when image loaded\n      const imgs = el.querySelectorAll<HTMLImageElement>('.atk-content img')\n      if (imgs.length === 0) el.style.maxHeight = ''\n      imgs.forEach((img) => {\n        img.onload = () => _check()\n      })\n    }\n  })\n}\n\n/** Height limit CSS class name */\nconst HEIGHT_LIMIT_CSS = 'atk-height-limit'\n\n/** Apply height limit on an element and add expand btn */\nexport function applyHeightLimit(obj: {\n  el: HTMLElement\n  max: number\n  afterExpandBtnClick?: (e: MouseEvent) => void\n}) {\n  if (!obj.el) return\n  if (!obj.max) return\n  if (obj.el.classList.contains(HEIGHT_LIMIT_CSS)) return\n\n  obj.el.classList.add(HEIGHT_LIMIT_CSS)\n  obj.el.style.height = `${obj.max}px`\n  obj.el.style.overflow = 'hidden'\n\n  /* Expand button */\n  const $expandBtn = Utils.createElement(\n    `<div class=\"atk-height-limit-btn\">${$t('readMore')}</span>`,\n  )\n  $expandBtn.onclick = (e) => {\n    e.stopPropagation()\n    disposeHeightLimit(obj.el)\n\n    if (obj.afterExpandBtnClick) obj.afterExpandBtnClick(e)\n  }\n  obj.el.append($expandBtn)\n}\n\n/** Dispose height limit on an element and remove expand btn */\nexport function disposeHeightLimit($el: HTMLElement) {\n  if (!$el) return\n  if (!$el.classList.contains(HEIGHT_LIMIT_CSS)) return\n\n  $el.classList.remove(HEIGHT_LIMIT_CSS)\n  Array.from($el.children).forEach((e) => {\n    if (e.classList.contains('atk-height-limit-btn')) e.remove()\n  })\n  $el.style.height = ''\n  $el.style.maxHeight = ''\n  $el.style.overflow = ''\n}\n\n/** Height limit scrollable CSS class name */\nconst HEIGHT_LIMIT_SCROLL_CSS = 'atk-height-limit-scroll'\n\n/** Apply scrollable height limit */\nexport function applyScrollableHeightLimit(opt: { el: HTMLElement; max: number }) {\n  if (!opt.el) return\n  if (opt.el.classList.contains(HEIGHT_LIMIT_SCROLL_CSS)) return\n  opt.el.classList.add(HEIGHT_LIMIT_SCROLL_CSS)\n  opt.el.style.height = `${opt.max}px`\n}\n","import * as Utils from '../../lib/utils'\nimport type Render from '../render'\nimport $t from '@/i18n'\n\n/**\n * \n */\nexport default function renderHeader(r: Render) {\n  Object.entries({\n    renderNick,\n    renderVerifyBadge,\n    renderDate,\n    renderUABadge,\n  }).forEach(([name, render]) => {\n    render(r)\n  })\n}\n\nfunction renderNick(r: Render) {\n  r.$headerNick = r.$el.querySelector<HTMLElement>('.atk-nick')!\n\n  if (r.data.link) {\n    const $nickA = Utils.createElement<HTMLLinkElement>(\n      '<a target=\"_blank\" rel=\"noreferrer noopener nofollow\"></a>',\n    )\n    $nickA.innerText = r.data.nick\n    $nickA.href = Utils.isValidURL(r.data.link) ? r.data.link : `https://${r.data.link}`\n    r.$headerNick.append($nickA)\n  } else {\n    r.$headerNick.innerText = r.data.nick\n  }\n}\n\nfunction renderVerifyBadge(ctx: Render) {\n  ctx.$headerBadgeWrap = ctx.$el.querySelector<HTMLElement>('.atk-badge-wrap')!\n  ctx.$headerBadgeWrap.innerHTML = ''\n\n  const badgeText = ctx.data.badge_name\n  const badgeColor = ctx.data.badge_color\n  if (badgeText) {\n    const $badge = Utils.createElement(`<span class=\"atk-badge\"></span>`)\n    $badge.innerText = badgeText.replace('', $t('admin')) // i18n patch\n    $badge.style.backgroundColor = badgeColor || ''\n    ctx.$headerBadgeWrap.append($badge)\n  } else if (ctx.data.is_verified) {\n    const $verifiedBadge = Utils.createElement(\n      `<span class=\"atk-verified-icon\" title=\"${$t('emailVerified')}\"></span>`,\n    ) // \n    ctx.$headerBadgeWrap.append($verifiedBadge)\n  }\n\n  if (ctx.data.is_pinned) {\n    const $pinnedBadge = Utils.createElement(`<span class=\"atk-pinned-badge\">${$t('pin')}</span>`) // \n    ctx.$headerBadgeWrap.append($pinnedBadge)\n  }\n}\n\nfunction renderDate(ctx: Render) {\n  const $date = ctx.$el.querySelector<HTMLElement>('.atk-date')!\n  $date.innerText = ctx.comment.getDateFormatted()\n  $date.setAttribute('data-atk-comment-date', String(+new Date(ctx.data.date)))\n}\n\nfunction renderUABadge(ctx: Render) {\n  if (!ctx.opts.uaBadge && !ctx.data.ip_region) return\n\n  let $uaWrap = ctx.$header.querySelector('atk-ua-wrap')\n  if (!$uaWrap) {\n    $uaWrap = Utils.createElement(`<span class=\"atk-ua-wrap\"></span>`)\n    ctx.$header.append($uaWrap)\n  }\n\n  $uaWrap.innerHTML = ''\n\n  if (ctx.data.ip_region) {\n    const $regionBadge = Utils.createElement(`<span class=\"atk-region-badge\"></span>`)\n    $regionBadge.innerText = ctx.data.ip_region\n    $uaWrap.append($regionBadge)\n  }\n\n  if (ctx.opts.uaBadge) {\n    const { browser, os } = ctx.comment.getUserUA()\n    if (String(browser).trim()) {\n      const $uaBrowser = Utils.createElement(`<span class=\"atk-ua ua-browser\"></span>`)\n      $uaBrowser.innerText = browser\n      $uaWrap.append($uaBrowser)\n    }\n\n    if (String(os).trim()) {\n      const $usOS = Utils.createElement(`<span class=\"atk-ua ua-os\"></span>`)\n      $usOS.innerText = os\n      $uaWrap.append($usOS)\n    }\n  }\n}\n","import * as Utils from '../lib/utils'\nimport $t from '@/i18n'\n\ninterface ActionBtnOptions {\n  /**  (/) */\n  text: (() => string) | string\n\n  /**  */\n  adminOnly?: boolean\n\n  /**  */\n  confirm?: boolean\n\n  /**  */\n  confirmText?: string\n}\n\n/**\n * \n */\nexport default class ActionBtn {\n  private opts: ActionBtnOptions\n  public $el: HTMLElement\n\n  public isLoading = false // \n\n  public msgRecTimer?: number // \n  public msgRecTimerFunc?: () => void // \n  public get isMessaging() {\n    return !!this.msgRecTimer\n  } // \n\n  public isConfirming = false // \n  public confirmRecTimer?: number // \n\n  /**  */\n  constructor(opts: ActionBtnOptions | string | (() => string)) {\n    this.$el = Utils.createElement(`<span class=\"atk-common-action-btn\"></span>`)\n\n    this.opts = typeof opts !== 'object' ? { text: opts } : opts\n    this.$el.innerText = this.getText()\n\n    // \n    if (this.opts.adminOnly) this.$el.setAttribute('atk-only-admin-show', '')\n  }\n\n  /**  */\n  public appendTo(dom: HTMLElement) {\n    dom.append(this.$el)\n    return this\n  }\n\n  /** / */\n  private getText() {\n    return typeof this.opts.text === 'string' ? this.opts.text : this.opts.text()\n  }\n\n  /**  */\n  public setClick(func: () => void) {\n    this.$el.onclick = (e) => {\n      e.stopPropagation() // \n\n      // \n      if (this.isLoading) {\n        return\n      }\n\n      // \n      if (this.opts.confirm && !this.isMessaging) {\n        const confirmRestore = () => {\n          this.isConfirming = false\n          this.$el.classList.remove('atk-btn-confirm')\n          this.$el.innerText = this.getText()\n        }\n\n        if (!this.isConfirming) {\n          this.isConfirming = true\n          this.$el.classList.add('atk-btn-confirm')\n          this.$el.innerText = this.opts.confirmText || $t('actionConfirm')\n          this.confirmRecTimer = window.setTimeout(() => confirmRestore(), 5000)\n          return\n        }\n\n        if (this.confirmRecTimer) window.clearTimeout(this.confirmRecTimer)\n        confirmRestore()\n      }\n\n      // \n      if (this.msgRecTimer) {\n        this.fireMsgRecTimer()\n        this.clearMsgRecTimer()\n        return\n      }\n\n      // \n      func()\n    }\n  }\n\n  /** / */\n  public updateText(text?: (() => string) | string) {\n    if (text) this.opts.text = text\n    this.setLoading(false)\n    this.$el.innerText = this.getText()\n  }\n\n  /**  */\n  public setLoading(value: boolean, loadingText?: string) {\n    if (this.isLoading === value) return\n    this.isLoading = value\n    if (value) {\n      this.$el.classList.add('atk-btn-loading')\n      this.$el.innerText = loadingText || `${$t('loading')}...`\n    } else {\n      this.$el.classList.remove('atk-btn-loading')\n      this.$el.innerText = this.getText()\n    }\n  }\n\n  /**  */\n  public setError(text: string) {\n    this.setMsg(text, 'atk-btn-error')\n  }\n\n  /**  */\n  public setWarn(text: string) {\n    this.setMsg(text, 'atk-btn-warn')\n  }\n\n  /**  */\n  public setSuccess(text: string) {\n    this.setMsg(text, 'atk-btn-success')\n  }\n\n  /**  */\n  public setMsg(text: string, className?: string, duringTime?: number, after?: () => void) {\n    this.setLoading(false)\n    if (className) this.$el.classList.add(className)\n    this.$el.innerText = text\n\n    //  timer\n    this.setMsgRecTimer(() => {\n      this.$el.innerText = this.getText()\n      if (className) this.$el.classList.remove(className)\n      if (after) after()\n    }, duringTime || 2500) //  2500s\n  }\n\n  /**  */\n  private setMsgRecTimer(func: () => void, duringTime: number) {\n    this.fireMsgRecTimer()\n    this.clearMsgRecTimer()\n\n    this.msgRecTimerFunc = func\n    this.msgRecTimer = window.setTimeout(() => {\n      func()\n      this.clearMsgRecTimer()\n    }, duringTime)\n  }\n\n  /**  */\n  private fireMsgRecTimer() {\n    if (this.msgRecTimerFunc) this.msgRecTimerFunc()\n  }\n\n  /**  timer */\n  private clearMsgRecTimer() {\n    if (this.msgRecTimer) window.clearTimeout(this.msgRecTimer)\n    this.msgRecTimer = undefined\n    this.msgRecTimerFunc = undefined\n  }\n}\n","import * as Utils from '../../lib/utils'\nimport ActionBtn from '../../components/action-btn'\nimport type Render from '../render'\nimport $t from '@/i18n'\n\n/**\n * \n */\nexport default function renderActions(r: Render) {\n  Object.entries({\n    renderVote,\n    renderReply,\n    // \n    renderCollapse,\n    renderModerator,\n    renderPin,\n    renderEdit,\n    renderDel,\n  }).forEach(([name, render]) => {\n    render(r)\n  })\n}\n\n//  - \nfunction renderVote(r: Render) {\n  if (!r.opts.vote) return // \n\n  // \n  r.voteBtnUp = new ActionBtn(() => `${$t('voteUp')} (${r.data.vote_up || 0})`).appendTo(r.$actions)\n  r.voteBtnUp.setClick(() => {\n    r.comment.getActions().vote('up')\n  })\n\n  // \n  if (r.opts.voteDown) {\n    r.voteBtnDown = new ActionBtn(() => `${$t('voteDown')} (${r.data.vote_down || 0})`).appendTo(\n      r.$actions,\n    )\n    r.voteBtnDown.setClick(() => {\n      r.comment.getActions().vote('down')\n    })\n  }\n}\n\n//  - \nfunction renderReply(r: Render) {\n  if (!r.data.is_allow_reply) return // \n\n  const replyBtn = Utils.createElement(`<span>${$t('reply')}</span>`)\n  r.$actions.append(replyBtn)\n  replyBtn.addEventListener('click', (e) => {\n    e.stopPropagation() // \n    r.opts.replyComment(r.data, r.$el)\n  })\n}\n\n//  - \nfunction renderCollapse(r: Render) {\n  const collapseBtn = new ActionBtn({\n    text: () => (r.data.is_collapsed ? $t('expand') : $t('collapse')),\n    adminOnly: true,\n  })\n  collapseBtn.appendTo(r.$actions)\n  collapseBtn.setClick(() => {\n    r.comment.getActions().adminEdit('collapsed', collapseBtn)\n  })\n}\n\n//  - \nfunction renderModerator(r: Render) {\n  const pendingBtn = new ActionBtn({\n    text: () => (r.data.is_pending ? $t('pending') : $t('approved')),\n    adminOnly: true,\n  })\n  pendingBtn.appendTo(r.$actions)\n  pendingBtn.setClick(() => {\n    r.comment.getActions().adminEdit('pending', pendingBtn)\n  })\n}\n\n//  - \nfunction renderPin(r: Render) {\n  const pinnedBtn = new ActionBtn({\n    text: () => (r.data.is_pinned ? $t('unpin') : $t('pin')),\n    adminOnly: true,\n  })\n  pinnedBtn.appendTo(r.$actions)\n  pinnedBtn.setClick(() => {\n    r.comment.getActions().adminEdit('pinned', pinnedBtn)\n  })\n}\n\n//  - \nfunction renderEdit(r: Render) {\n  const editBtn = new ActionBtn({\n    text: $t('edit'),\n    adminOnly: true,\n  })\n  editBtn.appendTo(r.$actions)\n  editBtn.setClick(() => {\n    r.opts.editComment(r.data, r.$el)\n  })\n}\n\n//  - \nfunction renderDel(r: Render) {\n  const delBtn = new ActionBtn({\n    text: $t('delete'),\n    confirm: true,\n    confirmText: $t('deleteConfirm'),\n    adminOnly: true,\n  })\n  delBtn.appendTo(r.$actions)\n  delBtn.setClick(() => {\n    r.comment.getActions().adminDelete(delBtn)\n  })\n}\n","import type Render from '../render'\nimport Avatar from './avatar'\nimport Header from './header'\nimport Content from './content'\nimport ReplyAt from './reply-at'\nimport ReplyTo from './reply-to'\nimport Pending from './pending'\nimport Actions from './actions'\n\nconst Renders = {\n  Avatar,\n  Header,\n  Content,\n  ReplyAt,\n  ReplyTo,\n  Pending,\n  Actions,\n}\n\nexport default function loadRenders(r: Render) {\n  Object.entries(Renders).forEach(([name, render]) => {\n    render(r)\n  })\n}\n","import * as Utils from '../../lib/utils'\nimport type Render from '../render'\n\n/**\n * \n */\nexport default function renderAvatar(r: Render) {\n  const $avatar = r.$el.querySelector<HTMLElement>('.atk-avatar')!\n  const $avatarImg = Utils.createElement<HTMLImageElement>('<img />')\n\n  const avatarURLBuilder = r.opts.avatarURLBuilder\n  $avatarImg.src = avatarURLBuilder ? avatarURLBuilder(r.data) : r.comment.getGravatarURL()\n\n  if (r.data.link) {\n    const $avatarA = Utils.createElement<HTMLLinkElement>(\n      '<a target=\"_blank\" rel=\"noreferrer noopener nofollow\"></a>',\n    )\n    $avatarA.href = Utils.isValidURL(r.data.link) ? r.data.link : `https://${r.data.link}`\n    $avatarA.append($avatarImg)\n    $avatar.append($avatarA)\n  } else {\n    $avatar.append($avatarImg)\n  }\n}\n","import * as Utils from '../../lib/utils'\nimport * as Ui from '../../lib/ui'\nimport type Render from '../render'\nimport $t from '@/i18n'\n\n/**\n * \n */\nexport default function renderContent(r: Render) {\n  if (!r.data.is_collapsed) {\n    r.$content.innerHTML = r.comment.getContentMarked()\n    r.$content.classList.remove('atk-hide', 'atk-collapsed')\n    return\n  }\n\n  //  & \n  r.$content.classList.add('atk-hide', 'atk-type-collapsed')\n  const collapsedInfoEl = Utils.createElement(`\n    <div class=\"atk-collapsed\">\n      <span class=\"atk-text\">${$t('collapsedMsg')}</span>\n      <span class=\"atk-show-btn\">${$t('expand')}</span>\n    </div>`)\n  r.$body.insertAdjacentElement('beforeend', collapsedInfoEl)\n\n  const contentShowBtn = collapsedInfoEl.querySelector<HTMLElement>('.atk-show-btn')!\n  contentShowBtn.addEventListener('click', (e) => {\n    e.stopPropagation() // \n\n    if (r.$content.classList.contains('atk-hide')) {\n      r.$content.innerHTML = r.comment.getContentMarked()\n      r.$content.classList.remove('atk-hide')\n      Ui.playFadeInAnim(r.$content)\n      contentShowBtn.innerText = $t('collapse')\n    } else {\n      r.$content.innerHTML = ''\n      r.$content.classList.add('atk-hide')\n      contentShowBtn.innerText = $t('expand')\n    }\n  })\n}\n","import * as Utils from '../../lib/utils'\nimport type Render from '../render'\n\n/**\n * Reply user indicator (with arrow icon) in the comment meta header\n */\nexport default function renderReplyAt(r: Render) {\n  if (r.opts.flatMode || r.data.rid === 0) return // if not nested mode or root comment\n  if (!r.opts.replyTo) return // if no replyTo data\n\n  r.$replyAt = Utils.createElement(\n    `<span class=\"atk-item atk-reply-at\"><span class=\"atk-arrow\"></span><span class=\"atk-nick\"></span></span>`,\n  )\n  r.$replyAt.querySelector<HTMLElement>('.atk-nick')!.innerText = `${r.opts.replyTo.nick}`\n  r.$replyAt.onclick = () => {\n    r.comment.getActions().goToReplyComment()\n  }\n\n  r.$headerBadgeWrap.insertAdjacentElement('afterend', r.$replyAt)\n}\n","import type Render from '../render'\nimport * as Utils from '@/lib/utils'\nimport marked from '@/lib/marked'\nimport $t from '@/i18n'\n\n/**\n *  ()\n */\nexport default function renderReplyTo(r: Render) {\n  if (!r.opts.flatMode) return // \n  if (!r.opts.replyTo) return\n\n  r.$replyTo = Utils.createElement(`\n    <div class=\"atk-reply-to\">\n      <div class=\"atk-meta\">${$t('reply')} <span class=\"atk-nick\"></span>:</div>\n      <div class=\"atk-content\"></div>\n    </div>`)\n\n  // Comment author name\n  const $nick = r.$replyTo.querySelector<HTMLElement>('.atk-nick')!\n  $nick.innerText = `@${r.opts.replyTo.nick}`\n  $nick.onclick = () => {\n    r.comment.getActions().goToReplyComment()\n  }\n\n  // Comment content\n  let replyContent = marked(r.opts.replyTo.content)\n  if (r.opts.replyTo.is_collapsed) replyContent = `[${$t('collapsed')}]`\n  r.$replyTo.querySelector<HTMLElement>('.atk-content')!.innerHTML = replyContent\n\n  // Mount the replyTo element\n  r.$body.prepend(r.$replyTo)\n}\n","import * as Utils from '../../lib/utils'\nimport type Render from '../render'\nimport $t from '@/i18n'\n\n/**\n * \n */\nexport default function renderPending(r: Render) {\n  if (!r.data.is_pending) return\n\n  const pendingEl = Utils.createElement(`<div class=\"atk-pending\">${$t('pendingMsg')}</div>`)\n  r.$body.prepend(pendingEl)\n}\n","import ActionBtn from '../components/action-btn'\nimport * as Utils from '../lib/utils'\nimport * as Ui from '../lib/ui'\n\nimport * as HeightLimit from './height-limit'\nimport CommentHTML from './comment.html?raw'\nimport loadRenders from './renders'\nimport type { CommentNode } from '.'\n\nexport default class Render {\n  public comment: CommentNode\n\n  public get data() {\n    return this.comment.getData()\n  }\n  public get opts() {\n    return this.comment.getOpts()\n  }\n\n  public $el!: HTMLElement\n  public $main!: HTMLElement\n  public $header!: HTMLElement\n  public $headerNick!: HTMLElement\n  public $headerBadgeWrap!: HTMLElement\n  public $body!: HTMLElement\n  public $content!: HTMLElement\n  public $childrenWrap!: HTMLElement | null\n  public $actions!: HTMLElement\n  public voteBtnUp?: ActionBtn\n  public voteBtnDown?: ActionBtn\n\n  public $replyTo?: HTMLElement //  ()\n  public $replyAt?: HTMLElement //  AT\n\n  public constructor(comment: CommentNode) {\n    this.comment = comment\n  }\n\n  /**\n   * Render the comment ui\n   *\n   * If comment data is updated, call this method to re-render the comment ui.\n   * The method will be called multiple times, so it should be idempotent.\n   *\n   * Renders may add event listeners to the comment ui, so it should be called only once or override the original.\n   * Please be aware of the memory leak caused by the event listener.\n   */\n  public render() {\n    // init ui elements\n    this.$el = Utils.createElement(CommentHTML)\n\n    this.$main = this.$el.querySelector('.atk-main')!\n    this.$header = this.$el.querySelector('.atk-header')!\n    this.$body = this.$el.querySelector('.atk-body')!\n    this.$content = this.$body.querySelector('.atk-content')!\n    this.$actions = this.$el.querySelector('.atk-actions')!\n\n    this.$el.setAttribute('id', `atk-comment-${this.data.id}`)\n\n    // call all renders\n    loadRenders(this)\n\n    // append children wrap if exists\n    if (this.$childrenWrap) {\n      this.$main.append(this.$childrenWrap)\n    }\n\n    return this.$el\n  }\n\n  /**  */\n  public checkHeightLimit() {\n    const conf = this.opts.heightLimit\n    if (!conf || !conf.content || !conf.children) return // \n\n    const contentMaxH = conf.content\n    const childrenMaxH = conf.children\n\n    HeightLimit.check(\n      {\n        afterExpandBtnClick: () => {\n          //  1\n          const children = this.comment.getChildren()\n          if (children.length === 1)\n            HeightLimit.disposeHeightLimit(children[0].getRender().$content)\n        },\n        scrollable: conf.scrollable,\n      },\n      [\n        // \n        { el: this.$content, max: contentMaxH, imgCheck: true },\n        { el: this.$replyTo, max: contentMaxH, imgCheck: true },\n        // \n        { el: this.$childrenWrap, max: childrenMaxH, imgCheck: false },\n      ],\n    )\n  }\n\n  /**  */\n  public heightLimitRemoveForChildren() {\n    if (!this.$childrenWrap) return\n    HeightLimit.disposeHeightLimit(this.$childrenWrap)\n  }\n\n  /**  */\n  playFadeAnim() {\n    Ui.playFadeInAnim(this.comment.getRender().$el)\n  }\n\n  /**    */\n  playFadeAnimForBody() {\n    Ui.playFadeInAnim(this.comment.getRender().$body)\n  }\n\n  /** Perform the flash animation */\n  playFlashAnim() {\n    // Make sure the class is removed\n    this.$el.classList.remove('atk-flash-once')\n    window.setTimeout(() => {\n      // Add the class to perform the animation\n      this.$el.classList.add('atk-flash-once')\n    }, 150)\n  }\n\n  /**  Wrap */\n  public getChildrenWrap() {\n    if (!this.$childrenWrap) {\n      // if not exists, create a new one\n      this.$childrenWrap = Utils.createElement('<div class=\"atk-comment-children\"></div>')\n      this.$main.append(this.$childrenWrap)\n    }\n    return this.$childrenWrap\n  }\n\n  /**  */\n  public setUnread(val: boolean) {\n    if (val) this.$el.classList.add('atk-unread')\n    else this.$el.classList.remove('atk-unread')\n  }\n\n  /**  */\n  public setOpenable(val: boolean) {\n    if (val) this.$el.classList.add('atk-openable')\n    else this.$el.classList.remove('atk-openable')\n  }\n\n  /**  URL */\n  public setOpenURL(url: string) {\n    this.setOpenable(true)\n    this.$el.onclick = (evt) => {\n      evt.stopPropagation()\n      window.open(url)\n    }\n  }\n\n  /**  */\n  public setOpenAction(action: () => void) {\n    this.setOpenable(true)\n    this.$el.onclick = (evt) => {\n      evt.stopPropagation()\n      action()\n    }\n  }\n}\n","export default \"<div class=\\\"atk-comment-wrap\\\">\\n  <div class=\\\"atk-comment\\\">\\n    <div class=\\\"atk-avatar\\\"></div>\\n    <div class=\\\"atk-main\\\">\\n      <div class=\\\"atk-header\\\">\\n        <span class=\\\"atk-item atk-nick\\\"></span>\\n        <span class=\\\"atk-badge-wrap\\\"></span>\\n        <span class=\\\"atk-item atk-date\\\"></span>\\n      </div>\\n      <div class=\\\"atk-body\\\">\\n        <div class=\\\"atk-content\\\"></div>\\n      </div>\\n      <div class=\\\"atk-footer\\\">\\n        <div class=\\\"atk-actions\\\"></div>\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n\"","import type { CommentNode } from '.'\nimport ActionBtn from '@/components/action-btn'\nimport $t from '@/i18n'\n\nexport default class CommentActions {\n  private comment: CommentNode\n\n  private get data() {\n    return this.comment.getData()\n  }\n  private get opts() {\n    return this.comment.getOpts()\n  }\n  private getApi() {\n    return this.comment.getOpts().getApi()\n  }\n\n  public constructor(comment: CommentNode) {\n    this.comment = comment\n  }\n\n  /**  */\n  public vote(type: 'up' | 'down') {\n    const actionBtn =\n      type === 'up' ? this.comment.getRender().voteBtnUp : this.comment.getRender().voteBtnDown\n\n    this.getApi()\n      .votes.vote(`comment_${type}`, this.data.id, {\n        ...this.getApi().getUserFields(),\n      })\n      .then((res) => {\n        this.data.vote_up = res.data.up\n        this.data.vote_down = res.data.down\n        this.comment.getRender().voteBtnUp?.updateText()\n        this.comment.getRender().voteBtnDown?.updateText()\n      })\n      .catch((err) => {\n        actionBtn?.setError($t('voteFail'))\n        console.error(err)\n      })\n  }\n\n  /**  -  */\n  public adminEdit(type: 'collapsed' | 'pending' | 'pinned', btnElem: ActionBtn) {\n    if (btnElem.isLoading) return // \n\n    btnElem.setLoading(true, `${$t('editing')}...`)\n\n    // \n    const modify = { ...this.data }\n    if (type === 'collapsed') {\n      modify.is_collapsed = !modify.is_collapsed\n    } else if (type === 'pending') {\n      modify.is_pending = !modify.is_pending\n    } else if (type === 'pinned') {\n      modify.is_pinned = !modify.is_pinned\n    }\n\n    this.getApi()\n      .comments.updateComment(this.data.id, {\n        ...modify,\n      })\n      .then((res) => {\n        btnElem.setLoading(false)\n\n        //  Comment UI\n        this.comment.setData(res.data)\n      })\n      .catch((err) => {\n        console.error(err)\n        btnElem.setError($t('editFail'))\n      })\n  }\n\n  /**  -  */\n  public adminDelete(btnElem: ActionBtn) {\n    if (btnElem.isLoading) return // \n\n    btnElem.setLoading(true, `${$t('deleting')}...`)\n    this.getApi()\n      .comments.deleteComment(this.data.id)\n      .then(() => {\n        btnElem.setLoading(false)\n        if (this.opts.onDelete) this.opts.onDelete(this.comment)\n      })\n      .catch((e) => {\n        console.error(e)\n        btnElem.setError($t('deleteFail'))\n      })\n  }\n\n  /**  */\n  public goToReplyComment() {\n    const origHash = window.location.hash\n    const modifyHash = `#atk-comment-${this.data.rid}`\n\n    window.location.hash = modifyHash\n    if (modifyHash === origHash) window.dispatchEvent(new Event('hashchange')) // \n  }\n}\n","import type { Api } from '../api'\nimport * as Ui from '../lib/ui'\nimport * as Utils from '../lib/utils'\nimport marked from '../lib/marked'\nimport UADetect from '../lib/detect'\nimport CommentUI from './render'\nimport CommentActions from './actions'\nimport $t from '@/i18n'\nimport type { CommentData, ArtalkConfig, ContextApi } from '@/types'\n\nexport interface CommentOptions {\n  // Hooks\n  onAfterRender?: () => void\n  onDelete?: (c: CommentNode) => void\n\n  /** The comment being replied to (linked comment) */\n  replyTo?: CommentData\n\n  // Referenced from ArtalkConfig\n  flatMode: boolean\n  vote: boolean\n  voteDown: boolean\n  uaBadge: boolean\n  nestMax: number\n  gravatar: ArtalkConfig['gravatar']\n  heightLimit: ArtalkConfig['heightLimit']\n  avatarURLBuilder: ArtalkConfig['avatarURLBuilder']\n  scrollRelativeTo: ArtalkConfig['scrollRelativeTo']\n\n  // TODO: Move to plugin folder and remove from core\n  getApi: () => Api\n  replyComment: ContextApi['replyComment']\n  editComment: ContextApi['editComment']\n}\n\nexport default class CommentNode {\n  $el?: HTMLElement\n\n  private renderInstance: CommentUI\n  private actionInstance: CommentActions\n\n  private data: CommentData\n  private opts: CommentOptions\n\n  private parent: CommentNode | null\n  private children: CommentNode[] = []\n\n  private nestCurt: number // \n\n  constructor(data: CommentData, opts: CommentOptions) {\n    this.opts = opts\n    this.data = { ...data }\n    this.data.date = this.data.date.replace(/-/g, '/') //  Safari  NaN \n\n    this.parent = null\n    this.nestCurt = 1 //  n \n\n    this.actionInstance = new CommentActions(this)\n    this.renderInstance = new CommentUI(this)\n  }\n\n  /**  UI */\n  public render() {\n    const newEl = this.renderInstance.render()\n\n    if (this.$el) this.$el.replaceWith(newEl)\n    this.$el = newEl\n    // Please be aware of the memory leak, the $el may be replaced multiple times.\n    // If somewhere else has a reference to the old $el, it will cause a memory leak.\n    // So it's limited to use the $el reference by `getEl()`.\n    // The `getEl()` will always return the latest $el.\n\n    if (this.opts.onAfterRender) this.opts.onAfterRender()\n  }\n\n  /**  */\n  public getActions() {\n    return this.actionInstance\n  }\n\n  /**  */\n  public getRender() {\n    return this.renderInstance\n  }\n\n  /**  */\n  public getData() {\n    return this.data\n  }\n\n  /**  */\n  public setData(data: CommentData) {\n    this.data = data\n\n    this.render()\n    this.getRender().playFadeAnimForBody()\n  }\n\n  /**  */\n  public getParent() {\n    return this.parent\n  }\n\n  /**  */\n  public getChildren() {\n    return this.children\n  }\n\n  /**  */\n  public getNestCurt() {\n    return this.nestCurt\n  }\n\n  /**  */\n  public getIsRoot() {\n    return this.data.rid === 0\n  }\n\n  /**  ID */\n  public getID() {\n    return this.data.id\n  }\n\n  /**  */\n  public putChild(childNode: CommentNode, insertMode: 'append' | 'prepend' = 'append') {\n    childNode.parent = this\n    childNode.nestCurt = this.nestCurt + 1 //  +1\n    this.children.push(childNode)\n\n    const $childrenWrap = this.getChildrenWrapEl()\n    const $childComment = childNode.getEl()\n    if (insertMode === 'append') $childrenWrap.append($childComment)\n    else if (insertMode === 'prepend') $childrenWrap.prepend($childComment)\n\n    childNode.getRender().playFadeAnim()\n    childNode.getRender().checkHeightLimit() // \n  }\n\n  /**  */\n  public getChildrenWrapEl(): HTMLElement {\n    // console.log(this.nestCurt)\n    if (this.nestCurt >= this.opts.nestMax) {\n      return this.parent!.getChildrenWrapEl()\n    }\n    return this.getRender().getChildrenWrap()\n  }\n\n  /**  */\n  public getParents() {\n    const flattenParents: CommentNode[] = []\n    let parent = this.parent\n    while (parent) {\n      flattenParents.push(parent)\n      parent = parent.getParent()\n    }\n    return flattenParents\n  }\n\n  /**\n   * Get the element of the comment\n   *\n   * The `getEl()` will always return the latest $el after calling `render()`.\n   * Please be aware of the memory leak if you use the $el reference directly.\n   */\n  public getEl() {\n    if (!this.$el) throw new Error('comment element not initialized before `getEl()`')\n    return this.$el\n  }\n\n  /**\n   * Focus on the comment\n   *\n   * Scroll to the comment and perform flash animation\n   */\n  focus() {\n    if (!this.$el) throw new Error('comment element not initialized before `focus()`')\n\n    //   \n    this.getParents().forEach((p) => {\n      p.getRender().heightLimitRemoveForChildren()\n    })\n\n    // Scroll to comment\n    this.scrollIntoView()\n\n    // Perform flash animation\n    this.getRender().playFlashAnim()\n  }\n\n  scrollIntoView() {\n    this.$el &&\n      Ui.scrollIntoView(this.$el, false, this.opts.scrollRelativeTo && this.opts.scrollRelativeTo())\n  }\n\n  /**\n   * Remove the comment node\n   */\n  remove() {\n    this.$el?.remove()\n  }\n\n  /**  Gravatar  URL */\n  public getGravatarURL() {\n    return Utils.getGravatarURL({\n      mirror: this.opts.gravatar.mirror,\n      params: this.opts.gravatar.params,\n      emailHash: this.data.email_encrypted,\n    })\n  }\n\n  /**  markdown  */\n  public getContentMarked() {\n    return marked(this.data.content)\n  }\n\n  /**  */\n  public getDateFormatted() {\n    return Utils.timeAgo(new Date(this.data.date), $t)\n  }\n\n  /**  UserAgent  */\n  public getUserUA() {\n    const info = UADetect(this.data.ua)\n    return {\n      browser: `${info.browser} ${info.version}`,\n      os: `${info.os} ${info.osVersion}`,\n    }\n  }\n\n  /**  */\n  public getOpts() {\n    return this.opts\n  }\n}\n","function Detect(userAgent?: string) {\n  const win = (window as any) || {}\n  const nav = navigator || {}\n\n  const u = String(userAgent || nav.userAgent)\n  const dest = {\n    os: '',\n    osVersion: '',\n    engine: '',\n    browser: '',\n    device: '',\n    language: '',\n    version: ''\n  }\n\n  // \n  const engineMatch = {\n    Trident: u.includes('Trident') || u.includes('NET CLR'),\n    Presto: u.includes('Presto'),\n    WebKit: u.includes('AppleWebKit'),\n    Gecko: u.includes('Gecko/')\n  }\n\n  // \n  const browserMatch = {\n    Safari: u.includes('Safari'),\n    Chrome: u.includes('Chrome') || u.includes('CriOS'),\n    IE: u.includes('MSIE') || u.includes('Trident'),\n    Edge: u.includes('Edge') || u.includes('Edg'),\n    Firefox: u.includes('Firefox') || u.includes('FxiOS'),\n    'Firefox Focus': u.includes('Focus'),\n    Chromium: u.includes('Chromium'),\n    Opera: u.includes('Opera') || u.includes('OPR'),\n    Vivaldi: u.includes('Vivaldi'),\n    Yandex: u.includes('YaBrowser'),\n    Kindle: u.includes('Kindle') || u.includes('Silk/'),\n    360: u.includes('360EE') || u.includes('360SE'),\n    UC: u.includes('UC') || u.includes(' UBrowser'),\n    QQBrowser: u.includes('QQBrowser'),\n    QQ: u.includes('QQ/'),\n    Baidu: u.includes('Baidu') || u.includes('BIDUBrowser'),\n    Maxthon: u.includes('Maxthon'),\n    Sogou: u.includes('MetaSr') || u.includes('Sogou'),\n    LBBROWSER: u.includes('LBBROWSER'),\n    '2345Explorer': u.includes('2345Explorer'),\n    TheWorld: u.includes('TheWorld'),\n    MIUI: u.includes('MiuiBrowser'),\n    Quark: u.includes('Quark'),\n    Qiyu: u.includes('Qiyu'),\n    Wechat: u.includes('MicroMessenger'),\n    Taobao: u.includes('AliApp(TB'),\n    Alipay: u.includes('AliApp(AP'),\n    Weibo: u.includes('Weibo'),\n    Douban: u.includes('com.douban.frodo'),\n    Suning: u.includes('SNEBUY-APP'),\n    iQiYi: u.includes('IqiyiApp'),\n  }\n\n  // \n  const osMatch = {\n    Windows: u.includes('Windows'),\n    Linux: u.includes('Linux') || u.includes('X11'),\n    'macOS': u.includes('Macintosh'),\n    Android: u.includes('Android') || u.includes('Adr'),\n    Ubuntu: u.includes('Ubuntu'),\n    FreeBSD: u.includes('FreeBSD'),\n    Debian: u.includes('Debian'),\n    'Windows Phone': u.includes('IEMobile') || u.includes('Windows Phone'),\n    BlackBerry: u.includes('BlackBerry') || u.includes('RIM'),\n    MeeGo: u.includes('MeeGo'),\n    Symbian: u.includes('Symbian'),\n    iOS: u.includes('like Mac OS X'),\n    'Chrome OS': u.includes('CrOS'),\n    WebOS: u.includes('hpwOS'),\n  }\n\n  // \n  const deviceMatch = {\n    Mobile: u.includes('Mobi') || u.includes('iPh') || u.includes('480'),\n    Tablet: u.includes('Tablet') || u.includes('Pad') || u.includes('Nexus 7')\n  }\n\n  // \n  if (deviceMatch.Mobile) {\n    deviceMatch.Mobile = !(u.includes('iPad'))\n  } else if (browserMatch.Chrome && u.includes('Edg')) {\n    // Chrome  Edge\n    browserMatch.Chrome = false\n    browserMatch.Edge = true\n  } else if (win.showModalDialog && win.chrome) {\n    browserMatch.Chrome = false\n    browserMatch['360'] = true\n  }\n\n  // \n  dest.device = 'PC'\n\n  // \n  dest.language = (() => {\n    const g = ((nav as any).browserLanguage || nav.language)\n    const arr = g.split('-')\n    if (arr[1]) arr[1] = arr[1].toUpperCase()\n    return arr.join('_')\n  })()\n\n  // \n  const hash = {\n    engine: engineMatch,\n    browser: browserMatch,\n    os: osMatch,\n    device: deviceMatch,\n  }\n  Object.entries(hash).forEach(([type, match]) => {\n    Object.entries(match).forEach(([name, result]) => {\n      if (result === true) dest[type] = name\n    })\n  })\n\n  // \n  const osVersion = {\n    Windows: () => {\n      const v = u.replace(/^.*Windows NT ([\\d.]+);.*$/, '$1')\n      const wvHash = {\n        '6.4': '10',\n        '6.3': '8.1',\n        '6.2': '8',\n        '6.1': '7',\n        '6.0': 'Vista',\n        '5.2': 'XP',\n        '5.1': 'XP',\n        '5.0': '2000',\n        '10.0': '10',\n        '11.0': '11' // \n      }\n      return wvHash[v] || v\n    },\n    Android: () => u.replace(/^.*Android ([\\d.]+);.*$/, '$1'),\n    iOS: () => u.replace(/^.*OS ([\\d_]+) like.*$/, '$1').replace(/_/g, '.'),\n    Debian: () => u.replace(/^.*Debian\\/([\\d.]+).*$/, '$1'),\n    'Windows Phone': () => u.replace(/^.*Windows Phone( OS)? ([\\d.]+);.*$/, '$2'),\n    'macOS': () => u.replace(/^.*Mac OS X ([\\d_]+).*$/, '$1').replace(/_/g, '.'),\n    WebOS: () => u.replace(/^.*hpwOS\\/([\\d.]+);.*$/, '$1')\n  }\n\n  dest.osVersion = ''\n  if (osVersion[dest.os]) {\n    dest.osVersion = osVersion[dest.os]()\n    if (dest.osVersion === u) {\n      dest.osVersion = ''\n    }\n  }\n\n  // \n  const version = {\n    Safari: () => u.replace(/^.*Version\\/([\\d.]+).*$/, '$1'),\n    Chrome: () => u.replace(/^.*Chrome\\/([\\d.]+).*$/, '$1').replace(/^.*CriOS\\/([\\d.]+).*$/, '$1'),\n    IE: () => u.replace(/^.*MSIE ([\\d.]+).*$/, '$1').replace(/^.*rv:([\\d.]+).*$/, '$1'),\n    Edge: () => u.replace(/^.*(Edge|Edg|Edg[A-Z]{1})\\/([\\d.]+).*$/, '$2'),\n    Firefox: () => u.replace(/^.*Firefox\\/([\\d.]+).*$/, '$1').replace(/^.*FxiOS\\/([\\d.]+).*$/, '$1'),\n    'Firefox Focus': () => u.replace(/^.*Focus\\/([\\d.]+).*$/, '$1'),\n    Chromium: () => u.replace(/^.*Chromium\\/([\\d.]+).*$/, '$1'),\n    Opera: () => u.replace(/^.*Opera\\/([\\d.]+).*$/, '$1').replace(/^.*OPR\\/([\\d.]+).*$/, '$1'),\n    Vivaldi: () => u.replace(/^.*Vivaldi\\/([\\d.]+).*$/, '$1'),\n    Yandex: () => u.replace(/^.*YaBrowser\\/([\\d.]+).*$/, '$1'),\n    Kindle: () => u.replace(/^.*Version\\/([\\d.]+).*$/, '$1'),\n    Maxthon: () => u.replace(/^.*Maxthon\\/([\\d.]+).*$/, '$1'),\n    QQBrowser: () => u.replace(/^.*QQBrowser\\/([\\d.]+).*$/, '$1'),\n    QQ: () => u.replace(/^.*QQ\\/([\\d.]+).*$/, '$1'),\n    Baidu: () => u.replace(/^.*BIDUBrowser[\\s/]([\\d.]+).*$/, '$1'),\n    UC: () => u.replace(/^.*UC?Browser\\/([\\d.]+).*$/, '$1'),\n    Sogou: () => u.replace(/^.*SE ([\\d.X]+).*$/, '$1').replace(/^.*SogouMobileBrowser\\/([\\d.]+).*$/, '$1'),\n    '2345Explorer': () => u.replace(/^.*2345Explorer\\/([\\d.]+).*$/, '$1'),\n    TheWorld: () => u.replace(/^.*TheWorld ([\\d.]+).*$/, '$1'),\n    MIUI: () => u.replace(/^.*MiuiBrowser\\/([\\d.]+).*$/, '$1'),\n    Quark: () => u.replace(/^.*Quark\\/([\\d.]+).*$/, '$1'),\n    Qiyu: () => u.replace(/^.*Qiyu\\/([\\d.]+).*$/, '$1'),\n    Wechat: () => u.replace(/^.*MicroMessenger\\/([\\d.]+).*$/, '$1'),\n    Taobao: () => u.replace(/^.*AliApp\\(TB\\/([\\d.]+).*$/, '$1'),\n    Alipay: () => u.replace(/^.*AliApp\\(AP\\/([\\d.]+).*$/, '$1'),\n    Weibo: () => u.replace(/^.*weibo__([\\d.]+).*$/, '$1'),\n    Douban: () => u.replace(/^.*com.douban.frodo\\/([\\d.]+).*$/, '$1'),\n    Suning: () => u.replace(/^.*SNEBUY-APP([\\d.]+).*$/, '$1'),\n    iQiYi: () => u.replace(/^.*IqiyiVersion\\/([\\d.]+).*$/, '$1'),\n  }\n\n  dest.version = ''\n  if (version[dest.browser]) {\n    dest.version = version[dest.browser]()\n    if (dest.version === u) {\n      dest.version = ''\n    }\n  }\n\n  // \n  /* if (_this.osVersion.indexOf('.')) {\n    _this.osVersion = _this.osVersion.substring(0, _this.osVersion.indexOf('.'))\n  } */\n  if (dest.version.indexOf('.')) {\n    dest.version = dest.version.substring(0, dest.version.indexOf('.'))\n  }\n\n  // \n  if (dest.os === 'iOS' && u.includes('iPad')) {\n    dest.os = 'iPadOS'\n  } else if (dest.browser === 'Edge' && !u.includes('Edg')) {\n    dest.engine = 'EdgeHTML'\n  } else if (dest.browser === 'MIUI') {\n    dest.os = 'Android'\n  } else if (dest.browser === 'Chrome' && Number(dest.version) > 27) {\n    dest.engine = 'Blink'\n  } else if (dest.browser === 'Opera' && Number(dest.version) > 12) {\n    dest.engine = 'Blink'\n  } else if (dest.browser === 'Yandex') {\n    dest.engine = 'Blink'\n  } else if (dest.browser === undefined) {\n    dest.browser = 'Unknow App'\n  }\n\n  return dest\n}\n\nexport default Detect\n","import * as Utils from '../lib/utils'\n\nexport interface ReadMoreBtnOptions {\n  /**  */\n  onClick: (offset: number) => void\n\n  pageSize: number\n\n  text?: string\n}\n\n/**\n * \n */\nexport default class ReadMoreBtn {\n  public opts: ReadMoreBtnOptions\n  public $el: HTMLElement\n  private $loading: HTMLElement\n  private $text: HTMLElement\n  private offset: number = 0\n  private total: number = 0\n  private origText: string = 'Load More'\n\n  /**  */\n  get hasMore() {\n    return this.total > this.offset + this.opts.pageSize\n  }\n\n  public constructor(opts: ReadMoreBtnOptions) {\n    this.opts = opts\n    this.origText = this.opts.text || this.origText\n\n    this.$el = Utils.createElement(\n      `<div class=\"atk-list-read-more\" style=\"display: none;\">\n      <div class=\"atk-list-read-more-inner\">\n        <div class=\"atk-loading-icon\" style=\"display: none;\"></div>\n        <span class=\"atk-text\">${this.origText}</span>\n      </div>\n    </div>`,\n    )\n\n    this.$loading = this.$el.querySelector<HTMLElement>('.atk-loading-icon')!\n    this.$text = this.$el.querySelector<HTMLElement>('.atk-text')!\n\n    this.$el.onclick = () => {\n      this.click()\n    }\n  }\n\n  click() {\n    if (this.hasMore) this.opts.onClick(this.offset + this.opts.pageSize)\n    this.checkDisabled()\n  }\n\n  /**  */\n  show() {\n    this.$el.style.display = ''\n  }\n\n  /**  */\n  hide() {\n    this.$el.style.display = 'none'\n  }\n\n  /**  */\n  setLoading(isLoading: boolean) {\n    this.$loading.style.display = isLoading ? '' : 'none'\n    this.$text.style.display = isLoading ? 'none' : ''\n  }\n\n  /**  */\n  showErr(errMsg: string) {\n    this.setLoading(false)\n\n    this.$text.innerText = errMsg\n    this.$el.classList.add('atk-err')\n    window.setTimeout(() => {\n      this.$text.innerText = this.origText\n      this.$el.classList.remove('atk-err')\n    }, 2000) // 2s\n  }\n\n  /**  */\n  public update(offset: number, total: number) {\n    this.offset = offset\n    this.total = total\n\n    this.checkDisabled()\n  }\n\n  public checkDisabled() {\n    if (this.hasMore) this.show()\n    else this.hide()\n  }\n}\n","import type { Paginator, IPgHolderOpt } from '.'\nimport type { ListFetchParams } from '@/types'\nimport ReadMoreBtn from '@/components/read-more-btn'\nimport $t from '@/i18n'\n\n/**\n * \n */\nexport default class ReadMorePaginator implements Paginator {\n  private instance!: ReadMoreBtn\n  private onReachedBottom: (() => void) | null = null\n  private opt!: IPgHolderOpt\n\n  create(opt: IPgHolderOpt) {\n    this.opt = opt\n\n    this.instance = new ReadMoreBtn({\n      pageSize: opt.pageSize,\n      onClick: async (o) => {\n        opt.ctx.fetch({\n          offset: o,\n        })\n      },\n      text: $t('loadMore'),\n    })\n\n    // \n    if (opt.readMoreAutoLoad) {\n      this.onReachedBottom = () => {\n        if (!this.instance.hasMore || this.opt.ctx.getData().getLoading()) return\n        this.instance.click()\n      }\n      this.opt.ctx.on('list-reach-bottom', this.onReachedBottom)\n    }\n\n    return this.instance.$el\n  }\n\n  setLoading(val: boolean) {\n    this.instance.setLoading(val)\n  }\n\n  update(offset: number, total: number) {\n    this.instance.update(offset, total)\n  }\n\n  showErr(msg: string) {\n    this.instance.showErr(msg)\n  }\n\n  next() {\n    this.instance.click()\n  }\n\n  getHasMore(): boolean {\n    return this.instance.hasMore\n  }\n\n  getIsClearComments(params: { offset?: number }): boolean {\n    return params.offset === 0\n  }\n\n  dispose(): void {\n    this.onReachedBottom && this.opt.ctx.off('list-reach-bottom', this.onReachedBottom)\n    this.instance.$el.remove()\n  }\n}\n","import * as Utils from '../lib/utils'\nimport * as Ui from '../lib/ui'\n\nexport interface PaginationOptions {\n  /**  */\n  pageSize: number\n\n  /**  */\n  onChange: (offset: number) => void\n}\n\nexport default class Pagination {\n  private opts: PaginationOptions\n  public total: number\n  public $el: HTMLElement\n  public $input: HTMLInputElement\n  public inputTimer?: number\n  public $prevBtn: HTMLElement\n  public $nextBtn: HTMLElement\n\n  public page: number = 1\n  get pageSize(): number {\n    return this.opts.pageSize\n  }\n  get offset(): number {\n    return this.pageSize * (this.page - 1)\n  }\n  get maxPage(): number {\n    return Math.ceil(this.total / this.pageSize)\n  }\n\n  public constructor(total: number, opts: PaginationOptions) {\n    this.total = total\n    this.opts = opts\n\n    this.$el = Utils.createElement(\n      `<div class=\"atk-pagination-wrap\">\n        <div class=\"atk-pagination\">\n          <div class=\"atk-btn atk-btn-prev\" aria-label=\"Previous page\">\n            <svg stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" viewBox=\"0 0 512 512\" height=\"14px\" width=\"14px\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M217.9 256L345 129c9.4-9.4 9.4-24.6 0-33.9-9.4-9.4-24.6-9.3-34 0L167 239c-9.1 9.1-9.3 23.7-.7 33.1L310.9 417c4.7 4.7 10.9 7 17 7s12.3-2.3 17-7c9.4-9.4 9.4-24.6 0-33.9L217.9 256z\"></path></svg>\n          </div>\n          <input type=\"text\" class=\"atk-input\" aria-label=\"Enter the number of page\" />\n          <div class=\"atk-btn atk-btn-next\" aria-label=\"Next page\">\n            <svg stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" viewBox=\"0 0 512 512\" height=\"14px\" width=\"14px\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M294.1 256L167 129c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.3 34 0L345 239c9.1 9.1 9.3 23.7.7 33.1L201.1 417c-4.7 4.7-10.9 7-17 7s-12.3-2.3-17-7c-9.4-9.4-9.4-24.6 0-33.9l127-127.1z\"></path></svg>\n          </div>\n        </div>\n      </div>`,\n    )\n    this.$input = this.$el.querySelector('.atk-input')!\n    this.$input.value = `${this.page}`\n\n    this.$input.oninput = () => this.input()\n    this.$input.onkeydown = (e) => this.keydown(e)\n\n    this.$prevBtn = this.$el.querySelector('.atk-btn-prev')!\n    this.$nextBtn = this.$el.querySelector('.atk-btn-next')!\n\n    this.$prevBtn.onclick = () => this.prev()\n    this.$nextBtn.onclick = () => this.next()\n\n    this.checkDisabled()\n  }\n\n  public update(offset: number, total: number) {\n    this.page = Math.ceil(offset / this.pageSize) + 1\n    this.total = total\n\n    this.setInput(this.page)\n    this.checkDisabled()\n  }\n\n  public setInput(page: number) {\n    this.$input.value = `${page}`\n  }\n\n  public input(now: boolean = false) {\n    window.clearTimeout(this.inputTimer)\n\n    const value = this.$input.value.trim()\n\n    const modify = () => {\n      if (value === '') {\n        this.setInput(this.page)\n        return\n      }\n      let page = Number(value)\n      if (Number.isNaN(page)) {\n        this.setInput(this.page)\n        return\n      }\n      if (page < 1) {\n        this.setInput(this.page)\n        return\n      }\n      if (page > this.maxPage) {\n        this.setInput(this.maxPage)\n        page = this.maxPage\n      }\n      this.change(page)\n    }\n\n    //  800ms \n    if (!now) this.inputTimer = window.setTimeout(() => modify(), 800)\n    else modify()\n  }\n\n  public prev() {\n    const page = this.page - 1\n    if (page < 1) {\n      return\n    }\n    this.change(page)\n  }\n\n  public next() {\n    const page = this.page + 1\n    if (page > this.maxPage) {\n      return\n    }\n    this.change(page)\n  }\n\n  public getHasMore() {\n    return this.page + 1 <= this.maxPage\n  }\n\n  public change(page: number) {\n    this.page = page\n    this.opts.onChange(this.offset)\n    this.setInput(page)\n    this.checkDisabled()\n  }\n\n  public checkDisabled() {\n    if (this.page + 1 > this.maxPage) {\n      this.$nextBtn.classList.add('atk-disabled')\n    } else {\n      this.$nextBtn.classList.remove('atk-disabled')\n    }\n\n    if (this.page - 1 < 1) {\n      this.$prevBtn.classList.add('atk-disabled')\n    } else {\n      this.$prevBtn.classList.remove('atk-disabled')\n    }\n  }\n\n  public keydown(e: KeyboardEvent) {\n    const keyCode = e.keyCode || e.which\n\n    if (keyCode === 38) {\n      // \n      const page = Number(this.$input.value) + 1\n      if (page > this.maxPage) {\n        return\n      }\n      this.setInput(page)\n      this.input()\n    } else if (keyCode === 40) {\n      // \n      const page = Number(this.$input.value) - 1\n      if (page < 1) {\n        return\n      }\n      this.setInput(page)\n      this.input()\n    } else if (keyCode === 13) {\n      // \n      this.input(true)\n    }\n  }\n\n  /**  */\n  setLoading(isLoading: boolean) {\n    if (isLoading) Ui.showLoading(this.$el)\n    else Ui.hideLoading(this.$el)\n  }\n}\n","import type { Paginator, IPgHolderOpt } from '.'\nimport PaginationComponent from '@/components/pagination'\n\n/**\n * \n */\nexport default class UpDownPaginator implements Paginator {\n  private instance!: PaginationComponent\n\n  create(opt: IPgHolderOpt) {\n    this.instance = new PaginationComponent(opt.total, {\n      pageSize: opt.pageSize,\n      onChange: async (o) => {\n        opt.ctx.editorResetState() // \n\n        opt.ctx.fetch({\n          offset: o,\n          onSuccess: () => {\n            opt.ctx.listGotoFirst()\n          },\n        })\n      },\n    })\n\n    return this.instance.$el\n  }\n\n  setLoading(val: boolean) {\n    this.instance.setLoading(val)\n  }\n\n  update(offset: number, total: number) {\n    this.instance.update(offset, total)\n  }\n\n  next() {\n    this.instance.next()\n  }\n\n  getHasMore(): boolean {\n    return this.instance.getHasMore()\n  }\n\n  getIsClearComments(): boolean {\n    return true\n  }\n\n  dispose(): void {\n    this.instance.$el.remove()\n  }\n}\n","import { Paginator } from './paginator'\nimport ReadMorePaginator from './paginator/read-more'\nimport UpDownPaginator from './paginator/up-down'\nimport $t from '@/i18n'\nimport type { ArtalkConfig, ContextApi } from '@/types'\n\nfunction createPaginatorByConf(conf: Pick<ArtalkConfig, 'pagination'>): Paginator {\n  if (conf.pagination.readMore) return new ReadMorePaginator()\n  return new UpDownPaginator()\n}\n\nfunction getPageDataByLastData(ctx: ContextApi): {\n  offset: number\n  total: number\n} {\n  const last = ctx.getData().getListLastFetch()\n  const r = { offset: 0, total: 0 }\n  if (!last) return r\n\n  r.offset = last.params.offset\n  if (last.data) r.total = last.params.flatMode ? last.data.count : last.data.roots_count\n\n  return r\n}\n\nexport const initListPaginatorFunc = (ctx: ContextApi) => {\n  let paginator: Paginator | null = null\n\n  // Init paginator when conf loaded\n  ctx.watchConf(['pagination', 'locale'], (conf) => {\n    const list = ctx.get('list')\n\n    if (paginator) paginator.dispose() // if had been init, dispose it\n\n    // create paginator instance\n    paginator = createPaginatorByConf(conf)\n\n    // create paginator dom\n    const { offset, total } = getPageDataByLastData(ctx)\n    const $paginator = paginator.create({\n      ctx,\n      pageSize: conf.pagination.pageSize,\n      total,\n\n      readMoreAutoLoad: conf.pagination.autoLoad,\n    })\n\n    // mount paginator dom\n    list.$commentsWrap.after($paginator)\n\n    // update paginator info\n    paginator?.update(offset, total)\n  })\n\n  // When list loaded\n  ctx.on('list-loaded', (comments) => {\n    // update paginator info\n    const { offset, total } = getPageDataByLastData(ctx)\n    paginator?.update(offset, total)\n  })\n\n  // When list fetch\n  ctx.on('list-fetch', (params) => {\n    // if clear comments when fetch new page data\n    if (ctx.getData().getComments().length > 0 && paginator?.getIsClearComments(params)) {\n      ctx.getData().clearComments()\n    }\n  })\n\n  // When list error\n  ctx.on('list-failed', () => {\n    paginator?.showErr?.($t('loadFail'))\n  })\n\n  // loading\n  ctx.on('list-fetch', (params) => {\n    paginator?.setLoading(true)\n  })\n  ctx.on('list-fetched', ({ params }) => {\n    paginator?.setLoading(false)\n  })\n}\n","import ListHTML from './list.html?raw'\nimport { ListLayout } from './layout'\nimport { createCommentNode } from './comment'\nimport { initListPaginatorFunc } from './page'\nimport type { ContextApi } from '@/types'\nimport Component from '@/lib/component'\nimport * as Utils from '@/lib/utils'\nimport { CommentNode } from '@/comment'\n\nexport default class List extends Component {\n  /**  */\n  $commentsWrap!: HTMLElement\n  public getCommentsWrapEl() {\n    return this.$commentsWrap\n  }\n\n  protected commentNodes: CommentNode[] = []\n  getCommentNodes() {\n    return this.commentNodes\n  }\n\n  constructor(ctx: ContextApi) {\n    super(ctx)\n\n    // Init base element\n    this.$el = Utils.createElement(ListHTML)\n    this.$commentsWrap = this.$el.querySelector('.atk-list-comments-wrap')!\n\n    // Init paginator\n    initListPaginatorFunc(ctx)\n\n    // Bind events\n    this.initCrudEvents()\n  }\n\n  getListLayout({ forceFlatMode }: { forceFlatMode?: boolean } = {}) {\n    return new ListLayout({\n      $commentsWrap: this.$commentsWrap,\n      nestSortBy: this.ctx.conf.nestSort,\n      nestMax: this.ctx.conf.nestMax,\n      flatMode:\n        typeof forceFlatMode === 'boolean' ? forceFlatMode : (this.ctx.conf.flatMode as boolean),\n      // flatMode must be boolean because it had been handled when Artalk.init\n      createCommentNode: (d, r) => {\n        const node = createCommentNode(this.ctx, d, r, { forceFlatMode })\n        this.commentNodes.push(node) // store node instance\n        return node\n      },\n      findCommentNode: (id) => this.commentNodes.find((c) => c.getID() === id),\n    })\n  }\n\n  private initCrudEvents() {\n    this.ctx.on('list-load', (comments) => {\n      // \n      this.getListLayout().import(comments)\n    })\n\n    this.ctx.on('list-loaded', (comments) => {\n      if (comments.length === 0) {\n        this.commentNodes = []\n        this.$commentsWrap.innerHTML = ''\n      }\n    })\n\n    // When comment insert\n    this.ctx.on('comment-inserted', (comment) => {\n      const replyComment = comment.rid\n        ? this.commentNodes.find((c) => c.getID() === comment.rid)?.getData()\n        : undefined\n      this.getListLayout().insert(comment, replyComment)\n    })\n\n    // When comment delete\n    this.ctx.on('comment-deleted', (comment) => {\n      const node = this.commentNodes.find((c) => c.getID() === comment.id)\n      if (!node) {\n        console.error(`comment node id=${comment.id} not found`)\n        return\n      }\n      node.remove()\n      this.commentNodes = this.commentNodes.filter((c) => c.getID() !== comment.id)\n      // TODO: remove child nodes\n    })\n\n    // When comment update\n    this.ctx.on('comment-updated', (comment) => {\n      const node = this.commentNodes.find((c) => c.getID() === comment.id)\n      node && node.setData(comment)\n    })\n  }\n}\n","export default \"<div class=\\\"atk-list\\\">\\n  <div class=\\\"atk-list-header\\\">\\n    <div class=\\\"atk-comment-count\\\">\\n      <div class=\\\"atk-text\\\"></div>\\n    </div>\\n    <div class=\\\"atk-right-action\\\">\\n      <span data-action=\\\"admin-close-comment\\\" class=\\\"atk-hide\\\" atk-only-admin-show></span>\\n      <span data-action=\\\"open-sidebar\\\" class=\\\"atk-hide atk-on\\\">\\n        <span class=\\\"atk-unread-badge\\\" style=\\\"display: none\\\"></span>\\n        <div class=\\\"atk-text\\\"></div>\\n      </span>\\n    </div>\\n  </div>\\n  <div class=\\\"atk-list-body\\\">\\n    <div class=\\\"atk-list-comments-wrap\\\"></div>\\n  </div>\\n  <div class=\\\"atk-list-footer\\\">\\n    <div class=\\\"atk-copyright\\\"></div>\\n  </div>\\n</div>\\n\"","import type { ContextApi, CommentData } from '@/types'\nimport { CommentNode } from '@/comment'\n\ninterface CreateCommentNodeOptions {\n  forceFlatMode?: boolean\n}\n\nexport function createCommentNode(\n  ctx: ContextApi,\n  comment: CommentData,\n  replyComment?: CommentData,\n  opts?: CreateCommentNodeOptions,\n): CommentNode {\n  const instance = new CommentNode(comment, {\n    onAfterRender: () => {\n      ctx.trigger('comment-rendered', instance)\n    },\n    onDelete: (c: CommentNode) => {\n      ctx.getData().deleteComment(c.getID())\n    },\n\n    replyTo: replyComment,\n\n    // TODO simplify reference\n    flatMode:\n      typeof opts?.forceFlatMode === 'boolean'\n        ? opts?.forceFlatMode\n        : (ctx.conf.flatMode as boolean),\n    gravatar: ctx.conf.gravatar,\n    nestMax: ctx.conf.nestMax,\n    heightLimit: ctx.conf.heightLimit,\n    avatarURLBuilder: ctx.conf.avatarURLBuilder,\n    scrollRelativeTo: ctx.conf.scrollRelativeTo,\n    vote: ctx.conf.vote,\n    voteDown: ctx.conf.voteDown,\n    uaBadge: ctx.conf.uaBadge,\n\n    // TODO: move to plugin folder and remove from core\n    getApi: () => ctx.getApi(),\n    replyComment: (c, $el) => ctx.replyComment(c, $el),\n    editComment: (c, $el) => ctx.editComment(c, $el),\n  })\n\n  // \n  instance.render()\n\n  return instance\n}\n","import * as Ui from '@/lib/ui'\n\nlet bodyOrgOverflow: string\nlet bodyOrgPaddingRight: string\n\nexport function getScrollbarHelper() {\n  return {\n    init() {\n      bodyOrgOverflow = document.body.style.overflow\n      bodyOrgPaddingRight = document.body.style.paddingRight\n    },\n\n    unlock() {\n      document.body.style.overflow = bodyOrgOverflow\n      document.body.style.paddingRight = bodyOrgPaddingRight\n    },\n\n    lock() {\n      document.body.style.overflow = 'hidden'\n      const barPaddingRight = parseInt(\n        window.getComputedStyle(document.body, null).getPropertyValue('padding-right'),\n        10,\n      )\n      document.body.style.paddingRight = `${Ui.getScrollBarWidth() + barPaddingRight || 0}px`\n    },\n  }\n}\n","export interface LayerOptions {\n  onShow: () => void\n  onHide: () => void\n}\n\nexport class Layer {\n  private allowMaskClose = true\n  private onAfterHide?: () => void\n\n  constructor(\n    private $el: HTMLElement,\n    private opts: LayerOptions,\n  ) {}\n\n  setOnAfterHide(func: () => void) {\n    this.onAfterHide = func\n  }\n\n  setAllowMaskClose(allow: boolean) {\n    this.allowMaskClose = allow\n  }\n\n  getAllowMaskClose() {\n    return this.allowMaskClose\n  }\n\n  getEl() {\n    return this.$el\n  }\n\n  show() {\n    this.opts.onShow()\n    this.$el.style.display = ''\n  }\n\n  async hide() {\n    this.opts.onHide()\n    this.$el.style.display = 'none'\n    this.onAfterHide && this.onAfterHide()\n  }\n\n  async destroy() {\n    this.opts.onHide()\n    this.$el.remove()\n    this.onAfterHide && this.onAfterHide()\n  }\n}\n","import { getScrollbarHelper } from './scrollbar-helper'\nimport { Layer } from './layer'\nimport * as Utils from '@/lib/utils'\n\nexport class LayerWrap {\n  private $wrap: HTMLElement\n  private $mask: HTMLElement\n  private items: Layer[] = []\n\n  constructor() {\n    this.$wrap = Utils.createElement(\n      `<div class=\"atk-layer-wrap\" style=\"display: none;\"><div class=\"atk-layer-mask\"></div></div>`,\n    )\n    this.$mask = this.$wrap.querySelector<HTMLElement>('.atk-layer-mask')!\n  }\n\n  createItem(name: string, el?: HTMLElement) {\n    // init element\n    el = el || this.createItemElement(name)\n    el.setAttribute('data-layer-name', name)\n    this.$wrap.appendChild(el)\n\n    // create layer instance\n    const layer = new Layer(el, {\n      onHide: () => this.hideWrap(el!),\n      onShow: () => this.showWrap(),\n    })\n\n    // register mask click event\n    this.getMask().addEventListener('click', () => {\n      layer.getAllowMaskClose() && layer.hide()\n    })\n\n    // add to items\n    this.items.push(layer)\n\n    return layer\n  }\n\n  private createItemElement(name: string) {\n    const el = document.createElement('div')\n    el.classList.add('atk-layer-item')\n    el.style.display = 'none'\n    this.$wrap.appendChild(el)\n    return el\n  }\n\n  getWrap() {\n    return this.$wrap\n  }\n\n  getMask() {\n    return this.$mask\n  }\n\n  showWrap() {\n    this.$wrap.style.display = 'block'\n    this.$mask.style.display = 'block'\n    this.$mask.classList.add('atk-fade-in')\n    getScrollbarHelper().lock()\n  }\n\n  hideWrap($el: HTMLElement) {\n    // if wrap contains more than one item, do not hide entire wrap\n    if (\n      this.items\n        .map((l) => l.getEl())\n        .filter((e) => e !== $el && e.isConnected && e.style.display !== 'none').length > 0\n    ) {\n      return\n    }\n\n    this.$wrap.style.display = 'none'\n    getScrollbarHelper().unlock()\n  }\n}\n","import { getScrollbarHelper } from './scrollbar-helper'\nimport { LayerWrap } from './wrap'\nimport type { ContextApi } from '@/types'\n\nexport class LayerManager {\n  private wrap: LayerWrap\n\n  constructor(ctx: ContextApi) {\n    this.wrap = new LayerWrap()\n    document.body.appendChild(this.wrap.getWrap())\n\n    ctx.on('unmounted', () => {\n      this.wrap.getWrap().remove()\n    })\n\n    //  CSS \n    getScrollbarHelper().init()\n  }\n\n  getEl() {\n    return this.wrap.getWrap()\n  }\n\n  create(name: string, el?: HTMLElement) {\n    return this.wrap.createItem(name, el)\n  }\n}\n","import type { LocalUser } from '@/types'\n\nconst LOCAL_USER_KEY = 'ArtalkUser'\n\ninterface UserOpts {\n  onUserChanged?: (user: LocalUser) => void\n}\n\nclass User {\n  private data: LocalUser\n\n  constructor(private opts: UserOpts) {\n    // Import from localStorage\n    const localUser = JSON.parse(window.localStorage.getItem(LOCAL_USER_KEY) || '{}')\n\n    // Initialize\n    this.data = {\n      nick: localUser.nick || '',\n      email: localUser.email || '',\n      link: localUser.link || '',\n      token: localUser.token || '',\n      isAdmin: localUser.isAdmin || false,\n    }\n  }\n\n  getData() {\n    return this.data\n  }\n\n  /** Update user data and save to localStorage */\n  update(obj: Partial<LocalUser> = {}) {\n    Object.entries(obj).forEach(([key, value]) => {\n      this.data[key] = value\n    })\n\n    window.localStorage.setItem(LOCAL_USER_KEY, JSON.stringify(this.data))\n    this.opts.onUserChanged && this.opts.onUserChanged(this.data)\n  }\n\n  /**\n   * Logout\n   *\n   * @description Logout will clear login status, but not clear user data (nick, email, link)\n   */\n  logout() {\n    this.update({\n      token: '',\n      isAdmin: false,\n    })\n  }\n\n  /** Check if user has filled basic data */\n  checkHasBasicUserInfo() {\n    return !!this.data.nick && !!this.data.email\n  }\n}\n\nexport default User\n","import CheckerLauncher from './components/checker'\nimport Editor from './editor/editor'\nimport SidebarLayer from './layer/sidebar-layer'\n\nimport List from './list/list'\n\nimport * as I18n from './i18n'\nimport { PlugManager } from './plugins/editor-kit'\nimport { LayerManager } from './layer/layer-manager'\nimport User from './lib/user'\nimport type { ContextApi } from '@/types'\n\n/**\n * Services\n *\n * @description Call these services by `ctx.get('serviceName')` or `ctx.serviceName`\n */\nconst services = {\n  // I18n\n  i18n(ctx: ContextApi) {\n    I18n.setLocale(ctx.conf.locale)\n\n    ctx.watchConf(['locale'], (conf) => {\n      I18n.setLocale(conf.locale)\n    })\n  },\n\n  // User Store\n  user(ctx: ContextApi) {\n    const user = new User({\n      onUserChanged: (data) => {\n        ctx.trigger('user-changed', data)\n      },\n    })\n    return user\n  },\n\n  // \n  layerManager(ctx: ContextApi) {\n    return new LayerManager(ctx)\n  },\n\n  // CheckerLauncher\n  checkerLauncher(ctx: ContextApi) {\n    const checkerLauncher = new CheckerLauncher({\n      getCtx: () => ctx,\n      getApi: () => ctx.getApi(),\n      onReload: () => ctx.reload(),\n\n      // make sure suffix with a slash, because it will be used as a base url when call `fetch`\n      getCaptchaIframeURL: () => `${ctx.conf.server}/api/v2/captcha/?t=${+new Date()}`,\n    })\n    return checkerLauncher\n  },\n\n  // \n  editor(ctx: ContextApi) {\n    const editor = new Editor(ctx)\n    ctx.$root.appendChild(editor.$el)\n    return editor\n  },\n\n  // \n  list(ctx: ContextApi): List {\n    const list = new List(ctx)\n    ctx.$root.appendChild(list.$el)\n    return list\n  },\n\n  //  Layer\n  sidebarLayer(ctx: ContextApi) {\n    const sidebarLayer = new SidebarLayer(ctx)\n    return sidebarLayer\n  },\n\n  // Extra Service\n  // -----------------------------------------\n  // Only for type check\n  // Not inject to ctx immediately,\n  // but can be injected by other occasions\n\n  editorPlugs(): PlugManager | undefined {\n    return undefined\n  },\n}\n\nexport default services\n\n// type tricks for dependency injection\ntype TServiceImps = typeof services\ntype TObjectWithFuncs = { [k: string]: (...args: any) => any }\ntype TKeysOnlyReturn<T extends TObjectWithFuncs, V> = {\n  [K in keyof T]: ReturnType<T[K]> extends V ? K : never\n}[keyof T]\ntype TOmitConditions = TKeysOnlyReturn<TServiceImps, void>\ntype TServiceInjectors = Omit<TServiceImps, TOmitConditions>\nexport type TInjectedServices = {\n  [K in keyof TServiceInjectors]: ReturnType<TServiceInjectors[K]>\n}\n","import type { ContextApi, ArtalkPlugin, ArtalkConfig } from '@/types'\nimport { Api } from '@/api'\n\ntype CountCache = { [pageKey: string]: number }\n\nexport interface CountOptions {\n  getApi(): Api\n\n  siteName: string\n  pageKey?: string\n  pageTitle?: string\n  countEl: string\n  pvEl: string\n  pageKeyAttr: string\n\n  /** Whether to add PV count when initializing */\n  pvAdd?: boolean\n}\n\nexport const PvCountWidget: ArtalkPlugin = (ctx: ContextApi) => {\n  ctx.watchConf(['site', 'pageKey', 'pageTitle', 'countEl', 'pvEl', 'statPageKeyAttr'], (conf) => {\n    initCountWidget({\n      getApi: () => ctx.getApi(),\n      siteName: conf.site,\n      pageKey: conf.pageKey,\n      pageTitle: conf.pageTitle,\n      countEl: conf.countEl,\n      pvEl: conf.pvEl,\n      pageKeyAttr: conf.statPageKeyAttr,\n      pvAdd: typeof ctx.conf.pvAdd === 'boolean' ? ctx.conf.pvAdd : true,\n    })\n  })\n}\n\n/** Initialize count widgets */\nexport async function initCountWidget(opt: CountOptions) {\n  // Load comment count\n  await loadCommentCount(opt)\n\n  // Increment PV count\n  const cacheData = await incrementPvCount(opt)\n\n  // Load PV count\n  await loadPvCount(opt, cacheData)\n}\n\n/** Increment PV count and get cache data that contains PV count */\nasync function incrementPvCount(opt: CountOptions) {\n  if (!opt.pvAdd || !opt.pageKey) return undefined\n\n  const pvCount = (\n    await opt.getApi().pages.logPv({\n      page_key: opt.pageKey,\n      page_title: opt.pageTitle,\n      site_name: opt.siteName,\n    })\n  ).data.pv // pv+1 and get pv count\n\n  return {\n    [opt.pageKey]: pvCount,\n  }\n}\n\n/** Load comment count */\nasync function loadCommentCount(opt: CountOptions) {\n  await loadStatCount({ opt, query: 'page_comment', containers: [opt.countEl, '#ArtalkCount'] })\n}\n\n/** Load PV count */\nasync function loadPvCount(opt: CountOptions, cache?: CountCache) {\n  await loadStatCount({ opt, query: 'page_pv', containers: [opt.pvEl, '#ArtalkPv'], cache })\n}\n\nasync function loadStatCount(args: {\n  opt: CountOptions\n  query: 'page_pv' | 'page_comment'\n  containers: string[]\n  cache?: CountCache\n}) {\n  const { opt } = args\n  let cache: CountCache = args.cache || {}\n\n  // Retrieve elements\n  const els = retrieveElements(args.containers)\n\n  // Get page keys which will be queried\n  const pageKeys = getPageKeys(els, opt.pageKeyAttr, opt.pageKey, cache)\n\n  // Fetch count data from server\n  if (pageKeys.length > 0) {\n    const res = (\n      await opt.getApi().stats.getStats(args.query, {\n        page_keys: pageKeys.join(','),\n        site_name: opt.siteName,\n      })\n    ).data.data as CountCache\n    cache = { ...cache, ...res }\n  }\n\n  updateElementsText(els, cache, opt.pageKey)\n}\n\n/** Retrieve elements based on selectors */\nfunction retrieveElements(containers: string[]): Set<HTMLElement> {\n  const els = new Set<HTMLElement>()\n  new Set(containers).forEach((selector) => {\n    document.querySelectorAll<HTMLElement>(selector).forEach((el) => els.add(el))\n  })\n  return els\n}\n\n/** Get page keys to be queried */\nfunction getPageKeys(\n  els: Set<HTMLElement>,\n  pageKeyAttr: string,\n  pageKey: string | undefined,\n  cache: CountCache,\n): string[] {\n  const pageKeys = Array.from(els)\n    .map((el) => el.getAttribute(pageKeyAttr) || pageKey)\n    .filter((key) => key && typeof cache[key] !== 'number') // filter out keys that already have data\n\n  return [...new Set(pageKeys as string[])] // deduplicate\n}\n\n/** Update elements text content with the count data */\nfunction updateElementsText(els: Set<HTMLElement>, data: CountCache, defaultPageKey?: string) {\n  els.forEach((el) => {\n    const pageKey = el.getAttribute('data-page-key')\n    const count = (pageKey && data[pageKey]) || (defaultPageKey && data[defaultPageKey]) || 0 // if pageKey is not set, use defaultCount\n    el.innerText = `${Number(count)}`\n  })\n}\n\nexport const exportedForTesting = {\n  incrementPvCount,\n  loadCommentCount,\n  loadPvCount,\n  retrieveElements,\n  getPageKeys,\n  updateElementsText,\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as marked from '@/lib/marked'\n\nexport const Markdown: ArtalkPlugin = (ctx) => {\n  ctx.watchConf(['imgLazyLoad', 'markedOptions'], (conf) => {\n    marked.initMarked({\n      markedOptions: ctx.getConf().markedOptions,\n      imgLazyLoad: ctx.getConf().imgLazyLoad,\n    })\n  })\n\n  ctx.watchConf(['markedReplacers'], (conf) => {\n    conf.markedReplacers && marked.setReplacers(conf.markedReplacers)\n  })\n}\n","import type PlugKit from './_kit'\nimport EditorPlug from './_plug'\nimport $t from '@/i18n'\n\nconst LocalStorageKey = 'ArtalkContent'\n\nexport default class LocalStorage extends EditorPlug {\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    const onContentUpdated = () => {\n      this.save()\n    }\n\n    this.kit.useMounted(() => {\n      // load editor content from localStorage when init\n      const localContent = window.localStorage.getItem(LocalStorageKey) || ''\n      if (localContent.trim() !== '') {\n        this.kit.useEditor().showNotify($t('restoredMsg'), 'i')\n        this.kit.useEditor().setContent(localContent)\n      }\n\n      // bind event\n      this.kit.useEvents().on('content-updated', onContentUpdated)\n    })\n\n    this.kit.useUnmounted(() => {\n      this.kit.useEvents().off('content-updated', onContentUpdated)\n    })\n  }\n\n  // Save editor content to localStorage\n  public save() {\n    window.localStorage.setItem(LocalStorageKey, this.kit.useEditor().getContentRaw().trim())\n  }\n}\n","import type PlugKit from './_kit'\nimport type { CommentData } from '@/types'\nimport * as Utils from '@/lib/utils'\n\nexport default class SubmitAddPreset {\n  constructor(private kit: PlugKit) {}\n\n  async reqAdd() {\n    const nComment = (\n      await this.kit.useApi().comments.createComment({\n        ...(await this.getSubmitAddParams()),\n      })\n    ).data\n    return nComment\n  }\n\n  async getSubmitAddParams() {\n    const { nick, email, link } = this.kit.useUser().getData()\n    const conf = this.kit.useConf()\n\n    return {\n      content: this.kit.useEditor().getContentFinal(),\n      name: nick,\n      email,\n      link,\n      rid: 0,\n      page_key: conf.pageKey,\n      page_title: conf.pageTitle,\n      site_name: conf.site,\n      ua: await Utils.getCorrectUserAgent(), // Get the corrected UA\n    }\n  }\n\n  postSubmitAdd(commentNew: CommentData) {\n    // insert the new comment to list\n    this.kit.useGlobalCtx().getData().insertComment(commentNew)\n  }\n}\n","import EditorPlug from './_plug'\nimport type PlugKit from './_kit'\nimport SubmitAddPreset from './submit-add'\nimport $t from '@/i18n'\nimport type { CommentData } from '@/types'\n\ninterface CustomSubmit {\n  activeCond: () => void\n  pre?: () => void\n  req?: () => Promise<CommentData>\n  /** The `post` method is called after the comment is successfully submitted */\n  post?: (nComment: CommentData) => void\n}\n\nexport default class Submit extends EditorPlug {\n  private customs: CustomSubmit[] = []\n  private defaultPreset: SubmitAddPreset\n\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    this.defaultPreset = new SubmitAddPreset(this.kit)\n\n    const onEditorSubmit = () => this.do()\n\n    this.kit.useMounted(() => {\n      // invoke `do()` when event `editor-submit` is triggered\n      this.kit.useGlobalCtx().on('editor-submit', onEditorSubmit)\n    })\n    this.kit.useUnmounted(() => {\n      this.kit.useGlobalCtx().off('editor-submit', onEditorSubmit)\n    })\n  }\n\n  registerCustom(c: CustomSubmit) {\n    this.customs.push(c)\n  }\n\n  private async do() {\n    if (this.kit.useEditor().getContentFinal().trim() === '') {\n      this.kit.useEditor().focus()\n      return\n    }\n\n    const custom = this.customs.find((o) => o.activeCond())\n\n    this.kit.useEditor().showLoading()\n\n    try {\n      // pre submit\n      if (custom?.pre) custom.pre()\n\n      let nComment: CommentData\n\n      // submit request\n      if (custom?.req) nComment = await custom.req()\n      else nComment = await this.defaultPreset.reqAdd()\n\n      // post submit\n      if (custom?.post) custom.post(nComment)\n      else this.defaultPreset.postSubmitAdd(nComment)\n    } catch (err: any) {\n      // submit error\n      console.error(err)\n      this.kit.useEditor().showNotify(`${$t('commentFail')}: ${err.message || String(err)}`, 'e')\n      return\n    } finally {\n      this.kit.useEditor().hideLoading()\n    }\n\n    this.kit.useEditor().reset() // \n    this.kit.useGlobalCtx().trigger('editor-submitted')\n  }\n}\n","import './emoticons.scss'\n\nimport EditorPlug from './_plug'\nimport type PlugKit from './_kit'\nimport type { EmoticonListData, EmoticonGrpData } from '@/types'\nimport * as Utils from '@/lib/utils'\nimport * as Ui from '@/lib/ui'\nimport $t from '@/i18n'\n\ntype OwOFormatType = {\n  [key: string]: {\n    type: 'emoticon' | 'emoji' | 'image'\n    container: { icon: string; text: string }[]\n  }\n}\n\nexport default class Emoticons extends EditorPlug {\n  private emoticons: EmoticonListData = []\n  private loadingTask: Promise<void> | null = null\n\n  private $grpWrap!: HTMLElement\n  private $grpSwitcher!: HTMLElement\n\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    this.kit.useMounted(() => {\n      this.usePanel(`<div class=\"atk-editor-plug-emoticons\"></div>`)\n      this.useBtn(\n        `<i aria-label=\"${$t('emoticon')}\"><svg fill=\"currentColor\" aria-hidden=\"true\" height=\"14\" viewBox=\"0 0 14 14\" width=\"14\"><path d=\"m4.26829 5.29294c0-.94317.45893-1.7074 1.02439-1.7074.56547 0 1.02439.76423 1.02439 1.7074s-.45892 1.7074-1.02439 1.7074c-.56546 0-1.02439-.76423-1.02439-1.7074zm4.43903 1.7074c.56546 0 1.02439-.76423 1.02439-1.7074s-.45893-1.7074-1.02439-1.7074c-.56547 0-1.02439.76423-1.02439 1.7074s.45892 1.7074 1.02439 1.7074zm-1.70732 2.73184c-1.51883 0-2.06312-1.52095-2.08361-1.58173l-1.29551.43231c.03414.10244.868 2.51604 3.3798 2.51604 2.51181 0 3.34502-2.41291 3.37982-2.51604l-1.29484-.43573c-.02254.06488-.56683 1.58583-2.08498 1.58583zm7-2.73252c0 3.86004-3.1401 7.00034-7 7.00034s-7-3.1396-7-6.99966c0-3.86009 3.1401-7.00034 7-7.00034s7 3.14025 7 7.00034zm-1.3659 0c0-3.10679-2.5275-5.63442-5.6341-5.63442-3.10663 0-5.63415 2.52832-5.63415 5.6351 0 3.10676 2.52752 5.63446 5.63415 5.63446 3.1066 0 5.6341-2.5277 5.6341-5.63446z\"/></svg></i>`,\n      )\n    })\n    this.kit.useUnmounted(() => {})\n\n    this.useContentTransformer((raw) => this.transEmoticonImageText(raw))\n    this.usePanelShow(() => {\n      ;(async () => {\n        await this.loadEmoticonsData()\n\n        // \n        if (!this.isImgLoaded) {\n          this.initEmoticonsList()\n          this.isImgLoaded = true\n        }\n\n        // \n        setTimeout(() => {\n          this.changeListHeight()\n        }, 30)\n      })()\n    })\n    this.usePanelHide(() => {\n      this.$panel!.parentElement!.style.height = ''\n    })\n\n    // \n    window.setTimeout(() => {\n      this.loadEmoticonsData()\n    }, 1000) //  1s \n  }\n\n  private isListLoaded = false\n  private isImgLoaded = false\n\n  public async loadEmoticonsData() {\n    if (this.isListLoaded) return\n    if (this.loadingTask !== null) {\n      await this.loadingTask\n      return\n    }\n\n    // \n    this.loadingTask = (async () => {\n      Ui.showLoading(this.$panel!)\n      this.emoticons = await this.handleData(this.kit.useConf().emoticons)\n      Ui.hideLoading(this.$panel!)\n      this.loadingTask = null\n      this.isListLoaded = true\n    })()\n    await this.loadingTask\n  }\n\n  private async handleData(data: any): Promise<any[]> {\n    if (!Array.isArray(data) && ['object', 'string'].includes(typeof data)) {\n      data = [data]\n    }\n\n    if (!Array.isArray(data)) {\n      Ui.setError(this.$panel!, `[${$t('emoticon')}] Data must be of Array/Object/String type`)\n      Ui.hideLoading(this.$panel!)\n      return []\n    }\n\n    const pushGrp = (grp: EmoticonGrpData) => {\n      if (typeof grp !== 'object') return\n      if (grp.name && data.find((o) => o.name === grp.name)) return\n      data.push(grp)\n    }\n\n    // \n    const remoteLoad = async (d: any[]) => {\n      await Promise.all(\n        d.map(async (grp, index) => {\n          if (typeof grp === 'object' && !Array.isArray(grp)) {\n            pushGrp(grp)\n          } else if (Array.isArray(grp)) {\n            await remoteLoad(grp)\n          } else if (typeof grp === 'string') {\n            const grpData = await this.remoteLoad(grp)\n\n            if (Array.isArray(grpData)) await remoteLoad(grpData)\n            else if (typeof grpData === 'object') pushGrp(grpData)\n          }\n        }),\n      )\n    }\n    await remoteLoad(data)\n\n    // \n    data.forEach((item: any) => {\n      if (this.isOwOFormat(item)) {\n        const c = this.convertOwO(item)\n        c.forEach((grp) => {\n          pushGrp(grp)\n        })\n      } else if (Array.isArray(item)) {\n        item.forEach((grp) => {\n          pushGrp(grp)\n        })\n      }\n    })\n\n    // \n    data = data.filter(\n      (item: any) => typeof item === 'object' && !Array.isArray(item) && !!item && !!item.name,\n    )\n\n    // console.log(data)\n\n    this.solveNullKey(data)\n    this.solveSameKey(data)\n\n    return data\n  }\n\n  /**  */\n  private async remoteLoad(url: string): Promise<any> {\n    if (!url) return []\n\n    try {\n      const resp = await fetch(url)\n      const json = await resp.json()\n      return json\n    } catch (err) {\n      Ui.hideLoading(this.$panel!)\n      console.error('[Emoticons] Load Failed:', err)\n      Ui.setError(this.$panel!, `[${$t('emoticon')}] ${$t('loadFail')}: ${String(err)}`)\n      return []\n    }\n  }\n\n  /**  item.key  null  */\n  private solveNullKey(data: EmoticonGrpData[]) {\n    data.forEach((grp) => {\n      grp.items.forEach((item, index) => {\n        if (!item.key) item.key = `${grp.name} ${index + 1}`\n      })\n    })\n  }\n\n  /**  item.key */\n  private solveSameKey(data: EmoticonGrpData[]) {\n    const tmp: { [key: string]: number } = {}\n    data.forEach((grp) => {\n      grp.items.forEach((item) => {\n        if (!item.key || String(item.key).trim() === '') return\n        if (!tmp[item.key]) tmp[item.key] = 1\n        else tmp[item.key]++\n\n        if (tmp[item.key] > 1) item.key = `${item.key} ${tmp[item.key]}`\n      })\n    })\n  }\n\n  /**  OwO  */\n  private isOwOFormat(data: any) {\n    try {\n      return (\n        typeof data === 'object' &&\n        !!Object.values(data).length &&\n        Array.isArray(Object.keys(Object.values<any>(data)[0].container)) &&\n        Object.keys(Object.values<any>(data)[0].container[0]).includes('icon')\n      )\n    } catch {\n      return false\n    }\n  }\n\n  /**  OwO  */\n  private convertOwO(owoData: OwOFormatType): EmoticonListData {\n    const dest: EmoticonListData = []\n    Object.entries(owoData).forEach(([grpName, grp]) => {\n      const nGrp: EmoticonGrpData = { name: grpName, type: grp.type, items: [] }\n      grp.container.forEach((item, index) => {\n        //  src \n        const iconStr = item.icon\n        if (/<(img|IMG)/.test(iconStr)) {\n          const find = /src=[\"'](.*?)[\"']/.exec(iconStr)\n          if (find && find.length > 1) item.icon = find[1]\n        }\n        nGrp.items.push({\n          key: item.text || `${grpName} ${index + 1}`,\n          val: item.icon,\n        })\n      })\n      dest.push(nGrp)\n    })\n    return dest\n  }\n\n  /**  */\n  private initEmoticonsList() {\n    // \n    this.$grpWrap = Utils.createElement(`<div class=\"atk-grp-wrap\"></div>`)\n    this.$panel!.append(this.$grpWrap)\n\n    this.emoticons.forEach((grp, index) => {\n      const $grp = Utils.createElement(`<div class=\"atk-grp\" style=\"display: none;\"></div>`)\n      this.$grpWrap.append($grp)\n      $grp.setAttribute('data-index', String(index))\n      $grp.setAttribute('data-grp-name', grp.name)\n      $grp.setAttribute('data-type', grp.type)\n      grp.items.forEach((item) => {\n        const $item = Utils.createElement(`<span class=\"atk-item\"></span>`)\n        $grp.append($item)\n\n        if (!!item.key && !new RegExp(`^(${grp.name})?\\\\s?[0-9]+$`).test(item.key))\n          $item.setAttribute('title', item.key)\n\n        if (grp.type === 'image') {\n          const imgEl = document.createElement('img')\n          imgEl.src = item.val\n          imgEl.alt = item.key\n          $item.append(imgEl)\n        } else {\n          $item.innerText = item.val\n        }\n\n        $item.onclick = () => {\n          if (grp.type === 'image') {\n            this.kit.useEditor().insertContent(`:[${item.key}]`)\n          } else {\n            this.kit.useEditor().insertContent(item.val || '')\n          }\n        }\n      })\n    })\n\n    //  bar\n    if (this.emoticons.length > 1) {\n      this.$grpSwitcher = Utils.createElement(`<div class=\"atk-grp-switcher\"></div>`)\n      this.$panel!.append(this.$grpSwitcher)\n      this.emoticons.forEach((grp, index) => {\n        const $item = Utils.createElement('<span />')\n        $item.innerText = grp.name\n        $item.setAttribute('data-index', String(index))\n        $item.onclick = () => this.openGrp(index)\n        this.$grpSwitcher.append($item)\n      })\n    }\n\n    // \n    if (this.emoticons.length > 0) this.openGrp(0)\n  }\n\n  /**  */\n  public openGrp(index: number) {\n    Array.from(this.$grpWrap.children).forEach((item) => {\n      const el = item as HTMLElement\n      if (el.getAttribute('data-index') !== String(index)) {\n        el.style.display = 'none'\n      } else {\n        el.style.display = ''\n      }\n    })\n\n    this.$grpSwitcher\n      ?.querySelectorAll('span.active')\n      .forEach((item) => item.classList.remove('active'))\n    this.$grpSwitcher?.querySelector(`span[data-index=\"${index}\"]`)?.classList.add('active')\n\n    this.changeListHeight()\n  }\n\n  private changeListHeight() {\n    /* const listWrapHeight = Utils.getHeight(this.$grpWrapem)\n    this.editor.plugWrapEl.style.height = `${listWrapHeight > 150 ? listWrapHeight : 150}px` */\n  }\n\n  /**  content  */\n  public transEmoticonImageText(text: string) {\n    if (!this.emoticons || !Array.isArray(this.emoticons)) return text\n\n    this.emoticons.forEach((grp) => {\n      if (grp.type !== 'image') return\n      Object.entries(grp.items).forEach(([index, item]) => {\n        text = text\n          .split(`:[${item.key}]`)\n          .join(`<img src=\"${item.val}\" atk-emoticon=\"${item.key}\">`) // replaceAll(...)\n      })\n    })\n\n    return text\n  }\n}\n","import type PlugKit from './_kit'\nimport EditorPlug from './_plug'\nimport * as Utils from '@/lib/utils'\nimport $t from '@/i18n'\n\n/**  */\nconst AllowImgExts = ['png', 'jpg', 'jpeg', 'gif', 'bmp', 'svg', 'webp']\n\nexport default class Upload extends EditorPlug {\n  private $imgUploadInput?: HTMLInputElement\n\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    this.kit.useMounted(() => this.init())\n\n    this.initDragImg()\n  }\n\n  private init() {\n    this.$imgUploadInput = document.createElement('input')\n    this.$imgUploadInput.type = 'file'\n    this.$imgUploadInput.style.display = 'none'\n    this.$imgUploadInput.accept = AllowImgExts.map((o) => `.${o}`).join(',')\n\n    // TODO: Use btn cannot refresh when mounted event is triggered\n    const $btn = this.useBtn(\n      `<i aria-label=\"${$t('uploadImage')}\"><svg fill=\"currentColor\" aria-hidden=\"true\" height=\"14\" viewBox=\"0 0 14 14\" width=\"14\"><path d=\"m0 1.94444c0-1.074107.870333-1.94444 1.94444-1.94444h10.11116c1.0741 0 1.9444.870333 1.9444 1.94444v10.11116c0 1.0741-.8703 1.9444-1.9444 1.9444h-10.11116c-1.074107 0-1.94444-.8703-1.94444-1.9444zm1.94444-.38888c-.21466 0-.38888.17422-.38888.38888v7.06689l2.33333-2.33333 2.33333 2.33333 3.88888-3.88889 2.3333 2.33334v-5.51134c0-.21466-.1742-.38888-.3888-.38888zm10.49996 8.09977-2.3333-2.33333-3.88888 3.8889-2.33333-2.33334-2.33333 2.33334v.8447c0 .2146.17422.3888.38888.3888h10.11116c.2146 0 .3888-.1742.3888-.3888zm-7.1944-6.54422c-.75133 0-1.36111.60978-1.36111 1.36111 0 .75134.60978 1.36111 1.36111 1.36111s1.36111-.60977 1.36111-1.36111c0-.75133-.60978-1.36111-1.36111-1.36111z\"/></svg></i>`,\n    )\n    $btn.after(this.$imgUploadInput)\n    $btn.onclick = () => {\n      // \n      const $input = this.$imgUploadInput!\n      $input.onchange = () => {\n        ;(async () => {\n          //  UI \n          if (!$input.files || $input.files.length === 0) return\n          const file = $input.files[0]\n          this.uploadImg(file)\n        })()\n      }\n      $input.click() // \n    }\n\n    if (!this.kit.useConf().imgUpload) {\n      this.$btn!.setAttribute('atk-only-admin-show', '')\n    }\n  }\n\n  private initDragImg() {\n    //  FileList \n    const uploadFromFileList = (files?: FileList) => {\n      if (!files) return\n\n      for (let i = 0; i < files.length; i++) {\n        const file = files[i]\n        this.uploadImg(file)\n      }\n    }\n\n    // \n    // @link https://developer.mozilla.org/zh-CN/docs/Web/API/HTML_Drag_and_Drop_API/File_drag_and_drop\n    // \n    const onDragover = (evt: Event) => {\n      evt.stopPropagation()\n      evt.preventDefault()\n    }\n\n    const onDrop = (evt: DragEvent) => {\n      const files = evt.dataTransfer?.files\n      if (files?.length) {\n        evt.preventDefault()\n        uploadFromFileList(files)\n      }\n    }\n\n    // \n    const onPaste = (evt: ClipboardEvent) => {\n      const files = evt.clipboardData?.files\n      if (files?.length) {\n        evt.preventDefault()\n        uploadFromFileList(files)\n      }\n    }\n\n    this.kit.useMounted(() => {\n      this.kit.useUI().$textarea.addEventListener('dragover', onDragover)\n      this.kit.useUI().$textarea.addEventListener('drop', onDrop)\n      this.kit.useUI().$textarea.addEventListener('paste', onPaste)\n    })\n    this.kit.useUnmounted(() => {\n      this.kit.useUI().$textarea.removeEventListener('dragover', onDragover)\n      this.kit.useUI().$textarea.removeEventListener('drop', onDrop)\n      this.kit.useUI().$textarea.removeEventListener('paste', onPaste)\n    })\n  }\n\n  async uploadImg(file: File) {\n    const fileExt = /[^.]+$/.exec(file.name)\n    if (!fileExt || !AllowImgExts.includes(String(fileExt[0]).toLowerCase())) return\n\n    // \n    if (!this.kit.useUser().checkHasBasicUserInfo()) {\n      this.kit.useEditor().showNotify($t('uploadLoginMsg'), 'w')\n      return\n    }\n\n    // \n    let insertPrefix = '\\n'\n    if (this.kit.useUI().$textarea.value.trim() === '') insertPrefix = ''\n\n    // \n    const uploadPlaceholderTxt = `${insertPrefix}![](Uploading ${file.name}...)`\n    this.kit.useEditor().insertContent(uploadPlaceholderTxt)\n\n    // \n    let resp: { public_url: string } | undefined\n    try {\n      const customUploaderFn = this.kit.useConf().imgUploader\n      if (!customUploaderFn) {\n        //  Artalk \n        resp = (await this.kit.useApi().upload.upload({ file })).data\n      } else {\n        // \n        resp = { public_url: await customUploaderFn(file) }\n      }\n    } catch (err: any) {\n      console.error(err)\n      this.kit.useEditor().showNotify(`${$t('uploadFail')}: ${err.message}`, 'e')\n    }\n    if (!!resp && resp.public_url) {\n      let imgURL = resp.public_url as string\n\n      //  artalk server\n      if (!Utils.isValidURL(imgURL))\n        imgURL = Utils.getURLBasedOnApi({\n          base: this.kit.useConf().server,\n          path: imgURL,\n        })\n\n      // \n      this.kit\n        .useEditor()\n        .setContent(\n          this.kit\n            .useUI()\n            .$textarea.value.replace(uploadPlaceholderTxt, `${insertPrefix}![](${imgURL})`),\n        )\n    } else {\n      // \n      this.kit\n        .useEditor()\n        .setContent(this.kit.useUI().$textarea.value.replace(uploadPlaceholderTxt, ''))\n    }\n  }\n}\n","import './preview.scss'\n\nimport EditorPlug from './_plug'\nimport type PlugKit from './_kit'\nimport * as marked from '@/lib/marked'\nimport $t from '@/i18n'\n\nexport default class Preview extends EditorPlug {\n  private isPlugPanelShow = false\n\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    this.kit.useMounted(() => {\n      this.usePanel(`<div class=\"atk-editor-plug-preview\"></div>`)\n\n      // initialize plug button\n      this.useBtn(\n        `<i aria-label=\"${$t('preview')}\"><svg fill=\"currentColor\" aria-hidden=\"true\" viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M14.85 3H1.15C.52 3 0 3.52 0 4.15v7.69C0 12.48.52 13 1.15 13h13.69c.64 0 1.15-.52 1.15-1.15v-7.7C16 3.52 15.48 3 14.85 3zM9 11H7V8L5.5 9.92 4 8v3H2V5h2l1.5 2L7 5h2v6zm2.99.5L9.5 8H11V5h2v3h1.5l-2.51 3.5z\"></path></svg></i>`,\n      )\n    })\n    this.kit.useUnmounted(() => {})\n\n    // function to update content\n    this.kit.useEvents().on('content-updated', (content) => {\n      this.isPlugPanelShow && this.updateContent()\n    })\n\n    this.usePanelShow(() => {\n      this.isPlugPanelShow = true\n      this.updateContent()\n    })\n    this.usePanelHide(() => {\n      this.isPlugPanelShow = false\n    })\n  }\n\n  updateContent() {\n    this.$panel!.innerHTML = this.kit.useEditor().getContentMarked()\n  }\n}\n","import type EditorPlug from './_plug'\nimport LocalStorage from './local-storage'\nimport Textarea from './textarea'\nimport SubmitBtn from './submit-btn'\nimport Submit from './submit'\nimport StateReply from './state-reply'\nimport StateEdit from './state-edit'\nimport Closable from './closable'\nimport HeaderEvent from './header-event'\nimport HeaderUser from './header-user'\nimport HeaderLink from './header-link'\nimport Mover from './mover'\nimport Emoticons from './emoticons'\nimport Upload from './upload'\nimport Preview from './preview'\nimport type { ArtalkConfig } from '@/types'\n\n/** The default enabled plugs */\nconst EDITOR_PLUGS: (typeof EditorPlug)[] = [\n  // Core\n  LocalStorage,\n  HeaderEvent,\n  HeaderUser,\n  HeaderLink,\n  Textarea,\n  Submit,\n  SubmitBtn,\n  Mover,\n  StateReply,\n  StateEdit,\n  Closable,\n\n  // Extensions\n  Emoticons,\n  Upload,\n  Preview,\n]\n\n/**\n * Get the enabled plugs by config\n */\nexport function getEnabledPlugs(\n  conf: Pick<ArtalkConfig, 'imgUpload' | 'emoticons' | 'preview' | 'editorTravel'>,\n): (typeof EditorPlug)[] {\n  // The reference map of config and plugs\n  // (for check if the plug is enabled)\n  const confRefs = new Map<typeof EditorPlug, any>()\n  confRefs.set(Upload, conf.imgUpload)\n  confRefs.set(Emoticons, conf.emoticons)\n  confRefs.set(Preview, conf.preview)\n  confRefs.set(Mover, conf.editorTravel)\n\n  return EDITOR_PLUGS.filter((p) => !confRefs.has(p) || !!confRefs.get(p))\n}\n","import EditorPlug from './_plug'\nimport type PlugKit from './_kit'\n\nexport default class HeaderEvent extends EditorPlug {\n  private get $inputs() {\n    return this.kit.useEditor().getHeaderInputEls()\n  }\n\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    const inputEventFns: { [name: string]: () => void } = {}\n    const changeEventFns: { [name: string]: () => void } = {}\n\n    const trigger =\n      (evt: 'header-input' | 'header-change', $input: HTMLInputElement, field: string) => () => {\n        this.kit.useEvents().trigger(evt, { field, $input })\n      }\n\n    this.kit.useMounted(() => {\n      // batch bind the events\n      Object.entries(this.$inputs).forEach(([key, $input]) => {\n        $input.addEventListener(\n          'input',\n          (inputEventFns[key] = trigger('header-input', $input, key)),\n        )\n        $input.addEventListener(\n          'change',\n          (changeEventFns[key] = trigger('header-change', $input, key)),\n        )\n      })\n    })\n\n    this.kit.useUnmounted(() => {\n      // unmount the event\n      Object.entries(this.$inputs).forEach(([key, $input]) => {\n        $input.removeEventListener('input', inputEventFns[key])\n        $input.removeEventListener('change', changeEventFns[key])\n      })\n    })\n  }\n}\n","import EditorPlug from './_plug'\nimport type PlugKit from './_kit'\nimport $t from '@/i18n'\nimport type { UserInfoApiResponseData } from '@/types'\n\nexport default class HeaderUser extends EditorPlug {\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    const onInput = ({ $input, field }: { $input: HTMLInputElement; field: string }) => {\n      if (this.kit.useEditor().getState() === 'edit') return // TODO: prevent execute when editing, since update comment.user not support\n\n      // update user data\n      this.kit.useUser().update({ [field]: $input.value.trim() })\n\n      // remote fetch user info\n      if (field === 'nick' || field === 'email') this.fetchUserInfo() // must after update user data, since fetchUserInfo() will use User.data\n    }\n\n    this.kit.useMounted(() => {\n      Object.entries(this.kit.useEditor().getHeaderInputEls()).forEach(([key, $input]) => {\n        // set placeholder\n        $input.placeholder = `${$t(key as any)}`\n\n        // sync header values from User.data\n        $input.value = this.kit.useUser().getData()[key] || ''\n      })\n\n      // bind events\n      this.kit.useEvents().on('header-input', onInput)\n    })\n\n    this.kit.useUnmounted(() => {\n      this.kit.useEvents().off('header-input', onInput)\n    })\n  }\n\n  private query = {\n    timer: <number | null>null,\n    abortFn: <(() => void) | null>null,\n  }\n\n  /**\n   * Fetch user info from server\n   */\n  private fetchUserInfo() {\n    this.kit.useUser().logout() // clear login status\n\n    if (this.query.timer) window.clearTimeout(this.query.timer) // clear the not executed timeout task\n    if (this.query.abortFn) this.query.abortFn() // abort the last request (if request is pending not finished)\n\n    this.query.timer = window.setTimeout(() => {\n      this.query.timer = null // clear the timer (clarify the timer is executing)\n\n      const api = this.kit.useApi()\n      const CANCEL_TOKEN = 'getUserCancelToken'\n      this.query.abortFn = () => api.abortRequest(CANCEL_TOKEN)\n\n      api.user\n        .getUser(\n          { ...api.getUserFields() },\n          {\n            cancelToken: CANCEL_TOKEN,\n          },\n        )\n        .then((res) => this.onUserInfoFetched(res.data))\n        .catch((err) => {})\n        .finally(() => {\n          this.query.abortFn = null // clear the abort function (clarify the request is finished)\n        })\n    }, 400) // delay to reduce request\n  }\n\n  /**\n   * Function called when user info fetched\n   *\n   * @param data The response data from server\n   */\n  private onUserInfoFetched(data: UserInfoApiResponseData) {\n    // If api response is not login, logout\n    if (!data.is_login) this.kit.useUser().logout()\n\n    // Update unread notifies\n    this.kit.useGlobalCtx().getData().updateNotifies(data.notifies)\n\n    // If user is admin and not login,\n    if (this.kit.useUser().checkHasBasicUserInfo() && !data.is_login && data.user?.is_admin) {\n      // then show login window\n      this.kit.useGlobalCtx().checkAdmin({\n        onSuccess: () => {},\n      })\n    }\n\n    // Auto fill user link from server\n    if (data.user && data.user.link) {\n      this.kit.useUI().$link.value = data.user.link\n      this.kit.useUser().update({ link: data.user.link })\n    }\n  }\n}\n","import EditorPlug from './_plug'\nimport type PlugKit from './_kit'\n\nexport default class HeaderLink extends EditorPlug {\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    const onLinkChange = ({ field }: { field: string }) => {\n      if (field === 'link') this.onLinkInputChange()\n    }\n\n    // bind events\n    this.kit.useMounted(() => {\n      this.kit.useEvents().on('header-change', onLinkChange)\n    })\n\n    this.kit.useUnmounted(() => {\n      this.kit.useEvents().off('header-change', onLinkChange)\n    })\n  }\n\n  private onLinkInputChange() {\n    // auto and force add protocol prefix for user input link\n    const link = this.kit.useUI().$link.value.trim()\n    if (!!link && !/^(http|https):\\/\\//.test(link)) {\n      this.kit.useUI().$link.value = `https://${link}`\n      this.kit.useUser().update({ link: this.kit.useUI().$link.value })\n    }\n  }\n}\n","import EditorPlug from './_plug'\nimport type PlugKit from './_kit'\nimport $t from '@/i18n'\n\nexport default class Textarea extends EditorPlug {\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    const onKeydown = (e: KeyboardEvent) => this.onKeydown(e)\n    const onInput = () => this.onInput()\n\n    this.kit.useMounted(() => {\n      // \n      this.kit.useUI().$textarea.placeholder = this.kit.useConf().placeholder || $t('placeholder')\n\n      // bind the event\n      this.kit.useUI().$textarea.addEventListener('keydown', onKeydown)\n      this.kit.useUI().$textarea.addEventListener('input', onInput)\n    })\n\n    this.kit.useUnmounted(() => {\n      // unmount the event\n      this.kit.useUI().$textarea.removeEventListener('keydown', onKeydown)\n      this.kit.useUI().$textarea.removeEventListener('input', onInput)\n    })\n\n    this.kit.useEvents().on('content-updated', () => {\n      // delay 80ms to prevent invalid execution\n      window.setTimeout(() => {\n        this.adaptiveHeightByContent()\n      }, 80)\n    })\n  }\n\n  //  Tab \n  private onKeydown(e: KeyboardEvent) {\n    const keyCode = e.keyCode || e.which\n\n    if (keyCode === 9) {\n      e.preventDefault()\n      this.kit.useEditor().insertContent('\\t')\n    }\n  }\n\n  private onInput() {\n    this.kit.useEvents().trigger('content-updated', this.kit.useEditor().getContentRaw())\n  }\n\n  // Resize the textarea height by content\n  public adaptiveHeightByContent() {\n    const diff = this.kit.useUI().$textarea.offsetHeight - this.kit.useUI().$textarea.clientHeight\n    this.kit.useUI().$textarea.style.height = '0px' // it's a magic. \n    this.kit.useUI().$textarea.style.height = `${this.kit.useUI().$textarea.scrollHeight + diff}px`\n  }\n}\n","import EditorPlug from './_plug'\nimport type PlugKit from './_kit'\nimport $t from '@/i18n'\n\nexport default class SubmitBtn extends EditorPlug {\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    const onClick = () => {\n      this.kit.useEditor().submit()\n    }\n\n    this.kit.useMounted(() => {\n      // apply the submit button text from user custom config\n      this.kit.useUI().$submitBtn.innerText = this.kit.useConf().sendBtn || $t('send')\n\n      // bind the event when click the submit button\n      this.kit.useUI().$submitBtn.addEventListener('click', onClick)\n    })\n\n    this.kit.useUnmounted(() => {\n      this.kit.useUI().$submitBtn.removeEventListener('click', onClick)\n    })\n  }\n}\n","import EditorPlug from './_plug'\nimport type PlugKit from './_kit'\nimport Submit from './submit'\nimport SubmitAddPreset from './submit-add'\nimport type { CommentData } from '@/types'\nimport * as Utils from '@/lib/utils'\nimport * as Ui from '@/lib/ui'\nimport $t from '@/i18n'\n\nexport default class StateReply extends EditorPlug {\n  private comment?: CommentData\n\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    // add effect when state switch to `reply`\n    this.useEditorStateEffect('reply', (commentData) => {\n      this.setReply(commentData)\n\n      return () => {\n        this.cancelReply()\n      }\n    })\n\n    // register submit preset\n    this.kit.useEvents().on('mounted', () => {\n      const submitPlug = this.kit.useDeps(Submit)\n      if (!submitPlug) throw Error('SubmitPlug not initialized')\n\n      const defaultPreset = new SubmitAddPreset(this.kit)\n\n      submitPlug.registerCustom({\n        activeCond: () => !!this.comment, // active this custom submit when reply mode\n        req: async () => {\n          if (!this.comment) throw new Error('reply comment cannot be empty')\n\n          const nComment = (\n            await this.kit.useApi().comments.createComment({\n              ...(await defaultPreset.getSubmitAddParams()),\n              rid: this.comment.id,\n              page_key: this.comment.page_key,\n              page_title: undefined,\n              site_name: this.comment.site_name,\n            })\n          ).data\n\n          return nComment\n        },\n        post: (nComment: CommentData) => {\n          // open another page when reply comment is not the same pageKey\n          const conf = this.kit.useConf()\n          if (nComment.page_key !== conf.pageKey) {\n            window.open(`${nComment.page_url}#atk-comment-${nComment.id}`)\n          }\n\n          defaultPreset.postSubmitAdd(nComment)\n        },\n      })\n    })\n  }\n\n  private setReply(commentData: CommentData) {\n    const ui = this.kit.useUI()\n    if (!ui.$sendReplyBtn) {\n      const $btn = Utils.createElement(\n        `<span class=\"atk-state-btn\">` +\n          `<span class=\"atk-text-wrap\">` +\n          `${$t('reply')} <span class=\"atk-text\"></span>` +\n          `</span>` +\n          `<span class=\"atk-cancel atk-icon-close atk-icon\"></span>` +\n          `</span>`,\n      )\n      $btn.querySelector<HTMLElement>('.atk-text')!.innerText = `@${commentData.nick}`\n      $btn.addEventListener('click', () => {\n        this.kit.useEditor().resetState()\n      })\n      ui.$stateWrap.append($btn)\n      ui.$sendReplyBtn = $btn\n    }\n\n    this.comment = commentData\n\n    ui.$textarea.focus()\n  }\n\n  private cancelReply() {\n    if (!this.comment) return\n\n    const ui = this.kit.useUI()\n    if (ui.$sendReplyBtn) {\n      ui.$sendReplyBtn.remove()\n      ui.$sendReplyBtn = undefined\n    }\n    this.comment = undefined\n  }\n}\n","import type PlugKit from './_kit'\nimport EditorPlug from './_plug'\nimport Submit from './submit'\nimport type { CommentData } from '@/types'\nimport $t from '@/i18n'\nimport * as Utils from '@/lib/utils'\n\nexport default class StateEdit extends EditorPlug {\n  private comment?: CommentData\n\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    // add effect when state switch to `edit`\n    this.useEditorStateEffect('edit', (comment) => {\n      this.edit(comment)\n\n      return () => {\n        this.cancelEdit()\n      }\n    })\n\n    // register submit preset\n    this.kit.useMounted(() => {\n      const submitPlug = this.kit.useDeps(Submit)\n      if (!submitPlug) throw Error('SubmitPlug not initialized')\n\n      submitPlug.registerCustom({\n        activeCond: () => !!this.comment, // active this custom submit when edit mode\n        req: async () => {\n          const saveData = {\n            content: this.kit.useEditor().getContentFinal(),\n            nick: this.kit.useUI().$nick.value,\n            email: this.kit.useUI().$email.value,\n            link: this.kit.useUI().$link.value,\n          }\n          const comment = this.comment!\n          const nComment = await this.kit.useApi().comments.updateComment(comment.id, {\n            ...comment,\n            ...saveData,\n          })\n          return nComment.data\n        },\n        post: (nComment: CommentData) => {\n          this.kit.useGlobalCtx().getData().updateComment(nComment)\n        },\n      })\n    })\n  }\n\n  private edit(comment: CommentData) {\n    const ui = this.kit.useUI()\n    if (!ui.$editCancelBtn) {\n      const $btn = Utils.createElement(\n        `<span class=\"atk-state-btn\">` +\n          `<span class=\"atk-text-wrap\">` +\n          `${$t('editCancel')}` +\n          `</span>` +\n          `<span class=\"atk-cancel atk-icon-close atk-icon\"></span>` +\n          `</span>`,\n      )\n      $btn.onclick = () => {\n        this.kit.useEditor().resetState()\n      }\n      ui.$stateWrap.append($btn)\n      ui.$editCancelBtn = $btn\n    }\n    this.comment = comment\n\n    ui.$header.style.display = 'none' // TODO: support modify header information\n\n    ui.$nick.value = comment.nick || ''\n    ui.$email.value = comment.email || ''\n    ui.$link.value = comment.link || ''\n\n    this.kit.useEditor().setContent(comment.content)\n    ui.$textarea.focus()\n\n    this.updateSubmitBtnText($t('save'))\n  }\n\n  private cancelEdit() {\n    if (!this.comment) return\n\n    const ui = this.kit.useUI()\n\n    if (ui.$editCancelBtn) {\n      ui.$editCancelBtn.remove()\n      ui.$editCancelBtn = undefined\n    }\n\n    this.comment = undefined\n\n    const { nick, email, link } = this.kit.useUser().getData()\n    ui.$nick.value = nick\n    ui.$email.value = email\n    ui.$link.value = link\n\n    this.kit.useEditor().setContent('')\n    this.restoreSubmitBtnText()\n\n    ui.$header.style.display = '' // TODO: support modify header information\n  }\n\n  // -------------------------------------------------------------------\n  //  Submit Btn Text Modifier\n  // -------------------------------------------------------------------\n\n  private originalSubmitBtnText = 'Send'\n\n  private updateSubmitBtnText(text: string) {\n    this.originalSubmitBtnText = this.kit.useUI().$submitBtn.innerText\n    this.kit.useUI().$submitBtn.innerText = text\n  }\n\n  private restoreSubmitBtnText() {\n    this.kit.useUI().$submitBtn.innerText = this.originalSubmitBtnText\n  }\n}\n","import EditorPlug from './_plug'\nimport type PlugKit from './_kit'\nimport * as Utils from '@/lib/utils'\nimport $t from '@/i18n'\n\nexport default class Closable extends EditorPlug {\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    const onOpen = () => this.open()\n    const onClose = () => this.close()\n\n    this.kit.useMounted(() => {\n      this.kit.useEvents().on('editor-open', onOpen)\n      this.kit.useEvents().on('editor-close', onClose)\n    })\n    this.kit.useUnmounted(() => {\n      this.kit.useEvents().off('editor-open', onOpen)\n      this.kit.useEvents().off('editor-close', onClose)\n    })\n  }\n\n  private open() {\n    this.kit.useUI().$textareaWrap.querySelector('.atk-comment-closed')?.remove()\n    this.kit.useUI().$textarea.style.display = ''\n    this.kit.useUI().$bottom.style.display = ''\n  }\n\n  private close() {\n    if (!this.kit.useUI().$textareaWrap.querySelector('.atk-comment-closed'))\n      this.kit\n        .useUI()\n        .$textareaWrap.prepend(\n          Utils.createElement(`<div class=\"atk-comment-closed\">${$t('onlyAdminCanReply')}</div>`),\n        )\n\n    if (!this.kit.useUser().getData().isAdmin) {\n      this.kit.useUI().$textarea.style.display = 'none'\n      this.kit.useEvents().trigger('panel-close')\n      this.kit.useUI().$bottom.style.display = 'none'\n    } else {\n      // \n      this.kit.useUI().$textarea.style.display = ''\n      this.kit.useUI().$bottom.style.display = ''\n    }\n  }\n}\n","import type { PlugManager } from '../editor-kit'\nimport type EditorPlug from './_plug'\n\n/**\n * PlugKit provides a set of methods to help you develop editor plug\n */\nexport default class PlugKit {\n  constructor(private plugs: PlugManager) {}\n\n  /** Use the editor */\n  useEditor() {\n    return this.plugs.editor\n  }\n\n  /**\n   * Use the context of global\n   *\n   * @deprecated The calls to this function should be reduced as much as possible\n   */\n  useGlobalCtx() {\n    return this.plugs.editor.ctx\n  }\n\n  /** Use the config of Artalk */\n  useConf() {\n    return this.plugs.editor.ctx.conf\n  }\n\n  /** Use the http api client */\n  useApi() {\n    return this.plugs.editor.ctx.getApi()\n  }\n\n  /** Use the user manager */\n  useUser() {\n    return this.plugs.editor.ctx.get('user')\n  }\n\n  /** Use the ui of editor */\n  useUI() {\n    return this.plugs.editor.getUI()\n  }\n\n  /** Use the events in editor scope */\n  useEvents() {\n    return this.plugs.getEvents()\n  }\n\n  /** Listen the event when plug is mounted */\n  useMounted(func: () => void) {\n    this.useEvents().on('mounted', func)\n  }\n\n  /** Listen the event when plug is unmounted */\n  useUnmounted(func: () => void) {\n    this.useEvents().on('unmounted', func)\n  }\n\n  /** Use the deps of other plug */\n  useDeps<T extends typeof EditorPlug>(plug: T) {\n    return this.plugs.get(plug)\n  }\n}\n","import { getEnabledPlugs } from './editor'\nimport EditorPlug from './editor/_plug'\nimport PlugKit from './editor/_kit'\nimport EventManager from '@/lib/event-manager'\nimport type { EditorApi, ArtalkPlugin } from '@/types'\n\nexport interface EditorEventPayloadMap {\n  mounted: undefined\n  unmounted: undefined\n  'header-input': { field: string; $input: HTMLInputElement }\n  'header-change': { field: string; $input: HTMLInputElement }\n  'content-updated': string\n  'panel-show': EditorPlug\n  'panel-hide': EditorPlug\n  'panel-close': undefined\n\n  'editor-close': undefined\n  'editor-open': undefined\n}\n\nexport const EditorKit: ArtalkPlugin = (ctx) => {\n  const editor = ctx.get('editor')\n\n  const editorPlugs = new PlugManager(editor)\n  ctx.inject('editorPlugs', editorPlugs)\n}\n\nexport class PlugManager {\n  private plugs: EditorPlug[] = []\n  private openedPlug: EditorPlug | null = null\n  private events = new EventManager<EditorEventPayloadMap>()\n\n  getPlugs() {\n    return this.plugs\n  }\n  getEvents() {\n    return this.events\n  }\n\n  private clear() {\n    this.plugs = []\n    this.events = new EventManager()\n    if (this.openedPlug) this.closePlugPanel()\n  }\n\n  constructor(public editor: EditorApi) {\n    let confLoaded = false // config not loaded at first time\n    this.editor.ctx.watchConf(\n      ['imgUpload', 'emoticons', 'preview', 'editorTravel', 'locale'],\n      (conf) => {\n        // trigger unmount event will call all plugs' unmount function\n        // (this will only be called while conf reloaded, not be called at first time)\n        confLoaded && this.getEvents().trigger('unmounted')\n\n        // reset the plugs\n        this.clear()\n\n        // init the all enabled plugs\n        getEnabledPlugs(conf).forEach((Plug) => {\n          // create the plug instance\n          const kit = new PlugKit(this)\n          this.plugs.push(new Plug(kit))\n        })\n\n        // trigger event for plug initialization\n        this.getEvents().trigger('mounted')\n        confLoaded = true\n\n        // refresh the plug UI\n        this.loadPluginUI()\n      },\n    )\n\n    this.events.on('panel-close', () => this.closePlugPanel())\n  }\n\n  private loadPluginUI() {\n    // handle ui, clear and reset the plug btns and plug panels\n    this.editor.getUI().$plugPanelWrap.innerHTML = ''\n    this.editor.getUI().$plugPanelWrap.style.display = 'none'\n    this.editor.getUI().$plugBtnWrap.innerHTML = ''\n\n    // load the plug UI\n    this.plugs.forEach((plug) => this.loadPluginItem(plug))\n  }\n\n  /** Load the plug btn and plug panel on editor ui */\n  private loadPluginItem(plug: EditorPlug) {\n    const $btn = plug.$btn\n    if (!$btn) return\n    this.editor.getUI().$plugBtnWrap.appendChild($btn)\n\n    // bind the event when click plug btn\n    !$btn.onclick &&\n      ($btn.onclick = () => {\n        // removing the active class from all the buttons\n        this.editor\n          .getUI()\n          .$plugBtnWrap.querySelectorAll('.active')\n          .forEach((item) => item.classList.remove('active'))\n\n        // if the plug is not the same as the openedPlug,\n        if (plug !== this.openedPlug) {\n          // then open the plug current clicked plug panel\n          this.openPlugPanel(plug)\n\n          // add active class for current plug panel\n          $btn.classList.add('active')\n        } else {\n          // then close the plug\n          this.closePlugPanel()\n        }\n      })\n\n    // initialization of plug panel\n    const $panel = plug.$panel\n    if ($panel) {\n      $panel.style.display = 'none'\n      this.editor.getUI().$plugPanelWrap.appendChild($panel)\n    }\n  }\n\n  get<T extends typeof EditorPlug>(plug: T) {\n    return this.plugs.find((p) => p instanceof plug) as InstanceType<T> | undefined\n  }\n\n  /** Open the editor plug panel */\n  openPlugPanel(plug: EditorPlug) {\n    this.plugs.forEach((aPlug) => {\n      const plugPanel = aPlug.$panel\n      if (!plugPanel) return\n\n      if (aPlug === plug) {\n        plugPanel.style.display = ''\n        this.events.trigger('panel-show', plug)\n      } else {\n        plugPanel.style.display = 'none'\n        this.events.trigger('panel-hide', plug)\n      }\n    })\n\n    this.editor.getUI().$plugPanelWrap.style.display = ''\n    this.openedPlug = plug\n  }\n\n  /** Close the editor plug panel */\n  closePlugPanel() {\n    if (!this.openedPlug) return\n\n    this.editor.getUI().$plugPanelWrap.style.display = 'none'\n    this.events.trigger('panel-hide', this.openedPlug)\n    this.openedPlug = null\n  }\n\n  /** Get the content which is transformed by plugs */\n  getTransformedContent(rawContent: string) {\n    let result = rawContent\n    this.plugs.forEach((aPlug) => {\n      if (!aPlug.contentTransformer) return\n      result = aPlug.contentTransformer(result)\n    })\n    return result\n  }\n}\n","import type { ArtalkPlugin } from '@/types'\n\nexport const GotoFocus: ArtalkPlugin = (ctx) => {\n  ctx.on('list-goto', async (commentID) => {\n    // find the comment node\n    let comment = ctx.getCommentNodes().find((c) => c.getID() === commentID)\n    if (!comment) {\n      // fetch and insert the comment from the server\n      const data = (await ctx.getApi().comments.getComment(commentID)).data\n      ctx\n        .get('list')\n        .getListLayout({ forceFlatMode: true })\n        .insert(data.comment, data.reply_comment)\n      comment = ctx.getCommentNodes().find((c) => c.getID() === commentID)\n    }\n    if (!comment) return\n    comment.focus()\n  })\n}\n","import * as Utils from '@/lib/utils'\nimport * as Ui from '@/lib/ui'\nimport $t from '@/i18n'\n\nexport interface ErrorDialogOptions {\n  $err: HTMLElement\n\n  errMsg: string\n  errData?: any\n  retryFn?: () => void\n\n  onOpenSidebar?: () => void\n}\n\nexport function showErrorDialog(opts: ErrorDialogOptions) {\n  const errEl = Utils.createElement(`<span><span class=\"error-message\"></span><br/><br/></span>`)\n  errEl.querySelector<HTMLElement>('.error-message')!.innerText =\n    `${$t('listLoadFailMsg')}\\n${opts.errMsg}`\n\n  if (opts.retryFn) {\n    const $retryBtn = Utils.createElement(`<span style=\"cursor:pointer;\">${$t('listRetry')}</span>`)\n    $retryBtn.onclick = () => opts.retryFn && opts.retryFn()\n    errEl.appendChild($retryBtn)\n  }\n\n  if (opts.onOpenSidebar) {\n    const $openSidebar = Utils.createElement(\n      `<span atk-only-admin-show> | <span style=\"cursor:pointer;\">${$t('openName', { name: $t('ctrlCenter') })}</span></span>`,\n    )\n    errEl.appendChild($openSidebar)\n    $openSidebar.onclick = () => opts.onOpenSidebar && opts.onOpenSidebar()\n  }\n\n  Ui.setError(opts.$err, errEl)\n}\n","import type { ArtalkPlugin } from '@/types'\nimport { version as ARTALK_VERSION } from '~/package.json'\nimport type List from '~/src/list/list'\nimport * as Ui from '@/lib/ui'\nimport * as Utils from '@/lib/utils'\nimport $t from '@/i18n'\n\nlet IgnoreVersionCheck = false\n\nexport const VersionCheck: ArtalkPlugin = (ctx) => {\n  ctx.watchConf(['apiVersion', 'versionCheck'], (conf) => {\n    const list = ctx.get('list')\n    if (conf.apiVersion && conf.versionCheck && !IgnoreVersionCheck)\n      versionCheck(list, ARTALK_VERSION, conf.apiVersion)\n  })\n}\n\nfunction versionCheck(list: List, feVer: string, beVer: string) {\n  const comp = Utils.versionCompare(feVer, beVer)\n  const sameVer = comp === 0\n  if (sameVer) return\n\n  const errEl = Utils.createElement(\n    `<div class=\"atk-version-check-notice\">${$t('updateMsg', {\n      name: comp < 0 ? $t('frontend') : $t('backend'),\n    })} <span class=\"atk-info\">` +\n      `${$t('currentVersion')}: ${$t('frontend')} ${feVer} / ${$t('backend')} ${beVer}` +\n      `</span></div>`,\n  )\n  const ignoreBtn = Utils.createElement(`<span class=\"atk-ignore-btn\">${$t('ignore')}</span>`)\n  ignoreBtn.onclick = () => {\n    errEl.remove()\n    IgnoreVersionCheck = true\n  }\n  errEl.append(ignoreBtn)\n  list.$el.parentElement!.prepend(errEl)\n}\n","import type { ArtalkPlugin } from '@/types'\n\n// Notice: Singleton pattern needs to be loaded as lazy as possible,\n//         because the SSG application does not have a `window` context.\nlet darkModeMedia: MediaQueryList | undefined\n\nfunction updateClassnames($els: HTMLElement[], darkMode: boolean) {\n  const DarkModeClassName = 'atk-dark-mode'\n\n  $els.forEach(($el) => {\n    if (darkMode) $el.classList.add(DarkModeClassName)\n    else $el.classList.remove(DarkModeClassName)\n  })\n}\n\nexport const DarkMode: ArtalkPlugin = (ctx) => {\n  // the handler bind to Artalk instance, don't forget to remove it when Artalk instance destroyed\n  let darkModeAutoHandler: ((evt: MediaQueryListEvent) => void) | undefined\n\n  const sync = (darkMode: boolean | 'auto') => {\n    // the elements that classnames need to be updated when darkMode changed\n    const $els = [ctx.$root, ctx.get('layerManager').getEl()]\n\n    // init darkModeMedia if not exists, and only create once\n    if (!darkModeMedia) {\n      darkModeMedia = window.matchMedia('(prefers-color-scheme: dark)')\n    }\n\n    if (darkMode === 'auto') {\n      // if darkMode is 'auto', add handler\n      if (!darkModeAutoHandler) {\n        // the handler that will be called when darkModeMedia changed\n        darkModeAutoHandler = (evt) => updateClassnames($els, evt.matches)\n        darkModeMedia.addEventListener('change', darkModeAutoHandler)\n      }\n\n      // update classnames immediately\n      updateClassnames($els, darkModeMedia.matches)\n    } else {\n      // if darkMode is boolean, remove handler\n      if (darkModeAutoHandler) {\n        darkModeMedia.removeEventListener('change', darkModeAutoHandler)\n        darkModeAutoHandler = undefined\n      }\n\n      // update classnames immediately\n      updateClassnames($els, darkMode)\n    }\n  }\n\n  ctx.watchConf(['darkMode'], (conf) => sync(conf.darkMode))\n  ctx.on('created', () => sync(ctx.conf.darkMode))\n  ctx.on('unmounted', () => {\n    // if handler exists, don't forget to remove it, or it will cause memory leak\n    darkModeAutoHandler && darkModeMedia?.removeEventListener('change', darkModeAutoHandler)\n    darkModeAutoHandler = undefined\n  })\n}\n","import { Markdown } from './markdown'\nimport { EditorKit } from './editor-kit'\nimport { ListPlugins } from './list'\nimport { Notifies } from './notifies'\nimport { PvCountWidget } from './stat'\nimport { VersionCheck } from './version-check'\nimport { AdminOnlyElem } from './admin-only-elem'\nimport { DarkMode } from './dark-mode'\nimport type { ArtalkPlugin } from '@/types'\n\nexport const DefaultPlugins: ArtalkPlugin[] = [\n  Markdown,\n  EditorKit,\n  AdminOnlyElem,\n  ...ListPlugins,\n  Notifies,\n  PvCountWidget,\n  VersionCheck,\n  DarkMode,\n]\n","import type { ArtalkPlugin } from '@/types'\n\nexport const AdminOnlyElem: ArtalkPlugin = (ctx) => {\n  const scanApply = () => {\n    applyAdminOnlyEls(\n      ctx.get('user').getData().isAdmin,\n      getAdminOnlyEls({\n        $root: ctx.$root,\n      }),\n    )\n  }\n\n  ctx.on('list-loaded', () => {\n    scanApply()\n  })\n\n  ctx.on('user-changed', (user) => {\n    scanApply()\n  })\n}\n\nfunction getAdminOnlyEls(opts: { $root: HTMLElement }): HTMLElement[] {\n  const els: HTMLElement[] = []\n\n  // elements in $root\n  opts.$root\n    .querySelectorAll<HTMLElement>(`[atk-only-admin-show]`)\n    .forEach((item) => els.push(item))\n\n  // TODO: provide a Artalk.conf hook to set whitelist of admin-only elements,\n  // and move following code to that hook (move into @artalk/artalk-sidebar)\n\n  // elements in sidebar\n  const $sidebarEl = document.querySelector<HTMLElement>('.atk-sidebar')\n  if ($sidebarEl)\n    $sidebarEl\n      .querySelectorAll<HTMLElement>(`[atk-only-admin-show]`)\n      .forEach((item) => els.push(item))\n\n  return els\n}\n\nfunction applyAdminOnlyEls(isAdmin: boolean, els: HTMLElement[]) {\n  els.forEach(($item: HTMLElement) => {\n    if (isAdmin) $item.classList.remove('atk-hide')\n    else $item.classList.add('atk-hide')\n  })\n}\n","import { WithEditor } from './with-editor'\nimport { Unread } from './unread'\nimport { Count } from './count'\nimport { SidebarBtn } from './sidebar-btn'\nimport { UnreadBadge } from './unread-badge'\nimport { GotoDispatcher } from './goto-dispatcher'\nimport { GotoFocus } from './goto-focus'\nimport { Copyright } from './copyright'\nimport { NoComment } from './no-comment'\nimport { Dropdown } from './dropdown'\nimport { TimeTicking } from './time-ticking'\nimport { ErrorDialog } from './error-dialog'\nimport { Loading } from './loading'\nimport { Fetch } from './fetch'\nimport { ReachBottom } from './reach-bottom'\nimport { GotoFirst } from './goto-first'\nimport type { ArtalkPlugin } from '@/types'\n\nconst ListPlugins: ArtalkPlugin[] = [\n  Fetch,\n  Loading,\n  Unread,\n  WithEditor,\n  Count,\n  SidebarBtn,\n  UnreadBadge,\n  Dropdown,\n  GotoDispatcher,\n  GotoFocus,\n  NoComment,\n  Copyright,\n  TimeTicking,\n  ErrorDialog,\n  ReachBottom,\n  GotoFirst,\n]\n\nexport { ListPlugins }\n","import type { ListFetchParams, ArtalkPlugin } from '@/types'\n\nexport const Fetch: ArtalkPlugin = (ctx) => {\n  ctx.on('list-fetch', (_params) => {\n    if (ctx.getData().getLoading()) return\n    ctx.getData().setLoading(true)\n\n    const params: ListFetchParams = {\n      // default params\n      offset: 0,\n      limit: ctx.conf.pagination.pageSize,\n      flatMode: ctx.conf.flatMode as boolean, // always be boolean because had been handled in Artalk.init\n      paramsModifier: ctx.conf.listFetchParamsModifier,\n      ..._params,\n    }\n\n    // must before other function call\n    ctx.getData().setListLastFetch({\n      params,\n    })\n\n    // prepare params for request\n    const reqParams = {\n      limit: params.limit,\n      offset: params.offset,\n      flat_mode: params.flatMode,\n      page_key: ctx.getConf().pageKey,\n      site_name: ctx.getConf().site,\n    }\n\n    // call the modifier function\n    if (params.paramsModifier) params.paramsModifier(reqParams)\n\n    // start request\n    ctx\n      .getApi()\n      .comments.getComments({\n        ...reqParams,\n        ...ctx.getApi().getUserFields(),\n      })\n      .then(({ data }) => {\n        // Must before all other function call and event trigger,\n        // because it will depend on the lastData\n        // TODO: this is global variable, easy to use, but not good, consider to refactor.\n        // refactor work is hard, because it is used in many places.\n        ctx.getData().setListLastFetch({ params, data })\n\n        // \n        ctx.getData().loadComments(data.comments)\n\n        // \n        ctx.getData().updatePage(data.page)\n\n        // trigger events when success\n        params.onSuccess && params.onSuccess(data)\n\n        ctx.trigger('list-fetched', { params, data })\n      })\n      .catch((e) => {\n        // \n        const error = {\n          msg: e.msg || String(e),\n          data: e.data,\n        }\n\n        params.onError && params.onError(error)\n\n        // trigger events when error\n        ctx.trigger('list-failed', error)\n        ctx.trigger('list-fetched', { params, error })\n\n        throw e\n      })\n      .finally(() => {\n        ctx.getData().setLoading(false)\n      })\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Ui from '@/lib/ui'\n\nexport const Loading: ArtalkPlugin = (ctx) => {\n  ctx.on('list-fetch', (p) => {\n    const list = ctx.get('list')\n\n    if (p.offset === 0)\n      // only show loading when fetch first page\n      Ui.setLoading(true, list.$el)\n    // else if not first page, show loading in paginator (code not there)\n  })\n\n  ctx.on('list-fetched', () => {\n    const list = ctx.get('list')\n    Ui.setLoading(false, list.$el)\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Utils from '@/lib/utils'\n\nexport const Unread: ArtalkPlugin = (ctx) => {\n  ctx.on('comment-rendered', (comment) => {\n    // comment unread highlight\n    if (ctx.conf.listUnreadHighlight === true) {\n      const notifies = ctx.getData().getNotifies()\n      const notify = notifies.find((o) => o.comment_id === comment.getID())\n\n      if (notify) {\n        // if comment contains in unread list\n        comment.getRender().setUnread(true)\n        comment.getRender().setOpenAction(() => {\n          window.open(notify.read_link)\n\n          // remove notify which has been read\n          ctx.getData().updateNotifies(notifies.filter((o) => o.comment_id !== comment.getID()))\n        })\n      } else {\n        // comment not in unread list\n        comment.getRender().setUnread(false)\n      }\n    }\n  })\n\n  ctx.on('list-goto', (commentID) => {\n    const notifyKey = Utils.getQueryParam('atk_notify_key')\n    if (notifyKey) {\n      // mark as read\n      ctx\n        .getApi()\n        .notifies.markNotifyRead(commentID, notifyKey)\n        .then(() => {\n          // remove from unread list\n          ctx.getData().updateNotifies(\n            ctx\n              .getData()\n              .getNotifies()\n              .filter((o) => o.comment_id !== commentID),\n          )\n        })\n    }\n  })\n}\n","import type { ContextApi, ArtalkPlugin, PageData } from '@/types'\nimport $t from '@/i18n'\n\nexport const WithEditor: ArtalkPlugin = (ctx) => {\n  let $closeCommentBtn: HTMLElement | undefined\n\n  // on Artalk mounted\n  // (after all components had mounted)\n  ctx.on('mounted', () => {\n    const list = ctx.get('list')\n\n    $closeCommentBtn = list.$el.querySelector<HTMLElement>('[data-action=\"admin-close-comment\"]')!\n\n    // bind editor close button click event\n    $closeCommentBtn.addEventListener('click', () => {\n      const page = ctx.getData().getPage()\n      if (!page) throw new Error('Page data not found')\n\n      page.admin_only = !page.admin_only\n      adminPageEditSave(ctx, page)\n    })\n  })\n\n  // on comment list loaded (it will include page data update)\n  ctx.on('page-loaded', (page) => {\n    const editor = ctx.get('editor')\n\n    // if page comment is closed\n    if (page?.admin_only === true) {\n      // then close editor\n      editor.getPlugs()?.getEvents().trigger('editor-close')\n      $closeCommentBtn && ($closeCommentBtn.innerText = $t('openComment'))\n    } else {\n      // the open editor\n      editor.getPlugs()?.getEvents().trigger('editor-open')\n      $closeCommentBtn && ($closeCommentBtn.innerText = $t('closeComment'))\n    }\n  })\n\n  ctx.on('list-loaded', (comments) => {\n    // \n    ctx.editorResetState()\n  })\n}\n\n/**  */\nfunction adminPageEditSave(ctx: ContextApi, page: PageData) {\n  ctx.editorShowLoading()\n  ctx\n    .getApi()\n    .pages.updatePage(page.id, page)\n    .then(({ data }) => {\n      ctx.getData().updatePage(data)\n    })\n    .catch((err) => {\n      ctx.editorShowNotify(`${$t('editFail')}: ${err.message || String(err)}`, 'e')\n    })\n    .finally(() => {\n      ctx.editorHideLoading()\n    })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Utils from '@/lib/utils'\nimport $t from '@/i18n'\n\nexport const Count: ArtalkPlugin = (ctx) => {\n  const refreshCountNumEl = () => {\n    const list = ctx.get('list')\n\n    const $count = list.$el.querySelector('.atk-comment-count .atk-text')\n    if (!$count) return\n\n    const text = Utils.htmlEncode(\n      $t('counter', {\n        count: `${Number(ctx.getData().getListLastFetch()?.data?.count) || 0}`,\n      }),\n    )\n    $count.innerHTML = text.replace(/(\\d+)/, '<span class=\"atk-comment-count-num\">$1</span>')\n  }\n\n  ctx.on('list-loaded', () => {\n    refreshCountNumEl()\n  })\n\n  ctx.on('comment-inserted', () => {\n    //  1\n    const last = ctx.getData().getListLastFetch()\n    if (last?.data) last.data.count += 1\n  })\n\n  ctx.on('comment-deleted', () => {\n    //  1\n    const last = ctx.getData().getListLastFetch()\n    if (last?.data) last.data.count -= 1\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport $t from '@/i18n'\n\nexport const SidebarBtn: ArtalkPlugin = (ctx) => {\n  let $openSidebarBtn: HTMLElement | null = null\n\n  const syncByUser = () => {\n    if (!$openSidebarBtn) return\n    const user = ctx.get('user').getData()\n\n    // \n    if (!!user.nick && !!user.email) {\n      $openSidebarBtn.classList.remove('atk-hide')\n\n      // update button text (normal user or admin)\n      const $btnText = $openSidebarBtn.querySelector<HTMLElement>('.atk-text')\n      if ($btnText) $btnText.innerText = !user.isAdmin ? $t('msgCenter') : $t('ctrlCenter')\n    } else {\n      $openSidebarBtn.classList.add('atk-hide')\n    }\n  }\n\n  ctx.watchConf(['locale'], (conf) => {\n    const list = ctx.get('list')\n\n    $openSidebarBtn = list.$el.querySelector<HTMLElement>('[data-action=\"open-sidebar\"]')\n    if (!$openSidebarBtn) return\n\n    $openSidebarBtn.onclick = () => {\n      // use onclick rather than addEventListener to prevent duplicate event\n      ctx.showSidebar()\n    }\n\n    syncByUser()\n  })\n\n  ctx.on('user-changed', (user) => {\n    syncByUser()\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\n\nexport const UnreadBadge: ArtalkPlugin = (ctx) => {\n  let $unreadBadge: HTMLElement | null = null\n\n  const showUnreadBadge = (count: number) => {\n    if (!$unreadBadge) return\n\n    if (count > 0) {\n      $unreadBadge.innerText = `${Number(count || 0)}`\n      $unreadBadge.style.display = 'block'\n    } else {\n      $unreadBadge.style.display = 'none'\n    }\n  }\n\n  ctx.on('mounted', () => {\n    const list = ctx.get('list')\n\n    $unreadBadge = list.$el.querySelector<HTMLElement>('.atk-unread-badge')\n  })\n\n  ctx.on('notifies-updated', (notifies) => {\n    showUnreadBadge(notifies.length || 0)\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Utils from '@/lib/utils'\nimport $t from '@/i18n'\n\nexport const Dropdown: ArtalkPlugin = (ctx) => {\n  const reloadUseParamsEditor = (func: (p: any) => void) => {\n    ctx.conf.listFetchParamsModifier = func\n    ctx.reload()\n  }\n\n  const initDropdown = ($dropdownOn: HTMLElement) => {\n    renderDropdown({\n      $dropdownWrap: $dropdownOn,\n      dropdownList: [\n        [\n          $t('sortLatest'),\n          () => {\n            reloadUseParamsEditor((p) => {\n              p.sort_by = 'date_desc'\n            })\n          },\n        ],\n        [\n          $t('sortBest'),\n          () => {\n            reloadUseParamsEditor((p) => {\n              p.sort_by = 'vote'\n            })\n          },\n        ],\n        [\n          $t('sortOldest'),\n          () => {\n            reloadUseParamsEditor((p) => {\n              p.sort_by = 'date_asc'\n            })\n          },\n        ],\n        [\n          $t('sortAuthor'),\n          () => {\n            reloadUseParamsEditor((p) => {\n              p.view_only_admin = true\n            })\n          },\n        ],\n      ],\n    })\n  }\n\n  ctx.watchConf(['listSort', 'locale'], (conf) => {\n    const list = ctx.get('list')\n\n    const $count = list.$el.querySelector<HTMLElement>('.atk-comment-count')\n    if (!$count) return\n\n    //  Dropdown \n    if (conf.listSort) {\n      initDropdown($count)\n    } else {\n      removeDropdown({\n        $dropdownWrap: $count,\n      })\n    }\n  })\n}\n\n/**  */\nfunction renderDropdown(conf: {\n  $dropdownWrap: HTMLElement\n  dropdownList: [string, () => void][]\n}) {\n  const { $dropdownWrap, dropdownList } = conf\n  if ($dropdownWrap.querySelector('.atk-dropdown')) return\n\n  //  class\n  $dropdownWrap.classList.add('atk-dropdown-wrap')\n\n  // \n  $dropdownWrap.append(Utils.createElement(`<span class=\"atk-arrow-down-icon\"></span>`))\n\n  // \n  let curtActive = 0 // \n  const onItemClick = (i: number, $item: HTMLElement, name: string, action: () => void) => {\n    action()\n\n    // set active\n    curtActive = i\n    $dropdown.querySelectorAll('.active').forEach((e) => {\n      e.classList.remove('active')\n    })\n    $item.classList.add('active')\n\n    //  ( :hover)\n    $dropdown.style.display = 'none'\n    setTimeout(() => {\n      $dropdown.style.display = ''\n    }, 80)\n  }\n\n  // \n  const $dropdown = Utils.createElement(`<ul class=\"atk-dropdown atk-fade-in\"></ul>`)\n  dropdownList.forEach((item, i) => {\n    const [name, action] = item\n\n    const $item = Utils.createElement(`<li class=\"atk-dropdown-item\"><span></span></li>`)\n    const $link = $item.querySelector<HTMLElement>('span')!\n    $link.innerText = name\n    $link.onclick = () => {\n      onItemClick(i, $item, name, action)\n    }\n    $dropdown.append($item)\n\n    if (i === curtActive) $item.classList.add('active') // \n  })\n\n  $dropdownWrap.append($dropdown)\n}\n\n/**  */\nfunction removeDropdown(conf: { $dropdownWrap: HTMLElement }) {\n  const { $dropdownWrap } = conf\n  $dropdownWrap.classList.remove('atk-dropdown-wrap')\n  $dropdownWrap.querySelector('.atk-arrow-down-icon')?.remove()\n  $dropdownWrap.querySelector('.atk-dropdown')?.remove()\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Utils from '@/lib/utils'\n\nexport const GotoDispatcher: ArtalkPlugin = (ctx) => {\n  let lastID = 0\n  const check = ({ locker }: { locker: boolean }) => {\n    const commentID = extractCommentID()\n    if (!commentID) return\n\n    if (locker && lastID === commentID) return // if the commentID is the same as the last one, do nothing\n    lastID = commentID // record the last commentID\n\n    ctx.trigger('list-goto', commentID) // trigger event\n  }\n\n  const hashChangeHandler = () => check({ locker: false })\n  const listLoadedHandler = () => check({ locker: true })\n  ctx.on('mounted', () => {\n    window.addEventListener('hashchange', hashChangeHandler)\n    ctx.on('list-loaded', listLoadedHandler)\n  })\n  ctx.on('unmounted', () => {\n    window.removeEventListener('hashchange', hashChangeHandler)\n    ctx.off('list-loaded', listLoadedHandler)\n  })\n}\n\nfunction extractCommentID(): number | null {\n  // Try get from hash\n  // Hash retrieval priority is higher than query,\n  // Because click goto will change hash.\n  const match = window.location.hash.match(/#atk-comment-([0-9]+)/)\n  let commentId =\n    match && match[1] && !Number.isNaN(parseFloat(match[1])) ? parseFloat(match[1]) : null\n\n  // Fail over to get from query\n  if (!commentId) {\n    commentId = Number(Utils.getQueryParam('atk_comment')) // same as backend GetReplyLink()\n  }\n\n  return commentId || null\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Utils from '@/lib/utils'\nimport { sanitize } from '@/lib/sanitizer'\n\nexport const NoComment: ArtalkPlugin = (ctx) => {\n  ctx.on('list-loaded', (comments) => {\n    const list = ctx.get('list')!\n\n    // \n    const isNoComment = comments.length <= 0\n    let $noComment = list.getCommentsWrapEl().querySelector<HTMLElement>('.atk-list-no-comment')\n\n    if (isNoComment) {\n      if (!$noComment) {\n        $noComment = Utils.createElement('<div class=\"atk-list-no-comment\"></div>')\n\n        // sanitize before set innerHTML\n        $noComment.innerHTML = sanitize(list.ctx.conf.noComment || list.ctx.$t('noComment'))\n        list.getCommentsWrapEl().appendChild($noComment)\n      }\n    } else {\n      $noComment?.remove()\n    }\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport { version as ARTALK_VERSION } from '~/package.json'\n\nexport const Copyright: ArtalkPlugin = (ctx) => {\n  ctx.on('mounted', () => {\n    const list = ctx.get('list')\n\n    const $copyright = list.$el.querySelector<HTMLElement>('.atk-copyright')\n    if (!$copyright) return\n\n    $copyright.innerHTML =\n      `Powered By <a href=\"https://artalk.js.org\" ` +\n      `target=\"_blank\" title=\"Artalk v${ARTALK_VERSION}\">` +\n      `Artalk</a>`\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Utils from '@/lib/utils'\n\n/**  */\nexport const TimeTicking: ArtalkPlugin = (ctx) => {\n  let timer: number | null = null\n\n  ctx.on('mounted', () => {\n    timer = window.setInterval(() => {\n      const list = ctx.get('list')\n\n      list.$el.querySelectorAll<HTMLElement>('[data-atk-comment-date]').forEach((el) => {\n        const date = el.getAttribute('data-atk-comment-date')\n        el.innerText = Utils.timeAgo(new Date(Number(date)), ctx.$t)\n      })\n    }, 30 * 1000) // 30s \n  })\n\n  ctx.on('unmounted', () => {\n    timer && window.clearInterval(timer)\n  })\n}\n","import * as Ui from '../../lib/ui'\nimport type { ArtalkPlugin, ContextApi } from '@/types'\nimport { showErrorDialog } from '@/components/error-dialog'\n\nexport const ErrorDialog: ArtalkPlugin = (ctx) => {\n  ctx.on('list-fetch', () => {\n    const list = ctx.get('list')\n\n    // clear the original error when a new fetch is triggered\n    Ui.setError(list.$el, null)\n  })\n\n  ctx.on('list-failed', (err) => {\n    showErrorDialog({\n      $err: ctx.get('list').$el,\n      errMsg: err.msg,\n      errData: err.data,\n      retryFn: () => ctx.fetch({ offset: 0 }),\n    })\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\n\nexport const ReachBottom: ArtalkPlugin = (ctx) => {\n  let observer: IntersectionObserver | null = null\n\n  const setupObserver = ($target: HTMLElement) => {\n    const scrollEvtAt = (ctx.conf.scrollRelativeTo && ctx.conf.scrollRelativeTo()) || null\n\n    observer = new IntersectionObserver(\n      ([entries]) => {\n        if (entries.isIntersecting) {\n          clearObserver() // clear before trigger event to avoid trigger twice `list-reach-bottom`\n\n          // note that this event will be triggered only once\n          // until the next list is loaded\n          ctx.trigger('list-reach-bottom')\n        }\n      },\n      {\n        threshold: 0.9, // when the target is 90% visible\n\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserver/root\n        // If the root is null, then the bounds of the actual document viewport are used.\n        root: scrollEvtAt,\n      },\n    )\n    observer.observe($target)\n  }\n\n  const clearObserver = () => {\n    observer?.disconnect()\n    observer = null\n  }\n\n  ctx.on('list-loaded', () => {\n    clearObserver()\n\n    const list = ctx.get('list')\n\n    // get the second last child\n    const children = list.getCommentsWrapEl().childNodes\n    const $target = children.length > 2 ? (children[children.length - 2] as HTMLElement) : null\n    if (!$target) return\n\n    // check IntersectionObserver support\n    if (!('IntersectionObserver' in window)) {\n      console.warn('IntersectionObserver api not supported')\n      return\n    }\n\n    // use IntersectionObserver to detect reach bottom\n    setupObserver($target)\n  })\n\n  ctx.on('unmounted', () => {\n    clearObserver()\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Utils from '@/lib/utils'\n\n/** List scroll to the first comment */\nexport const GotoFirst: ArtalkPlugin = (ctx) => {\n  const handler = () => {\n    const list = ctx.get('list')\n\n    const $relative = ctx.conf.scrollRelativeTo && ctx.conf.scrollRelativeTo()\n    ;($relative || window).scroll({\n      top: Utils.getOffset(list.$el, $relative).top,\n      left: 0,\n    })\n  }\n\n  ctx.on('mounted', () => {\n    ctx.on('list-goto-first', handler)\n  })\n\n  ctx.on('unmounted', () => {\n    ctx.off('list-goto-first', handler)\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\n\nexport const Notifies: ArtalkPlugin = (ctx) => {\n  ctx.on('list-fetch', (params) => {\n    if (params.offset !== 0) return\n\n    const user = ctx.getApi().getUserFields()\n    if (!user) return\n\n    // Fetch all unread notifies\n    ctx\n      .getApi()\n      .notifies.getNotifies(user)\n      .then((res) => {\n        ctx.getData().updateNotifies(res.data.notifies)\n      })\n  })\n}\n","import { DefaultPlugins } from './plugins'\nimport type { ArtalkConfig, ArtalkPlugin, ContextApi } from '@/types'\nimport { handleConfFormServer } from '@/config'\nimport { showErrorDialog } from '@/components/error-dialog'\n\n/**\n * Global Plugins for all Artalk instances\n */\nexport const GlobalPlugins: Set<ArtalkPlugin> = new Set([...DefaultPlugins])\n\nexport async function load(ctx: ContextApi) {\n  const loadedPlugins = new Set<ArtalkPlugin>()\n  const loadPlugins = (plugins: Set<ArtalkPlugin>) => {\n    plugins.forEach((plugin) => {\n      if (typeof plugin === 'function' && !loadedPlugins.has(plugin)) {\n        plugin(ctx)\n        loadedPlugins.add(plugin)\n      }\n    })\n  }\n\n  // Load local plugins\n  loadPlugins(GlobalPlugins)\n\n  // Get conf from server\n  const { data } = await ctx\n    .getApi()\n    .conf.conf()\n    .catch((err) => {\n      onLoadErr(ctx, err)\n      throw err\n    })\n\n  // Initial config\n  let conf: Partial<ArtalkConfig> = {\n    apiVersion: data.version?.version, // version info\n  }\n\n  // Reference conf from backend\n  if (ctx.conf.useBackendConf) {\n    if (!data.frontend_conf)\n      throw new Error(\n        'The remote backend does not respond to the frontend conf, but `useBackendConf` conf is enabled',\n      )\n    conf = { ...conf, ...handleConfFormServer(data.frontend_conf) }\n  }\n\n  // Apply conf modifier\n  ctx.conf.remoteConfModifier && ctx.conf.remoteConfModifier(conf)\n\n  // Dynamically load network plugins\n  conf.pluginURLs &&\n    (await loadNetworkPlugins(conf.pluginURLs, ctx.conf.server)\n      .then((plugins) => {\n        loadPlugins(plugins)\n      })\n      .catch((err) => {\n        console.error('Failed to load plugin', err)\n      }))\n\n  // After all plugins are loaded\n  ctx.trigger('created')\n\n  // Apply conf updating\n  ctx.updateConf(conf)\n\n  // Trigger mounted event\n  ctx.trigger('mounted')\n\n  // Load comment list\n  if (!ctx.conf.remoteConfModifier) {\n    // only auto fetch when no remoteConfModifier\n    ctx.fetch({ offset: 0 })\n  }\n}\n\n/**\n * Dynamically load plugins from Network\n */\nasync function loadNetworkPlugins(scripts: string[], apiBase: string): Promise<Set<ArtalkPlugin>> {\n  const networkPlugins = new Set<ArtalkPlugin>()\n  if (!scripts || !Array.isArray(scripts)) return networkPlugins\n\n  const tasks: Promise<void>[] = []\n\n  scripts.forEach((url) => {\n    // check url valid\n    if (!/^(http|https):\\/\\//.test(url))\n      url = `${apiBase.replace(/\\/$/, '')}/${url.replace(/^\\//, '')}`\n\n    tasks.push(\n      new Promise<void>((resolve, reject) => {\n        // check if loaded\n        if (document.querySelector(`script[src=\"${url}\"]`)) {\n          resolve()\n          return\n        }\n\n        // load script\n        const script = document.createElement('script')\n        script.src = url\n        document.head.appendChild(script)\n        script.onload = () => resolve()\n        script.onerror = (err) => reject(err)\n      }),\n    )\n  })\n\n  await Promise.all(tasks)\n\n  // Read ArtalkPlugins object from window\n  Object.values(window.ArtalkPlugins || {}).forEach((plugin) => {\n    if (typeof plugin === 'function') networkPlugins.add(plugin)\n  })\n\n  return networkPlugins\n}\n\nexport function onLoadErr(ctx: ContextApi, err: any) {\n  let sidebarOpenView = ''\n\n  // if response err_no_site, modify the sidebar open view to create site\n  if (err.data?.err_no_site) {\n    const viewLoadParam = {\n      create_name: ctx.conf.site,\n      create_urls: `${window.location.protocol}//${window.location.host}`,\n    }\n    sidebarOpenView = `sites|${JSON.stringify(viewLoadParam)}`\n  }\n\n  showErrorDialog({\n    $err: ctx.get('list').$el,\n    errMsg: err.msg || String(err),\n    errData: err.data,\n    retryFn: () => load(ctx),\n    onOpenSidebar: ctx.get('user').getData().isAdmin\n      ? () =>\n          ctx.showSidebar({\n            view: sidebarOpenView as any,\n          })\n      : undefined, // only show open sidebar button when user is admin\n  })\n}\n","import './style/main.scss'\n\nimport type { EventHandler } from './lib/event-manager'\nimport Context from './context'\nimport { handelCustomConf, convertApiOptions } from './config'\nimport Services from './service'\nimport * as Stat from './plugins/stat'\nimport { Api } from './api'\nimport type { TInjectedServices } from './service'\nimport { GlobalPlugins, load } from './load'\nimport type { ArtalkConfig, EventPayloadMap, ArtalkPlugin, ContextApi } from '@/types'\n\n/**\n * Artalk\n *\n * @see https://artalk.js.org\n */\nexport default class Artalk {\n  public ctx!: ContextApi\n\n  constructor(conf: Partial<ArtalkConfig>) {\n    // Init Config\n    const handledConf = handelCustomConf(conf, true)\n\n    // Init Context\n    this.ctx = new Context(handledConf)\n\n    // Init Services\n    Object.entries(Services).forEach(([name, initService]) => {\n      const obj = initService(this.ctx)\n      obj && this.ctx.inject(name as keyof TInjectedServices, obj) // auto inject deps to ctx\n    })\n\n    if (import.meta.env.DEV && import.meta.env.VITEST) {\n      global.devLoadArtalk = () => load(this.ctx)\n    } else {\n      load(this.ctx)\n    }\n  }\n\n  /** Get the config of Artalk */\n  public getConf() {\n    return this.ctx.getConf()\n  }\n\n  /** Get the root element of Artalk */\n  public getEl() {\n    return this.ctx.$root\n  }\n\n  /** Update config of Artalk */\n  public update(conf: Partial<ArtalkConfig>) {\n    this.ctx.updateConf(conf)\n    return this\n  }\n\n  /** Reload comment list of Artalk */\n  public reload() {\n    this.ctx.reload()\n  }\n\n  /** Destroy instance of Artalk */\n  public destroy() {\n    this.ctx.trigger('unmounted')\n    while (this.ctx.$root.firstChild) {\n      this.ctx.$root.removeChild(this.ctx.$root.firstChild)\n    }\n  }\n\n  /** Add an event listener */\n  public on<K extends keyof EventPayloadMap>(name: K, handler: EventHandler<EventPayloadMap[K]>) {\n    this.ctx.on(name, handler)\n  }\n\n  /** Remove an event listener */\n  public off<K extends keyof EventPayloadMap>(name: K, handler: EventHandler<EventPayloadMap[K]>) {\n    this.ctx.off(name, handler)\n  }\n\n  /** Trigger an event */\n  public trigger<K extends keyof EventPayloadMap>(name: K, payload?: EventPayloadMap[K]) {\n    this.ctx.trigger(name, payload)\n  }\n\n  /** Set dark mode */\n  public setDarkMode(darkMode: boolean) {\n    this.ctx.setDarkMode(darkMode)\n  }\n\n  // ===========================\n  //       Static Members\n  // ===========================\n\n  /** Init Artalk */\n  public static init(conf: Partial<ArtalkConfig>): Artalk {\n    return new Artalk(conf)\n  }\n\n  /** Use plugin, the plugin will be used when Artalk.init */\n  public static use(plugin: ArtalkPlugin) {\n    GlobalPlugins.add(plugin)\n  }\n\n  /** Load count widget */\n  public static loadCountWidget(c: Partial<ArtalkConfig>) {\n    const conf = handelCustomConf(c, true)\n\n    Stat.initCountWidget({\n      getApi: () => new Api(convertApiOptions(conf)),\n      siteName: conf.site,\n      countEl: conf.countEl,\n      pvEl: conf.pvEl,\n      pageKeyAttr: conf.statPageKeyAttr,\n      pvAdd: false,\n    })\n  }\n\n  // ===========================\n  //         Deprecated\n  // ===========================\n\n  /** @deprecated Please use `getEl()` instead */\n  public get $root() {\n    return this.ctx.$root\n  }\n\n  /** @description Please use `getConf()` instead */\n  public get conf() {\n    return this.ctx.getConf()\n  }\n}\n","import Artalk from './artalk'\nimport type * as ArtalkType from './types'\n\nexport type * from './types'\nexport { ArtalkType }\n\nexport default Artalk\n\n// Expose the static methods from the Artalk class\n// because direct export of static methods is not supported\n// for adapting to different environments like CommonJS and browser IIFE\n// for example, we can use `Artalk.init()` rather than `Artalk.default.init()`\n// therefore, we need to manually expose the static methods in the Artalk class.\nexport const init = Artalk.init\nexport const use = Artalk.use\nexport const loadCountWidget = Artalk.loadCountWidget\n"],"names":["HttpClient","constructor","apiConfig","__publicField","this","Map","fetchParams","fetch","credentials","headers","redirect","referrerPolicy","data","securityData","input","JSON","stringify","Object","keys","reduce","formData","key","property","append","Blob","FormData","toQueryString","cancelToken","abortControllers","has","abortController","get","signal","AbortController","set","abort","delete","_a","__async","_b","body","secure","path","type","query","format","baseUrl","params","__objRest","secureParams","baseApiParams","securityWorker","requestParams","mergeRequestParams","queryString","payloadFormatter","contentFormatters","responseFormat","customFetch","__spreadProps","__spreadValues","createAbortSignal","then","response","r","error","ok","catch","e","assign","encodeQueryParam","value","encodeURIComponent","addQueryParam","addArrayQueryParam","map","v","join","rawQuery","filter","Array","isArray","addQueryParams","params1","params2","super","arguments","loginByEmail","request","method","registerByEmail","sendVerifyEmail","checkDataMerge","applyDataMerge","flushCache","warmUpCache","getCaptcha","getCaptchaStatus","verifyCaptcha","getComments","createComment","comment","getComment","id","updateComment","deleteComment","conf","getSocialLoginProviders","getDomain","getNotifies","markAllNotifyRead","options","markNotifyRead","commentId","notifyKey","getPages","fetchAllPages","getPageFetchStatus","logPv","page","updatePage","deletePage","fetchPage","sendEmail","email","getSettings","applySettings","settings","getSettingsTemplate","locale","getSites","createSite","site","updateSite","deleteSite","getStats","exportArtrans","importArtrans","uploadArtrans","upload","getUser","login","user","getUserStatus","createUser","updateUser","deleteUser","getUsers","getVersion","syncVotes","vote","targetId","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","defineProperty","_createClass","protoProps","staticProps","prototype","_inherits","subClass","superClass","create","_setPrototypeOf","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","bind","__proto__","p","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","Boolean","valueOf","call","_assertThisInitialized","self","ReferenceError","_possibleConstructorReturn","_createSuper","Derived","hasNativeReflectConstruct","result","Super","NewTarget","apply","_superPropBase","object","hasOwnProperty","_get","receiver","base","desc","getOwnPropertyDescriptor","Emitter","callback","listeners","push","stack","l","splice","event","stackToCall","slice","listener","Promise","resolve","once","removeEventListener","defaultPrevented","AbortSignal","_Emitter","_super","_this","aborted","onabort","reason","Event","document","createEvent","initEvent","createEventObject","bubbles","cancelable","signalReason","Error","name","DOMException","err","dispatchEvent","polyfillNeeded","__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL","console","log","Request","abortableFetchDecorator","patchTargets","_patchTargets","_patchTargets$Request","NativeRequest","NativeAbortController","_patchTargets$__FORCE","init","realFetch","isPrototypeOf","abortError","reject","cancellation","_","addEventListener","race","Symbol","toStringTag","_abortableFetch","warn","global","Fetch","opts","apiToken","getApiToken","Headers","Authorization","resp","json","retry","handlers","promise","item","action","handler","code","FetchException","message","msg","createError","status","Api","ApiV2","baseURL","_opts","getUserFields","userInfo","escapes","unescapes","rescaped","runescaped","escapeHtmlChar","match","unescapeHtmlChar","escapeHtml","text","String","replace","unescapeHtml","html","she","encode","escape","decode","unescape","version","assignment_1","assignment","shift","toString","lowercase","string","toLowerCase","asKey","accumulator","toMap_1","list","attributes","uris","require$$0","elements","voids","he","require$$1","require$$3","rstart","rend","rattrs","rtag","rtagend","require$$2","parser","chars","lastItem","createStack","last","parsePart","substr","index","indexOf","substring","test","parseEdge","parseEndTag","parseStartTag","same","regex","tag","tagName","rest","unary","attrs","low","u","doubleQuotedValue","singleQuotedValue","unquotedValue","start","pos","end","sanitizer","buffer","context","ignoring","ignore","allowedTags","out","forEach","classesOk","allowedClasses","attrsOk","allowedAttributes","lkey","split","className","trim","colon","questionmark","hash","allowedSchemes","some","matches","scheme","testUrl","unignore","transformText","depth","reset","defaults","a","iframe","img","insane","strict","configuration","insaneOptions","span","node","reg","class","style","sanitize","content","exports","createCommonjsModule","fn","module","index$1","RegExp","line","source","block","defaultColors","toComment","cm","ref","colors","cache","re","m","word","color","factory","renderCode","hanabi","getRenderer","renderer","marked","Renderer","link","markedLinkRenderer","markedCodeRenderer","image","markedImageRenderer","orgLinkRenderer","href","title","isSameOriginLink","URL","origin","getLinkOrigin","window","location","lang","realLang","colorized","hljs","getLanguage","highlight","orgImageRenderer","imgLazyLoad","replacers","markedOptions","gfm","breaks","async","getInstance","src","markedContent","parse","alt","imgSrc","simpleMarked","dest","replacer","mergeDeep","objects","isObject","obj","prev","pVal","oVal","concat","DataManager","events","getLoading","loading","setLoading","val","getListLastFetch","listLastFetch","setListLastFetch","comments","fetchComments","trigger","findComment","find","c","clearComments","loadComments","partialComments","insertComment","notifies","updateNotifies","getPage","pageData","createElement","htmlStr","div","innerHTML","firstElementChild","htmlEncode","str","temp","innerText","getQueryParam","exec","search","decodeURIComponent","getOffset","el","relativeTo","getOffsetRecursive","element","rect","getBoundingClientRect","scrollLeft","pageXOffset","documentElement","scrollTop","pageYOffset","top","left","elOffset","relativeToOffset","padWithZeros","vNumber","width","numAsString","timeAgo","date","$t","n","oldTime","getTime","diffValue","Date","days","Math","floor","leave1","hours","leave2","minutes","leave3","seconds","round","vDay","getDate","vMonth","getMonth","getFullYear","dateFormat","getCorrectUserAgent","uaRaw","navigator","userAgent","userAgentData","getHighEntropyValues","uaData","uaGot","majorPlatformVersion","Number","platformVersion","platform","isValidURL","urlRaw","url","protocol","getURLBasedOnApi","en","placeholder","noComment","send","signIn","signUp","save","nick","emoticon","preview","uploadImage","uploadFail","commentFail","restoredMsg","onlyAdminCanReply","uploadLoginMsg","counter","sortLatest","sortOldest","sortBest","sortAuthor","openComment","closeComment","listLoadFailMsg","listRetry","loadMore","admin","reply","voteUp","voteDown","voteFail","readMore","actionConfirm","collapse","collapsed","collapsedMsg","expand","approved","pending","pendingMsg","edit","editCancel","deleteConfirm","pin","unpin","now","adminCheck","captchaCheck","confirm","cancel","msgCenter","ctrlCenter","noAccountPrompt","haveAccountPrompt","forgetPassword","resetPassword","verificationCode","verifySend","verifyResend","waitSeconds","emailVerified","password","username","nextStep","skipNotVerify","logoutConfirm","accountMergeNotice","accountMergeSelectOne","accountMergeConfirm","dismiss","merge","frontend","backend","loadFail","editing","editFail","deleting","deleteFail","reqGot","reqAborted","updateMsg","currentVersion","open","openName","GLOBAL_LOCALES_KEY","internal","findLocaleSet","p1","p2","toUpperCase","LocaleConf","LocaleDict","setLocale","t","args","token","Utils.htmlEncode","EventManager","on","off","evt","payload","pageKey","pageTitle","server","sendBtn","darkMode","editorTravel","flatMode","nestMax","nestSort","emoticons","uaBadge","listSort","countEl","pvEl","statPageKeyAttr","gravatar","mirror","pagination","pageSize","autoLoad","heightLimit","children","scrollable","imgUpload","reqTimeout","versionCheck","useBackendConf","handelCustomConf","customConf","full","Defaults","findEl","querySelector","pathname","language","matchMedia","convertApiOptions","ctx","siteName","timeout","getData","checkHasBasicUserInfo","getApiHandlers","watchConf","effect","lastVal","newVal","getConf","res","b","Context","getCommentNodes","$root","classList","add","mounted","inject","depName","getApi","apiHandlers","h","createApiHandlers","checkCaptcha","checkAdmin","createNewApiHandlers","replyComment","commentData","$comment","editor","setReply","editComment","setEditComment","reload","offset","listGotoFirst","editorShowLoading","showLoading","editorHideLoading","hideLoading","editorShowNotify","showNotify","editorResetState","resetState","showSidebar","sidebarLayer","show","hideSidebar","hide","checkerLauncher","I18n.t","setDarkMode","updateConf","nConf","getEl","getMarked","marked.getInstance","parentElem","$loading","Utils.createElement","transparentBg","background","appendChild","display","$spinner","setTimeout","isConnected","scrollIntoView","elem","enableAnim","containerRect","clientHeight","scrollY","innerHeight","height","scrollOptions","behavior","scroll","playFadeInAnim","after","onAnimEnded","remove","playFadeAnim","setError","errorTextEl","HTMLElement","iframeBody","checker","$iframeWrap","$iframe","Ui.showLoading","getOpts","getCaptchaIframeURL","onload","Ui.hideLoading","$closeBtn","hideInteractInput","stop","queryStatus","ms","isPass","captcha","is_pass","triggerSuccess","onclick","CaptchaChecker","inputVal","render.iframeBody","imgEl","setAttribute","img_data","render.imgBody","onSuccess","formEl","onError","click","AdminChecker","inputType","update","isAdmin","onReload","Dialog","contentEl","$el","$actions","$content","setYes","btn","onBtnClick","setNo","currentTarget","wrapPromise","cancelFn","onCancel","successFn","CheckerLauncher","fire","postFire","layer","getCtx","close","destroy","checkerStore","checkerCtx","$input","btnTextOrg","focus","onkeyup","keyCode","preventDefault","dialog","btnEl","btnTextRestore","btnText","tf","onfocus","clearTimeout","onMount","Component","Sel","$header","$nick","$email","$link","$textareaWrap","$textarea","$bottom","$submitBtn","$notifyWrap","$bottomLeft","$stateWrap","$plugBtnWrap","$plugPanelWrap","EditorPlug","kit","useBtn","$btn","usePanel","$panel","useContentTransformer","func","contentTransformer","usePanelShow","useEvents","aPlug","usePanelHide","useEditorStateEffect","stateName","effectFn","editorStateEffectWhen","editorStateEffect","Mover","move","afterEl","isMoved","editorEl","useUI","$travelPlace","replaceWith","back","useGlobalCtx","EditorStateManager","stateCurt","state","stateUnmountFn","getPlugs","moveAfterEl","_c","_d","$relative","scrollRelativeTo","Ui.scrollIntoView","getUI","plugin","_e","Editor","ui","entries","k","sel","render","getState","getHeaderInputEls","getContentFinal","getContentRaw","plugs","getTransformedContent","getContentMarked","setContent","getEvents","insertContent","selection","createRange","selectionStart","sStart","sEnd","selectionEnd","sT","switch","wrapElem","notifyElem","s","w","notifyRemove","timeoutFn","Ui.showNotify","submit","next","beforeSubmit","SidebarLayer","refreshOnShow","transform","initLayer","createIframe","view","iFrameSrc","getDarkMode","includes","iframeLoad","authCheck","animTimer","is_admin","is_login","setOnAfterHide","Utils.getURLBasedOnApi","time","urlParams","URLSearchParams","createNestStrategy","import","srcData","sortBy","nodeList","rid","root","rootNode","level","parent","loadChildren","parentNode","child","childNode","sortFunc","vote_up","sortLevels","nodes","sort","ListNest.makeNestCommentNodeList","nestSortBy","rootC","createCommentNode","$commentsWrap","getRender","parentC","replyD","childD","childC","putChild","checkHeightLimit","insert","prepend","findCommentNode","getParents","heightLimitRemoveForChildren","insertMode","is_collapsed","is_allow_reply","visible","$listCommentsWrap","ListLayout","getStrategy","check","rules","max","imgCheck","maxHeight","lock","_check","Utils.getHeight","parseFloat","getComputedStyle","opt","contains","HEIGHT_LIMIT_SCROLL_CSS","applyScrollableHeightLimit","HEIGHT_LIMIT_CSS","overflow","$expandBtn","stopPropagation","disposeHeightLimit","afterExpandBtnClick","applyHeightLimit","imgs","querySelectorAll","from","renderNick","$headerNick","$nickA","Utils.isValidURL","renderVerifyBadge","$headerBadgeWrap","badgeText","badge_name","badgeColor","badge_color","$badge","backgroundColor","is_verified","$verifiedBadge","is_pinned","$pinnedBadge","renderDate","$date","getDateFormatted","renderUABadge","ip_region","$uaWrap","$regionBadge","browser","os","getUserUA","$uaBrowser","$usOS","ActionBtn","getText","adminOnly","isMessaging","msgRecTimer","appendTo","dom","setClick","isLoading","confirmRestore","isConfirming","confirmText","confirmRecTimer","fireMsgRecTimer","clearMsgRecTimer","updateText","loadingText","setMsg","setWarn","setSuccess","duringTime","setMsgRecTimer","msgRecTimerFunc","renderVote","voteBtnUp","getActions","voteBtnDown","vote_down","renderReply","replyBtn","renderCollapse","collapseBtn","adminEdit","renderModerator","pendingBtn","is_pending","renderPin","pinnedBtn","renderEdit","editBtn","renderDel","delBtn","adminDelete","Renders","Avatar","$avatar","$avatarImg","avatarURLBuilder","getGravatarURL","$avatarA","Header","Content","collapsedInfoEl","$body","insertAdjacentElement","contentShowBtn","Ui.playFadeInAnim","ReplyAt","replyTo","$replyAt","goToReplyComment","ReplyTo","$replyTo","replyContent","Pending","pendingEl","Actions","Render","$main","$childrenWrap","contentMaxH","childrenMaxH","HeightLimit.check","getChildren","HeightLimit.disposeHeightLimit","playFadeAnimForBody","playFlashAnim","getChildrenWrap","setUnread","setOpenable","setOpenURL","setOpenAction","CommentActions","actionBtn","votes","up","down","btnElem","modify","setData","onDelete","origHash","modifyHash","CommentNode","nestCurt","actionInstance","renderInstance","CommentUI","newEl","onAfterRender","getParent","getNestCurt","getIsRoot","getID","getChildrenWrapEl","$childComment","flattenParents","emailHash","email_encrypted","Utils.timeAgo","info","win","nav","osVersion","engine","device","engineMatch","Trident","Presto","WebKit","Gecko","browserMatch","Safari","Chrome","IE","Edge","Firefox","Chromium","Opera","Vivaldi","Yandex","Kindle","UC","QQBrowser","QQ","Baidu","Maxthon","Sogou","LBBROWSER","TheWorld","MIUI","Quark","Qiyu","Wechat","Taobao","Alipay","Weibo","Douban","Suning","iQiYi","osMatch","Windows","Linux","macOS","Android","Ubuntu","FreeBSD","Debian","BlackBerry","MeeGo","Symbian","iOS","WebOS","deviceMatch","Mobile","Tablet","showModalDialog","chrome","arr","browserLanguage","UADetect","ua","ReadMoreBtn","origText","$text","hasMore","total","onClick","checkDisabled","showErr","errMsg","ReadMorePaginator","readMoreAutoLoad","onReachedBottom","getHasMore","getIsClearComments","dispose","Pagination","oninput","onkeydown","keydown","$prevBtn","$nextBtn","maxPage","ceil","setInput","inputTimer","isNaN","change","onChange","which","UpDownPaginator","PaginationComponent","getPageDataByLastData","count","roots_count","initListPaginatorFunc","paginator","createPaginatorByConf","$paginator","List","initCrudEvents","getCommentsWrapEl","commentNodes","getListLayout","forceFlatMode","d","bodyOrgOverflow","bodyOrgPaddingRight","getScrollbarHelper","paddingRight","unlock","barPaddingRight","parseInt","getPropertyValue","inner","outer","position","visibility","w1","offsetWidth","w2","clientWidth","removeChild","Ui.getScrollBarWidth","Layer","onAfterHide","setAllowMaskClose","allow","allowMaskClose","getAllowMaskClose","onShow","onHide","LayerWrap","$wrap","$mask","createItem","createItemElement","hideWrap","showWrap","getMask","items","getWrap","LayerManager","wrap","LOCAL_USER_KEY","User","localUser","localStorage","getItem","setItem","onUserChanged","logout","services","i18n","I18n.setLocale","layerManager","editorPlugs","initCountWidget","loadStatCount","containers","loadCommentCount","cacheData","pvAdd","pvCount","pages","page_key","page_title","site_name","pv","incrementPvCount","loadPvCount","els","Set","selector","retrieveElements","pageKeys","pageKeyAttr","getAttribute","getPageKeys","stats","page_keys","defaultPageKey","updateElementsText","LocalStorageKey","SubmitAddPreset","reqAdd","useApi","getSubmitAddParams","useUser","useConf","useEditor","Utils.getCorrectUserAgent","postSubmitAdd","commentNew","Submit","defaultPreset","onEditorSubmit","do","useMounted","useUnmounted","registerCustom","customs","custom","activeCond","nComment","pre","req","post","Emoticons","raw","transEmoticonImageText","loadEmoticonsData","isImgLoaded","initEmoticonsList","changeListHeight","parentElement","isListLoaded","loadingTask","handleData","Ui.setError","pushGrp","grp","remoteLoad","all","grpData","isOwOFormat","convertOwO","solveNullKey","solveSameKey","tmp","values","container","owoData","grpName","nGrp","iconStr","icon","$grpWrap","$grp","$item","$grpSwitcher","openGrp","AllowImgExts","Upload","initDragImg","$imgUploadInput","accept","onchange","files","file","uploadImg","uploadFromFileList","onDragover","onDrop","dataTransfer","onPaste","clipboardData","fileExt","insertPrefix","uploadPlaceholderTxt","customUploaderFn","imgUploader","public_url","imgURL","Preview","isPlugPanelShow","updateContent","EDITOR_PLUGS","onContentUpdated","localContent","$inputs","inputEventFns","changeEventFns","field","timer","abortFn","onInput","fetchUserInfo","api","CANCEL_TOKEN","abortRequest","onUserInfoFetched","finally","onLinkChange","onLinkInputChange","onKeydown","adaptiveHeightByContent","diff","offsetHeight","scrollHeight","cancelReply","submitPlug","useDeps","page_url","$sendReplyBtn","cancelEdit","saveData","$editCancelBtn","updateSubmitBtnText","restoreSubmitBtnText","originalSubmitBtnText","onOpen","onClose","PlugKit","plug","PlugManager","confLoaded","clear","confRefs","getEnabledPlugs","Plug","loadPluginUI","closePlugPanel","openedPlug","loadPluginItem","openPlugPanel","plugPanel","rawContent","showErrorDialog","errEl","retryFn","$retryBtn","onOpenSidebar","$openSidebar","$err","IgnoreVersionCheck","darkModeMedia","updateClassnames","$els","DarkModeClassName","DefaultPlugins","libMarked","setOptions","initMarked","markedReplacers","scanApply","$sidebarEl","getAdminOnlyEls","_params","limit","paramsModifier","listFetchParamsModifier","reqParams","flat_mode","listUnreadHighlight","notify","comment_id","read_link","commentID","Utils.getQueryParam","$closeCommentBtn","admin_only","adminPageEditSave","$count","$openSidebarBtn","syncByUser","$btnText","$unreadBadge","reloadUseParamsEditor","initDropdown","$dropdownOn","$dropdownWrap","dropdownList","curtActive","onItemClick","$dropdown","renderDropdown","sort_by","view_only_admin","removeDropdown","lastID","locker","extractCommentID","hashChangeHandler","listLoadedHandler","reply_comment","isNoComment","$noComment","$copyright","ARTALK_VERSION","setInterval","clearInterval","errData","observer","clearObserver","disconnect","childNodes","$target","scrollEvtAt","IntersectionObserver","isIntersecting","threshold","observe","setupObserver","Utils.getOffset","apiVersion","feVer","beVer","comp","pa","pb","na","nb","Utils.versionCompare","ignoreBtn","darkModeAutoHandler","sync","GlobalPlugins","load","loadedPlugins","loadPlugins","plugins","sidebarOpenView","err_no_site","viewLoadParam","create_name","create_urls","host","onLoadErr","frontend_conf","ExcludedKeys","startsWith","handleConfFormServer","remoteConfModifier","pluginURLs","scripts","apiBase","networkPlugins","tasks","script","head","onerror","ArtalkPlugins","loadNetworkPlugins","Artalk","handledConf","Services","initService","firstChild","use","loadCountWidget"],"mappings":"46BAunBO,MAAMA,EAcX,WAAAC,CAAYC,EAAyC,IAb5BC,EAAAC,KAAA,UAAA,WACuBD,EAAAC,KAAA,eAAA,MACxCD,EAAAC,KAAA,kBACAD,EAAAC,KAAA,uBAAuBC,KACvBF,EAAAC,KAAA,eAAc,IAAIE,IAA0CC,SAASD,KAEtCH,EAAAC,KAAA,gBAAA,CACrCI,YAAa,cACbC,QAAS,CAAC,EACVC,SAAU,SACVC,eAAgB,gBAOXR,EAAAC,KAAA,mBAAmBQ,IACxBR,KAAKS,aAAeD,CAAA,IAkCgDT,EAAAC,KAAA,oBAAA,CACpE,mBAAqBU,GACT,OAAVA,GAAoC,iBAAVA,GAAuC,iBAAVA,EAEnDA,EADAC,KAAKC,UAAUF,GAErB,aAAqBA,GACT,OAAVA,GAAmC,iBAAVA,EAAqBC,KAAKC,UAAUF,GAASA,EACxE,sBAAyBA,GACvBG,OAAOC,KAAKJ,GAAS,CAAA,GAAIK,QAAO,CAACC,EAAUC,KACnC,MAAAC,EAAWR,EAAMO,GAShB,OARED,EAAAG,OACPF,EACAC,aAAoBE,KAChBF,EACoB,iBAAbA,GAAsC,OAAbA,EAChCP,KAAKC,UAAUM,GACf,GAAGA,KAEFF,CAAA,GACN,IAAIK,UACT,oCAA2BX,GAAeV,KAAKsB,cAAcZ,KAgBrDX,EAAAC,KAAA,qBAAqBuB,IAC7B,GAAIvB,KAAKwB,iBAAiBC,IAAIF,GAAc,CAC1C,MAAMG,EAAkB1B,KAAKwB,iBAAiBG,IAAIJ,GAClD,OAAIG,EACKA,EAAgBE,YAElB,CACT,CAEM,MAAAF,EAAkB,IAAIG,gBAE5B,OADK7B,KAAAwB,iBAAiBM,IAAIP,EAAaG,GAChCA,EAAgBE,MAAA,IAGlB7B,EAAAC,KAAA,gBAAgBuB,IACrB,MAAMG,EAAkB1B,KAAKwB,iBAAiBG,IAAIJ,GAE9CG,IACFA,EAAgBK,QACX/B,KAAAwB,iBAAiBQ,OAAOT,GAC/B,IAGKxB,EAAAC,KAAA,WAAmCiC,GAUYC,EAAAlC,KAAA,MAAA,YATpD,IAAAmC,EAAAF,GAAAG,KAAAA,EAAAC,OACAA,EAAAC,KACAA,EAAAC,KACAA,EAAAC,MACAA,EAAAC,OACAA,EAAAC,QACAA,EAAAnB,YACAA,GARwCY,EASrCQ,+JAAAC,CATqCT,EASrC,CARH,OACA,SACA,OACA,OACA,QACA,SACA,UACA,gBAGA,MAAMU,GACgB,kBAAXR,EAAuBA,EAASrC,KAAK8C,cAAcT,SAC1DrC,KAAK+C,uBACE/C,KAAK+C,eAAe/C,KAAKS,gBAClC,GACIuC,EAAgBhD,KAAKiD,mBAAmBN,EAAQE,GAChDK,EAAcV,GAASxC,KAAKsB,cAAckB,GAC1CW,EAAmBnD,KAAKoD,kBAAkBb,GAAQ,oBAClDc,EAAiBZ,GAAUO,EAAcP,OAE/C,OAAOzC,KAAKsD,YACV,GAAGZ,GAAW1C,KAAK0C,SAAW,KAAKJ,IAAOY,EAAc,IAAIA,IAAgB,KAC5EK,OACKP,GADL,CAEE3C,QAASmD,EAAAA,EAAA,CAAA,EACHR,EAAc3C,SAAW,CAAC,GAC1BkC,GAAiB,wBAATA,EAAgC,CAAE,eAAgBA,GAAS,CAAC,GAE1EX,QAASL,EAAcvB,KAAKyD,kBAAkBlC,GAAeyB,EAAcpB,SAAW,KACtFQ,KAAM,MAAOA,EAAwC,KAAOe,EAAiBf,MAE/EsB,MAAYC,GAAazB,EAAAlC,KAAA,MAAA,YACzB,MAAM4D,EAAID,EACVC,EAAEpD,KAAO,KACToD,EAAEC,MAAQ,KAEJ,MAAArD,EAAQ6C,QAEJM,EAASN,KACZK,MAAMlD,IACDoD,EAAEE,GACJF,EAAEpD,KAAOA,EAEToD,EAAEC,MAAQrD,EAELoD,KAERG,OAAOC,IACNJ,EAAEC,MAAQG,EACHJ,KAZXA,EAmBJ,GAJIrC,GACGvB,KAAAwB,iBAAiBQ,OAAOT,IAG1BoC,EAASG,GAAU,MAAAtD,EACjB,OAAAA,CAAA,KACR,MA5JMK,OAAAoD,OAAOjE,KAAMF,EACtB,CAMU,gBAAAoE,CAAiBjD,EAAakD,GAE/B,MAAA,GADYC,mBAAmBnD,MACdmD,mBAAoC,iBAAVD,EAAqBA,EAAQ,GAAGA,MACpF,CAEU,aAAAE,CAAc7B,EAAwBvB,GAC9C,OAAOjB,KAAKkE,iBAAiBjD,EAAKuB,EAAMvB,GAC1C,CAEU,kBAAAqD,CAAmB9B,EAAwBvB,GAE5C,OADOuB,EAAMvB,GACPsD,KAAKC,GAAWxE,KAAKkE,iBAAiBjD,EAAKuD,KAAIC,KAAK,IACnE,CAEU,aAAAnD,CAAcoD,GAChB,MAAAlC,EAAQkC,GAAY,GAE1B,OADa7D,OAAOC,KAAK0B,GAAOmC,QAAQ1D,QAAQ,IAAuBuB,EAAMvB,KAE1EsD,KAAKtD,GACJ2D,MAAMC,QAAQrC,EAAMvB,IAChBjB,KAAKsE,mBAAmB9B,EAAOvB,GAC/BjB,KAAKqE,cAAc7B,EAAOvB,KAE/BwD,KAAK,IACV,CAEU,cAAAK,CAAeJ,GACjB,MAAAxB,EAAclD,KAAKsB,cAAcoD,GAChC,OAAAxB,EAAc,IAAIA,IAAgB,EAC3C,CAyBU,kBAAAD,CAAmB8B,EAAwBC,GAC5C,OAAAzB,WACFvD,KAAK8C,eACLiC,GACCC,GAAW,CAAC,GAHX,CAIL3E,QAASmD,EAAAA,EAAAA,EAAA,CAAA,EACHxD,KAAK8C,cAAczC,SAAW,CAAC,GAC/B0E,EAAQ1E,SAAW,CAAC,GACnB2E,GAAWA,EAAQ3E,SAAY,CAAC,IAG3C;;;;;;;;;WAiGK,cAAoDT,EAApD,WAAAC,GAAAoF,SAAAC,WACEnF,EAAAC,KAAA,OAAA,CAkBLmF,aAAc,CAAC3E,EAAoCmC,EAAwB,CAAA,IACzE3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,oBACN+C,OAAQ,OACRjD,KAAM5B,EACN+B,KAAM,mBACNE,OAAQ,QACLE,IAoBP2C,gBAAiB,CAAC9E,EAAuCmC,EAAwB,CAAA,IAC/E3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,uBACN+C,OAAQ,OACRjD,KAAM5B,EACN+B,KAAM,mBACNE,OAAQ,QACLE,IAuBP4C,gBAAiB,CAAC/E,EAAmCmC,EAAwB,CAAA,IAC3E3C,KAAKoF,QAOH5B,EAAA,CACAlB,KAAM,mBACN+C,OAAQ,OACRjD,KAAM5B,EACN+B,KAAM,mBACNE,OAAQ,QACLE,IAqBP6C,eAAgB,CAAC7C,EAAwB,KACvC3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,cACN+C,OAAQ,MACRhD,QAAQ,EACRI,OAAQ,QACLE,IAqBP8C,eAAgB,CAACjF,EAAwCmC,EAAwB,CAAA,IAC/E3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,cACN+C,OAAQ,OACRjD,KAAM5B,EACN6B,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,MAGD5C,EAAAC,KAAA,QAAA,CAsBN0F,WAAY,CAAC/C,EAAwB,KACnC3C,KAAKoF,QAOH5B,EAAA,CACAlB,KAAM,eACN+C,OAAQ,OACRhD,QAAQ,EACRI,OAAQ,QACLE,IAwBPgD,YAAa,CAAChD,EAAwB,KACpC3C,KAAKoF,QAOH5B,EAAA,CACAlB,KAAM,iBACN+C,OAAQ,OACRhD,QAAQ,EACRI,OAAQ,QACLE,MAGC5C,EAAAC,KAAA,UAAA,CAcR4F,WAAY,CAACjD,EAAwB,KACnC3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,WACN+C,OAAQ,MACR5C,OAAQ,QACLE,IAYPkD,iBAAkB,CAAClD,EAAwB,KACzC3C,KAAKoF,QAA2C5B,EAAA,CAC9ClB,KAAM,kBACN+C,OAAQ,MACR5C,OAAQ,QACLE,IAgBPmD,cAAe,CAACtF,EAAkCmC,EAAwB,CAAA,IACxE3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,kBACN+C,OAAQ,OACRjD,KAAM5B,EACN+B,KAAM,mBACNE,OAAQ,QACLE,MAGE5C,EAAAC,KAAA,WAAA,CAeT+F,YAAa,CACXvD,EA0BAG,EAAwB,CAAA,IAExB3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,YACN+C,OAAQ,MACR7C,QACAH,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IAqBPqD,cAAe,CAACC,EAAqCtD,EAAwB,CAAA,IAC3E3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,YACN+C,OAAQ,OACRjD,KAAM6D,EACN5D,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IAoBPuD,WAAY,CAACC,EAAYxD,EAAwB,CAAA,IAC/C3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,aAAa6D,IACnBd,OAAQ,MACR9C,KAAM,mBACNE,OAAQ,QACLE,IA6BPyD,cAAe,CAACD,EAAYF,EAAqCtD,EAAwB,CAAC,IACxF3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,aAAa6D,IACnBd,OAAQ,MACRjD,KAAM6D,EACN5D,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IAyBP0D,cAAe,CAACF,EAAYxD,EAAwB,CAAA,IAClD3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,aAAa6D,IACnBd,OAAQ,SACRhD,QAAQ,EACRI,OAAQ,QACLE,MAGF5C,EAAAC,KAAA,OAAA,CAULsG,KAAM,CAAC3D,EAAwB,KAC7B3C,KAAKoF,QAA6B5B,EAAA,CAChClB,KAAM,QACN+C,OAAQ,MACR5C,OAAQ,QACLE,IAgBP4D,wBAAyB,CAAC5D,EAAwB,KAChD3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,uBACN+C,OAAQ,MACR5C,OAAQ,QACLE,IAYP6D,UAAW,CACThE,EAIAG,EAAwB,CAAA,IAExB3C,KAAKoF,QAAwC5B,EAAA,CAC3ClB,KAAM,eACN+C,OAAQ,MACR7C,QACAC,OAAQ,QACLE,MAGE5C,EAAAC,KAAA,WAAA,CAkBTyG,YAAa,CACXjE,EAMAG,EAAwB,CAAA,IAExB3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,YACN+C,OAAQ,MACR7C,QACAD,KAAM,mBACNE,OAAQ,QACLE,IAoBP+D,kBAAmB,CAACC,EAAqChE,EAAwB,CAAA,IAC/E3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,iBACN+C,OAAQ,OACRjD,KAAMuE,EACNpE,KAAM,mBACNE,OAAQ,QACLE,IAwBPiE,eAAgB,CAACC,EAAmBC,EAAmBnE,EAAwB,CAAC,IAC9E3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,aAAauE,KAAaC,IAChCzB,OAAQ,OACR5C,OAAQ,QACLE,MAGD5C,EAAAC,KAAA,QAAA,CAeN+G,SAAU,CACRvE,EAQAG,EAAwB,CAAA,IAExB3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,SACN+C,OAAQ,MACR7C,QACAH,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IAqBPqE,cAAe,CAACL,EAAoChE,EAAwB,CAAA,IAC1E3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,eACN+C,OAAQ,OACRjD,KAAMuE,EACNtE,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IAaPsE,mBAAoB,CAACtE,EAAwB,KAC3C3C,KAAKoF,QAA6C5B,EAAA,CAChDlB,KAAM,sBACN+C,OAAQ,MACRhD,QAAQ,EACRI,OAAQ,QACLE,IAYPuE,MAAO,CAACC,EAA2BxE,EAAwB,CAAA,IACzD3C,KAAKoF,QAAoC5B,EAAA,CACvClB,KAAM,YACN+C,OAAQ,OACRjD,KAAM+E,EACN5E,KAAM,mBACNE,OAAQ,QACLE,IA6BPyE,WAAY,CAACjB,EAAYgB,EAA+BxE,EAAwB,CAAC,IAC/E3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,UAAU6D,IAChBd,OAAQ,MACRjD,KAAM+E,EACN9E,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IAyBP0E,WAAY,CAAClB,EAAYxD,EAAwB,CAAA,IAC/C3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,UAAU6D,IAChBd,OAAQ,SACRhD,QAAQ,EACRI,OAAQ,QACLE,IAqBP2E,UAAW,CAACnB,EAAYxD,EAAwB,CAAA,IAC9C3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,UAAU6D,UAChBd,OAAQ,OACRhD,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,MAGG5C,EAAAC,KAAA,YAAA,CAgBVuH,UAAW,CAACC,EAA+B7E,EAAwB,CAAA,IACjE3C,KAAKoF,QAMH5B,EAAA,CACAlB,KAAM,cACN+C,OAAQ,OACRjD,KAAMoF,EACNnF,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,MAGE5C,EAAAC,KAAA,WAAA,CAmBTyH,YAAa,CAAC9E,EAAwB,KACpC3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,YACN+C,OAAQ,MACRhD,QAAQ,EACRI,OAAQ,QACLE,IAqBP+E,cAAe,CAACC,EAAqChF,EAAwB,CAAA,IAC3E3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,YACN+C,OAAQ,MACRjD,KAAMuF,EACNtF,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IAaPiF,oBAAqB,CAACC,EAAgBlF,EAAwB,CAAA,IAC5D3C,KAAKoF,QAA6C5B,EAAA,CAChDlB,KAAM,sBAAsBuF,IAC5BxC,OAAQ,MACRhD,QAAQ,EACRI,OAAQ,QACLE,MAGD5C,EAAAC,KAAA,QAAA,CAWN8H,SAAU,CAACnF,EAAwB,KACjC3C,KAAKoF,QAAsC5B,EAAA,CACzClB,KAAM,SACN+C,OAAQ,MACRhD,QAAQ,EACRI,OAAQ,QACLE,IAyBPoF,WAAY,CAACC,EAA+BrF,EAAwB,CAAA,IAClE3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,SACN+C,OAAQ,OACRjD,KAAM4F,EACN3F,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IAaPsF,WAAY,CAAC9B,EAAY6B,EAA+BrF,EAAwB,CAAC,IAC/E3C,KAAKoF,QAAwC5B,EAAA,CAC3ClB,KAAM,UAAU6D,IAChBd,OAAQ,MACRjD,KAAM4F,EACN3F,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IAyBPuF,WAAY,CAAC/B,EAAYxD,EAAwB,CAAA,IAC/C3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,UAAU6D,IAChBd,OAAQ,SACRhD,QAAQ,EACRI,OAAQ,QACLE,MAGD5C,EAAAC,KAAA,QAAA,CA0BNmI,SAAU,CACR5F,EAWAC,EAQAG,EAAwB,CAAC,IAEzB3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,UAAUC,IAChB8C,OAAQ,MACR7C,QACAD,KAAM,mBACNE,OAAQ,QACLE,MAGE5C,EAAAC,KAAA,WAAA,CAeToI,cAAe,CAACzF,EAAwB,KACtC3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,mBACN+C,OAAQ,MACRhD,QAAQ,EACRI,OAAQ,QACLE,IAaP0F,cAAe,CAAC7H,EAAmCmC,EAAwB,CAAA,IACzE3C,KAAKoF,QAAqB5B,EAAA,CACxBlB,KAAM,mBACN+C,OAAQ,OACRjD,KAAM5B,EACN6B,QAAQ,EACRE,KAAM,oBACHI,IAoBP2F,cAAe,CACb9H,EAOAmC,EAAwB,CAAA,IAExB3C,KAAKoF,QAOH5B,EAAA,CACAlB,KAAM,mBACN+C,OAAQ,OACRjD,KAAM5B,EACN6B,QAAQ,EACRE,KAAM,sBACNE,OAAQ,QACLE,MAGA5C,EAAAC,KAAA,SAAA,CAuBPuI,OAAQ,CACN/H,EAOAmC,EAAwB,CAAA,IAExB3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,UACN+C,OAAQ,OACRjD,KAAM5B,EACN6B,QAAQ,EACRE,KAAM,sBACNE,OAAQ,QACLE,MAGF5C,EAAAC,KAAA,OAAA,CAeLwI,QAAS,CACPhG,EAMAG,EAAwB,CAAA,IAExB3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,QACN+C,OAAQ,MACR7C,QACAH,QAAQ,EACRI,OAAQ,QACLE,IA4BP8F,MAAO,CAACC,EAA8B/F,EAAwB,CAAA,IAC5D3C,KAAKoF,QAWH5B,EAAA,CACAlB,KAAM,qBACN+C,OAAQ,OACRjD,KAAMsG,EACNnG,KAAM,mBACNE,OAAQ,QACLE,IAaPgG,cAAe,CACbnG,EAMAG,EAAwB,CAAA,IAExB3C,KAAKoF,QAAwC5B,EAAA,CAC3ClB,KAAM,eACN+C,OAAQ,MACR7C,QACAH,QAAQ,EACRI,OAAQ,QACLE,MAGD5C,EAAAC,KAAA,QAAA,CAuBN4I,WAAY,CAACF,EAA+B/F,EAAwB,CAAA,IAClE3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,SACN+C,OAAQ,OACRjD,KAAMsG,EACNrG,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IA6BPkG,WAAY,CAAC1C,EAAYuC,EAA+B/F,EAAwB,CAAC,IAC/E3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,UAAU6D,IAChBd,OAAQ,MACRjD,KAAMsG,EACNrG,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IAyBPmG,WAAY,CAAC3C,EAAYxD,EAAwB,CAAA,IAC/C3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,UAAU6D,IAChBd,OAAQ,SACRhD,QAAQ,EACRI,OAAQ,QACLE,IAiBPoG,SAAU,CACRxG,EACAC,EAMAG,EAAwB,CAAC,IAEzB3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,UAAUC,IAChB8C,OAAQ,MACR7C,QACAH,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,MAGC5C,EAAAC,KAAA,UAAA,CAURgJ,WAAY,CAACrG,EAAwB,KACnC3C,KAAKoF,QAAmC5B,EAAA,CACtClB,KAAM,WACN+C,OAAQ,MACR5C,OAAQ,QACLE,MAGD5C,EAAAC,KAAA,QAAA,CAeNiJ,UAAW,CAACtG,EAAwB,KAClC3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,cACN+C,OAAQ,OACRhD,QAAQ,EACRI,OAAQ,QACLE,IAwBPuG,KAAM,CACJ3G,EACA4G,EACAD,EACAvG,EAAwB,CAExB,IAAA3C,KAAKoF,QAKH5B,EAAA,CACAlB,KAAM,UAAUC,KAAQ4G,IACxB9D,OAAQ,OACRjD,KAAM8G,EACN3G,KAAM,mBACNE,OAAQ,QACLE,KACJ,6PCx9EH,WAEO,SAAAyG,EAAgBC,EAAUC,GAC7B,KAAED,aAAoBC,GAClB,MAAA,IAAIC,UAAU,oCAEvB,CAEQ,SAAAC,EAAkBC,EAAQC,GACjC,IAAA,IAASC,EAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CACjC,IAAAE,EAAaH,EAAMC,GACZE,EAAAC,WAAaD,EAAWC,aAAc,EACjDD,EAAWE,cAAe,EACtB,UAAWF,IAAYA,EAAWG,UAAW,GACjDnJ,OAAOoJ,eAAeR,EAAQI,EAAW5I,IAAK4I,EAC/C,CACF,CAEQ,SAAAK,EAAaZ,EAAaa,EAAYC,GAMtC,OALHD,GAA8BX,EAAAF,EAAYe,UAAWF,GAElDtJ,OAAAoJ,eAAeX,EAAa,YAAa,CAC9CU,UAAU,IAELV,CACR,CAEQ,SAAAgB,EAAUC,EAAUC,GAC3B,GAA0B,mBAAfA,GAA4C,OAAfA,EAChC,MAAA,IAAIjB,UAAU,sDAGtBgB,EAASF,UAAYxJ,OAAO4J,OAAOD,GAAcA,EAAWH,UAAW,CACrExK,YAAa,CACXsE,MAAOoG,EACPP,UAAU,EACVD,cAAc,KAGXlJ,OAAAoJ,eAAeM,EAAU,YAAa,CAC3CP,UAAU,IAERQ,GAAYE,EAAgBH,EAAUC,EAC3C,CAED,SAASG,EAAgBC,GAIvB,OAHkBD,EAAA9J,OAAOgK,eAAiBhK,OAAOiK,eAAeC,OAAS,SAAyBH,GAChG,OAAOA,EAAEI,WAAanK,OAAOiK,eAAeF,EAClD,GAC2BA,EACxB,CAEQ,SAAAF,EAAgBE,EAAGK,GAKnB,OAJWP,EAAA7J,OAAOgK,eAAiBhK,OAAOgK,eAAeE,OAAS,SAAyBH,EAAGK,GAE5FL,OADPA,EAAEI,UAAYC,EACPL,CACb,GAC2BA,EAAGK,EAC3B,CAED,SAASC,IACP,GAAuB,oBAAZC,UAA4BA,QAAQC,UAAkB,OAAA,EACjE,GAAID,QAAQC,UAAUC,KAAa,OAAA,EACnC,GAAqB,mBAAVC,MAA6B,OAAA,EAEpC,IAEK,OADCC,QAAAlB,UAAUmB,QAAQC,KAAKN,QAAQC,UAAUG,QAAS,IAAI,WAAc,MACrE,CACR,OAAQvH,GACA,OAAA,CACR,CACF,CAED,SAAS0H,EAAuBC,GAC9B,QAAa,IAATA,EACI,MAAA,IAAIC,eAAe,6DAGpBD,OAAAA,CACR,CAEQ,SAAAE,EAA2BF,EAAMF,GACxC,GAAIA,IAAyB,iBAATA,GAAqC,mBAATA,GACvC,OAAAA,EACb,QAAwB,IAATA,EACH,MAAA,IAAIlC,UAAU,4DAGtB,OAAOmC,EAAuBC,EAC/B,CAED,SAASG,EAAaC,GACpB,IAAIC,EAA4Bd,IAEhC,OAAO,WACD,IACAe,EADAC,EAAQvB,EAAgBoB,GAG5B,GAAIC,EAA2B,CACzB,IAAAG,EAAYxB,EAAgB3K,MAAMH,YAEtCoM,EAASd,QAAQC,UAAUc,EAAOhH,UAAWiH,EACrD,MACiBF,EAAAC,EAAME,MAAMpM,KAAMkF,WAGtB,OAAA2G,EAA2B7L,KAAMiM,EAC9C,CACG,CAEQ,SAAAI,EAAeC,EAAQpL,GAC9B,MAAQL,OAAOwJ,UAAUkC,eAAed,KAAKa,EAAQpL,IAEpC,QADfoL,EAAS3B,EAAgB2B,MAIpB,OAAAA,CACR,CAED,SAASE,IAkBA,OAhBEA,EADc,oBAAZrB,SAA2BA,QAAQxJ,IACrCwJ,QAAQxJ,IAAIoJ,OAEZ,SAActB,EAAQvI,EAAUuL,GACjC,IAAAC,EAAOL,EAAe5C,EAAQvI,GAElC,GAAKwL,EAAL,CACA,IAAIC,EAAO9L,OAAO+L,yBAAyBF,EAAMxL,GAEjD,OAAIyL,EAAKhL,IACAgL,EAAKhL,IAAI8J,KAAKvG,UAAU0E,OAAS,EAAIH,EAASgD,GAGhDE,EAAKxI,KAPD,CAQnB,EAGWqI,EAAKJ,MAAMpM,KAAMkF,UACzB,CAED,IAAI2H,EAAmC,WACrC,SAASA,IACPzD,EAAgBpJ,KAAM6M,GAEfhM,OAAAoJ,eAAejK,KAAM,YAAa,CACvCmE,MAAO,CAAE,EACT6F,UAAU,EACVD,cAAc,GAEjB,CA4DM8C,OA1DP3C,EAAa2C,EAAS,CAAC,CACrB5L,IAAK,mBACLkD,MAAO,SAA0B5B,EAAMuK,EAAUnG,GACzCpE,KAAQvC,KAAK+M,YACZ/M,KAAA+M,UAAUxK,GAAQ,IAGpBvC,KAAA+M,UAAUxK,GAAMyK,KAAK,CACxBF,WACAnG,WAEH,GACA,CACD1F,IAAK,sBACLkD,MAAO,SAA6B5B,EAAMuK,GACpC,GAAEvK,KAAQvC,KAAK+M,UAMnB,IAFI,IAAAE,EAAQjN,KAAK+M,UAAUxK,GAElBoH,EAAI,EAAGuD,EAAID,EAAMrD,OAAQD,EAAIuD,EAAGvD,IACvC,GAAIsD,EAAMtD,GAAGmD,WAAaA,EAExB,YADMG,EAAAE,OAAOxD,EAAG,EAIrB,GACA,CACD1I,IAAK,gBACLkD,MAAO,SAAuBiJ,GAC5B,GAAMA,EAAM7K,QAAQvC,KAAK+M,UAAzB,CAOA,IAHA,IACIM,EADQrN,KAAK+M,UAAUK,EAAM7K,MACT+K,QAEf3D,EAAI,EAAGuD,EAAIG,EAAYzD,OAAQD,EAAIuD,EAAGvD,IAAK,CAC9C,IAAA4D,EAAWF,EAAY1D,GAEvB,IACO4D,EAAAT,SAASrB,KAAKzL,KAAMoN,EAC9B,OAAQpJ,GACCwJ,QAAAC,UAAU/J,MAAK,WACf,MAAAM,CACpB,GACW,CAEGuJ,EAAS5G,SAAW4G,EAAS5G,QAAQ+G,MACvC1N,KAAK2N,oBAAoBP,EAAM7K,KAAMgL,EAAST,SAEjD,CAED,OAAQM,EAAMQ,gBArBb,CAsBF,KAGIf,CACX,CAtEyC,GAwEnCgB,WAAqCC,GACvCxD,EAAUuD,EAAaC,GAEnB,IAAAC,EAASjC,EAAa+B,GAE1B,SAASA,IACH,IAAAG,EAgCG,OA9BP5E,EAAgBpJ,KAAM6N,IAEdG,EAAAD,EAAOtC,KAAKzL,OAOT+M,WACDF,EAAApB,KAAKC,EAAuBsC,IAKtCnN,OAAOoJ,eAAeyB,EAAuBsC,GAAQ,UAAW,CAC9D7J,OAAO,EACP6F,UAAU,EACVD,cAAc,IAEhBlJ,OAAOoJ,eAAeyB,EAAuBsC,GAAQ,UAAW,CAC9D7J,MAAO,KACP6F,UAAU,EACVD,cAAc,IAEhBlJ,OAAOoJ,eAAeyB,EAAuBsC,GAAQ,SAAU,CAC7D7J,WAAO,EACP6F,UAAU,EACVD,cAAc,IAETiE,CACR,CAsBMH,OApBP3D,EAAa2D,EAAa,CAAC,CACzB5M,IAAK,WACLkD,MAAO,WACE,MAAA,sBACR,GACA,CACDlD,IAAK,gBACLkD,MAAO,SAAuBiJ,GACT,UAAfA,EAAM7K,OACRvC,KAAKiO,SAAU,EAEa,mBAAjBjO,KAAKkO,SACTlO,KAAAkO,QAAQzC,KAAKzL,KAAMoN,IAIvBZ,EAAA7B,EAAgBkD,EAAYxD,WAAY,gBAAiBrK,MAAMyL,KAAKzL,KAAMoN,EAChF,KAGIS,CACR,EAAChB,GACEhL,EAA2C,WAC7C,SAASA,IACPuH,EAAgBpJ,KAAM6B,GAIfhB,OAAAoJ,eAAejK,KAAM,SAAU,CACpCmE,MAAO,IAAI0J,EACX7D,UAAU,EACVD,cAAc,GAEjB,CA0DMlI,OAxDPqI,EAAarI,EAAiB,CAAC,CAC7BZ,IAAK,QACLkD,MAAO,SAAegK,GAChB,IAAAf,EAEA,IACMA,EAAA,IAAIgB,MAAM,QACnB,OAAQpK,GACiB,oBAAbqK,SACJA,SAASC,aAMJlB,EAAAiB,SAASC,YAAY,UACvBC,UAAU,SAAS,GAAO,IALhCnB,EAAQiB,SAASG,qBACXjM,KAAO,QAQP6K,EAAA,CACN7K,KAAM,QACNkM,SAAS,EACTC,YAAY,EAGjB,CAED,IAAIC,EAAeR,EAEnB,QAAqB,IAAjBQ,EACE,GAAoB,oBAAbN,UACMM,EAAA,IAAIC,MAAM,+BACZC,KAAO,kBAEhB,IACaF,EAAA,IAAIG,aAAa,mCACjC,OAAQC,IAGQJ,EAAA,IAAIC,MAAM,+BACZC,KAAO,YACrB,CAIL7O,KAAK4B,OAAOuM,OAASQ,EAChB3O,KAAA4B,OAAOoN,cAAc5B,EAC3B,GACA,CACDnM,IAAK,WACLkD,MAAO,WACE,MAAA,0BACR,KAGItC,CACX,CAtEiD,GA+E/C,SAASoN,EAAetD,GACtB,OAAIA,EAAKuD,0CACPC,QAAQC,IAAI,sFACL,GAUsB,mBAAjBzD,EAAK0D,UAA2B1D,EAAK0D,QAAQhF,UAAUkC,eAAe,YAAcZ,EAAK9J,eACxG,CAgBD,SAASyN,EAAwBC,GAC3B,mBAAsBA,IACTA,EAAA,CACbpP,MAAOoP,IAIP,IAAAC,EAAgBD,EAChBpP,EAAQqP,EAAcrP,MACtBsP,EAAwBD,EAAcH,QACtCK,OAA0C,IAA1BD,EAAmCtP,EAAMkP,QAAUI,EACnEE,EAAwBH,EAAc3N,gBACtC+N,EAAwBJ,EAAcN,yCACtCA,OAAqE,IAA1BU,GAA2CA,EAE1F,IAAKX,EAAe,CAClB9O,MAAOA,EACPkP,QAASK,EACT7N,gBAAiB8N,EACjBT,6CAEO,MAAA,CACL/O,MAAOA,EACPkP,WAIJ,IAAIA,EAAUK,GAYVL,IAAYA,EAAQhF,UAAUkC,eAAe,WAAa2C,MAClDG,EAAA,SAAiB3O,EAAOmP,GAC5B,IAAAjO,EAEAiO,GAAQA,EAAKjO,SACfA,EAASiO,EAAKjO,cAOPiO,EAAKjO,QAGd,IAAIwD,EAAU,IAAIsK,EAAchP,EAAOmP,GAWhC,OATHjO,GACKf,OAAAoJ,eAAe7E,EAAS,SAAU,CACvC4E,UAAU,EACVF,YAAY,EACZC,cAAc,EACd5F,MAAOvC,IAIJwD,CACf,GAEciF,UAAYqF,EAAcrF,WAGpC,IAAIyF,EAAY3P,EAgDT,MAAA,CACLA,MA/CmB,SAAwBO,EAAOmP,GAC9C,IAAAjO,EAASyN,GAAWA,EAAQhF,UAAU0F,cAAcrP,GAASA,EAAMkB,OAASiO,EAAOA,EAAKjO,YAAS,EAErG,GAAIA,EAAQ,CACN,IAAAoO,EAEA,IACWA,EAAA,IAAIlB,aAAa,UAAW,aAC1C,OAAQC,IAGMiB,EAAA,IAAIpB,MAAM,YACZC,KAAO,YACnB,CAGD,GAAIjN,EAAOqM,QACF,OAAAT,QAAQyC,OAAOD,GAIxB,IAAIE,EAAe,IAAI1C,SAAQ,SAAU2C,EAAGF,GACnCrO,EAAAwO,iBAAiB,SAAS,WAC/B,OAAOH,EAAOD,EAC1B,GAAa,CACDtC,MAAM,GAElB,IAae,OAXHmC,GAAQA,EAAKjO,eAORiO,EAAKjO,OAIP4L,QAAQ6C,KAAK,CAACH,EAAcJ,EAAUpP,EAAOmP,IACrD,CAEM,OAAAC,EAAUpP,EAAOmP,EAC9B,EAIMR,UAEH,CAhKqB,oBAAXiB,QAA0BA,OAAOC,cAG1C1O,EAAgBwI,UAAUiG,OAAOC,aAAe,kBACpC1C,EAAAxD,UAAUiG,OAAOC,aAAe,eA8J9C,SAAW5E,GAEL,GAACsD,EAAetD,GAIhB,GAACA,EAAKxL,MAAN,CAKA,IAAAqQ,EAAkBlB,EAAwB3D,GAC1CxL,EAAQqQ,EAAgBrQ,MACxBkP,EAAUmB,EAAgBnB,QAE9B1D,EAAKxL,MAAQA,EACbwL,EAAK0D,QAAUA,EACRxO,OAAAoJ,eAAe0B,EAAM,kBAAmB,CAC7C3B,UAAU,EACVF,YAAY,EACZC,cAAc,EACd5F,MAAOtC,IAEFhB,OAAAoJ,eAAe0B,EAAM,cAAe,CACzC3B,UAAU,EACVF,YAAY,EACZC,cAAc,EACd5F,MAAO0J,GAlBR,MAFCsB,QAAQsB,KAAK,oEAsBd,CA7BH,CA6BmB,oBAAT9E,KAAuBA,KAAO+E,EAE1C,IC1hBO,MAAMC,EAAQ,CACnBC,EACAlQ,EACAmP,IACG3N,EAAAlC,KAAA,MAAA,YACH,MAAM6Q,EAAWD,EAAKE,aAAeF,EAAKE,cAEpCzQ,EAAU,IAAI0Q,QAAQvN,EAAA,CAC1BwN,cAAeH,EAAW,UAAUA,IAAa,IAC9C,MAAAhB,OAAAA,EAAAA,EAAMxP,UAGNA,EAAQsB,IAAI,kBAAkBtB,EAAQ2B,OAAO,iBAG5C,MAAAiP,QAAa9Q,MAAMO,EAAO6C,OAC3BsM,GAD2B,CAE9BxP,aAGE,IAAC4Q,EAAKnN,GAAI,CAEZ,MAAMoN,SAAmBD,EAAKC,OAAOnN,OAAM,WAAc,CAAA,EAEzD,IAAIoN,GAAQ,EAUR,GATCP,EAAAQ,iBACIR,EAAKQ,SAASzP,MAAMZ,QAAO,CAAOsQ,EAASC,IAASpP,EAAAlC,KAAA,MAAA,kBACnDqR,GACoB,IAAtBH,EAAKI,EAAKC,gBACND,EAAKE,QAAQN,GACXC,GAAA,EACV,KACC3D,QAAQC,YAET0D,EAAcR,OAAAA,EAAMC,EAAMlQ,EAAOmP,GAC/B,MAYD,SAAY4B,EAAcjR,GAC3B,MAAAuO,EAAM,IAAI2C,EAKT,OAJP3C,EAAI4C,QAAUnR,EAAKoR,KAAOpR,EAAKmR,SAAW,cAC1C5C,EAAI0C,KAAOA,EACX1C,EAAIvO,KAAOA,EACX2O,QAAQtL,MAAMkL,GACPA,CACT,CAnBU8C,CAAYZ,EAAKa,OAAQZ,EACjC,CAEO,OAAAD,CACT,IAEO,MAAMS,UAAuB9C,MAA7B,WAAA/O,GAAAoF,SAAAC,WACUnF,EAAAC,KAAA,OAAA,GACGD,EAAAC,KAAA,UAAA,eAClBD,EAAAC,KAAA,OAAA,EC1CK,MAAM+R,UAAYC,EAGvB,WAAAnS,CAAY+Q,GACJ3L,MAAA,CACJvC,QAASkO,EAAKqB,QACd3O,YAAa,CAAC5C,EAAOmP,IAASc,EAAMC,EAAMlQ,EAAOmP,KAL7C9P,EAAAC,KAAA,SAQNA,KAAKkS,MAAQtB,CACf,CAOA,aAAAuB,GACQ,MAAAzJ,EAAO1I,KAAKkS,MAAME,SACxB,IAAK,MAAA1J,OAAA,EAAAA,EAAMmG,QAAe,MAANnG,OAAM,EAAAA,EAAAlB,OAC1B,MAAO,CAAEqH,KAAMnG,EAAKmG,KAAMrH,MAAOkB,EAAKlB,MACxC,EC1BF,IAAI6K,EAAU,CACZ,IAAK,QACL,IAAK,OACL,IAAK,OACL,IAAK,SACL,IAAK,SAEHC,EAAY,CACd,QAAS,IACT,OAAQ,IACR,OAAQ,IACR,SAAU,IACV,QAAS,KAEPC,EAAW,kCACXC,EAAa,WAEjB,SAASC,EAAgBC,GACvB,OAAOL,EAAQK,EACjB,CACA,SAASC,EAAkBD,GACzB,OAAOJ,EAAUI,EACnB,CAEA,SAASE,EAAYC,GACZ,OAAQ,MAARA,EAAe,GAAKC,OAAOD,GAAME,QAAQP,EAAYC,EAC9D,CAEA,SAASO,EAAcC,GACd,OAAQ,MAARA,EAAe,GAAKH,OAAOG,GAAMF,QAAQR,EAAUI,EAC5D,CAEWC,EAAAjM,QAAUqM,EAAarM,QAAU,GAE5C,IAAAuM,EAAiB,CACfC,OAAQP,EACRQ,OAAQR,EACRS,OAAQL,EACRM,SAAUN,EACVO,QAAS,iBCpBX,IAAAC,EAnBA,SAASC,EAAYxH,GAInB,IAHA,IACIqF,EACArQ,EAFAgM,EAAQrI,MAAMyF,UAAUiD,MAAM7B,KAAKvG,UAAW,GAG3C+H,EAAMrD,QAEX,IAAK3I,KADLqQ,EAAOrE,EAAMyG,QAEPpC,EAAK/E,eAAetL,KAC8B,oBAAhDJ,OAAOwJ,UAAUsJ,SAASlI,KAAKQ,EAAOhL,IACjCgL,EAAAhL,GAAOwS,EAAWxH,EAAOhL,GAAMqQ,EAAKrQ,IAEpCgL,EAAAhL,GAAOqQ,EAAKrQ,IAKpB,OAAAgL,CACT,ECjBA2H,EAAiB,SAAoBC,GACnC,MAAyB,iBAAXA,EAAsBA,EAAOC,cAAgBD,CAC7D,ECES,SAAAE,EAAOC,EAAa1C,GAEpB,OADP0C,EAAY1C,IAAQ,EACb0C,CACT,CAEA,IAAAC,EATA,SAAgBC,GACd,OAAOA,EAAKnT,OAAOgT,EAAO,CAAE,EAC9B,ECCAI,EAAiB,CACfC,KAJUC,EACD,CAAC,aAAc,OAAQ,OAAQ,OAAQ,WAAY,MAAO,YCErEC,EAAiB,CACfC,MAJUF,EACA,CAAC,OAAQ,KAAM,MAAO,KAAM,MAAO,MAAO,QAAS,OAAQ,WAAY,OAAQ,UCDvFG,EAAKH,EACLT,EAAYa,EAEZH,EAAWI,EACXC,EAAS,6FACTC,EAAO,4BACPC,EAAS,0EACTC,EAAO,KACPC,EAAU,UA8Hd,ICtIIP,EAAKH,EACLT,EAAYa,EACZN,EAAaa,EACbV,EAAWI,EAsIf,ICxIIzQ,EAASwQ,EACTQ,EFgBKA,SAAQhC,EAAMzB,GAKrB,IAJA,IAEI0D,EAFAjI,EATN,WACE,IAAIA,EAAQ,GAIL,OAHDA,EAAAkI,SAAW,WACR,OAAAlI,EAAMA,EAAMrD,OAAS,EAChC,EACSqD,CACT,CAGcmI,GACRC,EAAOpC,EAGJA,OAKP,SAASqC,IACCJ,GAAA,EAWV,WAC4B,YAAtBjC,EAAKsC,OAAO,EAAG,IAoBfC,EAAQvC,EAAKwC,QAAQ,YACZ,IACPjE,EAAQvL,SACVuL,EAAQvL,QAAQgN,EAAKyC,UAAU,EAAGF,IAE7BvC,EAAAA,EAAKyC,UAAUF,EAAQ,GACtBN,GAAA,GAxBCH,EAAQY,KAAK1C,GACtB2C,EAAUhB,EAAMiB,GACPf,EAAKa,KAAK1C,IACnB2C,EAAUjB,EAAQmB,GActB,IACMN,GAUN,WACE,IAAKN,EACH,OAEE,IAAArC,EACA2C,EAAQvC,EAAKwC,QAAQ,KACrBD,GAAS,GACJ3C,EAAAI,EAAKyC,UAAU,EAAGF,GAClBvC,EAAAA,EAAKyC,UAAUF,KAEf3C,EAAAI,EACAA,EAAA,IAELzB,EAAQ0D,OACV1D,EAAQ0D,MAAMrC,EAEjB,GAtCA,IAjBC,IAAIkD,EAAO9C,IAASoC,EACbA,EAAApC,EAEH8C,IACK9C,EAAA,GAEV,CAaQ,SAAA2C,EAAWI,EAAOf,GACrB,IAAAvC,EAAQO,EAAKP,MAAMsD,GACnBtD,IACFO,EAAOA,EAAKyC,UAAUhD,EAAM,GAAG9I,QAC/B8I,EAAM,GAAGK,QAAQiD,EAAOf,GAChBC,GAAA,EAEX,CA+BD,SAASY,EAAeG,EAAKC,EAASC,EAAMC,GAC1C,IAAIC,EAAQ,CAAA,EACRC,EAAM1C,EAAUsC,GAChBK,EAAIjC,EAASC,MAAM+B,MAAUF,EAE5BD,EAAApD,QAAQ8B,GASb,SAAuBnC,EAAO7D,EAAM2H,EAAmBC,EAAmBC,GAEtEL,EAAMxH,QADkB,IAAtB2H,QAAsD,IAAtBC,QAAkD,IAAlBC,OACpD,EAEAlC,EAAGnB,OAAOmD,GAAqBC,GAAqBC,GAAiB,GAEtF,IAbIH,GACHtJ,EAAMD,KAAKsJ,GAET9E,EAAQmF,OACFnF,EAAAmF,MAAML,EAAKD,EAAOE,EAU7B,CAEQ,SAAAV,EAAaI,EAAKC,GACrB,IAAAvM,EACAiN,EAAM,EACNN,EAAM1C,EAAUsC,GACpB,GAAII,EACF,IAAKM,EAAM3J,EAAMrD,OAAS,EAAGgN,GAAO,GAC9B3J,EAAM2J,KAASN,EADkBM,KAMzC,GAAIA,GAAO,EAAG,CACZ,IAAKjN,EAAIsD,EAAMrD,OAAS,EAAGD,GAAKiN,EAAKjN,IAC/B6H,EAAQqF,KACFrF,EAAAqF,IAAI5J,EAAMtD,IAGtBsD,EAAMrD,OAASgN,CAChB,CACF,IACH,EEjIIE,EDEKA,SAAWC,EAAQpQ,GAEtB,IAAAqQ,EACApM,EAAIjE,GAAW,GAIZ,WAAA,CACLgQ,MASO,SAAOV,EAAKI,EAAOD,GACtB,IAAAE,EAAM1C,EAAUqC,GAEpB,GAAIe,EAAQC,SACG,YAAbC,EAAOZ,GAET,IAA+C,KAA1C1L,EAAEuM,aAAe,IAAI1B,QAAQa,GACnB,YAAbY,EAAOZ,GAEL,GAAA1L,EAAEjG,SAAWiG,EAAEjG,OAAO,CAAEsR,IAAKK,EAAKD,UACvB,YAAba,EAAOZ,GAGTc,EAAI,KACJA,EAAId,GACJzV,OAAOC,KAAKuV,GAAOgB,SAGnB,SAAgBpW,GACV,IAAAkD,EAAQkS,EAAMpV,GACdqW,GAAa1M,EAAE2M,gBAAkB,CAAA,GAAIjB,IAAQ,GAC7CkB,GAAW5M,EAAE6M,mBAAqB,CAAA,GAAInB,IAAQ,GAE9CoB,EAAO9D,EAAU3S,IACR,UAATyW,IAAkD,IAA9BF,EAAQ/B,QAAQiC,IAC9BvT,EAAAA,EAAMwT,MAAM,KAAKhT,QAc3B,SAAuBiT,GACrB,OAAON,IAA8C,IAAjCA,EAAU7B,QAAQmC,EACvC,IAhB+CnT,KAAK,KAAKoT,QAC1CjO,QAEoB,IAA1B4N,EAAQ/B,QAAQiC,MAA2C,IAA1BvD,EAAWC,KAAKsD,IAiC/D,SAAkB7E,GACZ8D,IAAAA,EAAQ9D,EAAK,GACb8D,GAAU,MAAVA,GAA2B,MAAVA,EACZ,OAAA,EAEL,IAAAmB,EAAQjF,EAAK4C,QAAQ,KACzB,IAAkB,IAAdqC,EACK,OAAA,EAEL,IAAAC,EAAelF,EAAK4C,QAAQ,KAC5B,IAAuB,IAAvBsC,GAAuBD,EAAQC,EAC1B,OAAA,EAEL,IAAAC,EAAOnF,EAAK4C,QAAQ,KACpB,OAAe,IAAfuC,GAAeF,EAAQE,GAGpBpN,EAAEqN,eAAeC,KAAKC,GAE7B,SAASA,EAASC,GAChB,OAAsC,IAA/BvF,EAAK4C,QAAQ2C,EAAS,IAC9B,CACF,CAvDgFC,CAAQlU,OAGnFiT,EAAI,KACJA,EAAInW,GACiB,iBAAVkD,IACTiT,EAAI,MACAA,EAAA5C,EAAGrB,OAAOhP,IACdiT,EAAI,MAMT,IA1BGA,EAAAhB,EAAQ,KAAO,IA2BpB,EAnDCS,IAqDF,SAAcZ,GACR,IAAAK,EAAM1C,EAAUqC,IACiC,KAAtCrL,EAAEuM,aAAe,IAAI1B,QAAQa,KAEjB,IAArBU,EAAQC,UACVG,EAAI,MACJA,EAAId,GACJc,EAAI,MAKNkB,EAAShC,EAEZ,EAlECpB,MA4FF,SAAgBrC,IACW,IAArBmE,EAAQC,UACVG,EAAIxM,EAAE2N,cAAgB3N,EAAE2N,cAAc1F,GAAQA,EAEjD,GA7FD,SAASuE,EAAKjT,GACZ4S,EAAO/J,KAAK7I,EACb,CA6FD,SAAS+S,EAAQjB,GACX3B,EAASC,MAAM0B,MAGM,IAArBe,EAAQC,SACVD,EAAU,CAAEC,SAAUhB,EAAKuC,MAAO,GACzBxB,EAAQC,WAAahB,GACtBe,EAAAwB,QAEX,CAED,SAASF,EAAUrC,GACbe,EAAQC,WAAahB,KACjBe,EAAQwB,OAAS,MAI1B,CAED,SAASC,IACPzB,EAAU,CAAEC,UAAU,EAAOuB,MAAO,EACrC,CACH,ECnIIE,ECJW,CACbjB,kBAAmB,CACjBkB,EAAG,CAAC,OAAQ,OAAQ,SAAU,QAAS,cACvCC,OAAQ,CAAC,kBAAmB,cAAe,OAC3CC,IAAK,CAAC,MAAO,MAAO,QAAS,eAE/BtB,eAAgB,CAAE,EAClBU,eAAgB,CAAC,OAAQ,QAAS,UAClCd,YAAa,CACX,IAAK,OAAQ,UAAW,IAAK,aAAc,KAAM,UAAW,OAAQ,MAAO,UAAW,MAAO,KAC7F,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,IAAK,MAAO,MAAO,MAAO,KAAM,OAAQ,OAClF,KAAM,IAAK,MAAO,UAAW,OAAQ,SAAU,SAAU,MAAO,UAAW,MAAO,QAClF,QAAS,KAAM,KAAM,QAAS,KAAM,IAAK,MAE3CxS,OAAQ,MDRD,SAAAmU,EAAQ7F,EAAMtM,EAASoS,GAC9B,IAAIhC,EAAS,GACTiC,GAA2B,IAAXD,EAAkBpS,EAAU1C,EAAO,CAAE,EAAEyU,EAAU/R,GACjE6K,EAAUsF,EAAUC,EAAQiC,GAIzB,OAFP/D,EAAOhC,EAAMzB,GAENuF,EAAOtS,KAAK,GACrB,CAEAqU,EAAOJ,SAAWA,YACDI,GEjBXG,EAAgB,CACpB1B,eAAgB,CAAC,EAKjBU,eAAgB,CACd,OACA,QACA,SACA,QAEFd,YAAa,CACX,IACA,OACA,UACA,IACA,aACA,KACA,UACA,OACA,MACA,UACA,MACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,IACA,MACA,MACA,MACA,KACA,OACA,OACA,KACA,IACA,MACA,UACA,OACA,SACA,SACA,MACA,UACA,MACA,QACA,QACA,KACA,KACA,QACA,KACA,IACA,MAEFM,kBAAmB,CACjB,IAAK,CAAC,QAAS,aACfkB,EAAG,CAAC,OAAQ,OAAQ,SAAU,aAAc,OAC5CE,IAAK,CAAC,MAAO,MAAO,QAAS,eAAgB,aAAc,WAAY,QAAS,WAEhFpH,KAAM,CAAC,SACPyH,KAAM,CAAC,QAAS,UAElBvU,OAASwU,IAES,CACd,CAAC,OAAQ,0BACT,CAAC,OAAQ,eACT,CAAC,MAAO,eAEF9B,SAAQ,EAAEpB,EAAKmD,MACjBD,EAAKlD,MAAQA,GAASkD,EAAK9C,MAAMgD,QAAWD,EAAezD,KAAKwD,EAAK9C,MAAMgD,eACtEF,EAAK9C,MAAMgD,KACpB,IAKa,SAAbF,EAAKlD,KACHkD,EAAK9C,MAAMiD,QACZ,kCAAkC3D,KAAKwD,EAAK9C,MAAMiD,eAE5CH,EAAK9C,MAAMiD,OAGb,IAIJ,SAASC,GAASC,GAGhBV,OAAAA,EAAOU,EAASP,EACzB,wBCjGkFQ,QAGzE,WAEA,SAAAC,EAAqBC,EAAIC,GAC1BA,OAA0BD,EAA1BC,EAAS,CAAEH,QAAS,CAAA,GAAiBG,EAAOH,SAAUG,EAAOH,OACpE,CAEG,IAAAI,EAAUH,GAAqB,SAAUE,GAGzC,IAAA3T,EAAU2T,EAAOH,QAAU,WAC9B,OAAO,IAAIK,OAAO,MAAQ7T,EAAQ8T,OAAOC,OAAS,QAAU/T,EAAQgU,QAAQD,OAAS,IAAK,KAC3F,EAEA/T,EAAQ8T,KAAO,WACP,MAAA,sBACR,EAEA9T,EAAQgU,MAAQ,WACR,MAAA,sBACR,CACA,IAEIC,EAAgB,CAAC,SAAU,SAAU,SAAU,SAAU,SAAU,SAAU,SAAU,SAAU,SAAU,SAAU,SAAU,SAAU,UAmC7I,SAASC,EAAUC,GACjB,MAAQ,kCAAsCA,EAAK,SACpD,CAEM,OArCK,SAAU1Z,EAAO2Z,QACd,IAARA,IAAiBA,EAAM,CAAA,GAC5B,IAAIC,EAASD,EAAIC,YAAwB,IAAXA,IAA6BA,EAAAJ,GAE3D,IAAI1E,EAAQ,EACR+E,EAAQ,CAAA,EAIRC,EAAK,IAAIV,OAAQ,IAHR,wFAGsBE,OAAU,IAF3B,IAE8CA,OAAU,MAASH,IAAUG,OAAU,IAAM,OAC7G,OAAOtZ,EACNqS,QAAQyH,GAAI,SAAUC,EAAGC,EAAMN,GAC9B,GAAIA,EACF,OAAOD,EAAUC,GAGnB,GAAa,MAATM,EACK,MAAA,OAEL,IAAAC,EACAJ,EAAMG,GACRC,EAAQJ,EAAMG,IAEdC,EAAQL,EAAO9E,GACf+E,EAAMG,GAAQC,GAGhB,IAAIvD,EAAM,wBAA2BuD,EAAQ,KAAQD,EAAO,UAErD,OADPlF,IAAUA,EAAQ8E,EAAO1Q,OAClBwN,CACX,GACA,CAQA,CAlEkFwD,0BCC3E,SAASC,GAAWpJ,GACzB,OAAOqJ,GAAOrJ,EAChB,CCIO,SAASsJ,GAAYpU,GACpB,MAAAqU,EAAW,IAAIC,SAAOC,SAIrB,OAHPF,EAASG,KAAOC,GAAmBJ,EAAUA,EAASG,MACtDH,EAASvJ,KAAO4J,KAChBL,EAASM,MAAQC,GAAoBP,EAAUA,EAASM,MAAO3U,GACxDqU,CACT,CAEA,MAAMI,GACJ,CAACJ,EAAeQ,IAChB,CAACC,EAAcC,EAAe7I,KACtB,MAOA8I,EAPgB,CAACR,IACjB,IACK,OAAA,IAAIS,IAAIT,GAAMU,MAAA,CACf,MAAA7X,GACC,MAAA,EACT,GAEuB8X,CAAcL,KAAUM,OAAOC,SAASH,OAEjE,OADaL,EAAgB/P,KAAKuP,EAAUS,EAAMC,EAAO7I,GAC7CE,QACV,OACA,sBAAuB4I,EAA0D,GAAvC,wCAAyC,EAInFN,GACJ,IACA,CAACpB,EAAegC,KAER,MAAAC,EAAYD,GAAO,YACzB,IAAIE,EAAYlC,EAShB,OARK8B,OAAeK,KACdF,GAAaH,OAAeK,KAAKC,YAAYH,KAC/CC,EAAaJ,OAAeK,KAAKE,UAAUJ,EAAUjC,GAAO9V,OAG9DgY,EAAYtB,GAAWZ,GAIvB,aAAaiC,mCACiBA,MAAaC,EAAUpJ,QAAQ,SAAU,qBAAI,EAK3EwI,GACJ,CACEP,EACAuB,GACEC,iBAEJ,CAACf,EAAcC,EAAsB7I,KACnC,MAAMI,EAAOsJ,EAAiB9Q,KAAKuP,EAAUS,EAAMC,EAAO7I,GAC1D,OAAK2J,EACe,WAAhBA,IAAqD,IAAxBA,EACxBvJ,EAAKF,QAAQ,SAAU,yCACZ,aAAhByJ,EACKvJ,EAAKF,QAAQ,SAAU,0BAA0BA,QAAQ,OAAQ,aACnEE,EALkBA,CAKlB,EC3DP,IAAA5J,GACAoT,GAAwB,GAE5B,MAAMC,GAA+B,CACnCC,KAAK,EACLC,QAAQ,EACRC,OAAO,GAIF,SAASC,KACP,OAAAzT,EACT,CAgCA,SAAwB4R,GAAO8B,SAC7B,IAAIC,EAAgB,OAAA/a,EAAA6a,WAAA,EAAA7a,EAAegb,MAAMF,GACpCC,IAEHA,EAaJ,SAAsBD,GACpB,OACEA,EAEGhK,QACC,kCACA,CAAC5C,EAAGsB,IAAS,cAAcoJ,GAAWpJ,oBAGvCsB,QAAQ,wBAAwB,CAAC5C,EAAG+M,EAAKC,IAAW,aAAaA,WAAgBD,UACjFnK,QACC,uBACA,CAAC5C,EAAG0C,EAAMsI,IAAS,YAAYA,sBAAyBtI,UAEzDE,QAAQ,MAAO,OAEtB,CA7BoBqK,CAAaL,IAG3B,IAAAM,EAAO9D,GAASyD,GAOb,OAJGP,GAAApF,SAASiG,IACO,mBAAbA,IAAyBD,EAAOC,EAASD,GAAI,IAGnDA,CACT,CC7DO,SAASE,MAAgBC,GACxB,MAAAC,EAAYC,GAAaA,GAAsB,iBAARA,GAAoBA,EAAI7d,cAAgBgB,OAErF,OAAO2c,EAAQzc,QAAO,CAAC4c,EAAMD,KAC3B7c,OAAOC,KAAY,MAAP4c,EAAOA,EAAA,CAAE,GAAErG,SAASpW,IAE9B,GAAY,cAARA,GAA+B,gBAARA,GAAiC,cAARA,EAClD,OAGI,MAAA2c,EAAOD,EAAK1c,GACZ4c,EAAOH,EAAIzc,GAEb2D,MAAMC,QAAQ+Y,IAAShZ,MAAMC,QAAQgZ,GACvCF,EAAK1c,GAAO2c,EAAKE,UAAUD,GAClBJ,EAASG,IAASH,EAASI,GACpCF,EAAK1c,GAAOsc,GAAUK,EAAMC,GAE5BF,EAAK1c,GAAO4c,CACd,IAGKF,IACN,CAAE,EACP,CCpBO,MAAMI,GAOX,WAAAle,CAAsBme,GANKje,EAAAC,KAAA,WAAA,GACnBD,EAAAC,KAAA,iBACAD,EAAAC,KAAA,WAA0B,IAC1BD,EAAAC,KAAA,WAAyB,IACzBD,EAAAC,KAAA,QAEcA,KAAAge,OAAAA,CAAwC,CAE9D,UAAAC,GACE,OAAOje,KAAKke,OACd,CAEA,UAAAC,CAAWC,GACTpe,KAAKke,QAAUE,CACjB,CAEA,gBAAAC,GACE,OAAOre,KAAKse,aACd,CAEA,gBAAAC,CAAiBH,GACfpe,KAAKse,cAAgBF,CACvB,CAKA,WAAArY,GACE,OAAO/F,KAAKwe,QACd,CAEA,aAAAC,CAAc9b,GACP3C,KAAAge,OAAOU,QAAQ,aAAc/b,EACpC,CAEA,WAAAgc,CAAYxY,GACV,OAAOnG,KAAKwe,SAASI,MAAMC,GAAMA,EAAE1Y,KAAOA,GAC5C,CAEA,aAAA2Y,GACE9e,KAAKwe,SAAW,GAChBxe,KAAKge,OAAOU,QAAQ,cAAe1e,KAAKwe,SAC1C,CAEA,YAAAO,CAAaC,GACNhf,KAAAge,OAAOU,QAAQ,YAAaM,GAE5Bhf,KAAAwe,SAASxR,QAAQgS,GAEtBhf,KAAKge,OAAOU,QAAQ,cAAe1e,KAAKwe,SAC1C,CAEA,aAAAS,CAAchZ,GACPjG,KAAAwe,SAASxR,KAAK/G,GAEdjG,KAAAge,OAAOU,QAAQ,mBAAoBzY,GACxCjG,KAAKge,OAAOU,QAAQ,cAAe1e,KAAKwe,SAC1C,CAEA,aAAApY,CAAcH,GACZjG,KAAKwe,SAAWxe,KAAKwe,SAASja,KAAKsa,GAC7BA,EAAE1Y,KAAOF,EAAQE,GAAWF,EACzB4Y,IAGJ7e,KAAAge,OAAOU,QAAQ,kBAAmBzY,GACvCjG,KAAKge,OAAOU,QAAQ,cAAe1e,KAAKwe,SAC1C,CAEA,aAAAnY,CAAcF,GACN,MAAAF,EAAUjG,KAAKwe,SAASI,MAAMC,GAAMA,EAAE1Y,KAAOA,IACnD,IAAKF,EAAS,MAAM,IAAI2I,MAAM,WAAWzI,eACpCnG,KAAAwe,SAAWxe,KAAKwe,SAAS7Z,QAAQka,GAAMA,EAAE1Y,KAAOA,IAEhDnG,KAAAge,OAAOU,QAAQ,kBAAmBzY,GACvCjG,KAAKge,OAAOU,QAAQ,cAAe1e,KAAKwe,SAC1C,CAKA,WAAA/X,GACE,OAAOzG,KAAKkf,QACd,CAEA,cAAAC,CAAeD,GACblf,KAAKkf,SAAWA,EAEhBlf,KAAKge,OAAOU,QAAQ,mBAAoB1e,KAAKkf,SAC/C,CAKA,OAAAE,GACE,OAAOpf,KAAKmH,IACd,CAEA,UAAAC,CAAWiY,GACTrf,KAAKmH,KAAOkY,EAEPrf,KAAAge,OAAOU,QAAQ,cAAeW,EACrC,EClHc,SAAAC,GAAmDC,EAAkB,IAC7E,MAAAC,EAAMnR,SAASiR,cAAc,OAEnC,OADIE,EAAAC,UAAYF,EAAQ1H,OAChB2H,EAAIE,mBAAqBF,CACnC,CAOO,SAASG,GAAWC,GACnB,MAAAC,EAAOxR,SAASiR,cAAc,OACpCO,EAAKC,UAAYF,EAEV,OADQC,EAAKJ,SAEtB,CASO,SAASM,GAAclR,GACtB,MAAA6D,EAAQoH,OAAO,OAAOjL,aAAgBmR,KAAKjE,OAAOC,SAASiE,QAC1D,OAAAvN,GAASwN,mBAAmBxN,EAAM,GAAGK,QAAQ,MAAO,KAC7D,CAEgB,SAAAoN,GAAUC,EAAiBC,GACnC,MAAAC,EAAsBC,IACpB,MAAAC,EAAOD,EAAQE,wBACfC,EAAa3E,OAAO4E,aAAetS,SAASuS,gBAAgBF,WAC5DG,EAAY9E,OAAO+E,aAAezS,SAASuS,gBAAgBC,UAC1D,MAAA,CACLE,IAAKP,EAAKO,IAAMF,EAChBG,KAAMR,EAAKQ,KAAON,EAAA,EAIhBO,EAAWX,EAAmBF,GACpC,IAAKC,EAAmB,OAAAY,EAElB,MAAAC,EAAmBZ,EAAmBD,GAErC,MAAA,CACLU,IAAKE,EAASF,IAAMG,EAAiBH,IACrCC,KAAMC,EAASD,KAAOE,EAAiBF,KAE3C,CAEgB,SAAAG,GAAaC,EAAiBC,GACxC,IAAAC,EAAcF,EAAQzN,WACnB,KAAA2N,EAAY1X,OAASyX,GAC1BC,EAAc,IAAIA,IAEb,OAAAA,CACT,CAYO,SAASC,GAAQC,EAAYC,EAAK,CAACC,GAAWA,IAC/C,IACI,MAAAC,EAAUH,EAAKI,UAEfC,GADW,IAAIC,MAAOF,UACCD,EAEvBI,EAAOC,KAAKC,MAAMJ,EAAa,OACrC,GAAa,IAATE,EAAY,CAER,MAAAG,EAASL,EAAa,MACtBM,EAAQH,KAAKC,MAAMC,EAAA,MACzB,GAAc,IAAVC,EAAa,CAET,MAAAC,EAASF,OACTG,EAAUL,KAAKC,MAAMG,EAAA,KAC3B,GAAgB,IAAZC,EAAe,CAEX,MAAAC,EAASF,MACTG,EAAUP,KAAKQ,MAAMF,EAAS,KACpC,OAAIC,EAAU,GAAWd,EAAG,OACrB,GAAGc,KAAWd,EAAG,YAC1B,CACA,MAAO,GAAGY,KAAWZ,EAAG,YAC1B,CACA,MAAO,GAAGU,KAASV,EAAG,UACxB,CACA,OAAIM,EAAO,EAAUN,EAAG,OAEpBM,EAAO,EACF,GAAGA,KAAQN,EAAG,UAvCpB,SAAoBD,GACzB,MAAMiB,EAAOtB,GAAaK,EAAKkB,UAAW,GACpCC,EAASxB,GAAaK,EAAKoB,WAAa,EAAG,GAKjD,MAAO,GAJOzB,GAAaK,EAAKqB,cAAe,MAI5BF,KAAUF,GAC/B,CAkCWK,CAAWtB,SACX3d,GAEA,OADPsL,QAAQtL,MAAMA,GACP,KACT,CACF,CA4BA,SAAsBkf,KAAsB,OAAA7gB,EAAAlC,KAAA,MAAA,YAC1C,MAAMgjB,EAAQC,UAAUC,UACxB,IAAMD,UAAkBE,gBAAmBF,UAAkBE,cAAcC,qBAClE,OAAAJ,EAKT,MAAMK,EAAUJ,UAAkBE,cAClC,IAAIG,EAAa,KACb,IACFA,QAAcD,EAAOD,qBAAqB,CAAC,0BACpCrU,GAEA,OADPI,QAAQtL,MAAMkL,GACPiU,CACT,CACM,MAAAO,EAAuBC,OAAOF,EAAMG,gBAAgB9L,MAAM,KAAK,IAEjE,MAAoB,YAApB0L,EAAOK,UACLH,GAAwB,GAInBP,EAAMjQ,QAAQ,kBAAmB,mBAGpB,UAApBsQ,EAAOK,UACLH,GAAwB,GAKnBP,EAAMjQ,QACX,kCACA,YAAYuQ,EAAMG,gBAAgB1Q,QAAQ,MAAO,QAKhDiQ,CACT,GAAA,CAGO,SAASW,GAAWC,GAErB,IAAAC,EACA,IACIA,EAAA,IAAIjI,IAAIgI,SACPzT,GACA,OAAA,CACT,CACA,MAAwB,UAAjB0T,EAAIC,UAAyC,WAAjBD,EAAIC,QACzC,CAGO,SAASC,GAAiBnT,GAC/B,OAI4BqB,EAJPrB,EAAKlE,KAImBpK,EAJbsO,EAAKtO,KAK9B,GAAG2P,EAAQc,QAAQ,MAAO,OAAOzQ,EAAKyQ,QAAQ,MAAO,MAD9C,IAAcd,EAAiB3P,CAH/C,CChMA,MAAM0hB,GAAK,CAETC,YAAa,kBACbC,UAAW,aACXC,KAAM,OACNC,OAAQ,UACRC,OAAQ,UACRC,KAAM,OACNC,KAAM,WACN/c,MAAO,QACP2T,KAAM,UACNqJ,SAAU,QACVC,QAAS,UACTC,YAAa,eACbC,WAAY,gBACZC,YAAa,oBACbC,YAAa,4BACbC,kBAAmB,uBACnBC,eAAgB,+CAGhBC,QAAS,mBACTC,WAAY,SACZC,WAAY,SACZC,SAAU,OACVC,WAAY,SACZC,YAAa,eACbC,aAAc,gBACdC,gBAAiB,0BACjBC,UAAW,QACXC,SAAU,YAGVC,MAAO,QACPC,MAAO,QACPC,OAAQ,KACRC,SAAU,OACVC,SAAU,cACVC,SAAU,YACVC,cAAe,UACfC,SAAU,WACVC,UAAW,YACXC,aAAc,kCACdC,OAAQ,SACRC,SAAU,WACVC,QAAS,UACTC,WAAY,sCACZC,KAAM,OACNC,WAAY,cACZzkB,OAAQ,SACR0kB,cAAe,UACfC,IAAK,MACLC,MAAO,QAGPrE,QAAS,cACTF,QAAS,cACTF,MAAO,YACPJ,KAAM,WACN8E,IAAK,WAGLC,WAAY,wBACZC,aAAc,iCACdC,QAAS,UACTC,OAAQ,SAGRC,UAAW,WACXC,WAAY,QAGZC,gBAAiB,yBACjBC,kBAAmB,2BACnBC,eAAgB,kBAChBC,cAAe,iBACfC,iBAAkB,oBAClBC,WAAY,SACZC,aAAc,SACdC,YAAa,kBACbC,cAAe,0BACfC,SAAU,WACVC,SAAU,WACVC,SAAU,YACVC,cAAe,sBACfC,cAAe,0BACfC,mBAAoB,sDACpBC,sBAAuB,4DACvBC,oBAAqB,4DACrBC,QAAS,UACTC,MAAO,QAGPC,SAAU,WACVC,QAAS,UACTtK,QAAS,UACTuK,SAAU,cACVC,QAAS,UACTC,SAAU,cACVC,SAAU,WACVC,WAAY,gBACZC,OAAQ,cACRC,WAAY,+CACZC,UAAW,0DACXC,eAAgB,kBAChB/R,OAAQ,SACRgS,KAAM,OACNC,SAAU,eCzGCC,GAAqB,aCQrBC,GAAW,CACtBrF,MACA,QAASA,GACT,QCXiB,CAEjBC,YAAa,UACbC,UAAW,YACXC,KAAM,KACNC,OAAQ,KACRC,OAAQ,KACRC,KAAM,KACNC,KAAM,KACN/c,MAAO,KACP2T,KAAM,KACNqJ,SAAU,KACVC,QAAS,KACTC,YAAa,OACbC,WAAY,OACZC,YAAa,OACbC,YAAa,UACbC,kBAAmB,UACnBC,eAAgB,gBAGhBC,QAAS,cACTC,WAAY,KACZC,WAAY,KACZC,SAAU,KACVC,WAAY,KACZC,YAAa,OACbC,aAAc,OACdC,gBAAiB,aACjBC,UAAW,SACXC,SAAU,OAGVC,MAAO,MACPC,MAAO,KACPC,OAAQ,KACRC,SAAU,KACVC,SAAU,OACVC,SAAU,OACVC,cAAe,OACfC,SAAU,KACVC,UAAW,MACXC,aAAc,gBACdC,OAAQ,KACRC,SAAU,KACVC,QAAS,KACTC,WAAY,aACZC,KAAM,KACNC,WAAY,OACZzkB,OAAQ,KACR0kB,cAAe,OACfC,IAAK,KACLC,MAAO,OAGPrE,QAAS,KACTF,QAAS,MACTF,MAAO,MACPJ,KAAM,KACN8E,IAAK,KAGLC,WAAY,gBACZC,aAAc,WACdC,QAAS,KACTC,OAAQ,KAGRC,UAAW,OACXC,WAAY,OAGZC,gBAAiB,QACjBC,kBAAmB,QACnBC,eAAgB,OAChBC,cAAe,OACfC,iBAAkB,MAClBC,WAAY,QACZC,aAAc,OACdC,YAAa,gBACbC,cAAe,QACfC,SAAU,KACVC,SAAU,MACVC,SAAU,MACVC,cAAe,SACfC,cAAe,YACfC,mBAAoB,uBACpBC,sBAAuB,oBACvBC,oBAAqB,2BACrBC,QAAS,KACTC,MAAO,KAGPC,SAAU,KACVC,QAAS,KACTtK,QAAS,MACTuK,SAAU,OACVC,QAAS,MACTC,SAAU,OACVC,SAAU,MACVC,WAAY,OACZC,OAAQ,OACRC,WAAY,YACZC,UAAW,8BACXC,eAAgB,OAChB/R,OAAQ,KACRgS,KAAM,KACNC,SAAU,aD1FL,SAASG,GAAcrN,GAQxB,OANJA,EAAOA,EAAKlJ,QACV,8BACA,CAAC5C,EAAGoZ,EAAYC,IAAeD,EAAGzV,eAAiB0V,GAAM,IAAIC,gBAI3DJ,GAASpN,GACJoN,GAASpN,GAIdF,OAAOqN,KAAuBrN,OAAOqN,IAAoBnN,GACpDF,OAAOqN,IAAoBnN,GAK7BoN,GAASrF,EAClB,CAKA,IAAI0F,GAA4B,KAC5BC,GAAmBL,GAAcI,IAK9B,SAASE,GAAU/hB,GACpBA,IAAW6hB,KACFA,GAAA7hB,EACb8hB,GAA+B,iBAAX9hB,EAAsByhB,GAAczhB,GAAUA,EACpE,CAKO,SAASgiB,GAAE5oB,EAAe6oB,EAAkC,IAC7D,IAAAlK,SAAM+J,aAAa1oB,KAAQA,EAGxB,OAFD2e,EAAAA,EAAI7M,QAAQ,qBAAqB,CAAC5C,EAAG4Z,IAAUD,EAAKC,IAAU,KAE7DC,GAAiBpK,EAC1B,CE5CA,MAAqBqK,GAArB,WAAApqB,GACUE,EAAAC,KAAA,SAA8B,GAAA,CAK/B,EAAAkqB,CACLrb,EACA2C,EACAZ,EAAqB,CAAA,GAErB5Q,KAAKge,OAAOhR,KAAKxJ,EAAA,CACfqL,OACA2C,WACGZ,GAEP,CAKO,GAAAuZ,CAAgCtb,EAAS2C,GACzCA,IACLxR,KAAKge,OAAShe,KAAKge,OAAOrZ,QAAQylB,KAAUA,EAAIvb,OAASA,GAAQub,EAAI5Y,UAAYA,KACnF,CAKO,OAAAkN,CAAoC7P,EAASwb,GAClDrqB,KAAKge,OACF1Q,MAAM,GACN3I,QAAQylB,GAAQA,EAAIvb,OAASA,GAA+B,mBAAhBub,EAAI5Y,UAChD6F,SAAS+S,IACJA,EAAI1c,MAAW1N,KAAAmqB,IAAItb,EAAMub,EAAI5Y,SACjC4Y,EAAI5Y,QAAQ6Y,EAAQ,GAE1B,ECvDF,MAAM3R,GAAyB,CAC7B0H,GAAI,GACJkK,QAAS,GACTC,UAAW,GACXC,OAAQ,GACRxiB,KAAM,GAENic,YAAa,GACbC,UAAW,GACXuG,QAAS,GACTC,UAAU,EACVC,cAAc,EAEdC,SAAU,OACVC,QAAS,EACTC,SAAU,WAEVC,UAAW,mEAEX7hB,MAAM,EACN2c,UAAU,EACVmF,SAAS,EACTC,UAAU,EACVxG,SAAS,EACTyG,QAAS,wBACTC,KAAM,mBACNC,gBAAiB,gBAEjBC,SAAU,CACRC,OAAQ,mCACR3oB,OAAQ,uBAGV4oB,WAAY,CACVC,SAAU,GACVzF,UAAU,EACV0F,UAAU,GAGZC,YAAa,CACXlS,QAAS,IACTmS,SAAU,IACVC,YAAY,GAGdC,WAAW,EACXC,WAAY,KACZC,cAAc,EACdC,gBAAgB,EAEhBnkB,OAAQ,MClCM,SAAAokB,GAAiBC,EAAmCC,GAAO,GAEzE,MAAM7lB,EAA8B6lB,EAAO5O,GAAU6O,GAAUF,GAAcA,EAG7E,GAAI5lB,EAAK8Z,IAAyB,iBAAZ9Z,EAAK8Z,GACrB,IACF,MAAMiM,EAAShe,SAASie,cAA2BhmB,EAAK8Z,IACxD,IAAKiM,EAAQ,MAAMzd,MAAM,mBAAmBtI,EAAK8Z,sBACjD9Z,EAAK8Z,GAAKiM,QACHroB,GAED,MADNmL,QAAQtL,MAAMG,GACR,IAAI4K,MAAM,wCAClB,CAqBK,MAjBc,KAAjBtI,EAAKgkB,UAAgBhkB,EAAKgkB,QAAU,GAAGvO,OAAOC,SAASuQ,YAGpC,KAAnBjmB,EAAKikB,YAAuBjkB,EAAAikB,UAAY,GAAGlc,SAASqN,SAGpDpV,EAAKkkB,SAAalkB,EAAAkkB,OAASlkB,EAAKkkB,OAAOzX,QAAQ,MAAO,IAAIA,QAAQ,YAAa,KAG/D,SAAhBzM,EAAKuB,SAAmBvB,EAAKuB,OAASob,UAAUuJ,UAG9B,SAAlBlmB,EAAKskB,WAAqBtkB,EAAKskB,SAAW7O,OAAO0Q,WAAW,sBAAsBtU,SAG1D,iBAAjB7R,EAAKukB,SAAwBrH,OAAOld,EAAKukB,UAAY,IAAGvkB,EAAKskB,UAAW,GAE5EtkB,CACT,CA4CgB,SAAAomB,GAAkBpmB,EAA6BqmB,GACtD,MAAA,CACL1a,QAAS,GAAG3L,EAAKkkB,gBACjBoC,SAAUtmB,EAAK0B,MAAQ,GACvBsiB,QAAShkB,EAAKgkB,SAAW,GACzBC,UAAWjkB,EAAKikB,WAAa,GAC7BsC,QAASvmB,EAAKwlB,WACdhb,YAAa,IAAW,MAAL6b,OAAK,EAAAA,EAAAhrB,IAAI,QAAQmrB,UAAU/C,MAC9C3X,UAAU,MAAAua,OAAA,EAAAA,EAAKhrB,IAAI,QAAQorB,yBACvB,CACEle,KAAM,MAAA8d,OAAA,EAAAA,EAAKhrB,IAAI,QAAQmrB,UAAUvI,KACjC/c,MAAO,MAAAmlB,OAAA,EAAAA,EAAKhrB,IAAI,QAAQmrB,UAAUtlB,YAEpC,EACJ4J,SAAe,MAALub,OAAK,EAAAA,EAAAK,iBAEnB,CC/GgB,SAAAC,GACdN,EACA7rB,EACAosB,GAWA,IAAIC,EAAe,KACnB,MAAM3b,EAAU,KACd,MAAM4b,EAVI,MACJ,MAAA9mB,EAAOqmB,EAAIU,UACXC,EAAW,CAAA,EAIV,OAHFxsB,EAAAuW,SAASpW,IACRqsB,EAAArsB,GAAOqF,EAAKrF,EAAG,IAEdqsB,CAAA,EAIQlP,GAXC,IAACzF,EAAQ4U,GAYC,MAAXJ,IAZExU,EAY4BwU,EAZpBI,EAY6BH,IAZlBzsB,KAAKC,UAAU+X,KAAOhY,KAAKC,UAAU2sB,QAe7DJ,EAAAC,EACVF,EAAOE,GACT,EAEET,EAAAzC,GAAG,UAAW1Y,GACdmb,EAAAzC,GAAG,UAAW1Y,EACpB,CCCA,MAAMgc,GAUJ,WAAA3tB,CAAYyG,GARZvG,EAAAC,KAAA,QACAD,EAAAC,KAAA,QACAD,EAAAC,KAAA,SAGQD,EAAAC,KAAA,SAAS,IAAIiqB,IACHlqB,EAAAC,KAAA,WAAA,GA4BwBD,EAAAC,KAAA,cAAA,MAuC1CD,EAAAC,KAAA,iBAAiBA,KAAKytB,iBACtB1tB,EAAAC,KAAA,qBAAqBA,KAAK+F,aAjExB/F,KAAKsG,KAAOA,EAEZtG,KAAK0tB,MAAQpnB,EAAK8Z,GACbpgB,KAAA0tB,MAAMC,UAAUC,IAAI,UACzB5tB,KAAK0tB,MAAMjO,UAAY,GAEvBzf,KAAKQ,KAAO,IAAIud,GAAY/d,KAAKge,QAE5Bhe,KAAAkqB,GAAG,WAAW,KACjBlqB,KAAK6tB,SAAU,CAAA,GAEnB,CAEA,MAAAC,CAAOC,EAAiBrQ,GACtB1d,KAAK+tB,GAAWrQ,CAClB,CAEA,GAAA/b,CAAIosB,GACF,OAAO/tB,KAAK+tB,EACd,CAEA,MAAAC,GACE,OAAO,IAAIjc,EAAI2a,GAAkB1sB,KAAKsG,KAAMtG,MAC9C,CAGA,cAAAgtB,GAEE,OADKhtB,KAAKiuB,cAAkBjuB,KAAAiuB,YFgDzB,SAA8BtB,GACnC,MAAMuB,EG/FD,WACL,MAAM9c,EAAyB,GACxB,MAAA,CACLwc,IAAK,CAACrc,EAAQC,KACZJ,EAASpE,KAAK,CAAEuE,SAAQC,WAAS,EAEnC7P,IAAK,IAAMyP,EAEf,CHuFY+c,GAIH,OAHPD,EAAEN,IAAI,gBAAiBN,GAAQX,EAAIyB,aAAad,KAChDY,EAAEN,IAAI,cAAc,IAAMjB,EAAI0B,WAAW,CAAE,KAEpCH,CACT,CEtD8CI,CAAqBtuB,OACxDA,KAAKiuB,WACd,CAEA,OAAAnB,GACE,OAAO9sB,KAAKQ,IACd,CAEA,YAAA+tB,CAAaC,EAA0BC,GAChCzuB,KAAA0uB,OAAOC,SAASH,EAAaC,EACpC,CAEA,WAAAG,CAAYJ,EAA0BC,GAC/BzuB,KAAA0uB,OAAOG,eAAeL,EAAaC,EAC1C,CAEA,KAAAtuB,CAAMwC,GACC3C,KAAAQ,KAAKie,cAAc9b,EAC1B,CAEA,MAAAmsB,GACE9uB,KAAKQ,KAAKie,cAAc,CAAEsQ,OAAQ,GACpC,CAGA,aAAAC,GACOhvB,KAAAge,OAAOU,QAAQ,kBACtB,CAEA,eAAA+O,GACS,OAAAztB,KAAKkU,KAAKuZ,iBACnB,CAEA,WAAA1nB,GACS,OAAA/F,KAAKQ,KAAKuF,aACnB,CAMA,iBAAAkpB,GACEjvB,KAAK0uB,OAAOQ,aACd,CAEA,iBAAAC,GACEnvB,KAAK0uB,OAAOU,aACd,CAEA,gBAAAC,CAAiBzd,EAAKrP,GACfvC,KAAA0uB,OAAOY,WAAW1d,EAAKrP,EAC9B,CAEA,gBAAAgtB,GACEvvB,KAAK0uB,OAAOc,YACd,CAGA,WAAAC,CAAYpF,GACLrqB,KAAA0vB,aAAaC,KAAKtF,EACzB,CAEA,WAAAuF,GACE5vB,KAAK0vB,aAAaG,MACpB,CAGA,UAAAxB,CAAWhE,GACF,OAAArqB,KAAK8vB,gBAAgBzB,WAAWhE,EACzC,CAEA,YAAA+D,CAAa/D,GACJ,OAAArqB,KAAK8vB,gBAAgB1B,aAAa/D,EAC3C,CAGA,EAAAH,CAAGrb,EAAW2C,GACPxR,KAAAge,OAAOkM,GAAGrb,EAAM2C,EACvB,CAEA,GAAA2Y,CAAItb,EAAW2C,GACRxR,KAAAge,OAAOmM,IAAItb,EAAM2C,EACxB,CAEA,OAAAkN,CAAQ7P,EAAWwb,GACZrqB,KAAAge,OAAOU,QAAQ7P,EAAMwb,EAC5B,CAGA,EAAA5I,CAAGxgB,EAAoB6oB,EAAkC,IAChDiG,OAAAA,GAAO9uB,EAAK6oB,EACrB,CAEA,WAAAkG,CAAYtF,GACL1qB,KAAAiwB,WAAW,CAAEvF,YACpB,CAEA,UAAAuF,CAAWC,GACTlwB,KAAKsG,KAAOiX,GAAUvd,KAAKsG,KAAM2lB,GAAiBiE,GAAO,IACzDlwB,KAAK6tB,SAAW7tB,KAAKge,OAAOU,QAAQ,UAAW1e,KAAKsG,KACtD,CAEA,OAAA+mB,GACE,OAAOrtB,KAAKsG,IACd,CAEA,KAAA6pB,GACE,OAAOnwB,KAAK0tB,KACd,CAEA,SAAA0C,GACE,OAAOC,IACT,CAEA,SAAApD,CACEnsB,EACAosB,GAEUD,GAAAjtB,KAAMc,EAAMosB,EACxB,EEtLc,SAAAgC,GAAYoB,EAAyBhqB,GAE/C,IAAAiqB,EAAWD,EAAWhE,cAA2B,yBAChDiE,IACQC,EAAAA,GACT,+PAMQ,MAANlqB,OAAM,EAAAA,EAAAmqB,iBAAeF,EAASjX,MAAMoX,WAAa,eACrDJ,EAAWK,YAAYJ,IAEzBA,EAASjX,MAAMsX,QAAU,GAGnB,MAAAC,EAAWN,EAASjE,cAA2B,wBACjDuE,IACFA,EAASvX,MAAMsX,QAAU,OACzB7U,OAAO+U,YAAW,KACZD,EAASE,cAAaF,EAASvX,MAAMsX,QAAU,GAAA,GAClD,KAEP,CAGO,SAASxB,GAAYkB,GACpB,MAAAC,EAAWD,EAAWhE,cAA2B,yBACnDiE,IAAUA,EAASjX,MAAMsX,QAAU,OACzC,CAGgB,SAAAzS,GAAWC,EAAckS,GACnClS,EAAK8Q,GAAYoB,GAChBlB,GAAYkB,EACnB,CAiBO,SAASU,GACdC,EACAC,GAAsB,EACtB7Q,GAEI,IAAAU,EAEJ,GAAIV,EAAY,CACR,MAAA8Q,EAAgB9Q,EAAWI,wBAG/BM,EAFkBkQ,EAAKxQ,wBAEXM,IACZoQ,EAAcpQ,IACdV,EAAWQ,UACXR,EAAW+Q,aAAe,EAC1BH,EAAKG,aAAe,CAAA,KACjB,CACC,MAAA5Q,EAAOyQ,EAAKxQ,wBAElBM,EADgBP,EAAKO,IAAMhF,OAAOsV,SACjBtV,OAAOuV,YAAc,EAAI9Q,EAAK+Q,OAAS,EAC1D,CAEA,MAAMC,EAAiC,CACrCzQ,MACAC,KAAM,EAENyQ,SAAU,WAGRpR,EAAYA,EAAWqR,OAAOF,GAC7BzV,OAAO2V,OAAOF,EACrB,CAgDgB,SAAAG,GAAeV,EAAmBW,IAZ3C,SAAsBX,EAAmBW,EAAoBrvB,EAAqB,MACvF0uB,EAAKtD,UAAUC,IAAI,YAAYrrB,KAE/B,MAAMsvB,EAAc,KAClBZ,EAAKtD,UAAUmE,OAAO,YAAYvvB,KAC7B0uB,EAAAtjB,oBAAoB,eAAgBkkB,EAAW,EAGjDZ,EAAA7gB,iBAAiB,eAAgByhB,EACxC,CAIeE,CAAAd,EAAMW,EAAO,KAC5B,CAQO,SAASI,GACd1B,EACArd,EACAyI,EAAgB,qDAEZ,IAAAuV,EAAOX,EAAWhE,cAA2B,oBACjD,GAAa,OAATrZ,EAEF,YADa,OAATge,GAAeA,EAAKa,UAGrBb,IACIT,EAAAA,GACL,gCAAgC9U,+CAElC4U,EAAWK,YAAYM,IAGnB,MAAAgB,EAAchB,EAAK3E,cAA2B,mBACpD2F,EAAYxS,UAAY,GACX,OAATxM,IAEAA,aAAgBif,YAClBD,EAAYtB,YAAY1d,GAExBgf,EAAYnS,UAAY7M,EAE5B,CC/IO,SAASkf,GAAWC,GACnB,MAAAC,EAAc7B,GAAoB,+CAClC8B,EAAU9B,GACd,0FAEF8B,EAAQhZ,MAAMsX,QAAU,OACxB2B,GAAeF,EAAa,CAAE5B,eAAe,IAC7C6B,EAAQvV,IAAMqV,EAAQI,UAAUC,sBAChCH,EAAQI,OAAS,KACfJ,EAAQhZ,MAAMsX,QAAU,GACxB+B,GAAeN,EAAW,EAE5BA,EAAYlxB,OAAOmxB,GAEnB,MAAMM,EAAYpC,GAChB,4EAEF6B,EAAYlxB,OAAOyxB,GAEnBR,EAAQS,oBAGR,IAAIC,GAAO,EA6BJ,OAtBN,SAAgBC,IAAc,OAAA7wB,EAAAlC,KAAA,MAAA,YANjB,IAACgzB,EAQT,SARSA,EAOD,IANZ,IAAIxlB,SAASC,IACXsO,OAAO+U,YAAW,KAChBrjB,EAAQ,KAAI,GACXulB,EAAE,KAIHF,EAAM,OACV,IAAIG,GAAS,EACT,IAEFA,SADmBb,EAAQpE,SAASkF,QAAQrtB,oBAC9BrF,KAAK2yB,OAAA,CACb,MAAAnvB,GACGivB,GAAA,CACX,CACIA,EACFb,EAAQgB,oBAGV,IAdD,GAiBDR,EAAUS,QAAU,KACXP,GAAA,EACPV,EAAQnL,QAAO,EAGVoL,CACT,CC9EA,MAAMiB,GAA0B,CAC9BluB,QAAA,CAAQgtB,EAASmB,IACRnB,EAAQpE,SAASkF,QAAQptB,cAAc,CAC5C3B,MAAOovB,IAIXnxB,KAAKgwB,GACCA,EAAQzwB,IAAI,UAAkB6xB,GAAkBpB,GDLjD,SAAiBA,GAEtB,MAAMnB,EAAOT,GACX,2CAA2C4B,EAAQzwB,IAAI,aAAe,OAAO8f,GAAG,0BAgB3E,OAZPwP,EAAK3E,cAA2B,oBAAqB+G,QAAU,KACvD,MAAAI,EAAQxC,EAAK3E,cAAc,oBACjC8F,EACGpE,SACAkF,QAAQttB,aACRlC,MAAM4pB,IACLmG,EAAOC,aAAa,MAAOpG,EAAI9sB,KAAKmzB,SAAQ,IAE7C5vB,OAAOgL,IACEI,QAAAtL,MAAM,+BAAgCkL,EAAG,GAClD,EAEEkiB,CACT,CCdW2C,CAAexB,GAGxB,SAAAyB,CAAUzB,EAAS5xB,EAAM+yB,EAAUO,GACzB1B,EAAAtwB,IAAI,MAAOyxB,EACrB,EAEA,OAAAQ,CAAQ3B,EAASrjB,EAAKwkB,EAAUO,GACvBA,EAAAxH,cAA2B,oBAAqB0H,QAChDF,EAAAxH,cAAgC,sBAAuBnoB,MAAQ,EACxE,GClBI8vB,GAA2C,CAC/CC,UAAW,WAEL,OAAA9uB,CAAQgtB,EAASmB,GAAU,OAAArxB,EAAAlC,KAAA,MAAA,YAC/B,aACQoyB,EAAQpE,SAAStlB,KAAKD,MAAM,CAChCoG,KAAMujB,EAAQ5pB,UAAUskB,UAAUvI,KAClC/c,MAAO4qB,EAAQ5pB,UAAUskB,UAAUtlB,MACnCqgB,SAAU0L,KAEZ/yB,IACJ,GAAA,EAEA4B,KAAKgwB,GACI5B,GAAoB,SAAS/O,GAAG,wBAGzC,SAAAoS,CAAUzB,EAAS9E,EAAKiG,EAAUO,GACxB1B,EAAA5pB,UAAU2rB,OAAO,CACvBC,SAAS,EACTrK,MAAOuD,EAAIvD,QAELqI,EAAAI,UAAU6B,UACpB,EAEA,OAAAN,CAAQ3B,EAASrjB,EAAKwkB,EAAUO,GAAS,GCrB3C,MAAqBQ,GAKnB,WAAAz0B,CAAY00B,GAJLx0B,EAAAC,KAAA,OACAD,EAAAC,KAAA,YACAD,EAAAC,KAAA,YAGLA,KAAKw0B,IAAMhE,GACT,6NASFxwB,KAAKy0B,SAAWz0B,KAAKw0B,IAAIlI,cAA2B,6BAGpDtsB,KAAK00B,SAAW10B,KAAKw0B,IAAIlI,cAAc,6BAClCtsB,KAAA00B,SAAS/D,YAAY4D,EAC5B,CAGO,MAAAI,CAAOnjB,GACZ,MAAMojB,EAAMpE,GACV,iCAAiC/O,GAAG,uBAK/B,OAHHmT,EAAAvB,QAAUrzB,KAAK60B,WAAWrjB,GACzBxR,KAAAy0B,SAAS9D,YAAYiE,GAEnB50B,IACT,CAGO,KAAA80B,CAAMtjB,GACX,MAAMojB,EAAMpE,GACV,gCAAgC/O,GAAG,sBAK9B,OAHHmT,EAAAvB,QAAUrzB,KAAK60B,WAAWrjB,GACzBxR,KAAAy0B,SAAS9D,YAAYiE,GAEnB50B,IACT,CAEQ,UAAA60B,CAAWrjB,GACjB,OAAQ4Y,IACN,MAAM5P,EAAKhJ,EAAQ4Y,EAAI2K,cAA8B/0B,WAC1C,IAAPwa,IAA2B,IAAPA,GACtBxa,KAAKw0B,IAAI1C,QACX,CAEJ,ECjCF,SAASkD,GAAuDrb,GAC9D,OAAQ0Q,GACN,IAAI7c,SAAc,CAACC,EAASwC,KAC1B,MAAMglB,EAAW5K,EAAQ6K,SACzB7K,EAAQ6K,SAAW,KACjBD,GAAYA,IACLhlB,EAAA,IAAIrB,MAAM,6BAA4B,EAE/C,MAAMumB,EAAY9K,EAAQwJ,UAC1BxJ,EAAQwJ,UAAY,KAClBsB,GAAaA,SAGfxb,EAAG0Q,EAAO,GAEhB,CAKA,MAAqB+K,GACnB,WAAAv1B,CAAoB+Q,GAEqD7Q,EAAAC,KAAA,eAAAg1B,IAAa/pB,IACpFjL,KAAKq1B,KAAK/B,GAAgBroB,GAAI0hB,IACxBA,EAAA7qB,IAAI,WAAYmJ,EAAE0oB,UAClBhH,EAAA7qB,IAAI,SAAUmJ,EAAE2N,OAAM,GAC3B,KAG6D7Y,EAAAC,KAAA,aAAAg1B,IAAa/pB,IACtEjL,KAAAq1B,KAAKpB,GAAchpB,EAAC,KAVPjL,KAAA4Q,KAAAA,CAA+B,CAa5C,IAAAykB,CAAKjD,EAAkB/H,EAAyBiL,GAErD,MAAMC,EAAQv1B,KAAK4Q,KAAK4kB,SAAS7zB,IAAI,gBAAgB8I,OAAO,gBAAeqX,MAAOF,aAClF2T,EAAM5F,OAEN,MAAM8F,EAAQ,KACZF,EAAMG,SAAQ,EAIVC,EAA6B,CAAA,EACnC,IAAI9C,GAAoB,EACxB,MAAM+C,EAAyB,CAC7B9zB,IAAK,CAACb,EAAKmd,KACTuX,EAAa10B,GAAOmd,CAAA,EAEtBzc,IAAMV,GAAQ00B,EAAa10B,GAC3BuxB,QAAS,IAAMxyB,KAAK4Q,KACpBpI,QAAS,IAAMxI,KAAK4Q,KAAK4kB,SAAS7zB,IAAI,QACtCqsB,OAAQ,IAAMhuB,KAAK4Q,KAAKod,SACxB6E,kBAAmB,KACGA,GAAA,CAAA,EAEtBO,eAAgB,SAEVhB,EAAQyB,WAAWzB,EAAQyB,UAAU+B,EAAY,GAAI,GAAI9B,GACzDzJ,EAAQwJ,WAAWxJ,EAAQwJ,WAAU,EAE3C5M,OAAQ,SAEFoD,EAAQ6K,UAAU7K,EAAQ6K,UAAS,GAIvCI,GAAUA,EAASM,GAGjB,MAAA9B,EAAStD,KACfsD,EAAOnD,YAAYyB,EAAQhwB,KAAKwzB,IAGhC,MAAMC,EAASrF,GACb,2BAA2B4B,EAAQ8B,WAAa,uDAc9C,IAAA4B,EAZJhC,EAAOnD,YAAYkF,GACnB/E,YAAW,IAAM+E,EAAOE,SAAS,IAG1BF,EAAAG,QAAW5L,IACA,UAAZA,EAAInpB,KAAmC,KAAhBmpB,EAAI6L,UAE7B7L,EAAI8L,iBACJX,EAAMpF,QAAQ7D,cAAiC,iCAAkC0H,QACnF,EAII,MAAAmC,EAAS,IAAI7B,GAAOR,GAGnBqC,EAAAxB,QAAQyB,IACP,MAAA7C,EAAWsC,EAAO1xB,MAAM0T,OAGzBie,IAAYA,EAAaM,EAAMtW,WAC9B,MAIAuW,EAAiB,KACrBD,EAAMtW,UAAYgW,GAAc,GAC1BM,EAAAzI,UAAUmE,OAAO,QAAO,EA6BzB,OA1BPsE,EAAMtW,UAAY,GAAG2B,GAAG,gBAGxB2Q,EACGhtB,QAAQwwB,EAAYrC,GACpB7vB,MAAMlD,QAID4xB,EAAQyB,WAAWzB,EAAQyB,UAAU+B,EAAYp1B,EAAM+yB,EAAUO,GACjEzJ,EAAQwJ,WAAWxJ,EAAQwJ,WAAU,IAE1C9vB,OAAOgL,IArBS,IAACunB,IAuBLxjB,OAAO/D,EAAI4C,SAAWmB,OAAO/D,IAtB1CqnB,EAAMtW,UAAYwW,EACZF,EAAAzI,UAAUC,IAAI,SAuBdwE,EAAQ2B,SAAS3B,EAAQ2B,QAAQ6B,EAAY7mB,EAAKwkB,EAAUO,GAGhE,MAAMyC,EAAKzF,YAAW,IAAMuF,KAAkB,KAC9CR,EAAOW,QAAU,SAEfC,aAAaF,EAAE,CAAA,KAId,CAAA,IAITJ,EAAOrB,OAAM,SAEPzK,EAAQ6K,UAAU7K,EAAQ6K,YACvB,KAGLrC,IACFgD,EAAOvc,MAAMsX,QAAU,OACvBuF,EAAO3B,IAAIlI,cAA2B,6BAA8BhT,MAAMsX,QAAU,QAItF2E,EAAMpF,QAAQhvB,OAAOg1B,EAAO3B,KAGxBnK,EAAQqM,SAAiBrM,EAAAqM,QAAQP,EAAO3B,IAC9C,ECnLF,MAA8BmC,GAMrB,WAAA92B,CAAmB8sB,GALnB5sB,EAAAC,KAAA,OAKmBA,KAAA2sB,IAAAA,CAAkB,CAJ5C,QAAWrmB,GACT,OAAOtG,KAAK2sB,IAAIrmB,IAClB,CAIA,KAAA6pB,GACE,OAAOnwB,KAAKw0B,GACd,ECZa,MCGToC,GAAM,CACVC,QAAS,cACTC,MAAO,4BACPC,OAAQ,6BACRC,MAAO,4BACPC,cAAe,qBACfC,UAAW,gBACXC,QAAS,cACTC,WAAY,gBACZC,YAAa,mBACbC,YAAa,mBACbC,WAAY,kBACZC,aAAc,qBACdC,eAAgB,wBCDlB,MAAMC,GACJ,WAAA73B,CAAsB83B,GAAA33B,KAAA23B,IAAAA,CAAe,CAGrC,MAAAC,CAAO3kB,EAAe,eAEpB,OADAjT,KAAK63B,KAAOrH,GAAoB,8BAA8Bvd,YACvDjT,KAAK63B,IACd,CAGA,QAAAC,CAAS7kB,EAAe,eAEtB,OADKjT,KAAA+3B,OAASvH,GAAoBvd,GAC3BjT,KAAK+3B,MACd,CAGA,qBAAAC,CAAsBC,GACpBj4B,KAAKk4B,mBAAqBD,CAC5B,CAGA,YAAAE,CAAaF,GACXj4B,KAAK23B,IAAIS,YAAYlO,GAAG,cAAemO,IACjCA,IAAUr4B,YAElB,CAGA,YAAAs4B,CAAaL,GACXj4B,KAAK23B,IAAIS,YAAYlO,GAAG,cAAemO,IACjCA,IAAUr4B,YAElB,CAGA,oBAAAu4B,CAAqBC,EAAwBC,GAC3Cz4B,KAAK04B,sBAAwBF,EAC7Bx4B,KAAK24B,kBAAoBF,CAC3B,EClDF,MAAqBG,WAAclB,GAAnC,WAAA73B,GAAAoF,SAAAC,WACoBnF,EAAAC,KAAA,WAAA,EAAA,CAElB,IAAA64B,CAAKC,GACH,GAAI94B,KAAK+4B,QAAS,OAClB/4B,KAAK+4B,SAAU,EAEf,MAAMC,EAAWh5B,KAAK23B,IAAIsB,QAAQzE,IAEzBwE,EAAApH,MAAMpB,GAAoB,sDAE7B,MAAA0I,EAAe1I,GAAoB,eACzCsI,EAAQlH,MAAMsH,GACdA,EAAaC,YAAYH,GAEhBA,EAAArL,UAAUC,IAAI,eACdoL,EAAArL,UAAUC,IAAI,mBACzB,CAEA,IAAAwL,SACOp5B,KAAK+4B,UACV/4B,KAAK+4B,SAAU,EACf,OAAA92B,EAAAjC,KAAK23B,IACF0B,eACA3L,MAAMpB,cAAc,oCAFvBrqB,EAGIk3B,YAAYn5B,KAAK23B,IAAIsB,QAAQzE,KACjCx0B,KAAK23B,IAAIsB,QAAQzE,IAAI7G,UAAUmE,OAAO,oBACxC,ECzBF,MAAqBwH,GACnB,WAAAz5B,CAAoB6uB,GAEa3uB,EAAAC,KAAA,YAAA,UACaD,EAAAC,KAAA,iBAAA,MAH1BA,KAAA0uB,OAAAA,CAAiB,CAMrC,GAAA/sB,GACE,OAAO3B,KAAKu5B,SACd,CAQA,OAAOC,EAAoBnP,iBAWrB,GATArqB,KAAKy5B,iBACPz5B,KAAKy5B,iBACLz5B,KAAKy5B,eAAiB,KAGtB,OAAAt3B,EAAA,OAAAF,EAAAjC,KAAK0uB,OAAOgL,iBAAY,EAAAz3B,EAAAN,IAAIi3B,MAAQz2B,EAAAi3B,QAIxB,WAAVI,GAAsBnP,EAAS,CAEjC,IAAIsP,EAActP,EAAQoE,SACrBzuB,KAAK0uB,OAAOpoB,KAAKskB,WACN+O,EAAAA,EAAYrN,cAA2B,gBACvD,OAAAsN,EAAA,OAAAA,EAAA55B,KAAK0uB,OAAOgL,mBAAZE,EAAwBj4B,IAAIi3B,MAA5BiB,EAAoChB,KAAKc,GAEnC,MAAAG,EACJ95B,KAAK0uB,OAAO/B,IAAIrmB,KAAKyzB,kBAAoB/5B,KAAK0uB,OAAO/B,IAAIrmB,KAAKyzB,mBAChEC,GAAkBh6B,KAAK0uB,OAAOuL,QAAQzF,KAAK,EAAMsF,GAE3C,MAAAI,EAAS,OAAAC,EAAKn6B,KAAA0uB,OACjBgL,iBACC,EAAAS,EAAAT,WACD9a,MAAM3T,GAAMA,EAAEytB,wBAA0Bc,IACvCU,GAAUA,EAAOvB,oBACnB34B,KAAKy5B,eAAiBS,EAAOvB,kBAAkBtO,EAAQpkB,SAE3D,CAGAjG,KAAKu5B,UAAYC,CACnB,EChDF,MAAMY,WAAezD,GAcnB,WAAA92B,CAAY8sB,GACV1nB,MAAM0nB,GAdA5sB,EAAAC,KAAA,MACAD,EAAAC,KAAA,SAgBNA,KAAKq6B,GJKF,WACC,MAAA7F,EAAMhE,GD/BC,qwBCgCP6J,EAAK,CAAE7F,OAIN,OAHA3zB,OAAAy5B,QAAQ1D,IAAKvf,SAAQ,EAAEkjB,EAAGC,MAC/BH,EAAGE,GAAK/F,EAAIlI,cAAckO,EAAG,IAExBH,CACT,CIZcI,GACLz6B,KAAAw0B,IAAMx0B,KAAKq6B,GAAG7F,IAGdx0B,KAAAw5B,MAAQ,IAAIF,GAAmBt5B,KACtC,CAnBA,KAAAi6B,GACE,OAAOj6B,KAAKq6B,EACd,CACA,QAAAX,GACS,OAAA15B,KAAK2sB,IAAIhrB,IAAI,cACtB,CACA,QAAA+4B,GACS,OAAA16B,KAAKw5B,MAAM73B,KACpB,CAaA,iBAAAg5B,GACE,MAAO,CAAEpW,KAAMvkB,KAAKq6B,GAAGvD,MAAOtvB,MAAOxH,KAAKq6B,GAAGtD,OAAQ5b,KAAMnb,KAAKq6B,GAAGrD,MACrE,CAEA,eAAA4D,GACM,IAAAphB,EAAUxZ,KAAK66B,gBAGb,MAAAC,EAAQ96B,KAAK05B,WAGZ,OAFHoB,IAAiBthB,EAAAshB,EAAMC,sBAAsBvhB,IAE1CA,CACT,CAEA,aAAAqhB,GACS,OAAA76B,KAAKq6B,GAAGnD,UAAU/yB,OAAS,EACpC,CAEA,gBAAA62B,GACS,OAAA/f,GAAOjb,KAAK46B,kBACrB,CAEA,UAAAK,CAAW7c,SACJpe,KAAAq6B,GAAGnD,UAAU/yB,MAAQia,EAG1B,OAAAnc,EAAAjC,KAAK05B,aAAYz3B,EAAAi5B,YAAYxc,QAAQ,kBAAmBN,EAC1D,CAEA,aAAA+c,CAAc/c,GACZ,GAAK/P,SAAiB+sB,UACfp7B,KAAAq6B,GAAGnD,UAAUnB,QACC1nB,SAAA+sB,UAAUC,cAAcxoB,KAAOuL,EAC7Cpe,KAAAq6B,GAAGnD,UAAUnB,aAAM,GACf/1B,KAAKq6B,GAAGnD,UAAUoE,gBAAuD,IAArCt7B,KAAKq6B,GAAGnD,UAAUoE,eAAsB,CAC/E,MAAAC,EAASv7B,KAAKq6B,GAAGnD,UAAUoE,eAC3BE,EAAOx7B,KAAKq6B,GAAGnD,UAAUuE,aACzBC,EAAK17B,KAAKq6B,GAAGnD,UAAUrW,UACxB7gB,KAAAi7B,WACHj7B,KAAKq6B,GAAGnD,UAAU/yB,MAAMuR,UAAU,EAAG6lB,GACnCnd,EACApe,KAAKq6B,GAAGnD,UAAU/yB,MAAMuR,UAAU8lB,EAAMx7B,KAAKq6B,GAAGnD,UAAU/yB,MAAMyF,SAE/D5J,KAAAq6B,GAAGnD,UAAUnB,QAClB/1B,KAAKq6B,GAAGnD,UAAUoE,eAAiBC,EAASnd,EAAIxU,OAChD5J,KAAKq6B,GAAGnD,UAAUuE,aAAeF,EAASnd,EAAIxU,OACzC5J,KAAAq6B,GAAGnD,UAAUrW,UAAY6a,CAAA,MAEzB17B,KAAAq6B,GAAGnD,UAAUnB,QACb/1B,KAAAq6B,GAAGnD,UAAU/yB,OAASia,CAE/B,CAEA,KAAA2X,GACO/1B,KAAAq6B,GAAGnD,UAAUnB,OACpB,CAEA,KAAAtd,GACEzY,KAAKi7B,WAAW,IAChBj7B,KAAKwvB,YACP,CAEA,UAAAA,GACOxvB,KAAAw5B,MAAMmC,OAAO,SACpB,CAEA,QAAAhN,CAAS1oB,EAAsBwoB,GAC7BzuB,KAAKw5B,MAAMmC,OAAO,QAAS,CAAE11B,UAASwoB,YACxC,CAEA,cAAAI,CAAe5oB,EAAsBwoB,GACnCzuB,KAAKw5B,MAAMmC,OAAO,OAAQ,CAAE11B,UAASwoB,YACvC,CAEA,UAAAa,CAAW1d,EAAarP,IZfV,SAAWq5B,EAAuBhqB,EAAarP,GACvD,MAGAs5B,EAAarL,GACjB,gEAJa,CAAEsL,EAAG,UAAW93B,EAAG,UAAW+3B,EAAG,UAAWpyB,EAAG,WAIWpH,sDAEjDs5B,EAAWvP,cAA2B,uBAC9C7M,UAAYuK,GAAiBpY,GAAKmB,QAAQ,KAAM,SAEhE6oB,EAASjL,YAAYkL,GAErB,MAAMG,EAAe,KACRH,EAAAlO,UAAUC,IAAI,gBACzBkD,YAAW,KACT+K,EAAW/J,QAAO,GACjB,IAAG,EAGJ,IAAAmK,EAEUA,EAAAlgB,OAAO+U,YAAW,WAnBhB,KAwBL+K,EAAAzrB,iBAAiB,SAAS,SAEnC2L,OAAO0a,aAAawF,EAAS,GAEjC,CYdIC,CAAcl8B,KAAKq6B,GAAGhD,YAAazlB,EAAKrP,EAC1C,CAEA,WAAA2sB,GACiBA,GAAAlvB,KAAKq6B,GAAG7F,IACzB,CAEA,WAAApF,GACiBA,GAAApvB,KAAKq6B,GAAG7F,IACzB,CAEA,MAAA2H,GACE,MAAMC,EAAO,IAAMp8B,KAAK2sB,IAAIjO,QAAQ,iBAChC1e,KAAK2sB,IAAIrmB,KAAK+1B,aAChBr8B,KAAK2sB,IAAIrmB,KAAK+1B,aAAar8B,KAAMo8B,MAIrC,ECtHF,MAAqBE,WAAqB3F,GAOxC,WAAA92B,CAAY8sB,GACV1nB,MAAM0nB,GAPD5sB,EAAAC,KAAA,SACAD,EAAAC,KAAA,WACAD,EAAAC,KAAA,aACAD,EAAAC,KAAA,eACAD,EAAAC,KAAA,WAqBiBD,EAAAC,KAAA,iBAAA,GAGhBD,EAAAC,KAAA,aAnBDA,KAAAw0B,IAAMhE,GCjBA,wSDkBXxwB,KAAK62B,QAAU72B,KAAKw0B,IAAIlI,cAAc,uBACtCtsB,KAAK4yB,UAAY5yB,KAAK62B,QAAQvK,cAAc,sBAC5CtsB,KAAKqyB,YAAcryB,KAAKw0B,IAAIlI,cAAc,4BAErCtsB,KAAA4yB,UAAUS,QAAU,KACvBrzB,KAAK6vB,MAAK,EAIP7vB,KAAA2sB,IAAIzC,GAAG,gBAAgB,KAC1BlqB,KAAKu8B,eAAgB,CAAA,GAEzB,CASa,IAAA5M,GAAK,OAAAztB,EAAAlC,KAAAkF,WAAA,UAAAoB,EAA2B,IAQ3C,GAPKtG,KAAAw0B,IAAIlb,MAAMkjB,UAAY,GAG3Bx8B,KAAKy8B,YACLz8B,KAAKu1B,MAAO5F,OAGR3vB,KAAKu8B,cACPv8B,KAAKu8B,eAAgB,EACrBv8B,KAAKqyB,YAAY5S,UAAY,GAC7Bzf,KAAKsyB,QAAUtyB,KAAK08B,aAAap2B,EAAKq2B,MACjC38B,KAAAqyB,YAAYlxB,OAAOnB,KAAKsyB,aACxB,CAEL,MAAMA,EAAUtyB,KAAKsyB,QACfsK,EAAYtK,EAAQvV,IACtB/c,KAAK68B,gBAAkBD,EAAUE,SAAS,gBACvC98B,KAAA+8B,WACHzK,EACAtyB,KAAK68B,cACDD,EAAU9e,OAAO,eACjB8e,EAAU7pB,QAAQ,cAAe,IAG3C,CAGA/S,KAAKg9B,UAAU,CACbnJ,UAAW,IAAM7zB,KAAK2vB,KAAKrpB,KAIxBtG,KAAAi9B,UAAYnM,YAAW,KAC1B9wB,KAAKi9B,eAAY,EACZj9B,KAAAw0B,IAAIlb,MAAMkjB,UAAY,kBAE3B1L,YAAW,KACT9wB,KAAK2sB,IAAIG,UAAU3N,eAAe,GAAE,GACnC,GAEEnf,KAAA2sB,IAAIjO,QAAQ,eAAc,GAC9B,IACL,GAAA,CAGO,IAAAmR,SACL,OAAA5tB,EAAAjC,KAAKu1B,QAAOtzB,EAAA4tB,MACd,CAIc,SAAAmN,CAAUpsB,GAAiC,OAAA1O,EAAAlC,KAAA,MAAA,YACvD,MAAMQ,SACER,KAAK2sB,IAAIqB,SAAStlB,KAAKC,cAAcnF,EAAA,CAAA,EACtCxD,KAAK2sB,IAAIqB,SAAS7b,mBAEvB3R,KACEA,EAAK08B,WAAa18B,EAAK28B,WACzBn9B,KAAKu8B,eAAgB,EAGrBv8B,KAAK2sB,IAAI0B,WAAW,CAClBwF,UAAW,KACT/C,YAAW,KACTlgB,EAAKijB,WAAU,GACd,IAAG,EAERqB,SAAU,KACRl1B,KAAK6vB,MAAK,IAKd7vB,KAAK6vB,OAET,GAAA,CAEQ,SAAA4M,GACFz8B,KAAKu1B,QAEJv1B,KAAAu1B,MAAQv1B,KAAK2sB,IAAIhrB,IAAI,gBAAgB8I,OAAO,UAAWzK,KAAKw0B,KAC5Dx0B,KAAAu1B,MAAM6H,gBAAe,KAExBp9B,KAAK2sB,IAAI4C,mBAGJvvB,KAAAi9B,WAAaxG,aAAaz2B,KAAKi9B,WAG/Bj9B,KAAAw0B,IAAIlb,MAAMkjB,UAAY,GAGtBx8B,KAAA2sB,IAAIjO,QAAQ,eAAc,IAEnC,CAEQ,YAAAge,CAAaC,GACnB,MAAMrK,EAAU9B,GACd,sEAIIve,EAEForB,GAAuB,CACrB3wB,KAAM1M,KAAK2sB,IAAIrmB,KAAKkkB,OACpBloB,KAAM,cAGNE,EAAa,CACjB8nB,QAAStqB,KAAKsG,KAAKgkB,QACnBtiB,KAAMhI,KAAKsG,KAAK0B,MAAQ,GACxBU,KAAM/H,KAAKC,UAAUZ,KAAK2sB,IAAIhrB,IAAI,QAAQmrB,WAC1CwQ,MAAO,IAAIxb,MAGT6a,IAAMn6B,EAAMm6B,KAAOA,GACnB38B,KAAK68B,gBAAer6B,EAAMkoB,SAAW,KAEnC,MAAA6S,EAAY,IAAIC,gBAAgBh7B,GAG/B,OAFFxC,KAAA+8B,WAAWzK,EAAS,GAAGrgB,KAAWsrB,EAAU5pB,cAE1C2e,CACT,CAEQ,WAAAuK,GACC,MAAuB,SAAvB78B,KAAKsG,KAAKokB,SACb3O,OAAO0Q,WAAW,gCAAgCtU,QAClDnY,KAAKsG,KAAKokB,QAChB,CAEQ,UAAAqS,CAAWzK,EAA4BvV,GAC7CuV,EAAQvV,IAAMA,EAGXwV,GAAYvyB,KAAKqyB,aACpBC,EAAQI,OAAS,KACZC,GAAY3yB,KAAKqyB,YAAW,CAEnC,EE9KW,MAAAoL,GAA6C7sB,IAAU,CAClE8sB,OAASlf,KCOJ,SACLmf,EACAC,EAAqB,YACrB/S,EAAU,GAEV,MAAMgT,EAA0B,GAElBF,EAAQh5B,QAAQiG,GAAgB,IAAVA,EAAEkzB,MAChCzmB,SAAS0mB,IACb,MAAMC,EAAwB,CAC5B73B,GAAI43B,EAAK53B,GACTF,QAAS83B,EACTpS,SAAU,GACVsS,MAAO,GAGTD,EAASE,OAASF,EAClBH,EAAS7wB,KAAKgxB,GACZ,SAASG,EAAaC,GAChB,MAAAzS,EAAWgS,EAAQh5B,QAAQiG,GAAMA,EAAEkzB,MAAQM,EAAWj4B,KACpC,IAApBwlB,EAAS/hB,SACTw0B,EAAWH,OAASpT,IAASuT,EAAaA,EAAWF,QAChDvS,EAAAtU,SAASgnB,IAChB,MAAMC,EAAyB,CAC7Bn4B,GAAIk4B,EAAMl4B,GACVF,QAASo4B,EACT1S,SAAU,GACVuS,OAAQE,EACRH,MAAOG,EAAWH,MAAQ,GAGjBG,EAAAzS,SAAS3e,KAAKsxB,GACzBH,EAAaG,EAAS,KAdxB,CAgBCN,EAAQ,IAIP,MAAAO,EAAW,CAAC5lB,EAAgB4U,KAC5B,IAAA/oB,EAAImU,EAAExS,GAAKonB,EAAEpnB,GAKV,MAJQ,aAAXy3B,EAAuBp5B,GAAK,IAAIsd,KAAKnJ,EAAE1S,QAAQub,OAAS,IAAIM,KAAKyL,EAAEtnB,QAAQub,MAC3D,cAAXoc,EAAwBp5B,GAAK,IAAIsd,KAAKyL,EAAEtnB,QAAQub,OAAS,IAAIM,KAAKnJ,EAAE1S,QAAQub,MACjE,cAAXoc,EAA4Bp5B,EAAAm5B,EAAQloB,QAAQkD,EAAE1S,SAAW03B,EAAQloB,QAAQ8X,EAAEtnB,SAChE,iBAAX23B,IAA2Bp5B,EAAI+oB,EAAEtnB,QAAQu4B,QAAU7lB,EAAE1S,QAAQu4B,SAC/Dh6B,CAAA,EAUF,OAPL,SAASi6B,EAAWC,GACdA,EAAArnB,SAAS8B,IACbA,EAAKwS,SAAWxS,EAAKwS,SAASgT,KAAKJ,GACnCE,EAAWtlB,EAAKwS,SAAQ,IAH1B,CAKCkS,GAEIA,CACT,ED5DsBe,CAAiCpgB,EAAU5N,EAAKiuB,WAAYjuB,EAAKia,SACzExT,SAAS2mB,UACjB,MAAMc,EAAQluB,EAAKmuB,kBAAkBf,EAAS/3B,SAG9C,OAAAhE,EAAA2O,EAAKouB,gBAAL/8B,EAAoB0uB,YAAYmO,EAAM3O,SAChC2O,EAAAG,YAAYlN,eAGZ,MAAAoM,EAAe,CAACe,EAAsBd,KAC/BA,EAAAzS,SAAStU,SAAS8B,IACrB,MAAAgmB,EAAS3gB,EAASI,MAAMC,GAAMA,EAAE1Y,KAAOgT,EAAKlT,QAAQ63B,MACpDsB,EAASjmB,EAAKlT,QACdo5B,EAASzuB,EAAKmuB,kBAAkBK,EAAQD,GAG9CD,EAAQI,SAASD,GAGjBlB,EAAakB,EAAQlmB,EAAI,GAC1B,EAEHglB,EAAaW,EAAOd,GAGdc,EAAAG,YAAYM,qBACnB,EAEHC,OAAQ,CAACv5B,EAASsoB,WAEhB,MAAMpV,EAAOvI,EAAKmuB,kBAAkB94B,EAASsoB,GAEzC,GAAgB,IAAhBtoB,EAAQ63B,IAEV,OAAA77B,EAAA2O,EAAKouB,gBAAL/8B,EAAoBw9B,QAAQtmB,EAAKgX,aAC5B,CAEL,MAAM+N,EAASttB,EAAK8uB,gBAAgBz5B,EAAQ63B,KACxCI,IACFA,EAAOoB,SAASnmB,EAA0B,aAApBvI,EAAKiuB,WAA4B,SAAW,WAGlE1lB,EAAKwmB,aAAatoB,SAASpM,IACvBA,EAAAg0B,YAAYW,kCAGpB,CAEKzmB,EAAA8lB,YAAYM,mBAEjBpmB,EAAK6X,iBACA7X,EAAA8lB,YAAYlN,kBExCrB,SAAS9S,GACPrO,EACAivB,EACA55B,EACAsoB,GAEItoB,EAAQ65B,eAAc75B,EAAQ85B,gBAAiB,GACnD,MAAM5mB,EAAOvI,EAAKmuB,kBAAkB94B,EAASsoB,GAI7C,GAAItoB,EAAQ+5B,QAAS,CACb,MAAAvR,EAAWtV,EAAKgX,QAChB8P,EAAoBrvB,EAAKouB,cACZ,WAAfa,IAAyB,MAAAI,GAAAA,EAAmB9+B,OAAOstB,IACpC,YAAfoR,IAA0B,MAAAI,GAAAA,EAAmBR,QAAQhR,IACpDtV,EAAA8lB,YAAYlN,cACnB,CAMO,OAFF5Y,EAAA8lB,YAAYM,mBAEVpmB,CACT,CCnBO,MAAM+mB,GACX,WAAArgC,CAAoB8G,GAAA3G,KAAA2G,QAAAA,CAAyB,CAErC,WAAAw5B,GACC,OAAAngC,KAAK2G,QAAQikB,UDxBkCha,ECyB/B5Q,KAAK2G,QDzBoC,CAClE+2B,OAASlf,IACEA,EAAAnH,SAASpR,IAChB,MAAMsoB,EACY,IAAhBtoB,EAAQ63B,SAAY,EAAYtf,EAASI,MAAMC,GAAMA,EAAE1Y,KAAOF,EAAQ63B,MAC1D7e,GAAArO,EAAM,SAAU3K,EAASsoB,EAAY,GACpD,EAEHiR,OAAQ,CAACv5B,EAASsoB,KACHtP,GAAcrO,EAAM,UAAW3K,EAASsoB,GAChDyC,gBAAe,ICgBhByM,GAAmBz9B,KAAK2G,SD1ByB,IAACiK,CC2BxD,CAEA,MAAA8sB,CAAOlf,GACAxe,KAAAmgC,cAAczC,OAAOlf,EAC5B,CAEA,MAAAghB,CAAOv5B,EAAsBsoB,GAC3BvuB,KAAKmgC,cAAcX,OAAOv5B,EAASsoB,EACrC,ECfc,SAAA6R,GAAM95B,EAAwB+5B,GAC5CA,EAAMhpB,SAAQ,EAAG+I,KAAIkgB,MAAKC,eACxB,IAAKngB,EAAI,OAGLmgB,IAAUngB,EAAG9G,MAAMknB,UAAY,GAAGF,EAAM,OAE5C,IAAIG,GAAO,EACX,MAAMC,EAAS,KACT,GAAAD,EAAM,OACNE,G9B5BH,SAAmBvgB,GAExB,OADYwgB,WAAWC,iBAAiBzgB,EAAI,MAAMmR,OAAOxe,QAAQ,KAAM,MACzD,CAChB,C8ByBU4tB,CAAgBvgB,IAAOkgB,EAAK,OAO/Bh6B,EAAKslB,WAoEL,SAAoCkV,GACzC,IAAKA,EAAI1gB,GAAI,OACb,GAAI0gB,EAAI1gB,GAAGuN,UAAUoT,SAASC,IAA0B,OACpDF,EAAA1gB,GAAGuN,UAAUC,IAAIoT,IACrBF,EAAI1gB,GAAG9G,MAAMiY,OAAS,GAAGuP,EAAIR,OAC/B,CAvEUW,CAA2B,CAAE7gB,KAAIkgB,QAsBpC,SAA0B5iB,GAK/B,IAAKA,EAAI0C,GAAI,OACb,IAAK1C,EAAI4iB,IAAK,OACd,GAAI5iB,EAAI0C,GAAGuN,UAAUoT,SAASG,IAAmB,OAE7CxjB,EAAA0C,GAAGuN,UAAUC,IAAIsT,IACrBxjB,EAAI0C,GAAG9G,MAAMiY,OAAS,GAAG7T,EAAI4iB,QACzB5iB,EAAA0C,GAAG9G,MAAM6nB,SAAW,SAGxB,MAAMC,EAAa5Q,GACjB,qCAAqC/O,GAAG,sBAE/B2f,EAAA/N,QAAWrvB,IACpBA,EAAEq9B,kBACFC,GAAmB5jB,EAAI0C,IAEnB1C,EAAI6jB,qBAAqB7jB,EAAI6jB,oBAAoBv9B,EAAC,EAEpD0Z,EAAA0C,GAAGjf,OAAOigC,EAChB,CA/CUI,CAAiB,CAAEphB,KAAIkgB,MAAKiB,oBANJ,WACnBd,GAAA,EACP,OAAAx+B,EAAAqE,EAAKi7B,sBAALt/B,EAAAwJ,KAAAnF,EAAA,GAKwC,EAO5C,OAAIi6B,EAAU,CAEN,MAAAkB,EAAOrhB,EAAGshB,iBAAmC,oBAC/B,IAAhBD,EAAK73B,SAAcwW,EAAG9G,MAAMknB,UAAY,IACvCiB,EAAApqB,SAASwB,IACRA,EAAA6Z,OAAS,IAAMgO,MAEvB,IAEJ,CAGA,MAAMQ,GAAmB,mBA8BlB,SAASI,GAAmB9M,GAC5BA,GACAA,EAAI7G,UAAUoT,SAASG,MAExB1M,EAAA7G,UAAUmE,OAAOoP,IACrBt8B,MAAM+8B,KAAKnN,EAAI7I,UAAUtU,SAASrT,IAC5BA,EAAE2pB,UAAUoT,SAAS,yBAAyB/8B,EAAE8tB,QAAO,IAE7D0C,EAAIlb,MAAMiY,OAAS,GACnBiD,EAAIlb,MAAMknB,UAAY,GACtBhM,EAAIlb,MAAM6nB,SAAW,GACvB,CAGA,MAAMH,GAA0B,0BCxFhC,SAASY,GAAWh+B,GAGd,GAFJA,EAAEi+B,YAAcj+B,EAAE4wB,IAAIlI,cAA2B,aAE7C1oB,EAAEpD,KAAK2a,KAAM,CACf,MAAM2mB,EAAStR,GACb,8DAEKsR,EAAAhiB,UAAYlc,EAAEpD,KAAK+jB,KAC1Bud,EAAOrmB,KAAOsmB,GAAiBn+B,EAAEpD,KAAK2a,MAAQvX,EAAEpD,KAAK2a,KAAO,WAAWvX,EAAEpD,KAAK2a,OAC5EvX,EAAAi+B,YAAY1gC,OAAO2gC,EAAM,MAEzBl+B,EAAAi+B,YAAY/hB,UAAYlc,EAAEpD,KAAK+jB,IAErC,CAEA,SAASyd,GAAkBrV,GACzBA,EAAIsV,iBAAmBtV,EAAI6H,IAAIlI,cAA2B,mBAC1DK,EAAIsV,iBAAiBxiB,UAAY,GAE3B,MAAAyiB,EAAYvV,EAAInsB,KAAK2hC,WACrBC,EAAazV,EAAInsB,KAAK6hC,YAC5B,GAAIH,EAAW,CACP,MAAAI,EAAS9R,GAAoB,mCACnC8R,EAAOxiB,UAAYoiB,EAAUnvB,QAAQ,MAAO0O,GAAG,UACxC6gB,EAAAhpB,MAAMipB,gBAAkBH,GAAc,GACzCzV,EAAAsV,iBAAiB9gC,OAAOmhC,EAAM,MAAA,GACzB3V,EAAInsB,KAAKgiC,YAAa,CAC/B,MAAMC,EAAiBjS,GACrB,0CAA0C/O,GAAG,6BAE3CkL,EAAAsV,iBAAiB9gC,OAAOshC,EAC9B,CAEI,GAAA9V,EAAInsB,KAAKkiC,UAAW,CACtB,MAAMC,EAAenS,GAAoB,kCAAkC/O,GAAG,iBAC1EkL,EAAAsV,iBAAiB9gC,OAAOwhC,EAC9B,CACF,CAEA,SAASC,GAAWjW,GAClB,MAAMkW,EAAQlW,EAAI6H,IAAIlI,cAA2B,aAC3CuW,EAAA/iB,UAAY6M,EAAI1mB,QAAQ68B,mBACxBD,EAAAnP,aAAa,wBAAyB5gB,QAAQ,IAAIgP,KAAK6K,EAAInsB,KAAKghB,OACxE,CAEA,SAASuhB,GAAcpW,GACrB,IAAKA,EAAI/b,KAAKoa,UAAY2B,EAAInsB,KAAKwiC,UAAW,OAE9C,IAAIC,EAAUtW,EAAIkK,QAAQvK,cAAc,eAQpC,GAPC2W,IACOA,EAAAzS,GAAoB,qCAC1B7D,EAAAkK,QAAQ11B,OAAO8hC,IAGrBA,EAAQxjB,UAAY,GAEhBkN,EAAInsB,KAAKwiC,UAAW,CAChB,MAAAE,EAAe1S,GAAoB,0CAC5B0S,EAAApjB,UAAY6M,EAAInsB,KAAKwiC,UAClCC,EAAQ9hC,OAAO+hC,EACjB,CAEI,GAAAvW,EAAI/b,KAAKoa,QAAS,CACpB,MAAMmY,QAAEA,EAASC,GAAAA,GAAOzW,EAAI1mB,QAAQo9B,YACpC,GAAIvwB,OAAOqwB,GAAStrB,OAAQ,CACpB,MAAAyrB,EAAa9S,GAAoB,2CACvC8S,EAAWxjB,UAAYqjB,EACvBF,EAAQ9hC,OAAOmiC,EACjB,CAEA,GAAIxwB,OAAOswB,GAAIvrB,OAAQ,CACf,MAAA0rB,EAAQ/S,GAAoB,sCAClC+S,EAAMzjB,UAAYsjB,EAClBH,EAAQ9hC,OAAOoiC,EACjB,CACF,CACF,CC1EA,MAAqBC,GAgBnB,WAAA3jC,CAAY+Q,GAfJ7Q,EAAAC,KAAA,QACDD,EAAAC,KAAA,OAEYD,EAAAC,KAAA,aAAA,GAEZD,EAAAC,KAAA,eACAD,EAAAC,KAAA,mBAKeD,EAAAC,KAAA,gBAAA,GACfD,EAAAC,KAAA,mBAIAA,KAAAw0B,IAAMhE,GAAoB,+CAE/BxwB,KAAK4Q,KAAuB,iBAATA,EAAoB,CAAEiC,KAAMjC,GAASA,EACnD5Q,KAAAw0B,IAAI1U,UAAY9f,KAAKyjC,UAGtBzjC,KAAK4Q,KAAK8yB,WAAgB1jC,KAAAw0B,IAAId,aAAa,sBAAuB,GACxE,CAhBA,eAAWiQ,GACF,QAAE3jC,KAAK4jC,WAChB,CAiBO,QAAAC,CAASC,GAEP,OADHA,EAAA3iC,OAAOnB,KAAKw0B,KACTx0B,IACT,CAGQ,OAAAyjC,GACC,MAA0B,iBAAnBzjC,KAAK4Q,KAAKiC,KAAoB7S,KAAK4Q,KAAKiC,KAAO7S,KAAK4Q,KAAKiC,MACzE,CAGO,QAAAkxB,CAAS9L,GACTj4B,KAAAw0B,IAAInB,QAAWrvB,IAIlB,GAHAA,EAAEq9B,mBAGErhC,KAAKgkC,UAAT,CAKA,GAAIhkC,KAAK4Q,KAAKoW,UAAYhnB,KAAK2jC,YAAa,CAC1C,MAAMM,EAAiB,KACrBjkC,KAAKkkC,cAAe,EACflkC,KAAAw0B,IAAI7G,UAAUmE,OAAO,mBACrB9xB,KAAAw0B,IAAI1U,UAAY9f,KAAKyjC,SAAQ,EAGhC,IAACzjC,KAAKkkC,aAKR,OAJAlkC,KAAKkkC,cAAe,EACflkC,KAAAw0B,IAAI7G,UAAUC,IAAI,mBACvB5tB,KAAKw0B,IAAI1U,UAAY9f,KAAK4Q,KAAKuzB,aAAe1iB,GAAG,sBACjDzhB,KAAKokC,gBAAkBroB,OAAO+U,YAAW,IAAMmT,KAAkB,MAI/DjkC,KAAKokC,iBAAwBroB,OAAA0a,aAAaz2B,KAAKokC,oBAErD,CAGA,GAAIpkC,KAAK4jC,YAGP,OAFA5jC,KAAKqkC,uBACLrkC,KAAKskC,sBAzBP,EAgCJ,CAGO,UAAAC,CAAW1xB,GACZA,IAAM7S,KAAK4Q,KAAKiC,KAAOA,GAC3B7S,KAAKme,YAAW,GACXne,KAAAw0B,IAAI1U,UAAY9f,KAAKyjC,SAC5B,CAGO,UAAAtlB,CAAWha,EAAgBqgC,GAC5BxkC,KAAKgkC,YAAc7/B,IACvBnE,KAAKgkC,UAAY7/B,EACbA,GACGnE,KAAAw0B,IAAI7G,UAAUC,IAAI,mBACvB5tB,KAAKw0B,IAAI1U,UAAY0kB,GAAe,GAAG/iB,GAAG,kBAErCzhB,KAAAw0B,IAAI7G,UAAUmE,OAAO,mBACrB9xB,KAAAw0B,IAAI1U,UAAY9f,KAAKyjC,WAE9B,CAGO,QAAAzR,CAASnf,GACT7S,KAAAykC,OAAO5xB,EAAM,gBACpB,CAGO,OAAA6xB,CAAQ7xB,GACR7S,KAAAykC,OAAO5xB,EAAM,eACpB,CAGO,UAAA8xB,CAAW9xB,GACX7S,KAAAykC,OAAO5xB,EAAM,kBACpB,CAGO,MAAA4xB,CAAO5xB,EAAc+E,EAAoBgtB,EAAqBhT,GACnE5xB,KAAKme,YAAW,GACZvG,GAAgB5X,KAAAw0B,IAAI7G,UAAUC,IAAIhW,GACtC5X,KAAKw0B,IAAI1U,UAAYjN,EAGrB7S,KAAK6kC,gBAAe,KACb7kC,KAAAw0B,IAAI1U,UAAY9f,KAAKyjC,UACtB7rB,GAAgB5X,KAAAw0B,IAAI7G,UAAUmE,OAAOla,GACrCga,SACHgT,GAAc,KACnB,CAGQ,cAAAC,CAAe5M,EAAkB2M,GACvC5kC,KAAKqkC,kBACLrkC,KAAKskC,mBAELtkC,KAAK8kC,gBAAkB7M,EAClBj4B,KAAA4jC,YAAc7nB,OAAO+U,YAAW,SAEnC9wB,KAAKskC,kBAAiB,GACrBM,EACL,CAGQ,eAAAP,GACFrkC,KAAK8kC,iBAAiB9kC,KAAK8kC,iBACjC,CAGQ,gBAAAR,GACFtkC,KAAK4jC,aAAoB7nB,OAAA0a,aAAaz2B,KAAK4jC,aAC/C5jC,KAAK4jC,iBAAc,EACnB5jC,KAAK8kC,qBAAkB,CACzB,EClJF,SAASC,GAAWnhC,GACbA,EAAEgN,KAAK1H,OAGZtF,EAAEohC,UAAY,IAAIxB,IAAU,IAAM,GAAG/hB,GAAG,cAAc7d,EAAEpD,KAAKg+B,SAAW,OAAMqF,SAASjgC,EAAE6wB,UACvF7wB,EAAAohC,UAAUjB,UAAS,KACnBngC,EAAEqC,QAAQg/B,aAAa/7B,KAAK,KAAI,IAI9BtF,EAAEgN,KAAKiV,WACTjiB,EAAEshC,YAAc,IAAI1B,IAAU,IAAM,GAAG/hB,GAAG,gBAAgB7d,EAAEpD,KAAK2kC,WAAa,OAAMtB,SAClFjgC,EAAE6wB,UAEF7wB,EAAAshC,YAAYnB,UAAS,KACrBngC,EAAEqC,QAAQg/B,aAAa/7B,KAAK,OAAM,KAGxC,CAGA,SAASk8B,GAAYxhC,GACf,IAACA,EAAEpD,KAAKu/B,eAAgB,OAE5B,MAAMsF,EAAW7U,GAAoB,SAAS/O,GAAG,mBAC/C7d,EAAA6wB,SAAStzB,OAAOkkC,GACTA,EAAAj1B,iBAAiB,SAAUpM,IAClCA,EAAEq9B,kBACFz9B,EAAEgN,KAAK2d,aAAa3qB,EAAEpD,KAAMoD,EAAE4wB,IAAG,GAErC,CAGA,SAAS8Q,GAAe1hC,GAChB,MAAA2hC,EAAc,IAAI/B,GAAU,CAChC3wB,KAAM,IAAOjP,EAAEpD,KAAKs/B,aAAere,GAAG,UAAYA,GAAG,YACrDiiB,WAAW,IAED6B,EAAA1B,SAASjgC,EAAE6wB,UACvB8Q,EAAYxB,UAAS,KACnBngC,EAAEqC,QAAQg/B,aAAaO,UAAU,YAAaD,EAAW,GAE7D,CAGA,SAASE,GAAgB7hC,GACjB,MAAA8hC,EAAa,IAAIlC,GAAU,CAC/B3wB,KAAM,IAAOjP,EAAEpD,KAAKmlC,WAAalkB,GAAG,WAAaA,GAAG,YACpDiiB,WAAW,IAEFgC,EAAA7B,SAASjgC,EAAE6wB,UACtBiR,EAAW3B,UAAS,KAClBngC,EAAEqC,QAAQg/B,aAAaO,UAAU,UAAWE,EAAU,GAE1D,CAGA,SAASE,GAAUhiC,GACX,MAAAiiC,EAAY,IAAIrC,GAAU,CAC9B3wB,KAAM,IAAOjP,EAAEpD,KAAKkiC,UAAYjhB,GAAG,SAAWA,GAAG,OACjDiiB,WAAW,IAEHmC,EAAAhC,SAASjgC,EAAE6wB,UACrBoR,EAAU9B,UAAS,KACjBngC,EAAEqC,QAAQg/B,aAAaO,UAAU,SAAUK,EAAS,GAExD,CAGA,SAASC,GAAWliC,GACZ,MAAAmiC,EAAU,IAAIvC,GAAU,CAC5B3wB,KAAM4O,GAAG,QACTiiB,WAAW,IAELqC,EAAAlC,SAASjgC,EAAE6wB,UACnBsR,EAAQhC,UAAS,KACfngC,EAAEgN,KAAKge,YAAYhrB,EAAEpD,KAAMoD,EAAE4wB,IAAG,GAEpC,CAGA,SAASwR,GAAUpiC,GACX,MAAAqiC,EAAS,IAAIzC,GAAU,CAC3B3wB,KAAM4O,GAAG,UACTuF,SAAS,EACTmd,YAAa1iB,GAAG,iBAChBiiB,WAAW,IAENuC,EAAApC,SAASjgC,EAAE6wB,UAClBwR,EAAOlC,UAAS,KACdngC,EAAEqC,QAAQg/B,aAAaiB,YAAYD,EAAM,GAE7C,CC3GA,MAAME,GAAU,CAAAC,OCHhB,SAAqCxiC,GACnC,MAAMyiC,EAAUziC,EAAE4wB,IAAIlI,cAA2B,eAC3Cga,EAAa9V,GAAsC,WAEnD+V,EAAmB3iC,EAAEgN,KAAK21B,iBAG5B,GAFOD,EAAAvpB,IAAMwpB,EAAmBA,EAAiB3iC,EAAEpD,MAAQoD,EAAEqC,QAAQugC,iBAErE5iC,EAAEpD,KAAK2a,KAAM,CACf,MAAMsrB,EAAWjW,GACf,8DAEFiW,EAAShrB,KAAOsmB,GAAiBn+B,EAAEpD,KAAK2a,MAAQvX,EAAEpD,KAAK2a,KAAO,WAAWvX,EAAEpD,KAAK2a,OAChFsrB,EAAStlC,OAAOmlC,GAChBD,EAAQllC,OAAOslC,EAAQ,MAEvBJ,EAAQllC,OAAOmlC,EAEnB,EDbEI,OHHF,SAAqC9iC,GACnC/C,OAAOy5B,QAAQ,CACbsH,cACAI,qBACAY,cACAG,mBACC1rB,SAAQ,EAAExI,EAAM4rB,MACjBA,EAAO72B,EAAC,GAEZ,EGLE+iC,QEHF,SAAsC/iC,GAChC,IAACA,EAAEpD,KAAKs/B,aAGV,OAFAl8B,EAAE8wB,SAASjV,UAAY7b,EAAEqC,QAAQ+0B,wBACjCp3B,EAAE8wB,SAAS/G,UAAUmE,OAAO,WAAY,iBAK1CluB,EAAE8wB,SAAS/G,UAAUC,IAAI,WAAY,sBAC/B,MAAAgZ,EAAkBpW,GAAoB,mEAEf/O,GAAG,4DACCA,GAAG,gCAElC7d,EAAAijC,MAAMC,sBAAsB,YAAaF,GAErC,MAAAG,EAAiBH,EAAgBta,cAA2B,iBACnDya,EAAA32B,iBAAiB,SAAUpM,IACxCA,EAAEq9B,kBAEEz9B,EAAE8wB,SAAS/G,UAAUoT,SAAS,aAChCn9B,EAAE8wB,SAASjV,UAAY7b,EAAEqC,QAAQ+0B,mBAC/Bp3B,EAAA8wB,SAAS/G,UAAUmE,OAAO,YACzBkV,GAAepjC,EAAE8wB,UACLqS,EAAAjnB,UAAY2B,GAAG,cAE9B7d,EAAE8wB,SAASjV,UAAY,GACrB7b,EAAA8wB,SAAS/G,UAAUC,IAAI,YACVmZ,EAAAjnB,UAAY2B,GAAG,UAChC,GAEJ,EF3BEwlB,QGNF,SAAsCrjC,GAChCA,EAAEgN,KAAKga,UAA2B,IAAfhnB,EAAEpD,KAAKs9B,KACzBl6B,EAAEgN,KAAKs2B,UAEZtjC,EAAEujC,SAAW3W,GACX,4GAEA5sB,EAAAujC,SAAS7a,cAA2B,aAAcxM,UAAY,GAAGlc,EAAEgN,KAAKs2B,QAAQ3iB,OAChF3gB,EAAAujC,SAAS9T,QAAU,KACjBzvB,EAAAqC,QAAQg/B,aAAamC,kBAAiB,EAG1CxjC,EAAEq+B,iBAAiB6E,sBAAsB,WAAYljC,EAAEujC,UACzD,EHNEE,QILF,SAAsCzjC,GAChC,IAACA,EAAEgN,KAAKga,SAAU,OAClB,IAAChnB,EAAEgN,KAAKs2B,QAAS,OAEnBtjC,EAAA0jC,SAAW9W,GAAoB,iEAEL/O,GAAG,qGAK/B,MAAMqV,EAAQlzB,EAAE0jC,SAAShb,cAA2B,aACpDwK,EAAMhX,UAAY,IAAIlc,EAAEgN,KAAKs2B,QAAQ3iB,OACrCuS,EAAMzD,QAAU,KACZzvB,EAAAqC,QAAQg/B,aAAamC,kBAAiB,EAI1C,IAAIG,EAAetsB,GAAOrX,EAAEgN,KAAKs2B,QAAQ1tB,SACrC5V,EAAEgN,KAAKs2B,QAAQpH,eAA6ByH,EAAA,IAAI9lB,GAAG,iBACvD7d,EAAE0jC,SAAShb,cAA2B,gBAAiB7M,UAAY8nB,EAGjE3jC,EAAAijC,MAAMpH,QAAQ77B,EAAE0jC,SACpB,EJlBEE,QKPF,SAAsC5jC,GAChC,IAACA,EAAEpD,KAAKmlC,WAAY,OAExB,MAAM8B,EAAYjX,GAAoB,4BAA4B/O,GAAG,uBACnE7d,EAAAijC,MAAMpH,QAAQgI,EAClB,ELGEC,QDPF,SAAsC9jC,GACpC/C,OAAOy5B,QAAQ,CACbyK,cACAK,eAEAE,kBACAG,mBACAG,aACAE,cACAE,eACC3uB,SAAQ,EAAExI,EAAM4rB,MACjBA,EAAO72B,EAAC,GAEZ,GOZA,MAAqB+jC,GAyBZ,WAAA9nC,CAAYoG,GAxBZlG,EAAAC,KAAA,WASAD,EAAAC,KAAA,OACAD,EAAAC,KAAA,SACAD,EAAAC,KAAA,WACAD,EAAAC,KAAA,eACAD,EAAAC,KAAA,oBACAD,EAAAC,KAAA,SACAD,EAAAC,KAAA,YACAD,EAAAC,KAAA,iBACAD,EAAAC,KAAA,YACAD,EAAAC,KAAA,aACAD,EAAAC,KAAA,eAEAD,EAAAC,KAAA,YACAD,EAAAC,KAAA,YAGLA,KAAKiG,QAAUA,CACjB,CAxBA,QAAWzF,GACF,OAAAR,KAAKiG,QAAQ6mB,SACtB,CACA,QAAWlc,GACF,OAAA5Q,KAAKiG,QAAQusB,SACtB,CA8BO,MAAAiI,GN5BT,IAAoC72B,EMgDhC,OAlBK5D,KAAAw0B,IAAMhE,GCjDA,ygBDmDXxwB,KAAK4nC,MAAQ5nC,KAAKw0B,IAAIlI,cAAc,aACpCtsB,KAAK62B,QAAU72B,KAAKw0B,IAAIlI,cAAc,eACtCtsB,KAAK6mC,MAAQ7mC,KAAKw0B,IAAIlI,cAAc,aACpCtsB,KAAK00B,SAAW10B,KAAK6mC,MAAMva,cAAc,gBACzCtsB,KAAKy0B,SAAWz0B,KAAKw0B,IAAIlI,cAAc,gBAEvCtsB,KAAKw0B,IAAId,aAAa,KAAM,eAAe1zB,KAAKQ,KAAK2F,MNtCrBvC,EMyCpB5D,KNxCPa,OAAAy5B,QAAQ6L,IAAS9uB,SAAQ,EAAExI,EAAM4rB,MACtCA,EAAO72B,EAAC,IM0CJ5D,KAAK6nC,eACF7nC,KAAA4nC,MAAMzmC,OAAOnB,KAAK6nC,eAGlB7nC,KAAKw0B,GACd,CAGO,gBAAA+K,GACC,MAAAj5B,EAAOtG,KAAK4Q,KAAK8a,YACvB,IAAKplB,IAASA,EAAKkT,UAAYlT,EAAKqlB,SAAU,OAE9C,MAAMmc,EAAcxhC,EAAKkT,QACnBuuB,EAAezhC,EAAKqlB,SAEdqc,GACV,CACEzG,oBAAqB,KAEb,MAAA5V,EAAW3rB,KAAKiG,QAAQgiC,cACN,IAApBtc,EAAS/hB,QACXs+B,GAA+Bvc,EAAS,GAAGsT,YAAYvK,SAAQ,EAEnE9I,WAAYtlB,EAAKslB,YAEnB,CAEE,CAAExL,GAAIpgB,KAAK00B,SAAU4L,IAAKwH,EAAavH,UAAU,GACjD,CAAEngB,GAAIpgB,KAAKsnC,SAAUhH,IAAKwH,EAAavH,UAAU,GAEjD,CAAEngB,GAAIpgB,KAAK6nC,cAAevH,IAAKyH,EAAcxH,UAAU,IAG7D,CAGO,4BAAAX,GACA5/B,KAAK6nC,eACEK,GAAmBloC,KAAK6nC,cACtC,CAGA,YAAA9V,GACEiV,GAAkBhnC,KAAKiG,QAAQg5B,YAAYzK,IAC7C,CAGA,mBAAA2T,GACEnB,GAAkBhnC,KAAKiG,QAAQg5B,YAAY4H,MAC7C,CAGA,aAAAuB,GAEOpoC,KAAAw0B,IAAI7G,UAAUmE,OAAO,kBAC1B/V,OAAO+U,YAAW,KAEX9wB,KAAAw0B,IAAI7G,UAAUC,IAAI,iBAAgB,GACtC,IACL,CAGO,eAAAya,GAML,OALKroC,KAAK6nC,gBAEH7nC,KAAA6nC,cAAgBrX,GAAoB,4CACpCxwB,KAAA4nC,MAAMzmC,OAAOnB,KAAK6nC,gBAElB7nC,KAAK6nC,aACd,CAGO,SAAAS,CAAUlqB,GACXA,EAAUpe,KAAAw0B,IAAI7G,UAAUC,IAAI,cACtB5tB,KAAAw0B,IAAI7G,UAAUmE,OAAO,aACjC,CAGO,WAAAyW,CAAYnqB,GACbA,EAAUpe,KAAAw0B,IAAI7G,UAAUC,IAAI,gBACtB5tB,KAAAw0B,IAAI7G,UAAUmE,OAAO,eACjC,CAGO,UAAA0W,CAAW3kB,GAChB7jB,KAAKuoC,aAAY,GACZvoC,KAAAw0B,IAAInB,QAAWjJ,IAClBA,EAAIiX,kBACJtlB,OAAOmN,KAAKrF,EAAG,CAEnB,CAGO,aAAA4kB,CAAcl3B,GACnBvR,KAAKuoC,aAAY,GACZvoC,KAAAw0B,IAAInB,QAAWjJ,IAClBA,EAAIiX,sBAGR,EE9JF,MAAqBqH,GAaZ,WAAA7oC,CAAYoG,GAZXlG,EAAAC,KAAA,WAaNA,KAAKiG,QAAUA,CACjB,CAZA,QAAYzF,GACH,OAAAR,KAAKiG,QAAQ6mB,SACtB,CACA,QAAYlc,GACH,OAAA5Q,KAAKiG,QAAQusB,SACtB,CACQ,MAAAxE,GACN,OAAOhuB,KAAKiG,QAAQusB,UAAUxE,QAChC,CAOO,IAAA9kB,CAAK3G,GACJ,MAAAomC,EACK,OAATpmC,EAAgBvC,KAAKiG,QAAQg5B,YAAY+F,UAAYhlC,KAAKiG,QAAQg5B,YAAYiG,YAE3EllC,KAAAguB,SACF4a,MAAM1/B,KAAK,WAAW3G,IAAQvC,KAAKQ,KAAK2F,GAAI3C,EACxC,CAAA,EAAAxD,KAAKguB,SAAS7b,kBAElBzO,MAAM4pB,YACAttB,KAAAQ,KAAKg+B,QAAUlR,EAAI9sB,KAAKqoC,GACxB7oC,KAAAQ,KAAK2kC,UAAY7X,EAAI9sB,KAAKsoC,KAC/B,OAAA7mC,EAAAjC,KAAKiG,QAAQg5B,YAAY+F,YAAW/iC,EAAAsiC,aACpC,OAAApiC,EAAAnC,KAAKiG,QAAQg5B,YAAYiG,cAAa/iC,EAAAoiC,YAAA,IAEvCxgC,OAAOgL,IACK,MAAA45B,GAAAA,EAAA3W,SAASvQ,GAAG,aACvBtS,QAAQtL,MAAMkL,EAAG,GAEvB,CAGO,SAAAy2B,CAAUjjC,EAA0CwmC,GACzD,GAAIA,EAAQ/E,UAAW,OAEvB+E,EAAQ5qB,YAAW,EAAM,GAAGsD,GAAG,iBAGzB,MAAAunB,EAASxlC,KAAKxD,KAAKQ,MACZ,cAAT+B,EACKymC,EAAAlJ,cAAgBkJ,EAAOlJ,aACZ,YAATv9B,EACFymC,EAAArD,YAAcqD,EAAOrD,WACV,WAATpjC,IACFymC,EAAAtG,WAAasG,EAAOtG,WAG7B1iC,KAAKguB,SACFxP,SAASpY,cAAcpG,KAAKQ,KAAK2F,GAAI3C,EAAA,CAAA,EACjCwlC,IAEJtlC,MAAM4pB,IACLyb,EAAQ5qB,YAAW,GAGdne,KAAAiG,QAAQgjC,QAAQ3b,EAAI9sB,KAAI,IAE9BuD,OAAOgL,IACNI,QAAQtL,MAAMkL,GACNg6B,EAAA/W,SAASvQ,GAAG,YAAW,GAErC,CAGO,WAAAykB,CAAY6C,GACbA,EAAQ/E,YAEZ+E,EAAQ5qB,YAAW,EAAM,GAAGsD,GAAG,kBAC1BzhB,KAAAguB,SACFxP,SAASnY,cAAcrG,KAAKQ,KAAK2F,IACjCzC,MAAK,KACJqlC,EAAQ5qB,YAAW,GACfne,KAAK4Q,KAAKs4B,UAAelpC,KAAA4Q,KAAKs4B,SAASlpC,KAAKiG,QAAO,IAExDlC,OAAOC,IACNmL,QAAQtL,MAAMG,GACN+kC,EAAA/W,SAASvQ,GAAG,cAAa,IAEvC,CAGO,gBAAA2lB,GACC,MAAA+B,EAAWptB,OAAOC,SAAShE,KAC3BoxB,EAAa,gBAAgBppC,KAAKQ,KAAKs9B,MAE7C/hB,OAAOC,SAAShE,KAAOoxB,EACnBA,IAAeD,GAAUptB,OAAO/M,cAAc,IAAIZ,MAAM,cAC9D,EC/DF,MAAqBi7B,GAcnB,WAAAxpC,CAAYW,EAAmBoQ,GAb/B7Q,EAAAC,KAAA,OAEQD,EAAAC,KAAA,kBACAD,EAAAC,KAAA,kBAEAD,EAAAC,KAAA,QACAD,EAAAC,KAAA,QAEAD,EAAAC,KAAA,UACAD,EAAAC,KAAA,WAA0B,IAE1BD,EAAAC,KAAA,YAGNA,KAAK4Q,KAAOA,EACP5Q,KAAAQ,KAAOgD,EAAK,CAAA,EAAAhD,GACjBR,KAAKQ,KAAKghB,KAAOxhB,KAAKQ,KAAKghB,KAAKzO,QAAQ,KAAM,KAE9C/S,KAAKk+B,OAAS,KACdl+B,KAAKspC,SAAW,EAEXtpC,KAAAupC,eAAiB,IAAIb,GAAe1oC,MACpCA,KAAAwpC,eAAiB,IAAIC,GAAUzpC,KACtC,CAGO,MAAAy6B,GACC,MAAAiP,EAAQ1pC,KAAKwpC,eAAe/O,SAE9Bz6B,KAAKw0B,KAAUx0B,KAAAw0B,IAAI2E,YAAYuQ,GACnC1pC,KAAKw0B,IAAMkV,EAMP1pC,KAAK4Q,KAAK+4B,eAAe3pC,KAAK4Q,KAAK+4B,eACzC,CAGO,UAAA1E,GACL,OAAOjlC,KAAKupC,cACd,CAGO,SAAAtK,GACL,OAAOj/B,KAAKwpC,cACd,CAGO,OAAA1c,GACL,OAAO9sB,KAAKQ,IACd,CAGO,OAAAyoC,CAAQzoC,GACbR,KAAKQ,KAAOA,EAEZR,KAAKy6B,SACAz6B,KAAAi/B,YAAYkJ,qBACnB,CAGO,SAAAyB,GACL,OAAO5pC,KAAKk+B,MACd,CAGO,WAAA+J,GACL,OAAOjoC,KAAK2rB,QACd,CAGO,WAAAke,GACL,OAAO7pC,KAAKspC,QACd,CAGO,SAAAQ,GACE,OAAkB,IAAlB9pC,KAAKQ,KAAKs9B,GACnB,CAGO,KAAAiM,GACL,OAAO/pC,KAAKQ,KAAK2F,EACnB,CAGO,QAAAm5B,CAAShB,EAAwBuB,EAAmC,UACzEvB,EAAUJ,OAASl+B,KACTs+B,EAAAgL,SAAWtpC,KAAKspC,SAAW,EAChCtpC,KAAA2rB,SAAS3e,KAAKsxB,GAEb,MAAAuJ,EAAgB7nC,KAAKgqC,oBACrBC,EAAgB3L,EAAUnO,QACb,WAAf0P,EAAyBgI,EAAc1mC,OAAO8oC,GAC1B,YAAfpK,GAA0BgI,EAAcpI,QAAQwK,GAE/C3L,EAAAW,YAAYlN,eACZuM,EAAAW,YAAYM,kBACxB,CAGO,iBAAAyK,GAEL,OAAIhqC,KAAKspC,UAAYtpC,KAAK4Q,KAAKia,QACtB7qB,KAAKk+B,OAAQ8L,oBAEfhqC,KAAKi/B,YAAYoJ,iBAC1B,CAGO,UAAA1I,GACL,MAAMuK,EAAgC,GACtC,IAAIhM,EAASl+B,KAAKk+B,OAClB,KAAOA,GACLgM,EAAel9B,KAAKkxB,GACpBA,EAASA,EAAO0L,YAEX,OAAAM,CACT,CAQO,KAAA/Z,GACL,IAAKnwB,KAAKw0B,IAAW,MAAA,IAAI5lB,MAAM,oDAC/B,OAAO5O,KAAKw0B,GACd,CAOA,KAAAuB,GACE,IAAK/1B,KAAKw0B,IAAW,MAAA,IAAI5lB,MAAM,oDAG/B5O,KAAK2/B,aAAatoB,SAASpM,IACvBA,EAAAg0B,YAAYW,kCAIhB5/B,KAAKgxB,iBAGAhxB,KAAAi/B,YAAYmJ,eACnB,CAEA,cAAApX,GACOhxB,KAAAw0B,KACHwF,GAAkBh6B,KAAKw0B,KAAK,EAAOx0B,KAAK4Q,KAAKmpB,kBAAoB/5B,KAAK4Q,KAAKmpB,mBAC/E,CAKA,MAAAjI,SACE,OAAA7vB,EAAAjC,KAAKw0B,MAAKvyB,EAAA6vB,QACZ,CAGO,cAAA0U,GACL,M3C7FK,IADsB51B,E2C8FC,CAC1B0a,OAAQtrB,KAAK4Q,KAAKya,SAASC,OAC3B3oB,OAAQ3C,KAAK4Q,KAAKya,SAAS1oB,OAC3BwnC,UAAWnqC,KAAKQ,KAAK4pC,kB3ChGV9e,OAAOvY,QAAQ,MAAO,OAAOnC,EAAKu5B,aAAav5B,EAAKjO,OAAOoQ,QAAQ,MAAO,MADpF,IAAwBnC,C2CmG7B,CAGO,gBAAAoqB,GACE,OAAA/f,GAAOjb,KAAKQ,KAAKgZ,QAC1B,CAGO,gBAAAspB,GACE,OAAAuH,GAAc,IAAIvoB,KAAK9hB,KAAKQ,KAAKghB,MAAOC,GACjD,CAGO,SAAA4hB,GACL,MAAMiH,EC9NV,SAAgBpnB,GACR,MAAAqnB,EAAOxuB,QAAkB,GACzByuB,EAAMvnB,WAAa,GAEnB1M,EAAIzD,OAAOoQ,GAAasnB,EAAItnB,WAC5B7F,EAAO,CACX+lB,GAAI,GACJqH,UAAW,GACXC,OAAQ,GACRvH,QAAS,GACTwH,OAAQ,GACRne,SAAU,GACVjZ,QAAS,IAILq3B,EAAc,CAClBC,QAASt0B,EAAEumB,SAAS,YAAcvmB,EAAEumB,SAAS,WAC7CgO,OAAQv0B,EAAEumB,SAAS,UACnBiO,OAAQx0B,EAAEumB,SAAS,eACnBkO,MAAOz0B,EAAEumB,SAAS,WAIdmO,EAAe,CACnBC,OAAQ30B,EAAEumB,SAAS,UACnBqO,OAAQ50B,EAAEumB,SAAS,WAAavmB,EAAEumB,SAAS,SAC3CsO,GAAI70B,EAAEumB,SAAS,SAAWvmB,EAAEumB,SAAS,WACrCuO,KAAM90B,EAAEumB,SAAS,SAAWvmB,EAAEumB,SAAS,OACvCwO,QAAS/0B,EAAEumB,SAAS,YAAcvmB,EAAEumB,SAAS,SAC7C,gBAAiBvmB,EAAEumB,SAAS,SAC5ByO,SAAUh1B,EAAEumB,SAAS,YACrB0O,MAAOj1B,EAAEumB,SAAS,UAAYvmB,EAAEumB,SAAS,OACzC2O,QAASl1B,EAAEumB,SAAS,WACpB4O,OAAQn1B,EAAEumB,SAAS,aACnB6O,OAAQp1B,EAAEumB,SAAS,WAAavmB,EAAEumB,SAAS,SAC3C,IAAKvmB,EAAEumB,SAAS,UAAYvmB,EAAEumB,SAAS,SACvC8O,GAAIr1B,EAAEumB,SAAS,OAASvmB,EAAEumB,SAAS,aACnC+O,UAAWt1B,EAAEumB,SAAS,aACtBgP,GAAIv1B,EAAEumB,SAAS,OACfiP,MAAOx1B,EAAEumB,SAAS,UAAYvmB,EAAEumB,SAAS,eACzCkP,QAASz1B,EAAEumB,SAAS,WACpBmP,MAAO11B,EAAEumB,SAAS,WAAavmB,EAAEumB,SAAS,SAC1CoP,UAAW31B,EAAEumB,SAAS,aACtB,eAAgBvmB,EAAEumB,SAAS,gBAC3BqP,SAAU51B,EAAEumB,SAAS,YACrBsP,KAAM71B,EAAEumB,SAAS,eACjBuP,MAAO91B,EAAEumB,SAAS,SAClBwP,KAAM/1B,EAAEumB,SAAS,QACjByP,OAAQh2B,EAAEumB,SAAS,kBACnB0P,OAAQj2B,EAAEumB,SAAS,aACnB2P,OAAQl2B,EAAEumB,SAAS,aACnB4P,MAAOn2B,EAAEumB,SAAS,SAClB6P,OAAQp2B,EAAEumB,SAAS,oBACnB8P,OAAQr2B,EAAEumB,SAAS,cACnB+P,MAAOt2B,EAAEumB,SAAS,aAIdgQ,EAAU,CACdC,QAASx2B,EAAEumB,SAAS,WACpBkQ,MAAOz2B,EAAEumB,SAAS,UAAYvmB,EAAEumB,SAAS,OACzCmQ,MAAS12B,EAAEumB,SAAS,aACpBoQ,QAAS32B,EAAEumB,SAAS,YAAcvmB,EAAEumB,SAAS,OAC7CqQ,OAAQ52B,EAAEumB,SAAS,UACnBsQ,QAAS72B,EAAEumB,SAAS,WACpBuQ,OAAQ92B,EAAEumB,SAAS,UACnB,gBAAiBvmB,EAAEumB,SAAS,aAAevmB,EAAEumB,SAAS,iBACtDwQ,WAAY/2B,EAAEumB,SAAS,eAAiBvmB,EAAEumB,SAAS,OACnDyQ,MAAOh3B,EAAEumB,SAAS,SAClB0Q,QAASj3B,EAAEumB,SAAS,WACpB2Q,IAAKl3B,EAAEumB,SAAS,iBAChB,YAAavmB,EAAEumB,SAAS,QACxB4Q,MAAOn3B,EAAEumB,SAAS,UAId6Q,EAAc,CAClBC,OAAQr3B,EAAEumB,SAAS,SAAWvmB,EAAEumB,SAAS,QAAUvmB,EAAEumB,SAAS,OAC9D+Q,OAAQt3B,EAAEumB,SAAS,WAAavmB,EAAEumB,SAAS,QAAUvmB,EAAEumB,SAAS,YAI9D6Q,EAAYC,OACdD,EAAYC,QAAWr3B,EAAEumB,SAAS,QACzBmO,EAAaE,QAAU50B,EAAEumB,SAAS,QAE3CmO,EAAaE,QAAS,EACtBF,EAAaI,MAAO,GACXd,EAAIuD,iBAAmBvD,EAAIwD,SACpC9C,EAAaE,QAAS,EACtBF,EAAa,MAAS,GAIxB5tB,EAAKstB,OAAS,KAGdttB,EAAKmP,eACG,MACAwhB,GADMxD,EAAYyD,iBAAmBzD,EAAIhe,UACjC7U,MAAM,KAEb,OADHq2B,EAAI,KAAIA,EAAI,GAAKA,EAAI,GAAGvkB,eACrBukB,EAAIvpC,KAAK,SAIlB,MAAMuT,EAAO,CACX0yB,OAAQE,EACRzH,QAAS8H,EACT7H,GAAI0J,EACJnC,OAAQgD,GAEH9sC,OAAAy5B,QAAQtiB,GAAMX,SAAQ,EAAE9U,EAAMmQ,MAC5B7R,OAAAy5B,QAAQ5nB,GAAO2E,SAAQ,EAAExI,EAAM5C,OACrB,IAAXA,IAAiBoR,EAAK9a,GAAQsM,EAAA,GACnC,IAIH,MAAM47B,EAAY,CAChBsC,QAAS,KACP,MAAMvoC,EAAI+R,EAAExD,QAAQ,6BAA8B,MAa3C,MAZQ,CACb,IAAO,KACP,IAAO,MACP,IAAO,IACP,IAAO,IACP,MAAO,QACP,IAAO,KACP,IAAO,KACP,MAAO,OACP,OAAQ,KACR,OAAQ,MAEIvO,IAAMA,CAAA,EAEtB0oC,QAAS,IAAM32B,EAAExD,QAAQ,0BAA2B,MACpD06B,IAAK,IAAMl3B,EAAExD,QAAQ,yBAA0B,MAAMA,QAAQ,KAAM,KACnEs6B,OAAQ,IAAM92B,EAAExD,QAAQ,yBAA0B,MAClD,gBAAiB,IAAMwD,EAAExD,QAAQ,sCAAuC,MACxEk6B,MAAS,IAAM12B,EAAExD,QAAQ,0BAA2B,MAAMA,QAAQ,KAAM,KACxE26B,MAAO,IAAMn3B,EAAExD,QAAQ,yBAA0B,OAGnDsK,EAAKotB,UAAY,GACbA,EAAUptB,EAAK+lB,MACjB/lB,EAAKotB,UAAYA,EAAUptB,EAAK+lB,MAC5B/lB,EAAKotB,YAAcl0B,IACrB8G,EAAKotB,UAAY,KAKrB,MAAMl3B,EAAU,CACd23B,OAAQ,IAAM30B,EAAExD,QAAQ,0BAA2B,MACnDo4B,OAAQ,IAAM50B,EAAExD,QAAQ,yBAA0B,MAAMA,QAAQ,wBAAyB,MACzFq4B,GAAI,IAAM70B,EAAExD,QAAQ,sBAAuB,MAAMA,QAAQ,oBAAqB,MAC9Es4B,KAAM,IAAM90B,EAAExD,QAAQ,yCAA0C,MAChEu4B,QAAS,IAAM/0B,EAAExD,QAAQ,0BAA2B,MAAMA,QAAQ,wBAAyB,MAC3F,gBAAiB,IAAMwD,EAAExD,QAAQ,wBAAyB,MAC1Dw4B,SAAU,IAAMh1B,EAAExD,QAAQ,2BAA4B,MACtDy4B,MAAO,IAAMj1B,EAAExD,QAAQ,wBAAyB,MAAMA,QAAQ,sBAAuB,MACrF04B,QAAS,IAAMl1B,EAAExD,QAAQ,0BAA2B,MACpD24B,OAAQ,IAAMn1B,EAAExD,QAAQ,4BAA6B,MACrD44B,OAAQ,IAAMp1B,EAAExD,QAAQ,0BAA2B,MACnDi5B,QAAS,IAAMz1B,EAAExD,QAAQ,0BAA2B,MACpD84B,UAAW,IAAMt1B,EAAExD,QAAQ,4BAA6B,MACxD+4B,GAAI,IAAMv1B,EAAExD,QAAQ,qBAAsB,MAC1Cg5B,MAAO,IAAMx1B,EAAExD,QAAQ,iCAAkC,MACzD64B,GAAI,IAAMr1B,EAAExD,QAAQ,6BAA8B,MAClDk5B,MAAO,IAAM11B,EAAExD,QAAQ,qBAAsB,MAAMA,QAAQ,qCAAsC,MACjG,eAAgB,IAAMwD,EAAExD,QAAQ,+BAAgC,MAChEo5B,SAAU,IAAM51B,EAAExD,QAAQ,0BAA2B,MACrDq5B,KAAM,IAAM71B,EAAExD,QAAQ,8BAA+B,MACrDs5B,MAAO,IAAM91B,EAAExD,QAAQ,wBAAyB,MAChDu5B,KAAM,IAAM/1B,EAAExD,QAAQ,uBAAwB,MAC9Cw5B,OAAQ,IAAMh2B,EAAExD,QAAQ,iCAAkC,MAC1Dy5B,OAAQ,IAAMj2B,EAAExD,QAAQ,6BAA8B,MACtD05B,OAAQ,IAAMl2B,EAAExD,QAAQ,6BAA8B,MACtD25B,MAAO,IAAMn2B,EAAExD,QAAQ,wBAAyB,MAChD45B,OAAQ,IAAMp2B,EAAExD,QAAQ,mCAAoC,MAC5D65B,OAAQ,IAAMr2B,EAAExD,QAAQ,2BAA4B,MACpD85B,MAAO,IAAMt2B,EAAExD,QAAQ,+BAAgC,OAoClD,OAjCPsK,EAAK9J,QAAU,GACXA,EAAQ8J,EAAK8lB,WACf9lB,EAAK9J,QAAUA,EAAQ8J,EAAK8lB,WACxB9lB,EAAK9J,UAAYgD,IACnB8G,EAAK9J,QAAU,KAQf8J,EAAK9J,QAAQkC,QAAQ,OAClB4H,EAAA9J,QAAU8J,EAAK9J,QAAQmC,UAAU,EAAG2H,EAAK9J,QAAQkC,QAAQ,OAIhD,QAAZ4H,EAAK+lB,IAAgB7sB,EAAEumB,SAAS,QAClCzf,EAAK+lB,GAAK,SACgB,SAAjB/lB,EAAK8lB,SAAuB5sB,EAAEumB,SAAS,OAEtB,SAAjBzf,EAAK8lB,QACd9lB,EAAK+lB,GAAK,UACgB,WAAjB/lB,EAAK8lB,SAAwB3f,OAAOnG,EAAK9J,SAAW,IAEnC,UAAjB8J,EAAK8lB,SAAuB3f,OAAOnG,EAAK9J,SAAW,IAElC,WAAjB8J,EAAK8lB,QAHd9lB,EAAKqtB,OAAS,aAKY,IAAjBrtB,EAAK8lB,UACd9lB,EAAK8lB,QAAU,cAVf9lB,EAAKqtB,OAAS,WAaTrtB,CACT,CDGiB6wB,CAASluC,KAAKQ,KAAK2tC,IACzB,MAAA,CACLhL,QAAS,GAAGmH,EAAKnH,WAAWmH,EAAK/2B,UACjC6vB,GAAI,GAAGkH,EAAKlH,MAAMkH,EAAKG,YAE3B,CAGO,OAAAjY,GACL,OAAOxyB,KAAK4Q,IACd,EE1NF,MAAqBw9B,GAcZ,WAAAvuC,CAAY+Q,GAbZ7Q,EAAAC,KAAA,QACAD,EAAAC,KAAA,OACCD,EAAAC,KAAA,YACAD,EAAAC,KAAA,SACiBD,EAAAC,KAAA,SAAA,GACDD,EAAAC,KAAA,QAAA,GACGD,EAAAC,KAAA,WAAA,aAQzBA,KAAK4Q,KAAOA,EACZ5Q,KAAKquC,SAAWruC,KAAK4Q,KAAKiC,MAAQ7S,KAAKquC,SAEvCruC,KAAKw0B,IAAMhE,GACT,8MAG2BxwB,KAAKquC,6CAKlCruC,KAAKuwB,SAAWvwB,KAAKw0B,IAAIlI,cAA2B,qBACpDtsB,KAAKsuC,MAAQtuC,KAAKw0B,IAAIlI,cAA2B,aAE5CtsB,KAAAw0B,IAAInB,QAAU,KACjBrzB,KAAKg0B,OAAM,CAEf,CAvBA,WAAIua,GACF,OAAOvuC,KAAKwuC,MAAQxuC,KAAK+uB,OAAS/uB,KAAK4Q,KAAK4a,QAC9C,CAuBA,KAAAwI,GACMh0B,KAAKuuC,SAASvuC,KAAK4Q,KAAK69B,QAAQzuC,KAAK+uB,OAAS/uB,KAAK4Q,KAAK4a,UAC5DxrB,KAAK0uC,eACP,CAGA,IAAA/e,GACO3vB,KAAAw0B,IAAIlb,MAAMsX,QAAU,EAC3B,CAGA,IAAAf,GACO7vB,KAAAw0B,IAAIlb,MAAMsX,QAAU,MAC3B,CAGA,UAAAzS,CAAW6lB,GACThkC,KAAKuwB,SAASjX,MAAMsX,QAAUoT,EAAY,GAAK,OAC/ChkC,KAAKsuC,MAAMh1B,MAAMsX,QAAUoT,EAAY,OAAS,EAClD,CAGA,OAAA2K,CAAQC,GACN5uC,KAAKme,YAAW,GAEhBne,KAAKsuC,MAAMxuB,UAAY8uB,EAClB5uC,KAAAw0B,IAAI7G,UAAUC,IAAI,WACvB7R,OAAO+U,YAAW,KACX9wB,KAAAsuC,MAAMxuB,UAAY9f,KAAKquC,SACvBruC,KAAAw0B,IAAI7G,UAAUmE,OAAO,UAAS,GAClC,IACL,CAGO,MAAAqC,CAAOpF,EAAgByf,GAC5BxuC,KAAK+uB,OAASA,EACd/uB,KAAKwuC,MAAQA,EAEbxuC,KAAK0uC,eACP,CAEO,aAAAA,GACD1uC,KAAKuuC,QAASvuC,KAAK2vB,OAClB3vB,KAAK6vB,MACZ,ECrFF,MAAqBgf,GAArB,WAAAhvC,GACUE,EAAAC,KAAA,YACuCD,EAAAC,KAAA,kBAAA,MACvCD,EAAAC,KAAA,MAAA,CAER,MAAAyK,CAAOq2B,GAsBL,OArBA9gC,KAAK8gC,IAAMA,EAEN9gC,KAAAqJ,SAAW,IAAI+kC,GAAY,CAC9B5iB,SAAUsV,EAAItV,SACdijB,QAAgB7jC,GAAM1I,EAAAlC,KAAA,MAAA,YACpB8gC,EAAInU,IAAIxsB,MAAM,CACZ4uB,OAAQnkB,GAEZ,IACAiI,KAAM4O,GAAG,cAIPqf,EAAIgO,mBACN9uC,KAAK+uC,gBAAkB,KAChB/uC,KAAKqJ,SAASklC,UAAWvuC,KAAK8gC,IAAInU,IAAIG,UAAU7O,cACrDje,KAAKqJ,SAAS2qB,SAEhBh0B,KAAK8gC,IAAInU,IAAIzC,GAAG,oBAAqBlqB,KAAK+uC,kBAGrC/uC,KAAKqJ,SAASmrB,GACvB,CAEA,UAAArW,CAAWC,GACJpe,KAAAqJ,SAAS8U,WAAWC,EAC3B,CAEA,MAAA+V,CAAOpF,EAAgByf,GAChBxuC,KAAAqJ,SAAS8qB,OAAOpF,EAAQyf,EAC/B,CAEA,OAAAG,CAAQ/8B,GACD5R,KAAAqJ,SAASslC,QAAQ/8B,EACxB,CAEA,IAAAwqB,GACEp8B,KAAKqJ,SAAS2qB,OAChB,CAEA,UAAAgb,GACE,OAAOhvC,KAAKqJ,SAASklC,OACvB,CAEA,kBAAAU,CAAmBtsC,GACjB,OAAyB,IAAlBA,EAAOosB,MAChB,CAEA,OAAAmgB,GACElvC,KAAK+uC,iBAAmB/uC,KAAK8gC,IAAInU,IAAIxC,IAAI,oBAAqBnqB,KAAK+uC,iBAC9D/uC,KAAAqJ,SAASmrB,IAAI1C,QACpB,ECtDF,MAAqBqd,GAoBZ,WAAAtvC,CAAY2uC,EAAe59B,GAnB1B7Q,EAAAC,KAAA,QACDD,EAAAC,KAAA,SACAD,EAAAC,KAAA,OACAD,EAAAC,KAAA,UACAD,EAAAC,KAAA,cACAD,EAAAC,KAAA,YACAD,EAAAC,KAAA,YAEeD,EAAAC,KAAA,OAAA,GAYpBA,KAAKwuC,MAAQA,EACbxuC,KAAK4Q,KAAOA,EAEZ5Q,KAAKw0B,IAAMhE,GACT,okCAYFxwB,KAAK61B,OAAS71B,KAAKw0B,IAAIlI,cAAc,cACrCtsB,KAAK61B,OAAO1xB,MAAQ,GAAGnE,KAAKmH,OAE5BnH,KAAK61B,OAAOuZ,QAAU,IAAMpvC,KAAKU,QACjCV,KAAK61B,OAAOwZ,UAAarrC,GAAMhE,KAAKsvC,QAAQtrC,GAE5ChE,KAAKuvC,SAAWvvC,KAAKw0B,IAAIlI,cAAc,iBACvCtsB,KAAKwvC,SAAWxvC,KAAKw0B,IAAIlI,cAAc,iBAEvCtsB,KAAKuvC,SAASlc,QAAU,IAAMrzB,KAAK2d,OACnC3d,KAAKwvC,SAASnc,QAAU,IAAMrzB,KAAKo8B,OAEnCp8B,KAAK0uC,eACP,CAxCA,YAAIljB,GACF,OAAOxrB,KAAK4Q,KAAK4a,QACnB,CACA,UAAIuD,GACK,OAAA/uB,KAAKwrB,UAAYxrB,KAAKmH,KAAO,EACtC,CACA,WAAIsoC,GACF,OAAOztB,KAAK0tB,KAAK1vC,KAAKwuC,MAAQxuC,KAAKwrB,SACrC,CAkCO,MAAA2I,CAAOpF,EAAgByf,GAC5BxuC,KAAKmH,KAAO6a,KAAK0tB,KAAK3gB,EAAS/uB,KAAKwrB,UAAY,EAChDxrB,KAAKwuC,MAAQA,EAERxuC,KAAA2vC,SAAS3vC,KAAKmH,MACnBnH,KAAK0uC,eACP,CAEO,QAAAiB,CAASxoC,GACTnH,KAAA61B,OAAO1xB,MAAQ,GAAGgD,GACzB,CAEO,KAAAzG,CAAMmmB,GAAe,GACnB9K,OAAA0a,aAAaz2B,KAAK4vC,YAEzB,MAAMzrC,EAAQnE,KAAK61B,OAAO1xB,MAAM0T,OAE1BmxB,EAAS,KACb,GAAc,KAAV7kC,EAEF,YADKnE,KAAA2vC,SAAS3vC,KAAKmH,MAGjB,IAAAA,EAAOqc,OAAOrf,GACdqf,OAAOqsB,MAAM1oC,IAIbA,EAAO,EAHJnH,KAAA2vC,SAAS3vC,KAAKmH,OAOjBA,EAAOnH,KAAKyvC,UACTzvC,KAAA2vC,SAAS3vC,KAAKyvC,SACnBtoC,EAAOnH,KAAKyvC,SAEdzvC,KAAK8vC,OAAO3oC,GAAI,EAIb0f,MAAK7mB,KAAK4vC,WAAa7zB,OAAO+U,YAAW,IAAMkY,KAAU,IAEhE,CAEO,IAAArrB,GACC,MAAAxW,EAAOnH,KAAKmH,KAAO,EACrBA,EAAO,GAGXnH,KAAK8vC,OAAO3oC,EACd,CAEO,IAAAi1B,GACC,MAAAj1B,EAAOnH,KAAKmH,KAAO,EACrBA,EAAOnH,KAAKyvC,SAGhBzvC,KAAK8vC,OAAO3oC,EACd,CAEO,UAAA6nC,GACE,OAAAhvC,KAAKmH,KAAO,GAAKnH,KAAKyvC,OAC/B,CAEO,MAAAK,CAAO3oC,GACZnH,KAAKmH,KAAOA,EACPnH,KAAA4Q,KAAKm/B,SAAS/vC,KAAK+uB,QACxB/uB,KAAK2vC,SAASxoC,GACdnH,KAAK0uC,eACP,CAEO,aAAAA,GACD1uC,KAAKmH,KAAO,EAAInH,KAAKyvC,QAClBzvC,KAAAwvC,SAAS7hB,UAAUC,IAAI,gBAEvB5tB,KAAAwvC,SAAS7hB,UAAUmE,OAAO,gBAG7B9xB,KAAKmH,KAAO,EAAI,EACbnH,KAAAuvC,SAAS5hB,UAAUC,IAAI,gBAEvB5tB,KAAAuvC,SAAS5hB,UAAUmE,OAAO,eAEnC,CAEO,OAAAwd,CAAQtrC,GACP,MAAAiyB,EAAUjyB,EAAEiyB,SAAWjyB,EAAEgsC,MAE/B,GAAgB,KAAZ/Z,EAAgB,CAElB,MAAM9uB,EAAOqc,OAAOxjB,KAAK61B,OAAO1xB,OAAS,EACrC,GAAAgD,EAAOnH,KAAKyvC,QACd,OAEFzvC,KAAK2vC,SAASxoC,GACdnH,KAAKU,OAAM,MAAA,GACU,KAAZu1B,EAAgB,CAEzB,MAAM9uB,EAAOqc,OAAOxjB,KAAK61B,OAAO1xB,OAAS,EACzC,GAAIgD,EAAO,EACT,OAEFnH,KAAK2vC,SAASxoC,GACdnH,KAAKU,OAAM,MACU,KAAZu1B,GAETj2B,KAAKU,OAAM,EAEf,CAGA,UAAAyd,CAAW6lB,GACLA,EAAczR,GAAYvyB,KAAKw0B,KAC3B7B,GAAY3yB,KAAKw0B,IAC3B,EC1KF,MAAqByb,GAArB,WAAApwC,GACUE,EAAAC,KAAA,WAAA,CAER,MAAAyK,CAAOq2B,GAeL,OAdA9gC,KAAKqJ,SAAW,IAAI6mC,GAAoBpP,EAAI0N,MAAO,CACjDhjB,SAAUsV,EAAItV,SACdukB,SAAiBnlC,GAAM1I,EAAAlC,KAAA,MAAA,YACrB8gC,EAAInU,IAAI4C,mBAERuR,EAAInU,IAAIxsB,MAAM,CACZ4uB,OAAQnkB,EACRipB,UAAW,KACTiN,EAAInU,IAAIqC,kBAGd,MAGKhvB,KAAKqJ,SAASmrB,GACvB,CAEA,UAAArW,CAAWC,GACJpe,KAAAqJ,SAAS8U,WAAWC,EAC3B,CAEA,MAAA+V,CAAOpF,EAAgByf,GAChBxuC,KAAAqJ,SAAS8qB,OAAOpF,EAAQyf,EAC/B,CAEA,IAAApS,GACEp8B,KAAKqJ,SAAS+yB,MAChB,CAEA,UAAA4S,GACS,OAAAhvC,KAAKqJ,SAAS2lC,YACvB,CAEA,kBAAAC,GACS,OAAA,CACT,CAEA,OAAAC,GACOlvC,KAAAqJ,SAASmrB,IAAI1C,QACpB,ECtCF,SAASqe,GAAsBxjB,GAI7B,MAAMtX,EAAOsX,EAAIG,UAAUzO,mBACrBza,EAAI,CAAEmrB,OAAQ,EAAGyf,MAAO,GAC9B,OAAKn5B,GAEHzR,EAAAmrB,OAAS1Z,EAAK1S,OAAOosB,OACnB1Z,EAAK7U,OAAQoD,EAAA4qC,MAAQn5B,EAAK1S,OAAOioB,SAAWvV,EAAK7U,KAAK4vC,MAAQ/6B,EAAK7U,KAAK6vC,aAErEzsC,GALWA,CAMpB,CAEa,MAAA0sC,GAAyB3jB,IACpC,IAAI4jB,EAA8B,KAGlC5jB,EAAIM,UAAU,CAAC,aAAc,WAAY3mB,IACjC,MAAA4N,EAAOyY,EAAIhrB,IAAI,QAEjB4uC,GAAWA,EAAUrB,UAGzBqB,EA7BJ,SAA+BjqC,GAC7B,OAAIA,EAAKilB,WAAWxF,SAAiB,IAAI8oB,GAClC,IAAIoB,EACb,CA0BgBO,CAAsBlqC,GAGlC,MAAMyoB,OAAEA,EAAAyf,MAAQA,GAAU2B,GAAsBxjB,GAC1C8jB,EAAaF,EAAU9lC,OAAO,CAClCkiB,MACAnB,SAAUllB,EAAKilB,WAAWC,SAC1BgjB,QAEAM,iBAAkBxoC,EAAKilB,WAAWE,WAI/BvX,EAAA8qB,cAAcpN,MAAM6e,GAGd,MAAAF,GAAAA,EAAApc,OAAOpF,EAAQyf,EAAA,IAIxB7hB,EAAAzC,GAAG,eAAgB1L,IAErB,MAAMuQ,OAAEA,EAAAyf,MAAQA,GAAU2B,GAAsBxjB,GACrC,MAAA4jB,GAAAA,EAAApc,OAAOpF,EAAQyf,EAAA,IAIxB7hB,EAAAzC,GAAG,cAAevnB,IAEhBgqB,EAAIG,UAAU/mB,cAAc6D,OAAS,IAAgB,MAAX2mC,OAAW,EAAAA,EAAAtB,mBAAmBtsC,KACtEgqB,EAAAG,UAAUhO,eAChB,IAIE6N,EAAAzC,GAAG,eAAe,WACT,OAAAjoB,EAAA,MAAAsuC,OAAA,EAAAA,EAAA5B,UAAUltB,EAAAA,KAAAA,EAAAA,GAAG,YAAU,IAIhCkL,EAAAzC,GAAG,cAAevnB,IACpB,MAAA4tC,GAAAA,EAAWpyB,YAAW,EAAA,IAExBwO,EAAIzC,GAAG,gBAAgB,EAAGvnB,aACxB,MAAA4tC,GAAAA,EAAWpyB,YAAW,EAAA,GACvB,ECvEH,MAAqBuyB,WAAa/Z,GAYhC,WAAA92B,CAAY8sB,GACV1nB,MAAM0nB,GAXR5sB,EAAAC,KAAA,iBAKUD,EAAAC,KAAA,eAA8B,IASjCA,KAAAw0B,IAAMhE,GCzBA,upBD0BXxwB,KAAKg/B,cAAgBh/B,KAAKw0B,IAAIlI,cAAc,2BAG5CgkB,GAAsB3jB,GAGtB3sB,KAAK2wC,gBACP,CArBO,iBAAAC,GACL,OAAO5wC,KAAKg/B,aACd,CAGA,eAAAvR,GACE,OAAOztB,KAAK6wC,YACd,CAgBA,aAAAC,EAAcC,cAAEA,GAA+C,IAC7D,OAAO,IAAI7Q,GAAW,CACpBlB,cAAeh/B,KAAKg/B,cACpBH,WAAY7+B,KAAK2sB,IAAIrmB,KAAKwkB,SAC1BD,QAAS7qB,KAAK2sB,IAAIrmB,KAAKukB,QACvBD,SAC2B,kBAAlBmmB,EAA8BA,EAAiB/wC,KAAK2sB,IAAIrmB,KAAKskB,SAEtEmU,kBAAmB,CAACiS,EAAGptC,KACf,MAAAuV,EErCP,SACLwT,EACA1mB,EACAsoB,EACA3d,GAEMvH,MAAAA,EAAW,IAAIggC,GAAYpjC,EAAS,CACxC0jC,cAAe,KACThd,EAAAjO,QAAQ,mBAAoBrV,EAAQ,EAE1C6/B,SAAWrqB,IACT8N,EAAIG,UAAUzmB,cAAcwY,EAAEkrB,QAAO,EAGvC7C,QAAS3Y,EAGT3D,SACiC,kBAAlB,MAANha,OAAM,EAAAA,EAAAmgC,eACH,MAANngC,OAAM,EAAAA,EAAAmgC,cACLpkB,EAAIrmB,KAAKskB,SAChBS,SAAUsB,EAAIrmB,KAAK+kB,SACnBR,QAAS8B,EAAIrmB,KAAKukB,QAClBa,YAAaiB,EAAIrmB,KAAKolB,YACtB6a,iBAAkB5Z,EAAIrmB,KAAKigC,iBAC3BxM,iBAAkBpN,EAAIrmB,KAAKyzB,iBAC3B7wB,KAAMyjB,EAAIrmB,KAAK4C,KACf2c,SAAU8G,EAAIrmB,KAAKuf,SACnBmF,QAAS2B,EAAIrmB,KAAK0kB,QAGlBgD,OAAQ,IAAMrB,EAAIqB,SAClBO,aAAc,CAAC1P,EAAG2V,IAAQ7H,EAAI4B,aAAa1P,EAAG2V,GAC9C5F,YAAa,CAAC/P,EAAG2V,IAAQ7H,EAAIiC,YAAY/P,EAAG2V,KAMvCnrB,OAFPA,EAASoxB,SAEFpxB,CACT,CFHqB01B,CAAkB/+B,KAAK2sB,IAAKqkB,EAAGptC,EAAG,CAAEmtC,kBAE1C,OADF/wC,KAAA6wC,aAAa7jC,KAAKmM,GAChBA,CAAA,EAETumB,gBAAkBv5B,GAAOnG,KAAK6wC,aAAajyB,MAAMC,GAAMA,EAAEkrB,UAAY5jC,KAEzE,CAEQ,cAAAwqC,GACN3wC,KAAK2sB,IAAIzC,GAAG,aAAc1L,IAEnBxe,KAAA8wC,gBAAgBpT,OAAOlf,EAAQ,IAGtCxe,KAAK2sB,IAAIzC,GAAG,eAAgB1L,IACF,IAApBA,EAAS5U,SACX5J,KAAK6wC,aAAe,GACpB7wC,KAAKg/B,cAAcvf,UAAY,GACjC,IAIFzf,KAAK2sB,IAAIzC,GAAG,oBAAqBjkB,UAC/B,MAAMsoB,EAAetoB,EAAQ63B,IACzB,OAAA77B,EAAAjC,KAAK6wC,aAAajyB,MAAMC,GAAMA,EAAEkrB,UAAY9jC,EAAQ63B,gBAAMhR,eAC1D,EACJ9sB,KAAK8wC,gBAAgBtR,OAAOv5B,EAASsoB,EAAY,IAInDvuB,KAAK2sB,IAAIzC,GAAG,mBAAoBjkB,IACxB,MAAAkT,EAAOnZ,KAAK6wC,aAAajyB,MAAMC,GAAMA,EAAEkrB,UAAY9jC,EAAQE,KAC5DgT,GAILA,EAAK2Y,SACA9xB,KAAA6wC,aAAe7wC,KAAK6wC,aAAalsC,QAAQka,GAAMA,EAAEkrB,UAAY9jC,EAAQE,MAJxEgJ,QAAQtL,MAAM,mBAAmBoC,EAAQE,eAIiC,IAK9EnG,KAAK2sB,IAAIzC,GAAG,mBAAoBjkB,IACxB,MAAAkT,EAAOnZ,KAAK6wC,aAAajyB,MAAMC,GAAMA,EAAEkrB,UAAY9jC,EAAQE,KACzDgT,GAAAA,EAAK8vB,QAAQhjC,EAAO,GAEhC,EGxFE,IAAAgrC,GACAC,GAEG,SAASC,KACP,MAAA,CACL,IAAAthC,GACoBohC,GAAA5iC,SAASjM,KAAKkX,MAAM6nB,SAChB+P,GAAA7iC,SAASjM,KAAKkX,MAAM83B,YAC5C,EAEA,MAAAC,GACWhjC,SAAAjM,KAAKkX,MAAM6nB,SAAW8P,GACtB5iC,SAAAjM,KAAKkX,MAAM83B,aAAeF,EACrC,EAEA,IAAAzQ,GACWpyB,SAAAjM,KAAKkX,MAAM6nB,SAAW,SAC/B,MAAMmQ,EAAkBC,SACtBx1B,OAAO8kB,iBAAiBxyB,SAASjM,KAAM,MAAMovC,iBAAiB,iBAC9D,IAEOnjC,SAAAjM,KAAKkX,MAAM83B,aAAe,G1CuJlC,WACC,MAAAK,EAAQpjC,SAASiR,cAAc,KACrCmyB,EAAMn4B,MAAM+H,MAAQ,OACpBowB,EAAMn4B,MAAMiY,OAAS,QAEf,MAAAmgB,EAAQrjC,SAASiR,cAAc,OACrCoyB,EAAMp4B,MAAMq4B,SAAW,WACvBD,EAAMp4B,MAAMyH,IAAM,MAClB2wB,EAAMp4B,MAAM0H,KAAO,MACnB0wB,EAAMp4B,MAAMs4B,WAAa,SACzBF,EAAMp4B,MAAM+H,MAAQ,QACpBqwB,EAAMp4B,MAAMiY,OAAS,QACrBmgB,EAAMp4B,MAAM6nB,SAAW,SACvBuQ,EAAM/gB,YAAY8gB,GAETpjC,SAAAjM,KAAKuuB,YAAY+gB,GAC1B,MAAMG,EAAKJ,EAAMK,YACjBJ,EAAMp4B,MAAM6nB,SAAW,SACvB,IAAI4Q,EAAKN,EAAMK,YAKf,OAJID,IAAOE,IAAIA,EAAKL,EAAMM,aAEjB3jC,SAAAjM,KAAK6vC,YAAYP,GAEnBG,EAAKE,CACd,C0C/K4CG,GAAyBZ,GAAmB,KACpF,EAEJ,CCrBO,MAAMa,GAIX,WAAAtyC,CACU20B,EACA5jB,GALe7Q,EAAAC,KAAA,kBAAA,GACjBD,EAAAC,KAAA,eAGEA,KAAAw0B,IAAAA,EACAx0B,KAAA4Q,KAAAA,CACP,CAEH,cAAAwsB,CAAenF,GACbj4B,KAAKoyC,YAAcna,CACrB,CAEA,iBAAAoa,CAAkBC,GAChBtyC,KAAKuyC,eAAiBD,CACxB,CAEA,iBAAAE,GACE,OAAOxyC,KAAKuyC,cACd,CAEA,KAAApiB,GACE,OAAOnwB,KAAKw0B,GACd,CAEA,IAAA7E,GACE3vB,KAAK4Q,KAAK6hC,SACLzyC,KAAAw0B,IAAIlb,MAAMsX,QAAU,EAC3B,CAEM,IAAAf,GAAO,OAAA3tB,EAAAlC,KAAA,MAAA,YACXA,KAAK4Q,KAAK8hC,SACL1yC,KAAAw0B,IAAIlb,MAAMsX,QAAU,OACpB5wB,KAAAoyC,aAAepyC,KAAKoyC,aAC3B,GAAA,CAEM,OAAA1c,GAAU,OAAAxzB,EAAAlC,KAAA,MAAA,YACdA,KAAK4Q,KAAK8hC,SACV1yC,KAAKw0B,IAAI1C,SACJ9xB,KAAAoyC,aAAepyC,KAAKoyC,aAC3B,GAAA,ECzCK,MAAMO,GAKX,WAAA9yC,GAJQE,EAAAC,KAAA,SACAD,EAAAC,KAAA,SACAD,EAAAC,KAAA,QAAiB,IAGvBA,KAAK4yC,MAAQpiB,GACX,+FAEFxwB,KAAK6yC,MAAQ7yC,KAAK4yC,MAAMtmB,cAA2B,kBACrD,CAEA,UAAAwmB,CAAWjkC,EAAcuR,IAElBA,EAAAA,GAAMpgB,KAAK+yC,kBAAkBlkC,IAC/B6kB,aAAa,kBAAmB7kB,GAC9B7O,KAAA4yC,MAAMjiB,YAAYvQ,GAGjB,MAAAmV,EAAQ,IAAI4c,GAAM/xB,EAAI,CAC1BsyB,OAAQ,IAAM1yC,KAAKgzC,SAAS5yB,GAC5BqyB,OAAQ,IAAMzyC,KAAKizC,aAWd,OAPPjzC,KAAKkzC,UAAU9iC,iBAAiB,SAAS,KACjCmlB,EAAAid,qBAAuBjd,EAAM1F,MAAK,IAIrC7vB,KAAAmzC,MAAMnmC,KAAKuoB,GAETA,CACT,CAEQ,iBAAAwd,CAAkBlkC,GAClB,MAAAuR,EAAK/R,SAASiR,cAAc,OAI3B,OAHJc,EAAAuN,UAAUC,IAAI,kBACjBxN,EAAG9G,MAAMsX,QAAU,OACd5wB,KAAA4yC,MAAMjiB,YAAYvQ,GAChBA,CACT,CAEA,OAAAgzB,GACE,OAAOpzC,KAAK4yC,KACd,CAEA,OAAAM,GACE,OAAOlzC,KAAK6yC,KACd,CAEA,QAAAI,GACOjzC,KAAA4yC,MAAMt5B,MAAMsX,QAAU,QACtB5wB,KAAA6yC,MAAMv5B,MAAMsX,QAAU,QACtB5wB,KAAA6yC,MAAMllB,UAAUC,IAAI,eACzBujB,KAAqB1Q,MACvB,CAEA,QAAAuS,CAASxe,GAGLx0B,KAAKmzC,MACF5uC,KAAK2I,GAAMA,EAAEijB,UACbxrB,QAAQX,GAAMA,IAAMwwB,GAAOxwB,EAAE+sB,aAAmC,SAApB/sB,EAAEsV,MAAMsX,UAAoBhnB,OAAS,IAKjF5J,KAAA4yC,MAAMt5B,MAAMsX,QAAU,OAC3BugB,KAAqBE,SACvB,ECtEK,MAAMgC,GAGX,WAAAxzC,CAAY8sB,GAFJ5sB,EAAAC,KAAA,QAGDA,KAAAszC,KAAO,IAAIX,GAChBtkC,SAASjM,KAAKuuB,YAAY3wB,KAAKszC,KAAKF,WAEhCzmB,EAAAzC,GAAG,aAAa,KACblqB,KAAAszC,KAAKF,UAAUthB,QAAO,IAI7Bqf,KAAqBthC,MACvB,CAEA,KAAAsgB,GACS,OAAAnwB,KAAKszC,KAAKF,SACnB,CAEA,MAAA3oC,CAAOoE,EAAcuR,GACnB,OAAOpgB,KAAKszC,KAAKR,WAAWjkC,EAAMuR,EACpC,ECvBF,MAAMmzB,GAAiB,aAMvB,MAAMC,GAGJ,WAAA3zC,CAAoB+Q,GAFZ7Q,EAAAC,KAAA,QAEYA,KAAA4Q,KAAAA,EAEZ,MAAA6iC,EAAY9yC,KAAKsc,MAAMlB,OAAO23B,aAAaC,QAAQJ,KAAmB,MAG5EvzC,KAAKQ,KAAO,CACV+jB,KAAMkvB,EAAUlvB,MAAQ,GACxB/c,MAAOisC,EAAUjsC,OAAS,GAC1B2T,KAAMs4B,EAAUt4B,MAAQ,GACxB4O,MAAO0pB,EAAU1pB,OAAS,GAC1BqK,QAASqf,EAAUrf,UAAW,EAElC,CAEA,OAAAtH,GACE,OAAO9sB,KAAKQ,IACd,CAGA,MAAA2zB,CAAOzW,EAA0B,IACxB7c,OAAAy5B,QAAQ5c,GAAKrG,SAAQ,EAAEpW,EAAKkD,MAC5BnE,KAAAQ,KAAKS,GAAOkD,CAAA,IAGnB4X,OAAO23B,aAAaE,QAAQL,GAAgB5yC,KAAKC,UAAUZ,KAAKQ,OAChER,KAAK4Q,KAAKijC,eAAiB7zC,KAAK4Q,KAAKijC,cAAc7zC,KAAKQ,KAC1D,CAOA,MAAAszC,GACE9zC,KAAKm0B,OAAO,CACVpK,MAAO,GACPqK,SAAS,GAEb,CAGA,qBAAArH,GACS,QAAE/sB,KAAKQ,KAAK+jB,QAAUvkB,KAAKQ,KAAKgH,KACzC,ECrCF,MAAMusC,GAAW,CAEf,IAAAC,CAAKrnB,GACY/C,GAAA+C,EAAIrmB,KAAKuB,QAExB8kB,EAAIM,UAAU,CAAC,WAAY3mB,IACpB2tC,GAAU3tC,EAAKuB,OAAM,GAE9B,EAGAa,KAAKikB,GACU,IAAI6mB,GAAK,CACpBK,cAAgBrzC,IACVmsB,EAAAjO,QAAQ,eAAgBle,EAAI,IAOtC0zC,aAAavnB,GACJ,IAAI0mB,GAAa1mB,GAI1BmD,gBAAgBnD,GACU,IAAIyI,GAAgB,CAC1CI,OAAQ,IAAM7I,EACdqB,OAAQ,IAAMrB,EAAIqB,SAClBqG,SAAU,IAAM1H,EAAImC,SAGpB2D,oBAAqB,IAAM,GAAG9F,EAAIrmB,KAAKkkB,6BAAiC,IAAA1I,SAM5E,MAAA4M,CAAO/B,GACC,MAAA+B,EAAS,IAAI0L,GAAOzN,GAEnB,OADHA,EAAAe,MAAMiD,YAAYjC,EAAO8F,KACtB9F,CACT,EAGA,IAAAxa,CAAKyY,GACG,MAAAzY,EAAO,IAAIw8B,GAAK/jB,GAEf,OADHA,EAAAe,MAAMiD,YAAYzc,EAAKsgB,KACpBtgB,CACT,EAGAwb,aAAa/C,GACU,IAAI2P,GAAa3P,GAUxC,WAAAwnB,GAEA,GChDF,SAAsBC,GAAgBtT,GAAmB,OAAA5+B,EAAAlC,KAAA,MAAA,kBA6BzD,SAAgC8gC,GAAmB,OAAA5+B,EAAAlC,KAAA,MAAA,kBAC3Cq0C,GAAc,CAAEvT,MAAKt+B,MAAO,eAAgB8xC,WAAY,CAACxT,EAAI5V,QAAS,iBAC9E,GAAA,CA7BQqpB,CAAiBzT,GAGjB,MAAA0T,QAOR,SAAgC1T,GAAmB,OAAA5+B,EAAAlC,KAAA,MAAA,YACjD,IAAK8gC,EAAI2T,QAAU3T,EAAIxW,QAAgB,OAEvC,MAAMoqB,SACE5T,EAAI9S,SAAS2mB,MAAMztC,MAAM,CAC7B0tC,SAAU9T,EAAIxW,QACduqB,WAAY/T,EAAIvW,UAChBuqB,UAAWhU,EAAIlU,YAEjBpsB,KAAKu0C,GAEA,MAAA,CACL,CAACjU,EAAIxW,SAAUoqB,EAEnB,GAAA,CArB0BM,CAAiBlU,SA6B5B,SAAYA,EAAmBvmB,GAAoB,OAAArY,EAAAlC,KAAA,MAAA,kBAC1Dq0C,GAAc,CAAEvT,MAAKt+B,MAAO,UAAW8xC,WAAY,CAACxT,EAAI3V,KAAM,aAAc5Q,SACpF,GAAA,CA5BQ06B,CAAYnU,EAAK0T,EACzB,GAAA,CA6BA,SAAeH,GAAcvqB,GAK1B,OAAA5nB,EAAAlC,KAAA,MAAA,YACK,MAAA8gC,IAAEA,GAAQhX,EACZ,IAAAvP,EAAoBuP,EAAKvP,OAAS,GAGhC,MAAA26B,EAoBR,SAA0BZ,GAClB,MAAAY,MAAUC,IAIT,OAHP,IAAIA,IAAIb,GAAYj9B,SAAS+9B,IAClB/mC,SAAAqzB,iBAA8B0T,GAAU/9B,SAAS+I,GAAO80B,EAAItnB,IAAIxN,IAAG,IAEvE80B,CACT,CA1BcG,CAAiBvrB,EAAKwqB,YAG5BgB,EA0BR,SACEJ,EACAK,EACAjrB,EACA/P,GAEM,MAAA+6B,EAAW1wC,MAAM+8B,KAAKuT,GACzB3wC,KAAK6b,GAAOA,EAAGo1B,aAAaD,IAAgBjrB,IAC5C3lB,QAAQ1D,GAAQA,GAA6B,iBAAfsZ,EAAMtZ,KAEvC,MAAO,IAAI,IAAIk0C,IAAIG,GACrB,CArCmBG,CAAYP,EAAKpU,EAAIyU,YAAazU,EAAIxW,QAAS/P,GAG5D,GAAA+6B,EAAS1rC,OAAS,EAAG,CACjB,MAAA0jB,SACEwT,EAAI9S,SAAS0nB,MAAMvtC,SAAS2hB,EAAKtnB,MAAO,CAC5CmzC,UAAWL,EAAS7wC,KAAK,KACzBqwC,UAAWhU,EAAIlU,YAEjBpsB,KAAKA,KACP+Z,EAAQ/W,OAAK+W,GAAU+S,EACzB,EA6BO,SAAmB4nB,EAAuB10C,EAAkBo1C,GAC/DV,EAAA79B,SAAS+I,IACL,MAAAkK,EAAUlK,EAAGo1B,aAAa,iBAC1BpF,EAAS9lB,GAAW9pB,EAAK8pB,IAAcsrB,GAAkBp1C,EAAKo1C,IAAoB,EACxFx1B,EAAGN,UAAY,GAAG0D,OAAO4sB,IAAM,GAEnC,CAjCqByF,CAAAX,EAAK36B,EAAOumB,EAAIxW,QACrC,GAAA,CCjGa,MCCPwrB,GAAkB,gBCAxB,MAAqBC,GACnB,WAAAl2C,CAAoB83B,GAAA33B,KAAA23B,IAAAA,CAAe,CAE7B,MAAAqe,GAAS,OAAA9zC,EAAAlC,KAAA,MAAA,YAMN,aAJCA,KAAK23B,IAAIse,SAASz3B,SAASxY,cAAcxC,EACzC,CAAA,QAAMxD,KAAKk2C,wBAEjB11C,IAEJ,GAAA,CAEM,kBAAA01C,GAAqB,OAAAh0C,EAAAlC,KAAA,MAAA,YACnB,MAAAukB,KAAEA,QAAM/c,EAAO2T,KAAAA,GAASnb,KAAK23B,IAAIwe,UAAUrpB,UAC3CxmB,EAAOtG,KAAK23B,IAAIye,UAEf,MAAA,CACL58B,QAASxZ,KAAK23B,IAAI0e,YAAYzb,kBAC9B/rB,KAAM0V,EACN/c,QACA2T,OACA2iB,IAAK,EACL8W,SAAUtuC,EAAKgkB,QACfuqB,WAAYvuC,EAAKikB,UACjBuqB,UAAWxuC,EAAK0B,KAChBmmC,SAAUmI,KAEd,GAAA,CAEA,aAAAC,CAAcC,GAEZx2C,KAAK23B,IAAI0B,eAAevM,UAAU7N,cAAcu3B,EAClD,ECtBF,MAAqBC,WAAe/e,GAIlC,WAAA73B,CAAY83B,GACV1yB,MAAM0yB,GAJA53B,EAAAC,KAAA,UAA0B,IAC1BD,EAAAC,KAAA,iBAKNA,KAAK02C,cAAgB,IAAIX,GAAgB/1C,KAAK23B,KAExC,MAAAgf,EAAiB,IAAM32C,KAAK42C,KAE7B52C,KAAA23B,IAAIkf,YAAW,KAElB72C,KAAK23B,IAAI0B,eAAenP,GAAG,gBAAiBysB,EAAc,IAEvD32C,KAAA23B,IAAImf,cAAa,KACpB92C,KAAK23B,IAAI0B,eAAelP,IAAI,gBAAiBwsB,EAAc,GAE/D,CAEA,cAAAI,CAAel4B,GACR7e,KAAAg3C,QAAQhqC,KAAK6R,EACpB,CAEc,KAAK,OAAA3c,EAAAlC,KAAA,MAAA,YACb,GAAkD,KAAlDA,KAAK23B,IAAI0e,YAAYzb,kBAAkB/iB,OAEzC,YADK7X,KAAA23B,IAAI0e,YAAYtgB,QAIjB,MAAAkhB,EAASj3C,KAAKg3C,QAAQp4B,MAAMhU,GAAMA,EAAEssC,eAErCl3C,KAAA23B,IAAI0e,YAAYnnB,cAEjB,IAIE,IAAAioB,GAFQ,MAARF,OAAQ,EAAAA,EAAAG,MAAKH,EAAOG,MAKID,GAAhB,MAARF,OAAQ,EAAAA,EAAAI,WAAsBJ,EAAOI,YACnBr3C,KAAK02C,cAAcV,UAG7B,MAARiB,OAAQ,EAAAA,EAAAK,MAAML,EAAOK,KAAKH,GACpBn3C,KAAA02C,cAAcH,cAAcY,SAC/BpoC,GAIP,OAFAI,QAAQtL,MAAMkL,QACd/O,KAAK23B,IAAI0e,YAAY/mB,WAAW,GAAG7N,GAAG,mBAAmB1S,EAAI4C,SAAWmB,OAAO/D,KAAQ,IACvF,CACA,QACK/O,KAAA23B,IAAI0e,YAAYjnB,aACvB,CAEKpvB,KAAA23B,IAAI0e,YAAY59B,QACrBzY,KAAK23B,IAAI0B,eAAe3a,QAAQ,mBAClC,GAAA,ECxDF,MAAqB64B,WAAkB7f,GAOrC,WAAA73B,CAAY83B,GACV1yB,MAAM0yB,GAPA53B,EAAAC,KAAA,YAA8B,IACMD,EAAAC,KAAA,cAAA,MAEpCD,EAAAC,KAAA,YACAD,EAAAC,KAAA,gBAwCeD,EAAAC,KAAA,gBAAA,GACDD,EAAAC,KAAA,eAAA,GApCfA,KAAA23B,IAAIkf,YAAW,KAClB72C,KAAK83B,SAAS,iDACT93B,KAAA43B,OACH,kBAAkBnW,GAAG,u7BAAW,IAG/BzhB,KAAA23B,IAAImf,cAAa,SAEtB92C,KAAKg4B,uBAAuBwf,GAAQx3C,KAAKy3C,uBAAuBD,KAChEx3C,KAAKm4B,cAAa,KACf,MAAaj2B,EAAAlC,KAAA,MAAA,kBACNA,KAAK03C,oBAGN13C,KAAK23C,cACR33C,KAAK43C,oBACL53C,KAAK23C,aAAc,GAIrB7mB,YAAW,KACT9wB,KAAK63C,kBAAiB,GACrB,GAAE,KAZN,MAeH73C,KAAKs4B,cAAa,KACXt4B,KAAA+3B,OAAQ+f,cAAex+B,MAAMiY,OAAS,EAAA,IAI7CxV,OAAO+U,YAAW,KAChB9wB,KAAK03C,mBAAkB,GACtB,IACL,CAKa,iBAAAA,GAAoB,OAAAx1C,EAAAlC,KAAA,MAAA,YAC3BA,KAAK+3C,eACgB,OAArB/3C,KAAKg4C,aAMTh4C,KAAKg4C,iBAA2B91C,EAAAlC,KAAA,MAAA,YAC3BuyB,GAAYvyB,KAAK+3B,QACf/3B,KAAA+qB,gBAAkB/qB,KAAKi4C,WAAWj4C,KAAK23B,IAAIye,UAAUrrB,WACvD4H,GAAY3yB,KAAK+3B,QACpB/3B,KAAKg4C,YAAc,KACnBh4C,KAAK+3C,cAAe,CAAA,aAEhB/3C,KAAKg4C,mBAZHh4C,KAAKg4C,YAaf,GAAA,CAEc,UAAAC,CAAWz3C,GAA2B,OAAA0B,EAAAlC,KAAA,MAAA,YAKlD,IAJK4E,MAAMC,QAAQrE,IAAS,CAAC,SAAU,UAAUs8B,gBAAgBt8B,KAC/DA,EAAO,CAACA,KAGLoE,MAAMC,QAAQrE,GAGjB,OAFA03C,GAAYl4C,KAAK+3B,OAAS,IAAItW,GAAG,yDAC9BkR,GAAY3yB,KAAK+3B,QACb,GAGH,MAAAogB,EAAWC,IACI,iBAARA,IACPA,EAAIvpC,MAAQrO,EAAKoe,MAAMhU,GAAMA,EAAEiE,OAASupC,EAAIvpC,QAChDrO,EAAKwM,KAAKorC,GAAG,EAITC,EAAoBrH,GAAa9uC,EAAAlC,KAAA,MAAA,kBAC/BwN,QAAQ8qC,IACZtH,EAAEzsC,KAAI,CAAO6zC,EAAK5iC,IAAUtT,EAAAlC,KAAA,MAAA,YAC1B,GAAmB,iBAARo4C,GAAqBxzC,MAAMC,QAAQuzC,IAEnC,GAAAxzC,MAAMC,QAAQuzC,SACjBC,EAAWD,QAAG,GACI,iBAARA,EAAkB,CAClC,MAAMG,QAAgBv4C,KAAKq4C,WAAWD,GAElCxzC,MAAMC,QAAQ0zC,SAAgBF,EAAWE,GACjB,iBAAZA,GAAsBJ,EAAQI,EAChD,OAREJ,EAAQC,EAQV,MAEJ,IA4BK,aA1BDC,EAAW73C,GAGZA,EAAA6W,SAAS/F,IACR,GAAAtR,KAAKw4C,YAAYlnC,GAAO,CAChBtR,KAAKy4C,WAAWnnC,GACxB+F,SAAS+gC,IACTD,EAAQC,EAAG,GAEJ,MAAAxzC,MAAMC,QAAQyM,IAClBA,EAAA+F,SAAS+gC,IACZD,EAAQC,EAAG,GAEf,IAIF53C,EAAOA,EAAKmE,QACT2M,GAA8B,iBAATA,IAAsB1M,MAAMC,QAAQyM,MAAWA,KAAUA,EAAKzC,OAKtF7O,KAAK04C,aAAal4C,GAClBR,KAAK24C,aAAan4C,GAEXA,CACT,GAAA,CAGc,UAAA63C,CAAWx0B,GAA2B,OAAA3hB,EAAAlC,KAAA,MAAA,YAClD,IAAK6jB,EAAK,MAAO,GAEb,IACI,MAAA5S,QAAa9Q,MAAM0jB,GAElB,aADY5S,EAAKC,aAEjBnC,GAIP,OAHG4jB,GAAY3yB,KAAK+3B,QACZ5oB,QAAAtL,MAAM,2BAA4BkL,GAC1CmpC,GAAYl4C,KAAK+3B,OAAS,IAAItW,GAAG,gBAAgBA,GAAG,gBAAgB3O,OAAO/D,MACpE,EACT,CACF,GAAA,CAGQ,YAAA2pC,CAAal4C,GACdA,EAAA6W,SAAS+gC,IACZA,EAAIjF,MAAM97B,SAAQ,CAAC/F,EAAMkE,KAClBlE,EAAKrQ,MAAKqQ,EAAKrQ,IAAM,GAAGm3C,EAAIvpC,QAAQ2G,EAAQ,IAAC,GACnD,GAEL,CAGQ,YAAAmjC,CAAan4C,GACnB,MAAMo4C,EAAiC,CAAA,EAClCp4C,EAAA6W,SAAS+gC,IACRA,EAAAjF,MAAM97B,SAAS/F,IACZA,EAAKrQ,KAAmC,KAA5B6R,OAAOxB,EAAKrQ,KAAK4W,SAC7B+gC,EAAItnC,EAAKrQ,KACT23C,EAAItnC,EAAKrQ,OADU23C,EAAAtnC,EAAKrQ,KAAO,EAGhC23C,EAAItnC,EAAKrQ,KAAO,IAAQqQ,EAAArQ,IAAM,GAAGqQ,EAAKrQ,OAAO23C,EAAItnC,EAAKrQ,QAAI,GAC/D,GAEL,CAGQ,WAAAu3C,CAAYh4C,GACd,IACF,MACkB,iBAATA,KACLK,OAAOg4C,OAAOr4C,GAAMoJ,QACtBhF,MAAMC,QAAQhE,OAAOC,KAAKD,OAAOg4C,OAAYr4C,GAAM,GAAGs4C,aACtDj4C,OAAOC,KAAKD,OAAOg4C,OAAYr4C,GAAM,GAAGs4C,UAAU,IAAIhc,SAAS,OAAM,CAEjE,MAAA94B,GACC,OAAA,CACT,CACF,CAGQ,UAAAy0C,CAAWM,GACjB,MAAM17B,EAAyB,GAiBxB,OAhBAxc,OAAAy5B,QAAQye,GAAS1hC,SAAQ,EAAE2hC,EAASZ,MACnC,MAAAa,EAAwB,CAAEpqC,KAAMmqC,EAASz2C,KAAM61C,EAAI71C,KAAM4wC,MAAO,IACtEiF,EAAIU,UAAUzhC,SAAQ,CAAC/F,EAAMkE,KAE3B,MAAM0jC,EAAU5nC,EAAK6nC,KACjB,GAAA,aAAaxjC,KAAKujC,GAAU,CACxB,MAAAt6B,EAAO,oBAAoBoB,KAAKk5B,GAClCt6B,GAAQA,EAAKhV,OAAS,IAAQ0H,EAAA6nC,KAAOv6B,EAAK,GAChD,CACAq6B,EAAK9F,MAAMnmC,KAAK,CACd/L,IAAKqQ,EAAKuB,MAAQ,GAAGmmC,KAAWxjC,EAAQ,IACxC4I,IAAK9M,EAAK6nC,MACX,IAEH97B,EAAKrQ,KAAKisC,EAAI,IAET57B,CACT,CAGQ,iBAAAu6B,GAED53C,KAAAo5C,SAAW5oB,GAAoB,oCAC/BxwB,KAAA+3B,OAAQ52B,OAAOnB,KAAKo5C,UAEzBp5C,KAAK+qB,UAAU1T,SAAQ,CAAC+gC,EAAK5iC,KACrB,MAAA6jC,EAAO7oB,GAAoB,sDAC5BxwB,KAAAo5C,SAASj4C,OAAOk4C,GACrBA,EAAK3lB,aAAa,aAAc5gB,OAAO0C,IAClC6jC,EAAA3lB,aAAa,gBAAiB0kB,EAAIvpC,MAClCwqC,EAAA3lB,aAAa,YAAa0kB,EAAI71C,MAC/B61C,EAAAjF,MAAM97B,SAAS/F,IACX,MAAAgoC,EAAQ9oB,GAAoB,kCAM9B,GALJ6oB,EAAKl4C,OAAOm4C,GAENhoC,EAAKrQ,MAAQ,IAAI6Y,OAAO,KAAKs+B,EAAIvpC,qBAAqB8G,KAAKrE,EAAKrQ,MAC9Dq4C,EAAA5lB,aAAa,QAASpiB,EAAKrQ,KAElB,UAAbm3C,EAAI71C,KAAkB,CAClB,MAAAkxB,EAAQplB,SAASiR,cAAc,OACrCmU,EAAM1W,IAAMzL,EAAK8M,IACjBqV,EAAMvW,IAAM5L,EAAKrQ,IACjBq4C,EAAMn4C,OAAOsyB,EAAK,MAElB6lB,EAAMx5B,UAAYxO,EAAK8M,IAGzBk7B,EAAMjmB,QAAU,KACG,UAAb+kB,EAAI71C,KACNvC,KAAK23B,IAAI0e,YAAYlb,cAAc,KAAK7pB,EAAKrQ,QAE7CjB,KAAK23B,IAAI0e,YAAYlb,cAAc7pB,EAAK8M,KAAO,GACjD,CAAA,GAEH,IAICpe,KAAK+qB,UAAUnhB,OAAS,IACrB5J,KAAAu5C,aAAe/oB,GAAoB,wCACnCxwB,KAAA+3B,OAAQ52B,OAAOnB,KAAKu5C,cACzBv5C,KAAK+qB,UAAU1T,SAAQ,CAAC+gC,EAAK5iC,KACrB,MAAA8jC,EAAQ9oB,GAAoB,YAClC8oB,EAAMx5B,UAAYs4B,EAAIvpC,KACtByqC,EAAM5lB,aAAa,aAAc5gB,OAAO0C,IACxC8jC,EAAMjmB,QAAU,IAAMrzB,KAAKw5C,QAAQhkC,GAC9BxV,KAAAu5C,aAAap4C,OAAOm4C,EAAK,KAK9Bt5C,KAAK+qB,UAAUnhB,OAAS,GAAG5J,KAAKw5C,QAAQ,EAC9C,CAGO,OAAAA,CAAQhkC,aACb5Q,MAAM+8B,KAAK3hC,KAAKo5C,SAASztB,UAAUtU,SAAS/F,IAC1C,MAAM8O,EAAK9O,EACP8O,EAAGo1B,aAAa,gBAAkB1iC,OAAO0C,GAC3C4K,EAAG9G,MAAMsX,QAAU,OAEnBxQ,EAAG9G,MAAMsX,QAAU,EACrB,IAGG,OAAA3uB,EAAAjC,KAAAu5C,eACDt3C,EAAAy/B,iBAAiB,eAClBrqB,SAAS/F,GAASA,EAAKqc,UAAUmE,OAAO,YACtC,OAAA8H,EAAA,OAAAz3B,EAAAnC,KAAAu5C,mBAAc,EAAAp3C,EAAAmqB,cAAc,oBAAoB9W,SAAhDokB,EAA4DjM,UAAUC,IAAI,UAE/E5tB,KAAK63C,kBACP,CAEQ,gBAAAA,GAGR,CAGO,sBAAAJ,CAAuB5kC,GAC5B,OAAK7S,KAAK+qB,WAAcnmB,MAAMC,QAAQ7E,KAAK+qB,YAEtC/qB,KAAA+qB,UAAU1T,SAAS+gC,IACL,UAAbA,EAAI71C,MACD1B,OAAAy5B,QAAQ8d,EAAIjF,OAAO97B,SAAQ,EAAE7B,EAAOlE,MACzCuB,EAAOA,EACJ8E,MAAM,KAAKrG,EAAKrQ,QAChBwD,KAAK,aAAa6M,EAAK8M,sBAAsB9M,EAAKrQ,QAAO,GAC7D,IAGI4R,GAXuDA,CAYhE,ECnTI,MAAA4mC,GAAe,CAAC,MAAO,MAAO,OAAQ,MAAO,MAAO,MAAO,QAEjE,MAAqBC,WAAehiB,GAGlC,WAAA73B,CAAY83B,GACV1yB,MAAM0yB,GAHA53B,EAAAC,KAAA,mBAKNA,KAAK23B,IAAIkf,YAAW,IAAM72C,KAAK6P,SAE/B7P,KAAK25C,aACP,CAEQ,IAAA9pC,GACD7P,KAAA45C,gBAAkBvrC,SAASiR,cAAc,SAC9Ctf,KAAK45C,gBAAgBr3C,KAAO,OACvBvC,KAAA45C,gBAAgBtgC,MAAMsX,QAAU,OAChC5wB,KAAA45C,gBAAgBC,OAASJ,GAAal1C,KAAKqG,GAAM,IAAIA,MAAKnG,KAAK,KAGpE,MAAMozB,EAAO73B,KAAK43B,OAChB,kBAAkBnW,GAAG,+yBAElBoW,EAAAjG,MAAM5xB,KAAK45C,iBAChB/hB,EAAKxE,QAAU,KAEb,MAAMwC,EAAS71B,KAAK45C,gBACpB/jB,EAAOikB,SAAW,KACf,MAAa53C,EAAAlC,KAAA,MAAA,YAEZ,IAAK61B,EAAOkkB,OAAiC,IAAxBlkB,EAAOkkB,MAAMnwC,OAAc,OAC1C,MAAAowC,EAAOnkB,EAAOkkB,MAAM,GAC1B/5C,KAAKi6C,UAAUD,EAAI,KAJpB,IAOHnkB,EAAO7B,OAAM,EAGVh0B,KAAK23B,IAAIye,UAAUvqB,WACjB7rB,KAAA63B,KAAMnE,aAAa,sBAAuB,GAEnD,CAEQ,WAAAimB,GAEA,MAAAO,EAAsBH,IAC1B,GAAKA,EAEL,IAAA,IAASpwC,EAAI,EAAGA,EAAIowC,EAAMnwC,OAAQD,IAAK,CAC/B,MAAAqwC,EAAOD,EAAMpwC,GACnB3J,KAAKi6C,UAAUD,EACjB,GAMIG,EAAc/vB,IAClBA,EAAIiX,kBACJjX,EAAI8L,gBAAe,EAGfkkB,EAAUhwB,UACR,MAAA2vB,EAAQ,OAAA93C,EAAImoB,EAAAiwB,mBAAc,EAAAp4C,EAAA83C,aAC5BA,WAAOnwC,UACTwgB,EAAI8L,iBACJgkB,EAAmBH,GACrB,EAIIO,EAAWlwB,UACT,MAAA2vB,EAAQ,OAAA93C,EAAImoB,EAAAmwB,oBAAe,EAAAt4C,EAAA83C,aAC7BA,WAAOnwC,UACTwgB,EAAI8L,iBACJgkB,EAAmBH,GACrB,EAGG/5C,KAAA23B,IAAIkf,YAAW,KAClB72C,KAAK23B,IAAIsB,QAAQ/B,UAAU9mB,iBAAiB,WAAY+pC,GACxDn6C,KAAK23B,IAAIsB,QAAQ/B,UAAU9mB,iBAAiB,OAAQgqC,GACpDp6C,KAAK23B,IAAIsB,QAAQ/B,UAAU9mB,iBAAiB,QAASkqC,EAAO,IAEzDt6C,KAAA23B,IAAImf,cAAa,KACpB92C,KAAK23B,IAAIsB,QAAQ/B,UAAUvpB,oBAAoB,WAAYwsC,GAC3Dn6C,KAAK23B,IAAIsB,QAAQ/B,UAAUvpB,oBAAoB,OAAQysC,GACvDp6C,KAAK23B,IAAIsB,QAAQ/B,UAAUvpB,oBAAoB,QAAS2sC,EAAO,GAEnE,CAEM,SAAAL,CAAUD,GAAY,OAAA93C,EAAAlC,KAAA,MAAA,YAC1B,MAAMw6C,EAAU,SAASx6B,KAAKg6B,EAAKnrC,MAC/B,IAAC2rC,IAAYf,GAAa3c,SAAShqB,OAAO0nC,EAAQ,IAAI1mC,eAAgB,OAG1E,IAAK9T,KAAK23B,IAAIwe,UAAUppB,wBAEtB,YADA/sB,KAAK23B,IAAI0e,YAAY/mB,WAAW7N,GAAG,kBAAmB,KAKxD,IAAIg5B,EAAe,KAC6B,KAA5Cz6C,KAAK23B,IAAIsB,QAAQ/B,UAAU/yB,MAAM0T,SAA8B4iC,EAAA,IAGnE,MAAMC,EAAuB,GAAGD,kBAA6BT,EAAKnrC,WAI9D,IAAAoC,EAHJjR,KAAK23B,IAAI0e,YAAYlb,cAAcuf,GAI/B,IACF,MAAMC,EAAmB36C,KAAK23B,IAAIye,UAAUwE,YAM1C3pC,EALG0pC,EAKI,CAAEE,iBAAkBF,EAAiBX,WAH9Bh6C,KAAK23B,IAAIse,SAAS1tC,OAAOA,OAAO,CAAEyxC,UAASx5C,WAKpDuO,GACPI,QAAQtL,MAAMkL,GACd/O,KAAK23B,IAAI0e,YAAY/mB,WAAW,GAAG7N,GAAG,kBAAkB1S,EAAI4C,UAAW,IACzE,CACA,GAAMV,GAAQA,EAAK4pC,WAAY,CAC7B,IAAIC,EAAS7pC,EAAK4pC,WAGb9Y,GAAiB+Y,KACpBA,EAASzd,GAAuB,CAC9B3wB,KAAM1M,KAAK23B,IAAIye,UAAU5rB,OACzBloB,KAAMw4C,KAIL96C,KAAA23B,IACF0e,YACApb,WACCj7B,KAAK23B,IACFsB,QACA/B,UAAU/yB,MAAM4O,QAAQ2nC,EAAsB,GAAGD,QAAmBK,MACzE,MAGF96C,KAAK23B,IACF0e,YACApb,WAAWj7B,KAAK23B,IAAIsB,QAAQ/B,UAAU/yB,MAAM4O,QAAQ2nC,EAAsB,IAEjF,GAAA,ECnJF,MAAqBK,WAAgBrjB,GAGnC,WAAA73B,CAAY83B,GACV1yB,MAAM0yB,GAHkB53B,EAAAC,KAAA,mBAAA,GAKnBA,KAAA23B,IAAIkf,YAAW,KAClB72C,KAAK83B,SAAS,+CAGT93B,KAAA43B,OACH,kBAAkBnW,GAAG,iWAAU,IAG9BzhB,KAAA23B,IAAImf,cAAa,SAGtB92C,KAAK23B,IAAIS,YAAYlO,GAAG,mBAAoB1Q,IACrCxZ,KAAAg7C,iBAAmBh7C,KAAKi7C,mBAG/Bj7C,KAAKm4B,cAAa,KAChBn4B,KAAKg7C,iBAAkB,EACvBh7C,KAAKi7C,eAAc,IAErBj7C,KAAKs4B,cAAa,KAChBt4B,KAAKg7C,iBAAkB,CAAA,GAE3B,CAEA,aAAAC,GACEj7C,KAAK+3B,OAAQtY,UAAYzf,KAAK23B,IAAI0e,YAAYrb,kBAChD,ECrBF,MAAMkgB,GAAsC,CNZ5C,cAA0CxjB,GACxC,WAAA73B,CAAY83B,GACV1yB,MAAM0yB,GAEN,MAAMwjB,EAAmB,KACvBn7C,KAAKskB,MAAK,EAGPtkB,KAAA23B,IAAIkf,YAAW,KAElB,MAAMuE,EAAer/B,OAAO23B,aAAaC,QAAQmC,KAAoB,GACzC,KAAxBsF,EAAavjC,SACf7X,KAAK23B,IAAI0e,YAAY/mB,WAAW7N,GAAG,eAAgB,KACnDzhB,KAAK23B,IAAI0e,YAAYpb,WAAWmgB,IAIlCp7C,KAAK23B,IAAIS,YAAYlO,GAAG,kBAAmBixB,EAAgB,IAGxDn7C,KAAA23B,IAAImf,cAAa,KACpB92C,KAAK23B,IAAIS,YAAYjO,IAAI,kBAAmBgxB,EAAgB,GAEhE,CAGO,IAAA72B,GACEvI,OAAA23B,aAAaE,QAAQkC,GAAiB91C,KAAK23B,IAAI0e,YAAYxb,gBAAgBhjB,OACpF,GO/BF,cAAyC6f,GACvC,WAAY2jB,GACV,OAAOr7C,KAAK23B,IAAI0e,YAAY1b,mBAC9B,CAEA,WAAA96B,CAAY83B,GACV1yB,MAAM0yB,GAEN,MAAM2jB,EAAgD,CAAA,EAChDC,EAAiD,CAAA,EAEjD78B,EACJ,CAAC0L,EAAuCyL,EAA0B2lB,IAAkB,KAC7Ex7C,KAAA23B,IAAIS,YAAY1Z,QAAQ0L,EAAK,CAAEoxB,QAAO3lB,UAAQ,EAGlD71B,KAAA23B,IAAIkf,YAAW,KAEXh2C,OAAAy5B,QAAQt6B,KAAKq7C,SAAShkC,SAAQ,EAAEpW,EAAK40B,MACnCA,EAAAzlB,iBACL,QACCkrC,EAAcr6C,GAAOyd,EAAQ,eAAgBmX,EAAQ50B,IAEjD40B,EAAAzlB,iBACL,SACCmrC,EAAet6C,GAAOyd,EAAQ,gBAAiBmX,EAAQ50B,GAAG,GAE9D,IAGEjB,KAAA23B,IAAImf,cAAa,KAEbj2C,OAAAy5B,QAAQt6B,KAAKq7C,SAAShkC,SAAQ,EAAEpW,EAAK40B,MAC1CA,EAAOloB,oBAAoB,QAAS2tC,EAAcr6C,IAClD40B,EAAOloB,oBAAoB,SAAU4tC,EAAet6C,GAAI,GACzD,GAEL,GCnCF,cAAwCy2B,GACtC,WAAA73B,CAAY83B,GACV1yB,MAAM0yB,GA8BQ53B,EAAAC,KAAA,QAAA,CACdy7C,MAAsB,KACtBC,QAA8B,OA9B9B,MAAMC,EAAU,EAAG9lB,SAAQ2lB,YACe,SAApCx7C,KAAK23B,IAAI0e,YAAY3b,aAGzB16B,KAAK23B,IAAIwe,UAAUhiB,OAAO,CAAEqnB,CAACA,GAAQ3lB,EAAO1xB,MAAM0T,SAGpC,SAAV2jC,GAA8B,UAAVA,GAAmBx7C,KAAK47C,gBAAc,EAG3D57C,KAAA23B,IAAIkf,YAAW,KAClBh2C,OAAOy5B,QAAQt6B,KAAK23B,IAAI0e,YAAY1b,qBAAqBtjB,SAAQ,EAAEpW,EAAK40B,MAEtEA,EAAO5R,YAAc,GAAGxC,GAAGxgB,KAGpB40B,EAAA1xB,MAAQnE,KAAK23B,IAAIwe,UAAUrpB,UAAU7rB,IAAQ,EAAA,IAItDjB,KAAK23B,IAAIS,YAAYlO,GAAG,eAAgByxB,EAAO,IAG5C37C,KAAA23B,IAAImf,cAAa,KACpB92C,KAAK23B,IAAIS,YAAYjO,IAAI,eAAgBwxB,EAAO,GAEpD,CAUQ,aAAAC,GACD57C,KAAA23B,IAAIwe,UAAUrC,SAEf9zC,KAAKwC,MAAMi5C,OAAc1/B,OAAA0a,aAAaz2B,KAAKwC,MAAMi5C,OACjDz7C,KAAKwC,MAAMk5C,SAAS17C,KAAKwC,MAAMk5C,UAEnC17C,KAAKwC,MAAMi5C,MAAQ1/B,OAAO+U,YAAW,KACnC9wB,KAAKwC,MAAMi5C,MAAQ,KAEb,MAAAI,EAAM77C,KAAK23B,IAAIse,SACf6F,EAAe,qBACrB97C,KAAKwC,MAAMk5C,QAAU,IAAMG,EAAIE,aAAaD,GAE5CD,EAAInzC,KACDF,QACChF,EAAA,CAAA,EAAKq4C,EAAI1pC,iBACT,CACE5Q,YAAau6C,IAGhBp4C,MAAM4pB,GAAQttB,KAAKg8C,kBAAkB1uB,EAAI9sB,QACzCuD,OAAOgL,IAAD,IACNktC,SAAQ,KACPj8C,KAAKwC,MAAMk5C,QAAU,IAAA,GACtB,GACF,IACL,CAOQ,iBAAAM,CAAkBx7C,SAEnBA,EAAK28B,UAAen9B,KAAA23B,IAAIwe,UAAUrC,SAGvC9zC,KAAK23B,IAAI0B,eAAevM,UAAU3N,eAAe3e,EAAK0e,UAGlDlf,KAAK23B,IAAIwe,UAAUppB,0BAA4BvsB,EAAK28B,WAAY,OAAAl7B,EAAAzB,EAAKkI,WAAL,EAAAzG,EAAWi7B,WAExEl9B,KAAA23B,IAAI0B,eAAehL,WAAW,CACjCwF,UAAW,SAKXrzB,EAAKkI,MAAQlI,EAAKkI,KAAKyS,OACzBnb,KAAK23B,IAAIsB,QAAQjC,MAAM7yB,MAAQ3D,EAAKkI,KAAKyS,KACpCnb,KAAA23B,IAAIwe,UAAUhiB,OAAO,CAAEhZ,KAAM3a,EAAKkI,KAAKyS,OAEhD,GC/FF,cAAwCuc,GACtC,WAAA73B,CAAY83B,GACV1yB,MAAM0yB,GAEN,MAAMukB,EAAe,EAAGV,YACR,SAAVA,GAAkBx7C,KAAKm8C,mBAAkB,EAI1Cn8C,KAAA23B,IAAIkf,YAAW,KAClB72C,KAAK23B,IAAIS,YAAYlO,GAAG,gBAAiBgyB,EAAY,IAGlDl8C,KAAA23B,IAAImf,cAAa,KACpB92C,KAAK23B,IAAIS,YAAYjO,IAAI,gBAAiB+xB,EAAY,GAE1D,CAEQ,iBAAAC,GAEN,MAAMhhC,EAAOnb,KAAK23B,IAAIsB,QAAQjC,MAAM7yB,MAAM0T,OACpCsD,IAAS,qBAAqBxF,KAAKwF,KACvCnb,KAAK23B,IAAIsB,QAAQjC,MAAM7yB,MAAQ,WAAWgX,IAC1Cnb,KAAK23B,IAAIwe,UAAUhiB,OAAO,CAAEhZ,KAAMnb,KAAK23B,IAAIsB,QAAQjC,MAAM7yB,QAE7D,GCxBF,cAAsCuzB,GACpC,WAAA73B,CAAY83B,GACV1yB,MAAM0yB,GAEN,MAAMykB,EAAap4C,GAAqBhE,KAAKo8C,UAAUp4C,GACjD23C,EAAU,IAAM37C,KAAK27C,UAEtB37C,KAAA23B,IAAIkf,YAAW,KAEb72C,KAAA23B,IAAIsB,QAAQ/B,UAAUjT,YAAcjkB,KAAK23B,IAAIye,UAAUnyB,aAAexC,GAAG,eAG9EzhB,KAAK23B,IAAIsB,QAAQ/B,UAAU9mB,iBAAiB,UAAWgsC,GACvDp8C,KAAK23B,IAAIsB,QAAQ/B,UAAU9mB,iBAAiB,QAASurC,EAAO,IAGzD37C,KAAA23B,IAAImf,cAAa,KAEpB92C,KAAK23B,IAAIsB,QAAQ/B,UAAUvpB,oBAAoB,UAAWyuC,GAC1Dp8C,KAAK23B,IAAIsB,QAAQ/B,UAAUvpB,oBAAoB,QAASguC,EAAO,IAGjE37C,KAAK23B,IAAIS,YAAYlO,GAAG,mBAAmB,KAEzCnO,OAAO+U,YAAW,KAChB9wB,KAAKq8C,yBAAwB,GAC5B,GAAE,GAET,CAGQ,SAAAD,CAAUp4C,GAGA,KAFAA,EAAEiyB,SAAWjyB,EAAEgsC,SAG7BhsC,EAAEkyB,iBACFl2B,KAAK23B,IAAI0e,YAAYlb,cAAc,MAEvC,CAEQ,OAAAwgB,GACD37C,KAAA23B,IAAIS,YAAY1Z,QAAQ,kBAAmB1e,KAAK23B,IAAI0e,YAAYxb,gBACvE,CAGO,uBAAAwhB,GACC,MAAAC,EAAOt8C,KAAK23B,IAAIsB,QAAQ/B,UAAUqlB,aAAev8C,KAAK23B,IAAIsB,QAAQ/B,UAAU9F,aAClFpxB,KAAK23B,IAAIsB,QAAQ/B,UAAU5d,MAAMiY,OAAS,MAC1CvxB,KAAK23B,IAAIsB,QAAQ/B,UAAU5d,MAAMiY,OAAS,GAAGvxB,KAAK23B,IAAIsB,QAAQ/B,UAAUslB,aAAeF,KACzF,GJ5BA7F,GKrBF,cAAuC/e,GACrC,WAAA73B,CAAY83B,GACV1yB,MAAM0yB,GAEN,MAAM8W,EAAU,KACTzuC,KAAA23B,IAAI0e,YAAYla,QAAO,EAGzBn8B,KAAA23B,IAAIkf,YAAW,KAEb72C,KAAA23B,IAAIsB,QAAQ7B,WAAWtX,UAAY9f,KAAK23B,IAAIye,UAAU3rB,SAAWhJ,GAAG,QAGzEzhB,KAAK23B,IAAIsB,QAAQ7B,WAAWhnB,iBAAiB,QAASq+B,EAAO,IAG1DzuC,KAAA23B,IAAImf,cAAa,KACpB92C,KAAK23B,IAAIsB,QAAQ7B,WAAWzpB,oBAAoB,QAAS8gC,EAAO,GAEpE,GLIA7V,GMlBF,cAAwClB,GAGtC,WAAA73B,CAAY83B,GACV1yB,MAAM0yB,GAHA53B,EAAAC,KAAA,WAMDA,KAAAu4B,qBAAqB,SAAU/J,IAClCxuB,KAAK2uB,SAASH,GAEP,KACLxuB,KAAKy8C,aAAY,KAKrBz8C,KAAK23B,IAAIS,YAAYlO,GAAG,WAAW,KACjC,MAAMwyB,EAAa18C,KAAK23B,IAAIglB,QAAQlG,IACpC,IAAKiG,EAAY,MAAM9tC,MAAM,8BAE7B,MAAM8nC,EAAgB,IAAIX,GAAgB/1C,KAAK23B,KAE/C+kB,EAAW3F,eAAe,CACxBG,WAAY,MAAQl3C,KAAKiG,QACzBoxC,IAAK,IAAYn1C,EAAAlC,KAAA,MAAA,YACf,IAAKA,KAAKiG,QAAe,MAAA,IAAI2I,MAAM,iCAY5B,aATC5O,KAAK23B,IAAIse,SAASz3B,SAASxY,cAAczC,EACzCC,EAAA,CAAA,QAAMkzC,EAAcR,sBADqB,CAE7CpY,IAAK99B,KAAKiG,QAAQE,GAClByuC,SAAU50C,KAAKiG,QAAQ2uC,SACvBC,gBAAY,EACZC,UAAW90C,KAAKiG,QAAQ6uC,cAE1Bt0C,IAGJ,IACA82C,KAAOH,IAEC,MAAA7wC,EAAOtG,KAAK23B,IAAIye,UAClBe,EAASvC,WAAatuC,EAAKgkB,SAC7BvO,OAAOmN,KAAK,GAAGiuB,EAASyF,wBAAwBzF,EAAShxC,MAG3DuwC,EAAcH,cAAcY,EAAQ,GAEvC,GAEL,CAEQ,QAAAxoB,CAASH,GACT,MAAA6L,EAAKr6B,KAAK23B,IAAIsB,QAChB,IAACoB,EAAGwiB,cAAe,CACrB,MAAMhlB,EAAOrH,GACX,2DAEK/O,GAAG,iHAKVoW,EAAKvL,cAA2B,aAAcxM,UAAY,IAAI0O,EAAYjK,OACrEsT,EAAAznB,iBAAiB,SAAS,KACxBpQ,KAAA23B,IAAI0e,YAAY7mB,YAAW,IAE/B6K,EAAA9C,WAAWp2B,OAAO02B,GACrBwC,EAAGwiB,cAAgBhlB,CACrB,CAEA73B,KAAKiG,QAAUuoB,EAEf6L,EAAGnD,UAAUnB,OACf,CAEQ,WAAA0mB,GACN,IAAKz8C,KAAKiG,QAAS,OAEb,MAAAo0B,EAAKr6B,KAAK23B,IAAIsB,QAChBoB,EAAGwiB,gBACLxiB,EAAGwiB,cAAc/qB,SACjBuI,EAAGwiB,mBAAgB,GAErB78C,KAAKiG,aAAU,CACjB,GCvFF,cAAuCyxB,GAGrC,WAAA73B,CAAY83B,GACV1yB,MAAM0yB,GAHA53B,EAAAC,KAAA,WAoGwBD,EAAAC,KAAA,wBAAA,QA9FzBA,KAAAu4B,qBAAqB,QAAStyB,IACjCjG,KAAKwmB,KAAKvgB,GAEH,KACLjG,KAAK88C,YAAW,KAKf98C,KAAA23B,IAAIkf,YAAW,KAClB,MAAM6F,EAAa18C,KAAK23B,IAAIglB,QAAQlG,IACpC,IAAKiG,EAAY,MAAM9tC,MAAM,8BAE7B8tC,EAAW3F,eAAe,CACxBG,WAAY,MAAQl3C,KAAKiG,QACzBoxC,IAAK,IAAYn1C,EAAAlC,KAAA,MAAA,YACf,MAAM+8C,EAAW,CACfvjC,QAASxZ,KAAK23B,IAAI0e,YAAYzb,kBAC9BrW,KAAMvkB,KAAK23B,IAAIsB,QAAQnC,MAAM3yB,MAC7BqD,MAAOxH,KAAK23B,IAAIsB,QAAQlC,OAAO5yB,MAC/BgX,KAAMnb,KAAK23B,IAAIsB,QAAQjC,MAAM7yB,OAEzB8B,EAAUjG,KAAKiG,QAKrB,aAJuBjG,KAAK23B,IAAIse,SAASz3B,SAASpY,cAAcH,EAAQE,GAAI3C,EACvEA,EAAA,CAAA,EAAAyC,GACA82C,KAEWv8C,IAClB,IACA82C,KAAOH,IACLn3C,KAAK23B,IAAI0B,eAAevM,UAAU1mB,cAAc+wC,EAAQ,GAE3D,GAEL,CAEQ,IAAA3wB,CAAKvgB,GACL,MAAAo0B,EAAKr6B,KAAK23B,IAAIsB,QAChB,IAACoB,EAAG2iB,eAAgB,CACtB,MAAMnlB,EAAOrH,GACX,2DAEK/O,GAAG,uFAKVoW,EAAKxE,QAAU,KACRrzB,KAAA23B,IAAI0e,YAAY7mB,YAAW,EAE/B6K,EAAA9C,WAAWp2B,OAAO02B,GACrBwC,EAAG2iB,eAAiBnlB,CACtB,CACA73B,KAAKiG,QAAUA,EAEZo0B,EAAAxD,QAAQvd,MAAMsX,QAAU,OAExByJ,EAAAvD,MAAM3yB,MAAQ8B,EAAQse,MAAQ,GAC9B8V,EAAAtD,OAAO5yB,MAAQ8B,EAAQuB,OAAS,GAChC6yB,EAAArD,MAAM7yB,MAAQ8B,EAAQkV,MAAQ,GAEjCnb,KAAK23B,IAAI0e,YAAYpb,WAAWh1B,EAAQuT,SACxC6gB,EAAGnD,UAAUnB,QAER/1B,KAAAi9C,oBAAoBx7B,GAAG,QAC9B,CAEQ,UAAAq7B,GACN,IAAK98C,KAAKiG,QAAS,OAEb,MAAAo0B,EAAKr6B,KAAK23B,IAAIsB,QAEhBoB,EAAG2iB,iBACL3iB,EAAG2iB,eAAelrB,SAClBuI,EAAG2iB,oBAAiB,GAGtBh9C,KAAKiG,aAAU,EAET,MAAAse,KAAEA,QAAM/c,EAAO2T,KAAAA,GAASnb,KAAK23B,IAAIwe,UAAUrpB,UACjDuN,EAAGvD,MAAM3yB,MAAQogB,EACjB8V,EAAGtD,OAAO5yB,MAAQqD,EAClB6yB,EAAGrD,MAAM7yB,MAAQgX,EAEjBnb,KAAK23B,IAAI0e,YAAYpb,WAAW,IAChCj7B,KAAKk9C,uBAEF7iB,EAAAxD,QAAQvd,MAAMsX,QAAU,EAC7B,CAQQ,mBAAAqsB,CAAoBpqC,GAC1B7S,KAAKm9C,sBAAwBn9C,KAAK23B,IAAIsB,QAAQ7B,WAAWtX,UACzD9f,KAAK23B,IAAIsB,QAAQ7B,WAAWtX,UAAYjN,CAC1C,CAEQ,oBAAAqqC,GACNl9C,KAAK23B,IAAIsB,QAAQ7B,WAAWtX,UAAY9f,KAAKm9C,qBAC/C,GChHF,cAAsCzlB,GACpC,WAAA73B,CAAY83B,GACV1yB,MAAM0yB,GAEA,MAAAylB,EAAS,IAAMp9C,KAAKkpB,OACpBm0B,EAAU,IAAMr9C,KAAKy1B,QAEtBz1B,KAAA23B,IAAIkf,YAAW,KAClB72C,KAAK23B,IAAIS,YAAYlO,GAAG,cAAekzB,GACvCp9C,KAAK23B,IAAIS,YAAYlO,GAAG,eAAgBmzB,EAAO,IAE5Cr9C,KAAA23B,IAAImf,cAAa,KACpB92C,KAAK23B,IAAIS,YAAYjO,IAAI,cAAeizB,GACxCp9C,KAAK23B,IAAIS,YAAYjO,IAAI,eAAgBkzB,EAAO,GAEpD,CAEQ,IAAAn0B,SACN,OAAAjnB,EAAAjC,KAAK23B,IAAIsB,QAAQhC,cAAc3K,cAAc,yBAAwBrqB,EAAA6vB,SACrE9xB,KAAK23B,IAAIsB,QAAQ/B,UAAU5d,MAAMsX,QAAU,GAC3C5wB,KAAK23B,IAAIsB,QAAQ9B,QAAQ7d,MAAMsX,QAAU,EAC3C,CAEQ,KAAA6E,GACDz1B,KAAK23B,IAAIsB,QAAQhC,cAAc3K,cAAc,wBAC3CtsB,KAAA23B,IACFsB,QACAhC,cAAcwI,QACbjP,GAAoB,mCAAmC/O,GAAG,+BAG3DzhB,KAAK23B,IAAIwe,UAAUrpB,UAAUsH,SAMhCp0B,KAAK23B,IAAIsB,QAAQ/B,UAAU5d,MAAMsX,QAAU,GAC3C5wB,KAAK23B,IAAIsB,QAAQ9B,QAAQ7d,MAAMsX,QAAU,KANzC5wB,KAAK23B,IAAIsB,QAAQ/B,UAAU5d,MAAMsX,QAAU,OAC3C5wB,KAAK23B,IAAIS,YAAY1Z,QAAQ,eAC7B1e,KAAK23B,IAAIsB,QAAQ9B,QAAQ7d,MAAMsX,QAAU,OAM7C,GRZA2mB,GACAmC,GACAqB,IS7BF,MAAqBuC,GACnB,WAAAz9C,CAAoBi7B,GAAA96B,KAAA86B,MAAAA,CAAqB,CAGzC,SAAAub,GACE,OAAOr2C,KAAK86B,MAAMpM,MACpB,CAOA,YAAA2K,GACS,OAAAr5B,KAAK86B,MAAMpM,OAAO/B,GAC3B,CAGA,OAAAypB,GACS,OAAAp2C,KAAK86B,MAAMpM,OAAO/B,IAAIrmB,IAC/B,CAGA,MAAA2vC,GACE,OAAOj2C,KAAK86B,MAAMpM,OAAO/B,IAAIqB,QAC/B,CAGA,OAAAmoB,GACE,OAAOn2C,KAAK86B,MAAMpM,OAAO/B,IAAIhrB,IAAI,OACnC,CAGA,KAAAs3B,GACS,OAAAj5B,KAAK86B,MAAMpM,OAAOuL,OAC3B,CAGA,SAAA7B,GACS,OAAAp4B,KAAK86B,MAAMI,WACpB,CAGA,UAAA2b,CAAW5e,GACTj4B,KAAKo4B,YAAYlO,GAAG,UAAW+N,EACjC,CAGA,YAAA6e,CAAa7e,GACXj4B,KAAKo4B,YAAYlO,GAAG,YAAa+N,EACnC,CAGA,OAAA0kB,CAAqCY,GAC5B,OAAAv9C,KAAK86B,MAAMn5B,IAAI47C,EACxB,EClCK,MAAMC,GAkBX,WAAA39C,CAAmB6uB,GAjBX3uB,EAAAC,KAAA,QAAsB,IACUD,EAAAC,KAAA,aAAA,MAChCD,EAAAC,KAAA,SAAS,IAAIiqB,IAeFjqB,KAAA0uB,OAAAA,EACjB,IAAI+uB,GAAa,EACjBz9C,KAAK0uB,OAAO/B,IAAIM,UACd,CAAC,YAAa,YAAa,UAAW,eAAgB,WACrD3mB,IAGCm3C,GAAcz9C,KAAKk7B,YAAYxc,QAAQ,aAGvC1e,KAAK09C,QVdN,SACLp3C,GAIM,MAAAq3C,MAAe19C,IAMrB,OALS09C,EAAA77C,IAAI43C,GAAQpzC,EAAKulB,WACjB8xB,EAAA77C,IAAIy1C,GAAWjxC,EAAKykB,WACpB4yB,EAAA77C,IAAIi5C,GAASz0C,EAAKme,SAClBk5B,EAAA77C,IAAI82B,GAAOtyB,EAAKqkB,cAElBuwB,GAAav2C,QAAQsG,IAAO0yC,EAASl8C,IAAIwJ,MAAQ0yC,EAASh8C,IAAIsJ,IACvE,CUKQ2yC,CAAgBt3C,GAAM+Q,SAASwmC,IAEvB,MAAAlmB,EAAM,IAAI2lB,GAAQt9C,MACxBA,KAAK86B,MAAM9tB,KAAK,IAAI6wC,EAAKlmB,GAAI,IAI1B33B,KAAAk7B,YAAYxc,QAAQ,WACZ++B,GAAA,EAGbz9C,KAAK89C,cAAa,IAItB99C,KAAKge,OAAOkM,GAAG,eAAe,IAAMlqB,KAAK+9C,kBAC3C,CA1CA,QAAArkB,GACE,OAAO15B,KAAK86B,KACd,CACA,SAAAI,GACE,OAAOl7B,KAAKge,MACd,CAEQ,KAAA0/B,GACN19C,KAAK86B,MAAQ,GACR96B,KAAAge,OAAS,IAAIiM,GACdjqB,KAAKg+C,YAAYh+C,KAAK+9C,gBAC5B,CAiCQ,YAAAD,GAEN99C,KAAK0uB,OAAOuL,QAAQxC,eAAehY,UAAY,GAC/Czf,KAAK0uB,OAAOuL,QAAQxC,eAAene,MAAMsX,QAAU,OACnD5wB,KAAK0uB,OAAOuL,QAAQzC,aAAa/X,UAAY,GAG7Czf,KAAK86B,MAAMzjB,SAASkmC,GAASv9C,KAAKi+C,eAAeV,IACnD,CAGQ,cAAAU,CAAeV,GACrB,MAAM1lB,EAAO0lB,EAAK1lB,KAClB,IAAKA,EAAM,OACX73B,KAAK0uB,OAAOuL,QAAQzC,aAAa7G,YAAYkH,IAG5CA,EAAKxE,UACHwE,EAAKxE,QAAU,KAEdrzB,KAAK0uB,OACFuL,QACAzC,aAAakK,iBAAiB,WAC9BrqB,SAAS/F,GAASA,EAAKqc,UAAUmE,OAAO,YAGvCyrB,IAASv9C,KAAKg+C,YAEhBh+C,KAAKk+C,cAAcX,GAGd1lB,EAAAlK,UAAUC,IAAI,WAGnB5tB,KAAK+9C,gBACP,GAIJ,MAAMhmB,EAASwlB,EAAKxlB,OAChBA,IACFA,EAAOze,MAAMsX,QAAU,OACvB5wB,KAAK0uB,OAAOuL,QAAQxC,eAAe9G,YAAYoH,GAEnD,CAEA,GAAAp2B,CAAiC47C,GAC/B,OAAOv9C,KAAK86B,MAAMlc,MAAM3T,GAAMA,aAAasyC,GAC7C,CAGA,aAAAW,CAAcX,GACPv9C,KAAA86B,MAAMzjB,SAASghB,IAClB,MAAM8lB,EAAY9lB,EAAMN,OACnBomB,IAED9lB,IAAUklB,GACZY,EAAU7kC,MAAMsX,QAAU,GACrB5wB,KAAAge,OAAOU,QAAQ,aAAc6+B,KAElCY,EAAU7kC,MAAMsX,QAAU,OACrB5wB,KAAAge,OAAOU,QAAQ,aAAc6+B,IACpC,IAGFv9C,KAAK0uB,OAAOuL,QAAQxC,eAAene,MAAMsX,QAAU,GACnD5wB,KAAKg+C,WAAaT,CACpB,CAGA,cAAAQ,GACO/9C,KAAKg+C,aAEVh+C,KAAK0uB,OAAOuL,QAAQxC,eAAene,MAAMsX,QAAU,OACnD5wB,KAAKge,OAAOU,QAAQ,aAAc1e,KAAKg+C,YACvCh+C,KAAKg+C,WAAa,KACpB,CAGA,qBAAAjjB,CAAsBqjB,GACpB,IAAInyC,EAASmyC,EAKN,OAJFp+C,KAAA86B,MAAMzjB,SAASghB,IACbA,EAAMH,qBACFjsB,EAAAosB,EAAMH,mBAAmBjsB,GAAM,IAEnCA,CACT,EChKW,iBCYN,SAASoyC,GAAgBztC,GACxB,MAAA0tC,EAAQ9tB,GAAoB,8DAIlC,GAHA8tB,EAAMhyB,cAA2B,kBAAmBxM,UAClD,GAAG2B,GAAG,uBAAuB7Q,EAAKg+B,SAEhCh+B,EAAK2tC,QAAS,CAChB,MAAMC,EAAYhuB,GAAoB,iCAAiC/O,GAAG,uBAC1E+8B,EAAUnrB,QAAU,IAAMziB,EAAK2tC,SAAW3tC,EAAK2tC,UAC/CD,EAAM3tB,YAAY6tB,EACpB,CAEA,GAAI5tC,EAAK6tC,cAAe,CACtB,MAAMC,EAAeluB,GACnB,8DAA8D/O,GAAG,WAAY,CAAE5S,KAAM4S,GAAG,iCAE1F68B,EAAM3tB,YAAY+tB,GAClBA,EAAarrB,QAAU,IAAMziB,EAAK6tC,eAAiB7tC,EAAK6tC,eAC1D,CAEYzsB,GAAAphB,EAAK+tC,KAAML,EACzB,CC3BA,IAAIM,IAAqB,ECHrB,IAAAC,GAEK,SAAAC,GAAiBC,EAAqBr0B,GAC7C,MAAMs0B,EAAoB,gBAErBD,EAAA1nC,SAASmd,IACR9J,EAAc8J,EAAA7G,UAAUC,IAAIoxB,GACvBxqB,EAAA7G,UAAUmE,OAAOktB,EAAiB,GAE/C,CAEa,MCLAC,GAAiC,CtBPPtyB,IACrCA,EAAIM,UAAU,CAAC,cAAe,kBAAmB3mB,K/D6B5C,SAAoBK,GACrB,IACE,IAACu4C,EAAUjkC,OAAApM,KAAM,MAAA,CACf,MAAA7K,GACN,MACF,CAGAk7C,EAAAA,OAAUC,WAAW37C,EAAAA,EAAA,CACnBwX,SAAUD,GAAY,CACpByB,YAAa7V,EAAQ6V,eAEpBE,IACA/V,EAAQ+V,gBAGFrT,GAAA61C,EAAAA,MACb,C+D7CsBE,CAAA,CAChB1iC,cAAeiQ,EAAIU,UAAU3Q,cAC7BF,YAAamQ,EAAIU,UAAU7Q,aAC5B,IAGHmQ,EAAIM,UAAU,CAAC,oBAAqB3mB,I/DY/B,IAAsB0nC,E+DXpB1nC,EAAA+4C,kB/DWoBrR,E+DXmB1nC,EAAK+4C,gB/DYvC5iC,GAAAuxB,E+DZsD,GACjE,EiBOqCrhB,IAChC,MAAA+B,EAAS/B,EAAIhrB,IAAI,UAEjBwyC,EAAc,IAAIqJ,GAAY9uB,GAChC/B,EAAAmB,OAAO,cAAeqmB,EAAW,EMtBKxnB,IAC1C,MAAM2yB,EAAY,KAuCX,IAAkBlrB,IArCrBzH,EAAIhrB,IAAI,QAAQmrB,UAAUsH,QAgBhC,SAAyBxjB,GACvB,MAAMskC,EAAqB,GAGtBtkC,EAAA8c,MACFgU,iBAA8B,yBAC9BrqB,SAAS/F,GAAS4jC,EAAIloC,KAAKsE,KAMxB,MAAAiuC,EAAalxC,SAASie,cAA2B,gBAMhD,OALHizB,GAECA,EAAA7d,iBAA8B,yBAC9BrqB,SAAS/F,GAAS4jC,EAAIloC,KAAKsE,KAEzB4jC,CACT,CAlCMsK,CAAgB,CACd9xB,MAAOf,EAAIe,QAoCbrW,SAASiiC,IACPllB,EAAeklB,EAAA3rB,UAAUmE,OAAO,YACzBwnB,EAAA3rB,UAAUC,IAAI,WAAU,GArChC,EAIDjB,EAAAzC,GAAG,eAAe,YAIlByC,EAAAzC,GAAG,gBAAiBxhB,UAEvB,KCAiC,CChBAikB,IAC9BA,EAAAzC,GAAG,cAAeu1B,IAChB,GAAA9yB,EAAIG,UAAU7O,aAAc,OAC5B0O,EAAAG,UAAU3O,YAAW,GAEzB,MAAMxb,EAA0Ba,EAAA,CAE9BurB,OAAQ,EACR2wB,MAAO/yB,EAAIrmB,KAAKilB,WAAWC,SAC3BZ,SAAU+B,EAAIrmB,KAAKskB,SACnB+0B,eAAgBhzB,EAAIrmB,KAAKs5C,yBACtBH,GAID9yB,EAAAG,UAAUvO,iBAAiB,CAC7B5b,WAIF,MAAMk9C,EAAY,CAChBH,MAAO/8C,EAAO+8C,MACd3wB,OAAQpsB,EAAOosB,OACf+wB,UAAWn9C,EAAOioB,SAClBgqB,SAAUjoB,EAAIU,UAAU/C,QACxBwqB,UAAWnoB,EAAIU,UAAUrlB,MAIvBrF,EAAOg9C,gBAAgBh9C,EAAOg9C,eAAeE,GAI9ClzB,EAAAqB,SACAxP,SAASzY,YAAYvC,EAAAA,EAAA,CAAA,EACjBq8C,GACAlzB,EAAIqB,SAAS7b,kBAEjBzO,MAAK,EAAGlD,WAKPmsB,EAAIG,UAAUvO,iBAAiB,CAAE5b,SAAQnC,SAGzCmsB,EAAIG,UAAU/N,aAAave,EAAKge,UAGhCmO,EAAIG,UAAU1lB,WAAW5G,EAAK2G,MAGvBxE,EAAAkxB,WAAalxB,EAAOkxB,UAAUrzB,GAErCmsB,EAAIjO,QAAQ,eAAgB,CAAE/b,SAAQnC,QAAM,IAE7CuD,OAAOC,IAEN,MAAMH,EAAQ,CACZ+N,IAAK5N,EAAE4N,KAAOkB,OAAO9O,GACrBxD,KAAMwD,EAAExD,MASJ,MANCmC,EAAAoxB,SAAWpxB,EAAOoxB,QAAQlwB,GAG7B8oB,EAAAjO,QAAQ,cAAe7a,GAC3B8oB,EAAIjO,QAAQ,eAAgB,CAAE/b,SAAQkB,UAEhCG,CAAA,IAEPi4C,SAAQ,KACHtvB,EAAAG,UAAU3O,YAAW,EAAK,GAC/B,GACJ,ECzEmCwO,IAChCA,EAAAzC,GAAG,cAAejf,IACd,MAAAiJ,EAAOyY,EAAIhrB,IAAI,QAEJ,IAAbsJ,EAAE8jB,QAEU5Q,IAAA,EAAMjK,EAAKsgB,IAAG,IAI5B7H,EAAAzC,GAAG,gBAAgB,KAEP/L,IAAA,EADDwO,EAAIhrB,IAAI,QACK6yB,IAAG,GAC9B,ECbkC7H,IAC/BA,EAAAzC,GAAG,oBAAqBjkB,IAEtB,IAAiC,IAAjC0mB,EAAIrmB,KAAKy5C,oBAA8B,CACzC,MAAM7gC,EAAWyN,EAAIG,UAAUrmB,cACzBu5C,EAAS9gC,EAASN,MAAMhU,GAAMA,EAAEq1C,aAAeh6C,EAAQ8jC,UAEzDiW,GAEM/5C,EAAAg5B,YAAYqJ,WAAU,GACtBriC,EAAAg5B,YAAYwJ,eAAc,KACzB1sB,OAAAmN,KAAK82B,EAAOE,WAGnBvzB,EAAIG,UAAU3N,eAAeD,EAASva,QAAQiG,GAAMA,EAAEq1C,aAAeh6C,EAAQ8jC,UAAQ,KAI/E9jC,EAAAg5B,YAAYqJ,WAAU,EAElC,KAGE3b,EAAAzC,GAAG,aAAci2B,IACb,MAAAr5C,EAAYs5C,GAAoB,kBAClCt5C,GAGC6lB,EAAAqB,SACA9O,SAAStY,eAAeu5C,EAAWr5C,GACnCpD,MAAK,KAEJipB,EAAIG,UAAU3N,eACZwN,EACGG,UACArmB,cACA9B,QAAQiG,GAAMA,EAAEq1C,aAAeE,IAAS,GAGnD,GACD,ECxCsCxzB,IACnC,IAAA0zB,EAIA1zB,EAAAzC,GAAG,WAAW,KACV,MAAAhW,EAAOyY,EAAIhrB,IAAI,QAEF0+C,EAAAnsC,EAAKsgB,IAAIlI,cAA2B,uCAGtC+zB,EAAAjwC,iBAAiB,SAAS,KACzC,MAAMjJ,EAAOwlB,EAAIG,UAAU1N,UAC3B,IAAKjY,EAAY,MAAA,IAAIyH,MAAM,uBAEtBzH,EAAAm5C,YAAcn5C,EAAKm5C,WA4BrB,SAAkB3zB,EAAiBxlB,GAC1CwlB,EAAIsC,oBACJtC,EACGqB,SACA2mB,MAAMvtC,WAAWD,EAAKhB,GAAIgB,GAC1BzD,MAAK,EAAGlD,WACHmsB,EAAAG,UAAU1lB,WAAW5G,EAAI,IAE9BuD,OAAOgL,IACN4d,EAAI0C,iBAAiB,GAAG5N,GAAG,gBAAgB1S,EAAI4C,SAAWmB,OAAO/D,KAAQ,IAAG,IAE7EktC,SAAQ,KACPtvB,EAAIwC,mBAAkB,GAE5B,CAzCMoxB,CAAkB5zB,EAAKxlB,EAAI,GAC5B,IAICwlB,EAAAzC,GAAG,eAAgB/iB,YACf,MAAAunB,EAAS/B,EAAIhrB,IAAI,WAGE,KAArB,MAAAwF,OAAA,EAAAA,EAAMm5C,aAER,OAAAr+C,EAAAysB,EAAOgL,aAAYz3B,EAAAi5B,YAAYxc,QAAQ,gBAClB2hC,IAAAA,EAAiBvgC,UAAY2B,GAAG,kBAGrD,OAAAtf,EAAAusB,EAAOgL,aAAYv3B,EAAA+4B,YAAYxc,QAAQ,eAClB2hC,IAAAA,EAAiBvgC,UAAY2B,GAAG,iBACvD,IAGEkL,EAAAzC,GAAG,eAAgB1L,IAErBmO,EAAI4C,kBAAiB,GACtB,ECtCiC5C,IAe9BA,EAAAzC,GAAG,eAAe,KAdI,cAClB,MAEAs2B,EAFO7zB,EAAIhrB,IAAI,QAED6yB,IAAIlI,cAAc,gCACtC,IAAKk0B,EAAQ,OAEb,MAAM3tC,EAAOmX,GACXvI,GAAG,UAAW,CACZ2uB,MAAO,GAAG5sB,OAAO,OAAArhB,EAAA,OAAAF,EAAA0qB,EAAIG,UAAUzO,yBAAoB,EAAApc,EAAAzB,WAAM,EAAA2B,EAAAiuC,QAAU,OAGvEoQ,EAAO/gC,UAAY5M,EAAKE,QAAQ,QAAS,gDAA+C,QAOtF4Z,EAAAzC,GAAG,oBAAoB,KAEzB,MAAM7U,EAAOsX,EAAIG,UAAUzO,oBACjB,MAANhJ,OAAM,EAAAA,EAAA7U,QAAM6U,EAAK7U,KAAK4vC,OAAS,EAAA,IAGjCzjB,EAAAzC,GAAG,mBAAmB,KAExB,MAAM7U,EAAOsX,EAAIG,UAAUzO,oBACjB,MAANhJ,OAAM,EAAAA,EAAA7U,QAAM6U,EAAK7U,KAAK4vC,OAAS,EAAA,GACpC,EC9BsCzjB,IACvC,IAAI8zB,EAAsC,KAE1C,MAAMC,EAAa,KACjB,IAAKD,EAAiB,OACtB,MAAM/3C,EAAOikB,EAAIhrB,IAAI,QAAQmrB,UAG7B,GAAMpkB,EAAK6b,MAAU7b,EAAKlB,MAAO,CACfi5C,EAAA9yB,UAAUmE,OAAO,YAG3B,MAAA6uB,EAAWF,EAAgBn0B,cAA2B,aACxDq0B,IAAmBA,EAAA7gC,UAAapX,EAAK0rB,QAA4B3S,GAAG,cAArBA,GAAG,aAA8B,MAEpEg/B,EAAA9yB,UAAUC,IAAI,WAChC,EAGFjB,EAAIM,UAAU,CAAC,WAAY3mB,IACnB,MAAA4N,EAAOyY,EAAIhrB,IAAI,QAEH8+C,EAAAvsC,EAAKsgB,IAAIlI,cAA2B,gCACjDm0B,IAELA,EAAgBptB,QAAU,KAExB1G,EAAI8C,aAAY,UAMhB9C,EAAAzC,GAAG,gBAAiBxhB,UAEvB,ECpCuCikB,IACxC,IAAIi0B,EAAmC,KAanCj0B,EAAAzC,GAAG,WAAW,KACV,MAAAhW,EAAOyY,EAAIhrB,IAAI,QAENi/C,EAAA1sC,EAAKsgB,IAAIlI,cAA2B,oBAAmB,IAGpEK,EAAAzC,GAAG,oBAAqBhL,IAjBJ,IAACkxB,IAkBPlxB,EAAStV,QAAU,EAjB9Bg3C,IAEDxQ,EAAQ,GACVwQ,EAAa9gC,UAAY,GAAG0D,OAAO4sB,GAAS,KAC5CwQ,EAAatnC,MAAMsX,QAAU,SAE7BgwB,EAAatnC,MAAMsX,QAAU,OAWK,GACrC,ECpBoCjE,IAC/B,MAAAk0B,EAAyB5oB,IAC7BtL,EAAIrmB,KAAKs5C,wBAA0B3nB,EACnCtL,EAAImC,QAAO,EAGPgyB,EAAgBC,KA0DxB,SAAwBz6C,GAIhB,MAAA06C,cAAEA,EAAeC,aAAAA,GAAiB36C,EACpC,GAAA06C,EAAc10B,cAAc,iBAAkB,OAGpC00B,EAAArzB,UAAUC,IAAI,qBAGdozB,EAAA7/C,OAAOqvB,GAAoB,8CAGzC,IAAI0wB,EAAa,EACjB,MAAMC,EAAc,CAACx3C,EAAW2vC,EAAoBzqC,EAAc0C,SAInD2vC,EAAAv3C,EACby3C,EAAU1f,iBAAiB,WAAWrqB,SAASrT,IAC3CA,EAAA2pB,UAAUmE,OAAO,SAAQ,IAEvBwnB,EAAA3rB,UAAUC,IAAI,UAGpBwzB,EAAU9nC,MAAMsX,QAAU,OAC1BE,YAAW,KACTswB,EAAU9nC,MAAMsX,QAAU,EAAA,GACzB,GAAE,EAIDwwB,EAAY5wB,GAAoB,8CACzBywB,EAAA5pC,SAAQ,CAAC/F,EAAM3H,KACpB,MAACkF,EAAM0C,GAAUD,EAEjBgoC,EAAQ9oB,GAAoB,oDAC5BwG,EAAQsiB,EAAMhtB,cAA2B,QAC/C0K,EAAMlX,UAAYjR,EAClBmoB,EAAM3D,QAAU,KACF8tB,EAAAx3C,EAAG2vC,EAAOzqC,EAAM0C,EAAM,EAEpC6vC,EAAUjgD,OAAOm4C,GAEb3vC,IAAMu3C,GAAkB5H,EAAA3rB,UAAUC,IAAI,SAAQ,IAGpDozB,EAAc7/C,OAAOigD,EACvB,CA1GmBC,CAAA,CACbL,cAAeD,EACfE,aAAc,CACZ,CACEx/B,GAAG,cACH,KACEo/B,GAAuB51C,IACrBA,EAAEq2C,QAAU,WAAA,GACb,GAGL,CACE7/B,GAAG,YACH,KACEo/B,GAAuB51C,IACrBA,EAAEq2C,QAAU,MAAA,GACb,GAGL,CACE7/B,GAAG,cACH,KACEo/B,GAAuB51C,IACrBA,EAAEq2C,QAAU,UAAA,GACb,GAGL,CACE7/B,GAAG,cACH,KACEo/B,GAAuB51C,IACrBA,EAAEs2C,iBAAkB,CAAA,GACrB,KAIR,EAGH50B,EAAIM,UAAU,CAAC,WAAY,WAAY3mB,IAC/B,MAEAk6C,EAFO7zB,EAAIhrB,IAAI,QAED6yB,IAAIlI,cAA2B,sBAC9Ck0B,IAGDl6C,EAAK2kB,SACP61B,EAAaN,GA8DnB,SAAwBl6C,WAChB,MAAA06C,cAAEA,GAAkB16C,EACZ06C,EAAArzB,UAAUmE,OAAO,qBACjB,OAAA7vB,EAAA++C,EAAA10B,cAAc,0BAAyBrqB,EAAA6vB,SACvC,OAAA3vB,EAAA6+C,EAAA10B,cAAc,mBAAkBnqB,EAAA2vB,QAChD,CAjEqB0vB,CAAA,CACbR,cAAeR,IAEnB,GACD,EC7D0C7zB,IAC3C,IAAI80B,EAAS,EACb,MAAMrhB,EAAQ,EAAGshB,aACf,MAAMvB,EAqBV,WAIE,MAAMztC,EAAQqJ,OAAOC,SAAShE,KAAKtF,MAAM,yBACzC,IAAI7L,EACF6L,GAASA,EAAM,KAAO8Q,OAAOqsB,MAAMjP,WAAWluB,EAAM,KAAOkuB,WAAWluB,EAAM,IAAM,KAG/E7L,IACSA,EAAA2c,OAAO48B,GAAoB,iBAGzC,OAAOv5C,GAAa,IACtB,CAnCsB86C,GACbxB,IAEDuB,GAAUD,IAAWtB,IAChBsB,EAAAtB,EAELxzB,EAAAjO,QAAQ,YAAayhC,IAAS,EAG9ByB,EAAoB,IAAMxhB,EAAM,CAAEshB,QAAQ,IAC1CG,EAAoB,IAAMzhB,EAAM,CAAEshB,QAAQ,IAC5C/0B,EAAAzC,GAAG,WAAW,KACTnO,OAAA3L,iBAAiB,aAAcwxC,GAClCj1B,EAAAzC,GAAG,cAAe23B,EAAiB,IAErCl1B,EAAAzC,GAAG,aAAa,KACXnO,OAAApO,oBAAoB,aAAci0C,GACrCj1B,EAAAxC,IAAI,cAAe03B,EAAiB,GACzC,EftBqCl1B,IAClCA,EAAAzC,GAAG,aAAoBi2B,GAAcj+C,EAAAlC,KAAA,MAAA,YAEnC,IAAAiG,EAAU0mB,EAAIc,kBAAkB7O,MAAMC,GAAMA,EAAEkrB,UAAYoW,IAC9D,IAAKl6C,EAAS,CAEN,MAAAzF,SAAcmsB,EAAIqB,SAASxP,SAAStY,WAAWi6C,IAAY3/C,KACjEmsB,EACGhrB,IAAI,QACJmvC,cAAc,CAAEC,eAAe,IAC/BvR,OAAOh/B,EAAKyF,QAASzF,EAAKshD,eACnB77C,EAAA0mB,EAAIc,kBAAkB7O,MAAMC,GAAMA,EAAEkrB,UAAYoW,GAC5D,CACKl6C,GACLA,EAAQ8vB,OAAM,KACf,EgBbqCpJ,IAClCA,EAAAzC,GAAG,eAAgB1L,IACf,MAAAtK,EAAOyY,EAAIhrB,IAAI,QAGfogD,EAAcvjC,EAAS5U,QAAU,EACvC,IAAIo4C,EAAa9tC,EAAK08B,oBAAoBtkB,cAA2B,wBAEjEy1B,EACGC,IACUA,EAAAxxB,GAAoB,2CAGtBwxB,EAAAviC,UAAYlG,GAASrF,EAAKyY,IAAIrmB,KAAK4d,WAAahQ,EAAKyY,IAAIlL,GAAG,cAClEvN,EAAA08B,oBAAoBjgB,YAAYqxB,IAG3B,MAAAA,GAAAA,EAAAlwB,QACd,GACD,ECpBqCnF,IAClCA,EAAAzC,GAAG,WAAW,KACV,MAEA+3B,EAFOt1B,EAAIhrB,IAAI,QAEG6yB,IAAIlI,cAA2B,kBAClD21B,IAEMA,EAAAxiC,UACT,6EACkCyiC,iBAAc,GAEnD,ECVuCv1B,IACxC,IAAI8uB,EAAuB,KAEvB9uB,EAAAzC,GAAG,WAAW,KACRuxB,EAAA1/B,OAAOomC,aAAY,KACZx1B,EAAIhrB,IAAI,QAEhB6yB,IAAIkN,iBAA8B,2BAA2BrqB,SAAS+I,IACnE,MAAAoB,EAAOpB,EAAGo1B,aAAa,yBAC1Bp1B,EAAAN,UAAYuqB,GAAc,IAAIvoB,KAAK0B,OAAOhC,IAAQmL,EAAIlL,GAAE,GAC5D,GACA,IAAS,IAGVkL,EAAAzC,GAAG,aAAa,KACTuxB,GAAA1/B,OAAOqmC,cAAc3G,EAAK,GACpC,EChBuC9uB,IACpCA,EAAAzC,GAAG,cAAc,KAIP8H,GAHCrF,EAAIhrB,IAAI,QAGJ6yB,IAAK,KAAI,IAGxB7H,EAAAzC,GAAG,eAAgBnb,IACLsvC,GAAA,CACdM,KAAMhyB,EAAIhrB,IAAI,QAAQ6yB,IACtBoa,OAAQ7/B,EAAI6C,IACZywC,QAAStzC,EAAIvO,KACb+9C,QAAS,IAAM5xB,EAAIxsB,MAAM,CAAE4uB,OAAQ,KACpC,GACF,ECjBuCpC,IACxC,IAAI21B,EAAwC,KAEtC,MAwBAC,EAAgB,KACV,MAAAD,GAAAA,EAAAE,aACCF,EAAA,IAAA,EAGT31B,EAAAzC,GAAG,eAAe,SAGd,MAGAyB,EAHOgB,EAAIhrB,IAAI,QAGCivC,oBAAoB6R,WACpCC,EAAU/2B,EAAS/hB,OAAS,EAAK+hB,EAASA,EAAS/hB,OAAS,GAAqB,KAClF84C,IAGC,yBAA0B3mC,OAxCZ,CAAC2mC,IACrB,MAAMC,EAAeh2B,EAAIrmB,KAAKyzB,kBAAoBpN,EAAIrmB,KAAKyzB,oBAAuB,KAElFuoB,EAAW,IAAIM,sBACb,EAAEtoB,MACIA,EAAQuoB,qBAKVl2B,EAAIjO,QAAQ,qBACd,GAEF,CACEokC,UAAW,GAIX/kB,KAAM4kB,IAGVL,EAASS,QAAQL,EAAO,EAyBxBM,CAAcN,GALZvzC,QAAQsB,KAAK,0CAKM,IAGnBkc,EAAAzC,GAAG,aAAa,WAEnB,ECpDqCyC,IACtC,MAAMnb,EAAU,KACR,MAAA0C,EAAOyY,EAAIhrB,IAAI,QAEfm4B,EAAYnN,EAAIrmB,KAAKyzB,kBAAoBpN,EAAIrmB,KAAKyzB,oBACtDD,GAAa/d,QAAQ2V,OAAO,CAC5B3Q,IAAKkiC,GAAgB/uC,EAAKsgB,IAAKsF,GAAW/Y,IAC1CC,KAAM,GACP,EAGC2L,EAAAzC,GAAG,WAAW,KACZyC,EAAAzC,GAAG,kBAAmB1Y,EAAO,IAG/Bmb,EAAAzC,GAAG,aAAa,KACdyC,EAAAxC,IAAI,kBAAmB3Y,EAAO,GACnC,GCnBoCmb,IACjCA,EAAAzC,GAAG,cAAevnB,IACpB,GAAsB,IAAlBA,EAAOosB,OAAc,OAEzB,MAAMrmB,EAAOikB,EAAIqB,SAAS7b,gBACrBzJ,GAIFikB,EAAAqB,SACA9O,SAASzY,YAAYiC,GACrBhF,MAAM4pB,IACLX,EAAIG,UAAU3N,eAAemO,EAAI9sB,KAAK0e,SAAQ,GAC/C,GACJ,EzCGyCyN,IACtCA,EAAAM,UAAU,CAAC,OAAQ,UAAW,YAAa,UAAW,OAAQ,oBAAqB3mB,IACrE8tC,GAAA,CACdpmB,OAAQ,IAAMrB,EAAIqB,SAClBpB,SAAUtmB,EAAK0B,KACfsiB,QAAShkB,EAAKgkB,QACdC,UAAWjkB,EAAKikB,UAChBW,QAAS5kB,EAAK4kB,QACdC,KAAM7kB,EAAK6kB,KACXoqB,YAAajvC,EAAK8kB,gBAClBqpB,MAAiC,kBAAnB9nB,EAAIrmB,KAAKmuC,OAAsB9nB,EAAIrmB,KAAKmuC,OACvD,GACF,EqBtBwC9nB,IACzCA,EAAIM,UAAU,CAAC,aAAc,iBAAkB3mB,IACvC,MAAA4N,EAAOyY,EAAIhrB,IAAI,QACjB2E,EAAK48C,YAAc58C,EAAKylB,eAAiB6yB,IAKxC,SAAa1qC,EAAYivC,EAAeC,GACzC,MAAAC,EhFsGQ,SAAe1qC,EAAW4U,GAClC,MAAA+1B,EAAK3qC,EAAEhB,MAAM,KACb4rC,EAAKh2B,EAAE5V,MAAM,KACnB,IAAA,IAAShO,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAC1B,MAAM65C,EAAKhgC,OAAO8/B,EAAG35C,IACf85C,EAAKjgC,OAAO+/B,EAAG55C,IACrB,GAAI65C,EAAKC,EAAW,OAAA,EACpB,GAAIA,EAAKD,EAAW,OAAA,EACpB,IAAKhgC,OAAOqsB,MAAM2T,IAAOhgC,OAAOqsB,MAAM4T,GAAY,OAAA,EAClD,GAAIjgC,OAAOqsB,MAAM2T,KAAQhgC,OAAOqsB,MAAM4T,GAAY,OAAA,CACpD,CACO,OAAA,CACT,CgFlHeC,CAAqBP,EAAOC,GAErC,GADqB,IAATC,EACH,OAEb,MAAM/E,EAAQ9tB,GACZ,yCAAyC/O,GAAG,YAAa,CACvD5S,KAAiB4S,GAAX4hC,EAAO,EAAO,WAAiB,uCAElC5hC,GAAG,sBAAsBA,GAAG,eAAe0hC,OAAW1hC,GAAG,cAAc2hC,kBAGxEO,EAAYnzB,GAAoB,gCAAgC/O,GAAG,oBACzEkiC,EAAUtwB,QAAU,KAClBirB,EAAMxsB,SACe8sB,IAAA,CAAA,EAEvBN,EAAMn9C,OAAOwiD,GACRzvC,EAAAsgB,IAAIsjB,cAAerY,QAAQ6e,EAClC,CAvBmBvyB,CAAA7X,EAAMguC,GAAgB57C,EAAK48C,WAAU,GACrD,ECCoCv2B,IAEjC,IAAAi3B,EAEE,MAAAC,EAAQn5B,IAEN,MAAAq0B,EAAO,CAACpyB,EAAIe,MAAOf,EAAIhrB,IAAI,gBAAgBwuB,SAG5C0uB,KACaA,GAAA9iC,OAAO0Q,WAAW,iCAGnB,SAAb/B,GAEGk5B,IAEHA,EAAuBx5B,GAAQ00B,GAAiBC,EAAM30B,EAAIjS,SAC5C0mC,GAAAzuC,iBAAiB,SAAUwzC,IAI1B9E,GAAAC,EAAMF,GAAc1mC,WAGjCyrC,IACY/E,GAAAlxC,oBAAoB,SAAUi2C,GACtBA,OAAA,GAIxB9E,GAAiBC,EAAMr0B,GACzB,EAGEiC,EAAAM,UAAU,CAAC,aAAc3mB,GAASu9C,EAAKv9C,EAAKokB,YAChDiC,EAAIzC,GAAG,WAAW,IAAM25B,EAAKl3B,EAAIrmB,KAAKokB,YAClCiC,EAAAzC,GAAG,aAAa,KAEK05B,IAAA,MAAA/E,IAAAA,GAAelxC,oBAAoB,SAAUi2C,IAC9CA,OAAA,CAAA,GACvB,GoBhDUE,GAAuC,IAAA3O,IAAI,IAAI8J,KAE5D,SAAsB8E,GAAKp3B,GAAiB,OAAAzqB,EAAAlC,KAAA,MAAA,kBACpC,MAAAgkD,MAAoB7O,IACpB8O,EAAeC,IACXA,EAAA7sC,SAAS6iB,IACO,mBAAXA,GAA0B8pB,EAAcviD,IAAIy4B,KACrDA,EAAOvN,GACPq3B,EAAcp2B,IAAIsM,GACpB,GACD,EAIH+pB,EAAYH,IAGZ,MAAMtjD,KAAEA,SAAemsB,EACpBqB,SACA1nB,KAAKA,OACLvC,OAAOgL,IAEA,MAwFI,SAAU4d,EAAiB5d,SACzC,IAAIo1C,EAAkB,GAGlB,GAAA,OAAAliD,EAAA8M,EAAIvO,WAAJ,EAAAyB,EAAUmiD,YAAa,CACzB,MAAMC,EAAgB,CACpBC,YAAa33B,EAAIrmB,KAAK0B,KACtBu8C,YAAa,GAAGxoC,OAAOC,SAAS8H,aAAa/H,OAAOC,SAASwoC,QAE/DL,EAAkB,SAASxjD,KAAKC,UAAUyjD,IAC5C,CAEgBhG,GAAA,CACdM,KAAMhyB,EAAIhrB,IAAI,QAAQ6yB,IACtBoa,OAAQ7/B,EAAI6C,KAAOkB,OAAO/D,GAC1BszC,QAAStzC,EAAIvO,KACb+9C,QAAS,IAAMwF,GAAKp3B,GACpB8xB,cAAe9xB,EAAIhrB,IAAI,QAAQmrB,UAAUsH,QACrC,IACEzH,EAAI8C,YAAY,CACdkN,KAAMwnB,SAEV,GAER,CAjHMM,CAAU93B,EAAK5d,GACTA,CAAA,IAIV,IAAIzI,EAA8B,CAChC48C,WAAY,OAAAjhD,EAAKzB,EAAA+S,cAAS,EAAAtR,EAAAsR,SAIxB,GAAAoZ,EAAIrmB,KAAK0lB,eAAgB,CAC3B,IAAKxrB,EAAKkkD,cACR,MAAM,IAAI91C,MACR,kGAEJtI,EAAO9C,EAAKA,EAAA,CAAA,EAAA8C,G9FiBT,SAA8BA,GACnC,MAAMq+C,EAAuC,CAC3C,KACA,UACA,YACA,SACA,OACA,OACA,UACA,mBAiBK,OAfP9jD,OAAOC,KAAKwF,GAAM+Q,SAASkjB,IACrBoqB,EAAa7nB,SAASvC,WAAkBj0B,EAAKi0B,GACvC,aAANA,GAAgC,SAAZj0B,EAAKi0B,WAAsBj0B,EAAKi0B,EAAC,IAIvDj0B,EAAKykB,WAAuC,iBAAnBzkB,EAAKykB,YAC3BzkB,EAAAykB,UAAYzkB,EAAKykB,UAAUlT,OAC5BvR,EAAKykB,UAAU65B,WAAW,MAAQt+C,EAAKykB,UAAU65B,WAAW,KAC9Dt+C,EAAKykB,UAAYpqB,KAAKsc,MAAM3W,EAAKykB,WACL,UAAnBzkB,EAAKykB,YACdzkB,EAAKykB,WAAY,IAIdzkB,CACT,C8F5CyBu+C,CAAqBrkD,EAAKkkD,eACjD,CAGA/3B,EAAIrmB,KAAKw+C,oBAAsBn4B,EAAIrmB,KAAKw+C,mBAAmBx+C,GAGtDA,EAAAy+C,mBA4BQ,SAAmBC,EAAmBC,GAA6C,OAAA/iD,EAAAlC,KAAA,MAAA,YAC1F,MAAAklD,MAAqB/P,IAC3B,IAAK6P,IAAYpgD,MAAMC,QAAQmgD,GAAiB,OAAAE,EAEhD,MAAMC,EAAyB,GAgCxB,OA9BCH,EAAA3tC,SAASwM,IAEV,qBAAqBlO,KAAKkO,KACvBA,EAAA,GAAGohC,EAAQlyC,QAAQ,MAAO,OAAO8Q,EAAI9Q,QAAQ,MAAO,OAEtDoyC,EAAAn4C,KACJ,IAAIQ,SAAc,CAACC,EAASwC,KAE1B,GAAI5B,SAASie,cAAc,eAAezI,OAExC,gBAII,MAAAuhC,EAAS/2C,SAASiR,cAAc,UACtC8lC,EAAOroC,IAAM8G,EACJxV,SAAAg3C,KAAK10B,YAAYy0B,GACnBA,EAAA1yB,OAAS,IAAMjlB,IACtB23C,EAAOE,QAAWv2C,GAAQkB,EAAOlB,EAAG,IACrC,UAICvB,QAAQ8qC,IAAI6M,GAGXtkD,OAAAg4C,OAAO98B,OAAOwpC,eAAiB,CAAA,GAAIluC,SAAS6iB,IAC3B,mBAAXA,GAAuBgrB,EAAet3B,IAAIsM,EAAM,IAGtDgrB,CACT,GAAA,CAhEWM,CAAmBl/C,EAAKy+C,WAAYp4B,EAAIrmB,KAAKkkB,QACjD9mB,MAAMwgD,IACLD,EAAYC,EAAO,IAEpBngD,OAAOgL,IACEI,QAAAtL,MAAM,wBAAyBkL,EAAG,KAIhD4d,EAAIjO,QAAQ,WAGZiO,EAAIsD,WAAW3pB,GAGfqmB,EAAIjO,QAAQ,WAGPiO,EAAIrmB,KAAKw+C,oBAEZn4B,EAAIxsB,MAAM,CAAE4uB,OAAQ,GAExB,GAAA,CCzDA,MAAqB02B,GAGnB,WAAA5lD,CAAYyG,GAFLvG,EAAAC,KAAA,OAIC,MAAA0lD,EAAcz5B,GAAiB3lB,GAAM,GAGtCtG,KAAA2sB,IAAM,IAAIa,GAAQk4B,GAGhB7kD,OAAAy5B,QAAQqrB,IAAUtuC,SAAQ,EAAExI,EAAM+2C,MACjC,MAAAloC,EAAMkoC,EAAY5lD,KAAK2sB,KAC7BjP,GAAO1d,KAAK2sB,IAAImB,OAAOjf,EAAiC6O,EAAG,IAM3DqmC,GAAK/jD,KAAK2sB,IAEd,CAGO,OAAAU,GACE,OAAArtB,KAAK2sB,IAAIU,SAClB,CAGO,KAAA8C,GACL,OAAOnwB,KAAK2sB,IAAIe,KAClB,CAGO,MAAAyG,CAAO7tB,GAEL,OADFtG,KAAA2sB,IAAIsD,WAAW3pB,GACbtG,IACT,CAGO,MAAA8uB,GACL9uB,KAAK2sB,IAAImC,QACX,CAGO,OAAA4G,GAEE,IADF11B,KAAA2sB,IAAIjO,QAAQ,aACV1e,KAAK2sB,IAAIe,MAAMm4B,YACpB7lD,KAAK2sB,IAAIe,MAAMukB,YAAYjyC,KAAK2sB,IAAIe,MAAMm4B,WAE9C,CAGO,EAAA37B,CAAoCrb,EAAS2C,GAC7CxR,KAAA2sB,IAAIzC,GAAGrb,EAAM2C,EACpB,CAGO,GAAA2Y,CAAqCtb,EAAS2C,GAC9CxR,KAAA2sB,IAAIxC,IAAItb,EAAM2C,EACrB,CAGO,OAAAkN,CAAyC7P,EAASwb,GAClDrqB,KAAA2sB,IAAIjO,QAAQ7P,EAAMwb,EACzB,CAGO,WAAA2F,CAAYtF,GACZ1qB,KAAA2sB,IAAIqD,YAAYtF,EACvB,CAOA,WAAc7a,CAAKvJ,GACV,OAAA,IAAIm/C,GAAOn/C,EACpB,CAGA,UAAcw/C,CAAI5rB,GAChB4pB,GAAcl2B,IAAIsM,EACpB,CAGA,sBAAc6rB,CAAgBlnC,GACtB,MAAAvY,EAAO2lB,GAAiBpN,GAAG,GAEZu1B,GAAA,CACnBpmB,OAAQ,IAAM,IAAIjc,EAAI2a,GAAkBpmB,IACxCsmB,SAAUtmB,EAAK0B,KACfkjB,QAAS5kB,EAAK4kB,QACdC,KAAM7kB,EAAK6kB,KACXoqB,YAAajvC,EAAK8kB,gBAClBqpB,OAAO,GAEX,CAOA,SAAW/mB,GACT,OAAO1tB,KAAK2sB,IAAIe,KAClB,CAGA,QAAWpnB,GACF,OAAAtG,KAAK2sB,IAAIU,SAClB,ECpHK,MAAMxd,GAAO41C,GAAO51C,KACdi2C,GAAML,GAAOK,IACbC,GAAkBN,GAAOM","x_google_ignoreList":[1,4,5,6,7,8,9,10,11,12,13,15]}